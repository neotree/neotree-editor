"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2269],{18934:function(e,i,a){a.d(i,{U:function(){return s}});var n=a(2265),t=a(20920);function s(e){return{getDefaultValues:(0,n.useCallback)(()=>({fieldId:(null==e?void 0:e.fieldId)||(0,t.Z)(),type:(null==e?void 0:e.type)||"",key:(null==e?void 0:e.key)||"",label:(null==e?void 0:e.label)||"",refKey:(null==e?void 0:e.refKey)||"",calculation:(null==e?void 0:e.calculation)||"",condition:(null==e?void 0:e.condition)||"",dataType:(null==e?void 0:e.dataType)||"",defaultValue:(null==e?void 0:e.defaultValue)||"",format:(null==e?void 0:e.format)||"",minValue:(null==e?void 0:e.minValue)||"",maxValue:(null==e?void 0:e.maxValue)||"",minDate:(null==e?void 0:e.minDate)||"",maxDate:(null==e?void 0:e.maxDate)||"",minTime:(null==e?void 0:e.minTime)||"",maxTime:(null==e?void 0:e.maxTime)||"",minDateKey:(null==e?void 0:e.minDateKey)||"",maxDateKey:(null==e?void 0:e.maxDateKey)||"",minTimeKey:(null==e?void 0:e.minTimeKey)||"",maxTimeKey:(null==e?void 0:e.maxTimeKey)||"",values:(null==e?void 0:e.values)||"",confidential:(null==e?void 0:e.confidential)||!1,optional:(null==e?void 0:e.optional)||!1,printable:(null==e?void 0:e.printable)||!1,prePopulate:(null==e?void 0:e.prePopulate)||[],...e}),[e])}}},80929:function(e,i,a){a.d(i,{A:function(){return h}});var n=a(57437),t=a(2265),s=a(16463),l=a(12491),r=a(20920),o=a(5192),u=a(95317),d=a(50495),m=a(83102),c=a(93146),g=a(67135),v=a(39661),f=a(44371);let x=e=>({itemId:"".concat((null==e?void 0:e.itemId)||(0,r.Z)()),key:"".concat((null==e?void 0:e.key)||""),drug:"".concat((null==e?void 0:e.drug)||""),minGestation:"".concat((null==e?void 0:e.minGestation)===null?"":null==e?void 0:e.minGestation),maxGestation:"".concat((null==e?void 0:e.maxGestation)===null?"":null==e?void 0:e.maxGestation),minWeight:"".concat((null==e?void 0:e.minWeight)===null?"":null==e?void 0:e.minWeight),maxWeight:"".concat((null==e?void 0:e.maxWeight)===null?"":null==e?void 0:e.maxWeight),minAge:"".concat((null==e?void 0:e.minAge)===null?"":null==e?void 0:e.minAge),maxAge:"".concat((null==e?void 0:e.maxAge)===null?"":null==e?void 0:e.maxAge),dosage:"".concat((null==e?void 0:e.dosage)===null?"":null==e?void 0:e.dosage),dosageMultiplier:"".concat((null==e?void 0:e.dosageMultiplier)===null?"":null==e?void 0:e.dosageMultiplier),dayOfLife:"".concat((null==e?void 0:e.dayOfLife)||""),dosageText:"".concat((null==e?void 0:e.dosageText)||""),managementText:"".concat((null==e?void 0:e.managementText)||""),gestationKey:"".concat((null==e?void 0:e.gestationKey)||""),weightKey:"".concat((null==e?void 0:e.weightKey)||""),diagnosisKey:"".concat((null==e?void 0:e.diagnosisKey)||""),administrationFrequency:"".concat((null==e?void 0:e.administrationFrequency)||""),drugUnit:"".concat((null==e?void 0:e.drugUnit)||""),routeOfAdministration:"".concat((null==e?void 0:e.routeOfAdministration)||""),ageKey:"".concat((null==e?void 0:e.ageKey)||"")});function h(e){let{disabled:i,item:a,floating:r,onChange:h}=e,[b,y]=(0,o.Z)(),[p,j]=(0,o.Z)(),[N,T]=(0,t.useState)(!1),[w,A]=(0,t.useState)(x(a)),K=(0,s.useRouter)(),D=(0,s.useSearchParams)(),I=(0,t.useMemo)(()=>l.Z.parse(D.toString()),[D]),{itemId:k,addDrug:C}=I,{keys:G,loading:W}=(0,f.a)();(0,t.useEffect)(()=>{T(!!k||!!C)},[k,C]),(0,t.useEffect)(()=>{A(x(a))},[a]);let F=(0,t.useCallback)(()=>{h({...w,minWeight:w.minWeight?Number(w.minWeight):null,maxWeight:w.maxWeight?Number(w.maxWeight):null,minGestation:w.minGestation?Number(w.minGestation):null,maxGestation:w.maxGestation?Number(w.maxGestation):null,minAge:w.minAge?Number(w.minAge):null,maxAge:w.maxAge?Number(w.maxAge):null,dosage:w.dosage?Number(w.dosage):null,dosageMultiplier:w.dosageMultiplier?Number(w.dosageMultiplier):null})},[w,a,h]),S=(0,t.useCallback)(()=>{T(!1),A(x()),K.push("?".concat(l.Z.stringify({...I,itemId:void 0,addDrug:void 0})));let e=(null==y?void 0:y.top)||0;setTimeout(()=>window.scrollTo({top:e}),500)},[I,y,K.push]),_=(0,t.useCallback)(()=>!!(w.key&&w.drug&&w.minWeight&&w.minGestation&&w.maxWeight&&w.maxGestation&&w.minAge&&w.maxAge&&w.managementText&&w.dosageText&&w.diagnosisKey&&w.administrationFrequency&&w.drugUnit&&w.routeOfAdministration&&w.ageKey&&w.dosage&&Number(w.minGestation||"0")<=Number(w.maxGestation||"0")&&Number(w.minWeight||"0")<=Number(w.maxWeight||"0")&&Number(w.minAge||"0")<=Number(w.maxAge||"0")),[w]),M=(0,t.useCallback)(()=>!_()||W||i,[_,W,i]),E=(0,n.jsxs)("div",{className:"flex flex-col gap-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(g._,{secondary:!0,htmlFor:"drug",children:"Drug *"}),(0,n.jsx)(m.I,{name:"drug",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:w.drug,disabled:i,onChange:e=>A(i=>({...i,drug:e.target.value}))})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(g._,{secondary:!0,htmlFor:"key",children:"Key *"}),(0,n.jsx)(m.I,{name:"key",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:w.key,disabled:i,onChange:e=>A(i=>({...i,key:e.target.value}))})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(g._,{secondary:!0,htmlFor:"diagnosisKey",children:"Diagnosis Key *"}),(0,n.jsx)(c.g,{rows:3,name:"gestationKey",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:w.diagnosisKey,disabled:i,onChange:e=>A(i=>({...i,diagnosisKey:e.target.value}))}),(0,n.jsx)("span",{className:"opacity-80 text-xs",children:"e.g NSep,Premature,Dehyd"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(g._,{secondary:!0,htmlFor:"gestationKey",children:"Gestation Key *"}),(0,n.jsx)(m.I,{name:"gestationKey",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:w.gestationKey,disabled:i,onChange:e=>A(i=>({...i,gestationKey:e.target.value}))})]}),(0,n.jsxs)("div",{className:"flex gap-x-2",children:[(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)(g._,{secondary:!0,htmlFor:"minGestation",children:"Min Gestation (weeks) *"}),(0,n.jsx)(m.I,{name:"minGestation",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:w.minGestation,type:"number",disabled:i,onChange:e=>{let i=e.target.value,a=w.maxGestation;i||(a=""),A(e=>({...e,minGestation:i,maxGestation:a}))}})]}),(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)(g._,{secondary:!0,htmlFor:"maxGestation",error:Number(w.minGestation||"0")>Number(w.maxGestation||"0"),children:"Max Gestation (weeks) *"}),(0,n.jsx)(m.I,{name:"maxGestation",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:w.maxGestation,type:"number",disabled:i||!w.minGestation,min:w.minGestation,error:Number(w.minGestation||"0")>Number(w.maxGestation||"0"),onChange:e=>A(i=>({...i,maxGestation:e.target.value}))})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(g._,{secondary:!0,htmlFor:"weightKey",children:"Weight Key *"}),(0,n.jsx)(m.I,{name:"weightKey",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:w.weightKey,disabled:i,onChange:e=>A(i=>({...i,weightKey:e.target.value}))})]}),(0,n.jsxs)("div",{className:"flex gap-x-2",children:[(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)(g._,{secondary:!0,htmlFor:"minWeight",children:"Min Weight (grams) *"}),(0,n.jsx)(m.I,{name:"minWeight",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:w.minWeight,type:"number",disabled:i,onChange:e=>{let i=e.target.value,a=w.maxWeight;i||(a=""),A(e=>({...e,minWeight:i,maxWeight:a}))}})]}),(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)(g._,{secondary:!0,htmlFor:"maxWeight",error:Number(w.minWeight||"0")>Number(w.maxWeight||"0"),children:"Max Weight (grams) *"}),(0,n.jsx)(m.I,{name:"maxWeight",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:w.maxWeight,type:"number",disabled:i||!w.minWeight,min:w.minWeight,error:Number(w.minWeight||"0")>Number(w.maxWeight||"0"),onChange:e=>A(i=>({...i,maxWeight:e.target.value}))})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(g._,{secondary:!0,htmlFor:"ageKey",children:"Day of Life (Age) Key *"}),(0,n.jsx)(m.I,{name:"ageKey",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:w.ageKey,disabled:i,onChange:e=>A(i=>({...i,ageKey:e.target.value}))})]}),(0,n.jsxs)("div",{className:"flex gap-x-2",children:[(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)(g._,{secondary:!0,htmlFor:"minAge",children:"Min Day of Life (Age - hours) *"}),(0,n.jsx)(m.I,{name:"minAge",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:w.minAge,type:"number",disabled:i,onChange:e=>{let i=e.target.value,a=w.maxAge;i||(a=""),A(e=>({...e,minAge:i,maxAge:a}))}})]}),(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)(g._,{secondary:!0,htmlFor:"maxAge",error:Number(w.minAge||"0")>Number(w.maxAge||"0"),children:"Max Day of Life (Age - hours) *"}),(0,n.jsx)(m.I,{name:"maxAge",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:w.maxAge,type:"number",disabled:i||!w.minAge,min:w.minAge,error:Number(w.minAge||"0")>Number(w.maxAge||"0"),onChange:e=>A(i=>({...i,maxAge:e.target.value}))})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(g._,{secondary:!0,htmlFor:"dosage",children:"Dose (e.g. mg/kg) *"}),(0,n.jsx)(m.I,{name:"dosage",type:"number",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:w.dosage,disabled:i,onChange:e=>A(i=>({...i,dosage:e.target.value}))})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(g._,{secondary:!0,htmlFor:"dosageMultiplier",children:"Drug Dose Multiplier *"}),(0,n.jsx)(m.I,{name:"dosageMultiplier",type:"number",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:w.dosageMultiplier,disabled:i,onChange:e=>A(i=>({...i,dosageMultiplier:e.target.value}))})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(g._,{secondary:!0,htmlFor:"weight",children:"Dosage text *"}),(0,n.jsx)(m.I,{name:"dosageText",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:w.dosageText,disabled:i,onChange:e=>A(i=>({...i,dosageText:e.target.value}))})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(g._,{secondary:!0,htmlFor:"administrationFrequency",children:"Administration Frequency *"}),(0,n.jsx)(m.I,{name:"administrationFrequency",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:w.administrationFrequency,disabled:i,onChange:e=>A(i=>({...i,administrationFrequency:e.target.value}))})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(g._,{secondary:!0,htmlFor:"drugUnit",children:"Drug Unit *"}),(0,n.jsx)(m.I,{name:"drugUnit",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:w.drugUnit,disabled:i,onChange:e=>A(i=>({...i,drugUnit:e.target.value}))})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(g._,{secondary:!0,htmlFor:"routeOfAdministration",children:"Route of Administration *"}),(0,n.jsx)(m.I,{name:"routeOfAdministration",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:w.routeOfAdministration,disabled:i,onChange:e=>A(i=>({...i,routeOfAdministration:e.target.value}))})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(g._,{secondary:!0,htmlFor:"managementText",children:"Management text *"}),(0,n.jsx)(m.I,{name:"managementText",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:w.managementText,disabled:i,onChange:e=>A(i=>({...i,managementText:e.target.value}))})]})]});return(0,n.jsxs)(n.Fragment,{children:[W&&(0,n.jsx)(v.a,{overlay:!0}),(0,n.jsx)("div",{ref:b,children:!1===r?E:(0,n.jsx)(u.yo,{open:N,onOpenChange:e=>{e||S()},children:(0,n.jsxs)(u.ue,{hideCloseButton:!0,side:"right",className:"p-0 m-0 flex flex-col w-full max-w-full sm:max-w-[80%] md:max-w-[80%] lg:max-w-[50%]",children:[(0,n.jsxs)(u.Tu,{className:"flex flex-row items-center py-2 px-4 border-b border-b-border text-left sm:text-left",children:[(0,n.jsxs)(u.bC,{children:[C?"Add":"",k?"Edit":""," drug"]}),(0,n.jsx)(u.Ei,{className:"hidden"})]}),(0,n.jsx)("div",{ref:p,className:"flex-1 py-2 px-0 overflow-y-auto",children:(0,n.jsx)("div",{className:"px-4",children:E})}),(0,n.jsxs)("div",{className:"border-t border-t-border px-4 py-2 flex gap-x-2",children:[(0,n.jsx)("span",{className:"text-danger text-xs my-auto",children:"* Required"}),(0,n.jsx)("div",{className:"ml-auto"}),(0,n.jsx)(u.sw,{asChild:!0,children:(0,n.jsx)(d.z,{variant:"ghost",onClick:()=>{},children:"Cancel"})}),(0,n.jsx)(u.sw,{asChild:!0,children:(0,n.jsx)(d.z,{onClick:()=>F(),disabled:M(),children:"Save"})})]})]})})})]})}},76905:function(e,i,a){a.d(i,{Uv:function(){return s},VO:function(){return t},d4:function(){return n},fR:function(){return r}});let n=[{value:"allSearches",label:"Found in all searches"},{value:"admissionSearches",label:"Found in admission searches"},{value:"twinSearches",label:"Found in twin searches"}],t=[{label:"Days & hours",value:"days_hours"},{label:"Years & Months",value:"years_months"}],s=[{name:"date",label:"Date"},{name:"datetime",label:"Date + Time"},{name:"dropdown",label:"Dropdown"},{name:"number",label:"Number"},{name:"text",label:"Text"},{name:"time",label:"Time"},{name:"period",label:"Time period"}],l={calculation:null,condition:"",confidential:!1,dataType:null,defaultValue:null,format:null,type:null,key:null,refKey:null,label:null,minValue:null,maxValue:null,optional:!1,minDate:null,maxDate:null,minTime:null,maxTime:null,minDateKey:"",maxDateKey:"",minTimeKey:"",maxTimeKey:"",values:""},r={admission:[{...l,type:"dropdown",key:"BabyTransfered",values:"Y,Yes\nN,No",label:"Has the baby been transfered from another facility"},{...l,type:"text",key:"patientNUID",label:"Search patient's NUID",condition:"$BabyTransfered = 'Y'"},{...l,type:"dropdown",key:"BabyTwin",values:"Y,Yes\nN,No",label:"Does the baby have a twin?"},{...l,type:"text",key:"BabyTwinNUID",label:"Search twin's NUID",condition:"$BabyTwin = 'Y'"}],other:[{...l,type:"text",key:"patientNUID",values:"Y,Yes\nN,No",label:"Search patient's NUID"}]}},44371:function(e,i,a){a.d(i,{R:function(){return c},a:function(){return g}});var n=a(2265),t=a(16463),s=a(12491),l=a(38472),r=a(39099),o=a(53699),u=a(7752);let d={initialised:!1,loading:!1,keys:[],drugs:[]},m=(0,r.Ue)(e=>d);function c(){m.setState(d)}function g(){let e=m(),{drugs:i}=e,a=(0,t.useRouter)(),r=(0,t.useSearchParams)(),c=(0,n.useMemo)(()=>s.Z.parse(r.toString()),[r]),{itemId:g}=c,v=(0,n.useMemo)(()=>{var e;return null===(e=i.filter(e=>e.itemId===g||e.key===g)[0])||void 0===e?void 0:e.itemId},[g,i]),{alert:f}=(0,o.s)(),x=(0,n.useCallback)(async()=>{try{var e,i;m.setState({loading:!0});let a=await l.Z.get("/api/drugs-library?data="+JSON.stringify({returnDraftsIfExist:!0}));if(null===(e=a.data.errors)||void 0===e?void 0:e.length)throw Error(null===(i=a.data.errors)||void 0===i?void 0:i.join(", "));m.setState({drugs:a.data.data})}catch(e){f({title:"Error",message:e.message,variant:"error"})}finally{m.setState({loading:!1})}},[f]);!function(e){let{events:i}=e,a=(0,n.useMemo)(()=>i,[i]),s=(0,n.useRef)({eventsTimeouts:{},eventsTimestamps:{}});(0,n.useRef)(new Date().getTime());let l=(0,t.useRouter)();(0,n.useEffect)(()=>{a.forEach(e=>{let{name:i,action:a,delay:n=100,onEvent:t}=e;u.Z.on(i,function(){for(var e=arguments.length,r=Array(e),o=0;o<e;o++)r[o]=arguments[o];let u=()=>{var e,n;(!a||r[0]===a)&&(null===(e=t.callback)||void 0===e||e.call(t,...r),(null==t?void 0:t.refreshRouter)&&(console.log(i,"refreshing..."),l.refresh()),(null===(n=t.redirect)||void 0===n?void 0:n.to)&&(t.redirect.replace?l.replace(t.redirect.to):l.push(t.redirect.to)))},d=new Date().getTime();n?(clearTimeout(s.current.eventsTimeouts[i]),s.current.eventsTimeouts[i]=setTimeout(()=>{s.current.eventsTimestamps[i]=d,u()},n)):(s.current.eventsTimestamps[i]=new Date().getTime(),u())})})},[a,l])}({events:[{name:"data_changed",onEvent:{callback:async()=>{await x(),a.refresh()}}}]});let h=(0,n.useCallback)(async e=>{try{var i,n;m.setState(i=>({loading:!0,drugs:i.drugs.filter(i=>!e.includes(i.itemId))}));let t=await l.Z.delete("/api/drugs-library?data="+JSON.stringify({itemsIds:e}));if(null===(i=t.data.errors)||void 0===i?void 0:i.length)throw Error(null===(n=t.data.errors)||void 0===n?void 0:n.join(", "));a.refresh(),f({title:"",message:"Drug deleted successfully!",variant:"success"})}catch(e){f({title:"Error",message:e.message,variant:"error"})}finally{m.setState({loading:!1})}},[f,a.refresh]),b=(0,n.useCallback)(async e=>{try{var n,t;m.setState({loading:!0});let s=i;m.setState(i=>(s=!v&&e?[...i.drugs,e]:i.drugs.map(i=>i.itemId!==(null==e?void 0:e.itemId)?i:{...i,...e}),{loading:!0,drugs:s}));let r={data:e?[e]:s,broadcastAction:!0},o=await l.Z.post("/api/drugs-library/save",r);if(null===(n=o.data.errors)||void 0===n?void 0:n.length)throw Error(null===(t=o.data.errors)||void 0===t?void 0:t.join(", "));await x(),a.refresh(),f({title:"",message:"Drug".concat(e?"":"s"," saved successfully!"),variant:"success"})}catch(e){f({title:"Error",message:e.message,variant:"error"})}finally{m.setState({loading:!1})}},[i,v,a.refresh]);return(0,n.useEffect)(()=>{m.getState().initialised||(x(),m.setState({initialised:!0}))},[x]),(0,n.useCallback)(()=>{m.setState(d)},[]),{...e,selectedItemId:v,addLink:"?".concat(s.Z.stringify({...c,addDrug:1})),editLink:e=>"?".concat(s.Z.stringify({...c,itemId:e})),getDrugs:x,deleteDrugs:h,saveDrugs:b}}},78591:function(e,i,a){a.d(i,{s:function(){return n}});function n(e){let i=[],a=(e||"").split("\n").map(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.trim()}).map(e=>{let i=e.split(",");return{value:i[0],label:i[1]}}),n=a.map(e=>e.value),t=a.map(e=>e.label),s=a.filter(e=>!e.value||!e.label),l=n.filter((e,i)=>n.indexOf(e)!==i);return(t.filter((e,i)=>t.indexOf(e)!==i).length||l.length)&&i.push("Dropdown values contain duplicate data"),s.length&&i.push("Incorrect dropdown values format"),i}}}]);