(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7591],{98026:function(e,t,n){Promise.resolve().then(n.bind(n,27006)),Promise.resolve().then(n.bind(n,25704))},27006:function(e,t,n){"use strict";n.d(t,{DataKeyForm:function(){return D}});var r=n(57437),l=n(2265),a=n(39343),i=n(92513),s=n(45188),o=n(90399),d=n(12599),u=n(16463),c=n(87138),f=n(23920),p=n(46294),m=n(46910),v=n(50495),h=n(67135),x=n(83102),g=n(76230),y=n(44380),j=n(83146),b=n(39661),N=n(27475),C=n(36013),w=n(71239);function D(e){let{loadingDataKeys:t}=(0,f.M)();return t?(0,r.jsx)(b.a,{overlay:!0}):(0,r.jsx)(k,{...e})}function k(e){let{disabled:t}=e,{dataKeyId:n}=(0,u.useParams)(),{dataKeys:D,loadingDataKeys:k,saving:R,saveDataKeys:I}=(0,f.M)(),{confirm:_}=(0,g.t)(),T=(0,l.useMemo)(()=>D.find(e=>e.uuid===n),[D,n]),M=(0,w.v)({isDraft:!!(null==T?void 0:T.isDraft),userId:null==T?void 0:T.draftCreatedByUserId});t=t||M;let{control:E,register:F,handleSubmit:Z,watch:P,setValue:O}=(0,a.cI)({defaultValues:{...T,name:(null==T?void 0:T.name)||"",refId:(null==T?void 0:T.refId)||"",dataType:(null==T?void 0:T.dataType)||"",label:(null==T?void 0:T.label)||"",options:(null==T?void 0:T.options)||[],metadata:(null==T?void 0:T.metadata)||{},version:(null==T?void 0:T.version)||1}}),A=P("dataType"),S=P("options"),V=j.y0.find(e=>e.value===A),W=Z(async e=>{await I([e],e=>{e||(window.location.href="/data-keys")})}),L=t||R,q=(0,l.useMemo)(()=>S.map(e=>D.find(t=>t.uniqueKey===e)).filter(e=>e),[D,S]),z=k||R;return(0,r.jsxs)(r.Fragment,{children:[z&&(0,r.jsx)(b.a,{overlay:!0}),(0,r.jsx)(C.Zb,{children:(0,r.jsxs)(C.aY,{children:[(0,r.jsxs)(C.Ol,{children:[(0,r.jsxs)(C.ll,{children:[T?"Edit":"New"," data key"]}),(0,r.jsx)(C.SZ,{className:"hidden",children:""})]}),(0,r.jsxs)("div",{className:"flex-1 flex flex-col py-2 px-0 gap-y-4 overflow-y-auto",children:[(0,r.jsx)(a.Qr,{control:E,name:"dataType",disabled:L,rules:{required:!0},render:e=>{let{field:{value:t,onChange:n}}=e;return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:"px-4",children:[(0,r.jsx)(h._,{htmlFor:"name",children:"Data type *"}),(0,r.jsxs)(p.Ph,{value:t,name:"name",disabled:L,onValueChange:e=>{n(e);let t=j.y0.find(t=>t.value===e);O("options",(null==t?void 0:t.hasChildren)&&(null==T?void 0:T.options)||[])},children:[(0,r.jsx)(p.i4,{children:(0,r.jsx)(p.ki,{placeholder:"Select type"})}),(0,r.jsx)(p.Bw,{children:(0,r.jsx)(p.DI,{children:j.y0.map(e=>(0,r.jsx)(p.Ql,{value:e.value,children:e.label},e.value))})})]})]})})}}),(0,r.jsxs)("div",{className:"px-4",children:[(0,r.jsx)(h._,{htmlFor:"name",children:"Key *"}),(0,r.jsx)(x.I,{disabled:L,...F("name",{disabled:L,required:!0})})]}),(0,r.jsxs)("div",{className:"px-4",children:[(0,r.jsx)(h._,{htmlFor:"label",children:"Label *"}),(0,r.jsx)(x.I,{disabled:L,...F("label",{disabled:L,required:!0})})]}),(0,r.jsxs)("div",{className:"px-4 hidden",children:[(0,r.jsx)(h._,{htmlFor:"refId",children:"Ref ID"}),(0,r.jsx)(x.I,{disabled:L,...F("refId",{disabled:L,required:!1})})]}),(0,r.jsx)(a.Qr,{control:E,name:"options",disabled:L,render:e=>{let{field:{value:n,onChange:l}}=e;return(null==V?void 0:V.hasChildren)?(0,r.jsx)("div",{className:"mt-4 pt-4 border-t border-t-border",children:(0,r.jsx)(y.DataTable,{sortable:!t,onSort:(e,t)=>{l((0,d.q)([...n],e,t))},search:{},title:"Options",headerActions:(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(N.V,{multiple:!0,search:{placeholder:"Search data keys"},options:D.filter(e=>!S.includes(e.uniqueKey)).map(e=>({label:e.name,value:e.uniqueKey,caption:e.dataType||"",description:e.label})),trigger:(0,r.jsxs)(v.z,{variant:"ghost",className:"w-auto h-auto",children:[(0,r.jsx)(i.Z,{className:"w-4 h-4 mr-2"}),"Add"]}),onSelect:e=>{l([...n,...e.map(e=>e.value)])}})}),noDataMessage:(0,r.jsx)("div",{className:"mt-4 flex flex-col items-center justify-center gap-y-2",children:(0,r.jsx)("div",{children:"Data keys has no options"})}),columns:[{name:"Key"},{name:"Label"},{name:"Data type"},{name:"",align:"right",cellClassName:"w-20",cellRenderer(e){let{rowIndex:l}=e;return!n[l]||t?null:(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)(m.h_,{children:[(0,r.jsx)(m.$F,{children:(0,r.jsx)(s.Z,{className:"h-4 w-4"})}),(0,r.jsx)(m.AW,{children:(0,r.jsxs)(m.Xi,{className:"text-destructive",onClick:()=>setTimeout(()=>_(()=>O("options",S.filter((e,t)=>t!==l)),{title:"Delete",message:"Are you sure you want to delete data key option?",danger:!0}),0),children:[(0,r.jsx)(o.Z,{className:"h-4 w-4 mr-2"})," Delete"]})})]})})}}],data:q.map(e=>[e.name||"",e.label||"",e.dataType||"",""])})}):(0,r.jsx)(r.Fragment,{})}})]}),(0,r.jsx)("br",{}),(0,r.jsxs)(C.eW,{className:"gap-x-2",children:[(0,r.jsx)("div",{className:"ml-auto"}),(0,r.jsx)(v.z,{asChild:!0,variant:"ghost",children:(0,r.jsx)(c.default,{href:"/data-keys",children:"Cancel"})}),!t&&(0,r.jsx)(v.z,{onClick:()=>W(),disabled:L,children:"Save"})]})]})})]})}},39661:function(e,t,n){"use strict";n.d(t,{a:function(){return a}});var r=n(57437),l=n(89627);function a(e){let{overlay:t,transparent:n,padding:a="50px 0"}=e;return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("div",{style:{width:"100%",display:"flex",justifyContent:"center",alignItems:"center",...t?{height:"100%",position:"fixed",top:0,left:0,bottom:0,zIndex:999,backgroundColor:n?"transparent":"rgba(255,255,255,.6)"}:{padding:a}},children:(0,r.jsx)(l.Z,{style:{height:24,width:24},className:"animate-spin"})})})}},58502:function(e,t,n){"use strict";n.d(t,{SocketEventsListener:function(){return i}});var r=n(2265),l=n(16463),a=n(7752);function i(e){let{events:t}=e,n=(0,r.useRef)({eventsTimeouts:{},eventsTimestamps:{}});(0,r.useRef)(new Date().getTime());let i=(0,l.useRouter)();return(0,r.useEffect)(()=>{t.forEach(e=>{let{name:t,action:r,delay:l=100,onEvent:s}=e;a.Z.on(t,function(){for(var e=arguments.length,a=Array(e),o=0;o<e;o++)a[o]=arguments[o];let d=()=>{var e,n;(!r||a[0]===r)&&(null===(e=s.callback)||void 0===e||e.call(s,...a),(null==s?void 0:s.refreshRouter)&&(console.log(t,"refreshing..."),i.refresh()),(null===(n=s.redirect)||void 0===n?void 0:n.to)&&(s.redirect.replace?i.replace(s.redirect.to):i.push(s.redirect.to)))},u=new Date().getTime();l?(clearTimeout(n.current.eventsTimeouts[t]),n.current.eventsTimeouts[t]=setTimeout(()=>{n.current.eventsTimestamps[t]=u,d()},l)):(n.current.eventsTimestamps[t]=new Date().getTime(),d())})})},[t,i]),null}},25704:function(e,t,n){"use strict";n.d(t,{Title:function(){return a}});var r=n(2265),l=n(20357);function a(e){let{children:t}=e;return(0,r.useEffect)(()=>{document.title=[l.env.NEXT_PUBLIC_APP_NAME||"",t||""].filter(e=>e).join(" - ")},[t]),(0,r.useEffect)(()=>()=>{document.title="".concat(l.env.NEXT_PUBLIC_APP_NAME||"")},[]),null}},36013:function(e,t,n){"use strict";n.d(t,{Ol:function(){return s},SZ:function(){return d},Zb:function(){return i},aY:function(){return u},eW:function(){return c},ll:function(){return o}});var r=n(57437),l=n(2265),a=n(37440);let i=l.forwardRef((e,t)=>{let{className:n,...l}=e;return(0,r.jsx)("div",{ref:t,className:(0,a.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",n),...l})});i.displayName="Card";let s=l.forwardRef((e,t)=>{let{className:n,...l}=e;return(0,r.jsx)("div",{ref:t,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",n),...l})});s.displayName="CardHeader";let o=l.forwardRef((e,t)=>{let{className:n,...l}=e;return(0,r.jsx)("h3",{ref:t,className:(0,a.cn)("text-2xl font-semibold leading-none tracking-tight",n),...l})});o.displayName="CardTitle";let d=l.forwardRef((e,t)=>{let{className:n,...l}=e;return(0,r.jsx)("p",{ref:t,className:(0,a.cn)("text-sm text-muted-foreground",n),...l})});d.displayName="CardDescription";let u=l.forwardRef((e,t)=>{let{className:n,...l}=e;return(0,r.jsx)("div",{ref:t,className:(0,a.cn)("p-6 pt-0",n),...l})});u.displayName="CardContent";let c=l.forwardRef((e,t)=>{let{className:n,...l}=e;return(0,r.jsx)("div",{ref:t,className:(0,a.cn)("flex items-center p-6 pt-0",n),...l})});c.displayName="CardFooter"},67135:function(e,t,n){"use strict";n.d(t,{_:function(){return d}});var r=n(57437),l=n(2265),a=n(38364),i=n(13027),s=n(37440);let o=(0,i.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=l.forwardRef((e,t)=>{let{className:n,secondary:l,error:i,...d}=e;return(0,r.jsx)(a.f,{ref:t,className:(0,s.cn)(o(),l&&"text-xs",i?"text-danger":"",n),...d})});d.displayName=a.f.displayName},17647:function(e,t,n){"use strict";n.d(t,{AppContextProvider:function(){return x},b:function(){return h}});var r=n(57437),l=n(2265),a=n(79512),i=n(16463),s=n(23314),o=n(44785);let d=o.Z.get,u=o.Z.set;o.Z.remove;var c={get:d,set:u};function f(){let e=c.get("mode");return e||(e="view",c.set("mode",e,{expires:31536e7})),e}var p=n(7752),m=n(58502);let v=(0,l.createContext)(null),h=()=>(0,l.useContext)(v);function x(e){let{children:t,...n}=e,o=function(e){(0,i.useRouter)();let{isAdmin:t,isSuperUser:n,sys:r}=e,{setTheme:s}=(0,a.F)();(0,l.useEffect)(()=>{"yes"===r.data.hide_theme_toggle&&s("light")},[r]);let o=(0,l.useCallback)(()=>(t||n?f():"view")||"view",[n,t]),[d,u]=(0,l.useState)(o()),m=!t&&!n||"view"===d,v=(0,l.useCallback)(function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let r=function(e){return c.set("mode",e,{expires:31536e7}),f()}(...t);return p.Z.emit("mode_changed",o()),u(o()),r},[o]),h=(0,l.useCallback)(()=>{u(o())},[o]);return{...e,mode:d,viewOnly:m,onModeChange:h,getMode:f,setMode:v}}(n),[d,u]=(0,l.useState)(!1);return((0,s.Z)(()=>{u(!0)}),d)?(0,r.jsxs)(v.Provider,{value:o,children:[t,(0,r.jsx)(m.SocketEventsListener,{events:[{name:"mode_changed",onEvent:{callback:o.onModeChange}}]})]}):null}},76230:function(e,t,n){"use strict";n.d(t,{t:function(){return a}});var r=n(39099);let l={danger:!1,title:"Confirm",message:"Are you sure?",positiveLabel:"Ok",negativeLabel:"Cancel"},a=(0,r.Ue)(e=>({isOpen:!1,...l,confirm:(t,n)=>e({isOpen:!0,...l,...n,onConfirm:t}),close:()=>e({isOpen:!1,onConfirm:void 0,...l})}))},71239:function(e,t,n){"use strict";n.d(t,{v:function(){return l}});var r=n(17647);function l(e){let{isDraft:t,userId:n}=e,{authenticatedUser:l}=(0,r.b)();return!!(t&&n&&n!==(null==l?void 0:l.userId))}},7752:function(e,t,n){"use strict";var r=n(45040),l=n(20357);let a=(0,r.io)(l.env.NEXT_PUBLIC_APP_URL);t.Z=a},45188:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.399.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,n(78030).Z)("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]])},92513:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.399.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,n(78030).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},90399:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.399.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,n(78030).Z)("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]])},74697:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.399.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,n(78030).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},87138:function(e,t,n){"use strict";n.d(t,{default:function(){return l.a}});var r=n(231),l=n.n(r)},13304:function(e,t,n){"use strict";n.d(t,{Dx:function(){return er},VY:function(){return en},aV:function(){return et},dk:function(){return el},fC:function(){return G},h_:function(){return ee},jm:function(){return H},p8:function(){return b},x8:function(){return ea},xz:function(){return J}});var r=n(2265),l=n(78149),a=n(1584),i=n(98324),s=n(53201),o=n(91715),d=n(53938),u=n(80467),c=n(56935),f=n(31383),p=n(25171),m=n(20589),v=n(49418),h=n(78369),x=n(71538),g=n(57437),y="Dialog",[j,b]=(0,i.b)(y),[N,C]=j(y),w=e=>{let{__scopeDialog:t,children:n,open:l,defaultOpen:a,onOpenChange:i,modal:d=!0}=e,u=r.useRef(null),c=r.useRef(null),[f,p]=(0,o.T)({prop:l,defaultProp:null!=a&&a,onChange:i,caller:y});return(0,g.jsx)(N,{scope:t,triggerRef:u,contentRef:c,contentId:(0,s.M)(),titleId:(0,s.M)(),descriptionId:(0,s.M)(),open:f,onOpenChange:p,onOpenToggle:r.useCallback(()=>p(e=>!e),[p]),modal:d,children:n})};w.displayName=y;var D="DialogTrigger",k=r.forwardRef((e,t)=>{let{__scopeDialog:n,...r}=e,i=C(D,n),s=(0,a.e)(t,i.triggerRef);return(0,g.jsx)(p.WV.button,{type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":U(i.open),...r,ref:s,onClick:(0,l.M)(e.onClick,i.onOpenToggle)})});k.displayName=D;var R="DialogPortal",[I,_]=j(R,{forceMount:void 0}),T=e=>{let{__scopeDialog:t,forceMount:n,children:l,container:a}=e,i=C(R,t);return(0,g.jsx)(I,{scope:t,forceMount:n,children:r.Children.map(l,e=>(0,g.jsx)(f.z,{present:n||i.open,children:(0,g.jsx)(c.h,{asChild:!0,container:a,children:e})}))})};T.displayName=R;var M="DialogOverlay",E=r.forwardRef((e,t)=>{let n=_(M,e.__scopeDialog),{forceMount:r=n.forceMount,...l}=e,a=C(M,e.__scopeDialog);return a.modal?(0,g.jsx)(f.z,{present:r||a.open,children:(0,g.jsx)(Z,{...l,ref:t})}):null});E.displayName=M;var F=(0,x.Z8)("DialogOverlay.RemoveScroll"),Z=r.forwardRef((e,t)=>{let{__scopeDialog:n,...r}=e,l=C(M,n);return(0,g.jsx)(v.Z,{as:F,allowPinchZoom:!0,shards:[l.contentRef],children:(0,g.jsx)(p.WV.div,{"data-state":U(l.open),...r,ref:t,style:{pointerEvents:"auto",...r.style}})})}),P="DialogContent",O=r.forwardRef((e,t)=>{let n=_(P,e.__scopeDialog),{forceMount:r=n.forceMount,...l}=e,a=C(P,e.__scopeDialog);return(0,g.jsx)(f.z,{present:r||a.open,children:a.modal?(0,g.jsx)(A,{...l,ref:t}):(0,g.jsx)(S,{...l,ref:t})})});O.displayName=P;var A=r.forwardRef((e,t)=>{let n=C(P,e.__scopeDialog),i=r.useRef(null),s=(0,a.e)(t,n.contentRef,i);return r.useEffect(()=>{let e=i.current;if(e)return(0,h.Ry)(e)},[]),(0,g.jsx)(V,{...e,ref:s,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:(0,l.M)(e.onCloseAutoFocus,e=>{var t;e.preventDefault(),null===(t=n.triggerRef.current)||void 0===t||t.focus()}),onPointerDownOutside:(0,l.M)(e.onPointerDownOutside,e=>{let t=e.detail.originalEvent,n=0===t.button&&!0===t.ctrlKey;(2===t.button||n)&&e.preventDefault()}),onFocusOutside:(0,l.M)(e.onFocusOutside,e=>e.preventDefault())})}),S=r.forwardRef((e,t)=>{let n=C(P,e.__scopeDialog),l=r.useRef(!1),a=r.useRef(!1);return(0,g.jsx)(V,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:t=>{var r,i;null===(r=e.onCloseAutoFocus)||void 0===r||r.call(e,t),t.defaultPrevented||(l.current||null===(i=n.triggerRef.current)||void 0===i||i.focus(),t.preventDefault()),l.current=!1,a.current=!1},onInteractOutside:t=>{var r,i;null===(r=e.onInteractOutside)||void 0===r||r.call(e,t),t.defaultPrevented||(l.current=!0,"pointerdown"!==t.detail.originalEvent.type||(a.current=!0));let s=t.target;(null===(i=n.triggerRef.current)||void 0===i?void 0:i.contains(s))&&t.preventDefault(),"focusin"===t.detail.originalEvent.type&&a.current&&t.preventDefault()}})}),V=r.forwardRef((e,t)=>{let{__scopeDialog:n,trapFocus:l,onOpenAutoFocus:i,onCloseAutoFocus:s,...o}=e,c=C(P,n),f=r.useRef(null),p=(0,a.e)(t,f);return(0,m.EW)(),(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(u.M,{asChild:!0,loop:!0,trapped:l,onMountAutoFocus:i,onUnmountAutoFocus:s,children:(0,g.jsx)(d.XB,{role:"dialog",id:c.contentId,"aria-describedby":c.descriptionId,"aria-labelledby":c.titleId,"data-state":U(c.open),...o,ref:p,onDismiss:()=>c.onOpenChange(!1)})}),(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(Y,{titleId:c.titleId}),(0,g.jsx)($,{contentRef:f,descriptionId:c.descriptionId})]})]})}),W="DialogTitle",L=r.forwardRef((e,t)=>{let{__scopeDialog:n,...r}=e,l=C(W,n);return(0,g.jsx)(p.WV.h2,{id:l.titleId,...r,ref:t})});L.displayName=W;var q="DialogDescription",z=r.forwardRef((e,t)=>{let{__scopeDialog:n,...r}=e,l=C(q,n);return(0,g.jsx)(p.WV.p,{id:l.descriptionId,...r,ref:t})});z.displayName=q;var B="DialogClose",K=r.forwardRef((e,t)=>{let{__scopeDialog:n,...r}=e,a=C(B,n);return(0,g.jsx)(p.WV.button,{type:"button",...r,ref:t,onClick:(0,l.M)(e.onClick,()=>a.onOpenChange(!1))})});function U(e){return e?"open":"closed"}K.displayName=B;var X="DialogTitleWarning",[H,Q]=(0,i.k)(X,{contentName:P,titleName:W,docsSlug:"dialog"}),Y=e=>{let{titleId:t}=e,n=Q(X),l="`".concat(n.contentName,"` requires a `").concat(n.titleName,"` for the component to be accessible for screen reader users.\n\nIf you want to hide the `").concat(n.titleName,"`, you can wrap it with our VisuallyHidden component.\n\nFor more information, see https://radix-ui.com/primitives/docs/components/").concat(n.docsSlug);return r.useEffect(()=>{t&&!document.getElementById(t)&&console.error(l)},[l,t]),null},$=e=>{let{contentRef:t,descriptionId:n}=e,l=Q("DialogDescriptionWarning"),a="Warning: Missing `Description` or `aria-describedby={undefined}` for {".concat(l.contentName,"}.");return r.useEffect(()=>{var e;let r=null===(e=t.current)||void 0===e?void 0:e.getAttribute("aria-describedby");n&&r&&!document.getElementById(n)&&console.warn(a)},[a,t,n]),null},G=w,J=k,ee=T,et=E,en=O,er=L,el=z,ea=K}}]);