"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2429],{20021:function(e,l,t){t.d(l,{M:function(){return h}});var i=t(57437),a=t(92513),n=t(90399),r=t(5192),s=t(12491),d=t(50495),o=t(76230),c=t(77605),u=t(21475);function h(e){let{image:l,disabled:t,onChange:h}=e,m=(0,u.Y)(),[f,{width:p}]=(0,r.Z)(),{confirm:x}=(0,o.t)(),g="".concat((null==l?void 0:l.data)||"").split("?").filter((e,l)=>l).join(""),{width:v,height:y}=s.Z.parse(g);return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("div",{ref:f,className:"flex flex-col gap-y-2 min-w-60 max-w-60",children:[(0,i.jsx)("div",{className:"w-full flex flex-col items-center justify-center min-h-28",children:(0,i.jsx)(c.E,{alt:"",width:Number(v||"0"),height:Number(y||"0"),containerWidth:p,src:(null==l?void 0:l.data)||"/images/placeholder.png"})}),(0,i.jsxs)("div",{className:"flex items-center justify-center gap-x-4",children:[(0,i.jsx)(d.z,{size:"icon",className:"w-8 h-8 rounded-full",disabled:t,onClick:()=>m.openModal({onSelectFiles(e){let[l]=e;h({data:l.url,fileId:l.fileId,filename:l.filename,size:l.size,contentType:l.contentType})}}),children:(0,i.jsx)(a.Z,{className:"h-4 w-4"})}),!!l&&(0,i.jsx)(d.z,{variant:"destructive",size:"icon",className:"w-8 h-8 rounded-full",disabled:t,onClick:()=>x(()=>h(null),{title:"Delete image",message:"Are you sure you want to delete this image?",danger:!0}),children:(0,i.jsx)(n.Z,{className:"h-4 w-4"})})]})]})})}},77605:function(e,l,t){t.d(l,{E:function(){return n}});var i=t(57437),a=t(48625);function n(e){let{width:l=0,height:t=0,containerWidth:n,...r}=e;r.sizes;let s={width:"100%",height:"auto"};if(t&&l&&n){let e=(0,a.a)({imageWidth:l,imageHeight:t,containerWidth:n});s.width=e.imageWidth,s.height=e.imageHeight}return(0,i.jsx)("img",{...r,src:r.src,style:{...s,...r.style}})}},80852:function(e,l,t){t.d(l,{L:function(){return s}});var i=t(57437),a=t(2265),n=t(27475),r=t(23920);function s(e){let{value:l,disabled:t,modal:s,multiple:d,placeholder:o,error:c,onChange:u,filterDataKeys:h}=e,{dataKeys:m,extractDataKeys:f}=(0,r.M)(),p=(0,a.useMemo)(()=>m.filter(e=>!h||h(e)).map(e=>({label:e.name,value:e.uniqueKey,caption:e.dataType||"",description:e.label})),[m,h]);return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(n.V,{multiple:d,modal:s,error:c,placeholder:"".concat(l||"")||o||"Select key",search:{placeholder:"Search data keys"},options:p,onSelect:e=>{let l=f(e.map(e=>e.value)).map(e=>({...e,children:f(e.options)}));null==u||u(l)}})})}},27475:function(e,l,t){t.d(l,{V:function(){return u}});var i=t(57437),a=t(2265),n=t(1282),r=t(22468),s=t(50495),d=t(83102),o=t(90837),c=t(37440);function u(e){let{options:l,selected:t,...a}=e;t=Array.isArray(t)?t:t?[t]:[];let n=l.map(e=>({...e,value:"".concat(e.value)})),r=t.map(e=>"".concat(e));if(!a.multiple){let[e]=Array.isArray(r)?r:[r];e&&n.find(l=>l.value===e)}return(0,i.jsx)(h,{...a,options:n,selected:r})}function h(e){var l;let{modal:t,header:u,placeholder:h,search:m,multiple:f=!1,error:p=!1,disabled:x=!1,selected:g,options:v=[],trigger:y,onTrigger:j,onSelect:b}=e,[N,w]=(0,a.useState)(""),S=function(e,l){let[t,i]=(0,a.useState)(e);return(0,a.useEffect)(()=>{let l=setTimeout(()=>i(e),500);return()=>{clearTimeout(l)}},[e,void 0]),t}(N),[C,I]=(0,a.useState)([]),z=(0,a.useMemo)(()=>g?Array.isArray(g)?g.map(e=>v.find(l=>(null==l?void 0:l.value)===e)).map(e=>e):v.filter(e=>(null==e?void 0:e.value)===g)||[]:[],[g,v]),M=(0,a.useMemo)(()=>v.map(e=>{let l=z.map(e=>null==e?void 0:e.value).map(e=>"".concat(e||"")).filter(e=>e).includes("".concat(null==e?void 0:e.value));return l=l||C.includes(e.value),{...e,isSelected:l}}).sort((e,l)=>(e.disabled?1:0)-(l.disabled?1:0)).sort((e,l)=>{let t=e.isSelected?1:0;return(l.isSelected?1:0)-t}).filter(e=>JSON.stringify([e.value||"",e.label||"",e.description||""]).toLowerCase().match(S.toLowerCase())),[v,S,z,C]);return(0,a.useEffect)(()=>()=>w(""),[]),(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(o.Vq,{modal:t,onOpenChange:()=>{w(""),I([])},children:[(0,i.jsx)(o.hg,{asChild:!0,children:y||(0,i.jsxs)(s.z,{disabled:x,variant:"outline",className:(0,c.cn)("justify-between w-full",p&&"border border-destructive hover:bg-destructive/10"),onClick:j,children:[(0,i.jsx)("span",{className:z.length?"":"opacity-50",children:(null===(l=z[0])||void 0===l?void 0:l.label)||h||""}),(0,i.jsx)(n.Z,{className:"size-4 opacity-50"})]})}),(0,i.jsxs)(o.cZ,{hideCloseButton:!0,className:"flex flex-col max-h-[90%] gap-y-4 p-0 m-0 sm:max-w-xl",children:[(0,i.jsxs)(o.fK,{className:"border-b border-b-border px-4 py-4",children:[(0,i.jsx)(o.$N,{className:"hidden",children:""}),(0,i.jsx)(o.Be,{className:"hidden",children:""}),(0,i.jsxs)("div",{className:"flex items-center gap-x-4",children:[m?(0,i.jsx)("div",{className:"flex-1",children:(0,i.jsx)(d.I,{type:"search",placeholder:m.placeholder||"",value:N,onChange:e=>w(e.target.value)})}):null,u]})]}),(0,i.jsx)("div",{className:"flex-1 flex flex-col gap-y-1 overflow-y-auto px-4 py-2 overflow-x-hidden",children:M.map(e=>{let l=f?"button":o.GG;return(0,i.jsx)(a.Fragment,{children:(0,i.jsx)(l,{onClick:()=>{e.disabled||(e.isSelected?f?I(l=>l.filter(l=>l!==e.value)):null==b||b(z.filter(l=>l.value!==e.value)):f?I(l=>[...l,e.value]):null==b||b([e]))},className:(0,c.cn)("flex flex-col gap-y-1 border border-border p-2 rounded-md items-start text-left",e.disabled?"opacity-50 cursor-not-allowed":"transition-colors hover:bg-primary/20",e.isSelected&&"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground"),children:(0,i.jsxs)("div",{className:"flex items-center",children:[e.isSelected?(0,i.jsx)(r.Z,{className:"size-4 mr-2"}):null,(0,i.jsxs)("div",{children:[e.caption?(0,i.jsx)("div",{className:"text-xs opacity-60",dangerouslySetInnerHTML:{__html:e.caption||""}}):null,(0,i.jsx)("p",{children:e.label}),e.description?(0,i.jsx)("div",{className:"text-xs opacity-60",dangerouslySetInnerHTML:{__html:e.description||""}}):null]})]})})},e.value)})}),(0,i.jsxs)(o.cN,{className:"border-t border-t-border px-4 py-2 items-center w-full gap-x-2",children:[(0,i.jsx)(o.GG,{asChild:!0,children:(0,i.jsx)(s.z,{variant:"ghost",children:"Close"})}),!!C.length&&(0,i.jsx)(o.GG,{asChild:!0,children:(0,i.jsx)(s.z,{onClick:()=>{null==b||b(C.map(e=>M.find(l=>l.value===e)).filter(e=>e))},children:"Save"})})]})]})]})})}},64344:function(e,l,t){t.d(l,{Z:function(){return s}});var i=t(57437),a=t(2265),n=t(48484),r=t(37440);let s=a.forwardRef((e,l)=>{let{className:t,orientation:a="horizontal",decorative:s=!0,...d}=e;return(0,i.jsx)(n.f,{ref:l,decorative:s,orientation:a,className:(0,r.cn)("shrink-0 bg-border","horizontal"===a?"h-[1px] w-full":"h-full w-[1px]",t),...d})});s.displayName=n.f.displayName},21475:function(e,l,t){t.d(l,{Y:function(){return n}});var i=t(39099),a=t(38472);let n=(0,i.Ue)((e,l)=>{let t=async t=>{try{let{reset:i,...n}={...t};i&&(n.page=1),e({loading:!0,unhandledErrors:[]});let{data:r,errors:s,totalPages:d,totalRows:o,page:c}=(await a.Z.get("/api/files?data=".concat(JSON.stringify({...n,limit:n.limit||l().limit,page:n.page||l().page})))).data;if(null==s?void 0:s.length)e({unhandledErrors:s});else{let t=i?r:[...l().files,...r];t=t.filter((e,l)=>l===t.map(e=>e.fileId).indexOf(e.fileId)),n.siteId&&n.siteId!==l().siteId&&(t=r),e({files:t,totalPages:d,totalRows:o,page:c,siteId:n.siteId||l().siteId,lastFilesQueryDate:r.length?new Date:null})}}catch(l){e({unhandledErrors:[l.message]})}finally{e({loading:!1})}};return{isModalOpen:!1,loading:!1,siteId:"",files:[],unhandledErrors:[],lastFilesQueryDate:null,page:1,limit:15,totalPages:1,totalRows:0,onSelectFiles:null,selectMultiple:!1,getFiles:t,openModal(i){e({onSelectFiles:(null==i?void 0:i.onSelectFiles)||null,isModalOpen:!0}),l().lastFilesQueryDate||t()},closeModal:()=>e({isModalOpen:!1})}})},48625:function(e,l,t){async function i(e){return new Promise((l,t)=>{let i=new Image;i.onload=function(){l({width:i.width,height:i.height})},i.onerror=function(e,l,i,a,n){t(n||Error("Failed to load image"))},i.src=e})}function a(e){let{imageWidth:l,imageHeight:t,containerWidth:i}=e;return l>i&&(t=i/l*t,l=i),{imageWidth:l,imageHeight:t}}t.d(l,{a:function(){return a},p:function(){return i}})}}]);