"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3335],{86377:function(e,a,t){t.d(a,{A:function(){return f}});var i=t(57437),n=t(2265),l=t(16463),s=t(12491),r=t(20920),o=t(5192),d=t(46294),u=t(95317),m=t(50495),c=t(83102),g=t(67135),h=t(39661),x=t(3064);let v=e=>({itemId:"".concat((null==e?void 0:e.itemId)||(0,r.Z)()),drug:"".concat((null==e?void 0:e.drug)||""),minGestation:"".concat((null==e?void 0:e.minGestation)||""),maxGestation:"".concat((null==e?void 0:e.maxGestation)||""),minWeight:"".concat((null==e?void 0:e.minWeight)||""),maxWeight:"".concat((null==e?void 0:e.maxWeight)||""),dayOfLife:"".concat((null==e?void 0:e.dayOfLife)||""),dosageText:"".concat((null==e?void 0:e.dosageText)||""),managementText:"".concat((null==e?void 0:e.managementText)||""),gestationKey:"".concat((null==e?void 0:e.gestationKey)||""),weightKey:"".concat((null==e?void 0:e.weightKey)||"")});function f(e){let{disabled:a,item:t,floating:r,onChange:f}=e,[b,y]=(0,o.Z)(),[p,j]=(0,o.Z)(),[N,w]=(0,n.useState)(!1),[T,k]=(0,n.useState)(v(t)),D=(0,l.useRouter)(),{scriptId:S}=(0,l.useParams)(),C=(0,l.useSearchParams)(),I=(0,n.useMemo)(()=>s.Z.parse(C.toString()),[C]),{itemId:G,addDrug:K}=I,{keys:W,loading:E}=(0,x.a)(S);(0,n.useEffect)(()=>{w(!!G||!!K)},[G,K]),(0,n.useEffect)(()=>{k(v(t))},[t]);let _=(0,n.useCallback)(()=>{f({...T,scriptId:S,minWeight:Number(T.minWeight),maxWeight:Number(T.maxWeight),minGestation:Number(T.minGestation),maxGestation:Number(T.maxGestation)})},[T,S,t,f]),F=(0,n.useCallback)(()=>{w(!1),k(v()),D.push("?".concat(s.Z.stringify({...I,itemId:void 0,addDrug:void 0})));let e=(null==y?void 0:y.top)||0;setTimeout(()=>window.scrollTo({top:e}),500)},[I,y,D.push]),V=(0,n.useCallback)(()=>!!(T.drug&&T.minWeight&&T.minGestation&&T.maxWeight&&T.maxGestation&&T.managementText&&T.dosageText&&Number(T.minGestation||"0")<=Number(T.maxGestation||"0")&&Number(T.minWeight||"0")<=Number(T.maxWeight||"0")),[T]),Z=(0,n.useCallback)(()=>!V()||E||a,[V,E,a]),O=(0,i.jsxs)("div",{className:"flex flex-col gap-y-4",children:[(0,i.jsxs)("div",{className:"",children:[(0,i.jsx)(g._,{secondary:!0,htmlFor:"drug",children:"Drug *"}),(0,i.jsx)(c.I,{name:"drug",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:T.drug,disabled:a,onChange:e=>k(a=>({...a,drug:e.target.value}))})]}),(0,i.jsxs)("div",{className:"flex gap-x-2",children:[(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsx)(g._,{secondary:!0,htmlFor:"minGestation",children:"Min Gestation (weeks) *"}),(0,i.jsx)(c.I,{name:"minGestation",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:T.minGestation,type:"number",disabled:a,onChange:e=>{let a=e.target.value,t=T.maxGestation;a||(t=""),k(e=>({...e,minGestation:a,maxGestation:t}))}})]}),(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsx)(g._,{secondary:!0,htmlFor:"maxGestation",error:Number(T.minGestation||"0")>Number(T.maxGestation||"0"),children:"Max Gestation (weeks) *"}),(0,i.jsx)(c.I,{name:"maxGestation",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:T.maxGestation,type:"number",disabled:a||!T.minGestation,min:T.minGestation,error:Number(T.minGestation||"0")>Number(T.maxGestation||"0"),onChange:e=>k(a=>({...a,maxGestation:e.target.value}))})]})]}),(0,i.jsxs)("div",{className:"",children:[(0,i.jsx)(g._,{secondary:!0,htmlFor:"gestationKey",children:"Gestation Key *"}),(0,i.jsxs)(d.Ph,{value:T.gestationKey||"",required:!0,name:"gestationKey",disabled:a,onValueChange:e=>{k(a=>({...a,gestationKey:e||""}))},children:[(0,i.jsx)(d.i4,{children:(0,i.jsx)(d.ki,{placeholder:"Select gestation key"})}),(0,i.jsx)(d.Bw,{children:(0,i.jsx)(d.DI,{children:W.map(e=>(0,i.jsx)(d.Ql,{value:e,children:e},e))})})]})]}),(0,i.jsxs)("div",{className:"flex gap-x-2",children:[(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsx)(g._,{secondary:!0,htmlFor:"minWeight",children:"Min Weight (weeks) *"}),(0,i.jsx)(c.I,{name:"minWeight",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:T.minWeight,type:"number",disabled:a,onChange:e=>{let a=e.target.value,t=T.maxWeight;a||(t=""),k(e=>({...e,minWeight:a,maxWeight:t}))}})]}),(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsx)(g._,{secondary:!0,htmlFor:"maxWeight",error:Number(T.minWeight||"0")>Number(T.maxWeight||"0"),children:"Max Weight (weeks) *"}),(0,i.jsx)(c.I,{name:"maxWeight",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:T.maxWeight,type:"number",disabled:a||!T.minWeight,min:T.minWeight,error:Number(T.minWeight||"0")>Number(T.maxWeight||"0"),onChange:e=>k(a=>({...a,maxWeight:e.target.value}))})]})]}),(0,i.jsxs)("div",{className:"",children:[(0,i.jsx)(g._,{secondary:!0,htmlFor:"gestationKey",children:"Weight Key *"}),(0,i.jsxs)(d.Ph,{value:T.weightKey||"",required:!0,name:"weightKey",disabled:a,onValueChange:e=>{k(a=>({...a,weightKey:e||""}))},children:[(0,i.jsx)(d.i4,{children:(0,i.jsx)(d.ki,{placeholder:"Select gestation key"})}),(0,i.jsx)(d.Bw,{children:(0,i.jsx)(d.DI,{children:W.map(e=>(0,i.jsx)(d.Ql,{value:e,children:e},e))})})]})]}),(0,i.jsxs)("div",{className:"",children:[(0,i.jsx)(g._,{secondary:!0,htmlFor:"managementText",children:"Management text *"}),(0,i.jsx)(c.I,{name:"managementText",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:T.managementText,disabled:a,onChange:e=>k(a=>({...a,managementText:e.target.value}))})]}),(0,i.jsxs)("div",{className:"",children:[(0,i.jsx)(g._,{secondary:!0,htmlFor:"weight",children:"Dosage text *"}),(0,i.jsx)(c.I,{name:"dosageText",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:T.dosageText,disabled:a,onChange:e=>k(a=>({...a,dosageText:e.target.value}))})]})]});return(0,i.jsxs)(i.Fragment,{children:[E&&(0,i.jsx)(h.a,{overlay:!0}),(0,i.jsx)("div",{ref:b,children:!1===r?O:(0,i.jsx)(u.yo,{open:N,onOpenChange:e=>{e||F()},children:(0,i.jsxs)(u.ue,{hideCloseButton:!0,side:"right",className:"p-0 m-0 flex flex-col w-full max-w-full sm:max-w-[80%] md:max-w-[80%] lg:max-w-[50%]",children:[(0,i.jsxs)(u.Tu,{className:"flex flex-row items-center py-2 px-4 border-b border-b-border text-left sm:text-left",children:[(0,i.jsxs)(u.bC,{children:[K?"Add":"",G?"Edit":""," drug"]}),(0,i.jsx)(u.Ei,{className:"hidden"})]}),(0,i.jsx)("div",{ref:p,className:"flex-1 py-2 px-0 overflow-y-auto",children:(0,i.jsx)("div",{className:"px-4",children:O})}),(0,i.jsxs)("div",{className:"border-t border-t-border px-4 py-2 flex gap-x-2",children:[(0,i.jsx)("span",{className:"text-danger text-xs my-auto",children:"* Required"}),(0,i.jsx)("div",{className:"ml-auto"}),(0,i.jsx)(u.sw,{asChild:!0,children:(0,i.jsx)(m.z,{variant:"ghost",onClick:()=>{},children:"Cancel"})}),(0,i.jsx)(u.sw,{asChild:!0,children:(0,i.jsx)(m.z,{onClick:()=>_(),disabled:Z(),children:"Save"})})]})]})})})]})}},18934:function(e,a,t){t.d(a,{U:function(){return l}});var i=t(2265),n=t(20920);function l(e){return{getDefaultValues:(0,i.useCallback)(()=>({fieldId:(null==e?void 0:e.fieldId)||(0,n.Z)(),type:(null==e?void 0:e.type)||"",key:(null==e?void 0:e.key)||"",label:(null==e?void 0:e.label)||"",refKey:(null==e?void 0:e.refKey)||"",calculation:(null==e?void 0:e.calculation)||"",condition:(null==e?void 0:e.condition)||"",dataType:(null==e?void 0:e.dataType)||"",defaultValue:(null==e?void 0:e.defaultValue)||"",format:(null==e?void 0:e.format)||"",minValue:(null==e?void 0:e.minValue)||"",maxValue:(null==e?void 0:e.maxValue)||"",minDate:(null==e?void 0:e.minDate)||"",maxDate:(null==e?void 0:e.maxDate)||"",minTime:(null==e?void 0:e.minTime)||"",maxTime:(null==e?void 0:e.maxTime)||"",minDateKey:(null==e?void 0:e.minDateKey)||"",maxDateKey:(null==e?void 0:e.maxDateKey)||"",minTimeKey:(null==e?void 0:e.minTimeKey)||"",maxTimeKey:(null==e?void 0:e.maxTimeKey)||"",values:(null==e?void 0:e.values)||"",confidential:(null==e?void 0:e.confidential)||!1,optional:(null==e?void 0:e.optional)||!1,printable:(null==e?void 0:e.printable)||!1,prePopulate:(null==e?void 0:e.prePopulate)||[],...e}),[e])}}},76905:function(e,a,t){t.d(a,{Uv:function(){return l},VO:function(){return n},d4:function(){return i},fR:function(){return r}});let i=[{value:"allSearches",label:"Found in all searches"},{value:"admissionSearches",label:"Found in admission searches"},{value:"twinSearches",label:"Found in twin searches"}],n=[{label:"Days & hours",value:"days_hours"},{label:"Years & Months",value:"years_months"}],l=[{name:"date",label:"Date"},{name:"datetime",label:"Date + Time"},{name:"dropdown",label:"Dropdown"},{name:"number",label:"Number"},{name:"text",label:"Text"},{name:"time",label:"Time"},{name:"period",label:"Time period"}],s={calculation:null,condition:"",confidential:!1,dataType:null,defaultValue:null,format:null,type:null,key:null,refKey:null,label:null,minValue:null,maxValue:null,optional:!1,minDate:null,maxDate:null,minTime:null,maxTime:null,minDateKey:"",maxDateKey:"",minTimeKey:"",maxTimeKey:"",values:""},r={admission:[{...s,type:"dropdown",key:"BabyTransfered",values:"Y,Yes\nN,No",label:"Has the baby been transfered from another facility"},{...s,type:"text",key:"patientNUID",label:"Search patient's NUID",condition:"$BabyTransfered = 'Y'"},{...s,type:"dropdown",key:"BabyTwin",values:"Y,Yes\nN,No",label:"Does the baby have a twin?"},{...s,type:"text",key:"BabyTwinNUID",label:"Search twin's NUID",condition:"$BabyTwin = 'Y'"}],other:[{...s,type:"text",key:"patientNUID",values:"Y,Yes\nN,No",label:"Search patient's NUID"}]}},3064:function(e,a,t){t.d(a,{R:function(){return m},a:function(){return c}});var i=t(2265),n=t(16463),l=t(12491),s=t(38472),r=t(39099),o=t(53699);let d={initialised:!1,loading:!1,keys:[],drugs:[]},u=(0,r.Ue)(e=>d);function m(){u.setState(d)}function c(e){let a=u(),{drugs:t}=a,r=(0,n.useSearchParams)(),m=(0,i.useMemo)(()=>l.Z.parse(r.toString()),[r]),{itemId:c}=m,{alert:g}=(0,o.s)(),h=(0,i.useCallback)(async()=>{try{let{data:a,errors:t}=(await s.Z.get("/api/scripts/metadata?data="+JSON.stringify({scriptsIds:[e]}))).data;if(null==t?void 0:t.length)throw Error(t.join(", "));let i=a.reduce((e,a)=>(a.screens.forEach(a=>a.fields.forEach(a=>{a.key&&(e[a.key.toLowerCase()]=a.key)})),e),{});u.setState({keys:Object.values(i)})}catch(e){g({title:"",message:"Error: "+e.message,variant:"error"})}},[e,open,g]),x=(0,i.useCallback)(async()=>{try{var a,t;u.setState({loading:!0});let i=await s.Z.get("/api/scripts/drugs-library?data="+JSON.stringify({scriptsIds:[e]}));if(null===(a=i.data.errors)||void 0===a?void 0:a.length)throw Error(null===(t=i.data.errors)||void 0===t?void 0:t.join(", "));u.setState({drugs:i.data.data})}catch(e){g({title:"Error",message:e.message,variant:"error"})}finally{u.setState({loading:!1})}},[g,e]),v=(0,i.useCallback)(async e=>{try{var a,t;u.setState(a=>({loading:!0,drugs:a.drugs.filter(a=>!e.includes(a.itemId))}));let i=await s.Z.delete("/api/scripts/drugs-library?data="+JSON.stringify({itemsIds:e}));if(null===(a=i.data.errors)||void 0===a?void 0:a.length)throw Error(null===(t=i.data.errors)||void 0===t?void 0:t.join(", "));g({title:"",message:"Drug deleted successfully!",variant:"success"})}catch(e){g({title:"Error",message:e.message,variant:"error"})}finally{u.setState({loading:!1})}},[g]),f=(0,i.useCallback)(async e=>{try{var a,i;u.setState({loading:!0});let n=t;u.setState(a=>(n=!c&&e?[...a.drugs,e]:a.drugs.map(a=>a.itemId!==(null==e?void 0:e.itemId)?a:{...a,...e}),{loading:!0,drugs:n}));let l={data:e?[e]:n,returnSaved:!0},r=await s.Z.post("/api/scripts/drugs-library",l);if(null===(a=r.data.errors)||void 0===a?void 0:a.length)throw Error(null===(i=r.data.errors)||void 0===i?void 0:i.join(", "));await x(),g({title:"",message:"Drug".concat(e?"":"s"," saved successfully!"),variant:"success"})}catch(e){g({title:"Error",message:e.message,variant:"error"})}finally{u.setState({loading:!1})}},[t,c]);(0,i.useEffect)(()=>{u.getState().initialised||(h(),x(),u.setState({initialised:!0}))},[x,h]);let b=(0,i.useCallback)(()=>{u.setState(d)},[]);return{...a,selectedItemId:c,addLink:"?".concat(l.Z.stringify({...m,addDrug:1})),editLink:e=>"?".concat(l.Z.stringify({...m,itemId:e})),getDrugs:x,deleteDrugs:v,saveDrugs:f,resetState:b,getScriptKeys:h}}},78591:function(e,a,t){t.d(a,{s:function(){return i}});function i(e){let a=[],t=(e||"").split("\n").map(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.trim()}).map(e=>{let a=e.split(",");return{value:a[0],label:a[1]}}),i=t.map(e=>e.value),n=t.map(e=>e.label),l=t.filter(e=>!e.value||!e.label),s=i.filter((e,a)=>i.indexOf(e)!==a);return(n.filter((e,a)=>n.indexOf(e)!==a).length||s.length)&&a.push("Dropdown values contain duplicate data"),l.length&&a.push("Incorrect dropdown values format"),a}}}]);