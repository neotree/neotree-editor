"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3242],{18934:function(e,t,a){a.d(t,{U:function(){return i},w:function(){return s}});var l=a(2265),r=a(20920);function i(e){return{getDefaultValues:(0,l.useCallback)(()=>({...e,fieldId:(null==e?void 0:e.fieldId)||(0,r.Z)(),type:(null==e?void 0:e.type)||"",key:(null==e?void 0:e.key)||"",keyId:(null==e?void 0:e.keyId)||"",label:(null==e?void 0:e.label)||"",refKey:(null==e?void 0:e.refKey)||"",refKeyId:(null==e?void 0:e.refKeyId)||"",calculation:(null==e?void 0:e.calculation)||"",condition:(null==e?void 0:e.condition)||"",dataType:(null==e?void 0:e.dataType)||"",defaultValue:(null==e?void 0:e.defaultValue)||"",format:(null==e?void 0:e.format)||"",minValue:(null==e?void 0:e.minValue)||"",maxValue:(null==e?void 0:e.maxValue)||"",minDate:(null==e?void 0:e.minDate)||"",maxDate:(null==e?void 0:e.maxDate)||"",minTime:(null==e?void 0:e.minTime)||"",maxTime:(null==e?void 0:e.maxTime)||"",minDateKey:(null==e?void 0:e.minDateKey)||"",maxDateKey:(null==e?void 0:e.maxDateKey)||"",minTimeKey:(null==e?void 0:e.minTimeKey)||"",maxTimeKey:(null==e?void 0:e.maxTimeKey)||"",minDateKeyId:(null==e?void 0:e.minDateKeyId)||"",maxDateKeyId:(null==e?void 0:e.maxDateKeyId)||"",minTimeKeyId:(null==e?void 0:e.minTimeKeyId)||"",maxTimeKeyId:(null==e?void 0:e.maxTimeKeyId)||"",values:(null==e?void 0:e.values)||"",valuesOptions:(null==e?void 0:e.valuesOptions)||[],confidential:(null==e?void 0:e.confidential)||!1,optional:(null==e?void 0:e.optional)||!1,printable:(null==e?void 0:e.printable)||!1,prePopulate:(null==e?void 0:e.prePopulate)||[],editable:(null==e?void 0:e.editable)||!1,items:(null==e?void 0:e.items)||[]}),[e])}}function s(e){return{getDefaultValues:(0,l.useCallback)(()=>({label:(null==e?void 0:e.label)||"",screen:(null==e?void 0:e.screen)||"",...e}),[e])}}},44371:function(e,t,a){a.d(t,{R:function(){return m},a:function(){return v}});var l=a(2265),r=a(16463),i=a(12491),s=a(38472),n=a(39099),o=a(53699),u=a(7752);let d={initialised:!1,loading:!1,keys:[],drugs:[],searchQuery:"",typeFilter:"",statusFilter:"",sortBy:"name-asc"},c=(0,n.Ue)(e=>d);function m(){c.setState(d)}function v(){let e=c(),{drugs:t,searchQuery:a,typeFilter:n,statusFilter:m,sortBy:v}=e,y=(0,r.useRouter)(),g=(0,r.useSearchParams)(),f=(0,l.useMemo)(()=>i.Z.parse(g.toString()),[g]),{itemId:p}=f,h=(0,l.useMemo)(()=>{var e;return null===(e=t.filter(e=>e.itemId===p||e.key===p)[0])||void 0===e?void 0:e.itemId},[p,t]),{alert:k}=(0,o.s)(),b=(0,l.useCallback)(()=>{let e=[],l=t.map(e=>[e.drug||"",e.type||"",e.key||"",e.dosageText||"",e.itemId]),r=[...l=l.filter((l,r)=>{let i=t[r],s=!0;if(a){let e=a.toLowerCase(),t=[i.drug,i.type,i.key,i.dosageText].join(" ").toLowerCase();s=s&&t.includes(e)}if(n&&"all"!==n){var o;s=s&&(null===(o=i.type)||void 0===o?void 0:o.toLowerCase())===n.toLowerCase()}return m&&"all"!==m&&("draft"===m?s=s&&!0===i.isDraft:"published"===m&&(s=s&&!i.isDraft)),s&&e.push(t[r]),s})],i=[...e],s=r.map((e,t)=>({row:e,drug:i[t]}));switch(v){case"name-asc":s.sort((e,t)=>(e.drug.drug||"").localeCompare(t.drug.drug||""));break;case"name-desc":s.sort((e,t)=>(t.drug.drug||"").localeCompare(e.drug.drug||""));break;case"type-asc":s.sort((e,t)=>(e.drug.type||"").localeCompare(t.drug.type||""));break;case"type-desc":s.sort((e,t)=>(t.drug.type||"").localeCompare(e.drug.type||""));break;case"key-asc":s.sort((e,t)=>(e.drug.key||"").localeCompare(t.drug.key||""));break;case"key-desc":s.sort((e,t)=>(t.drug.key||"").localeCompare(e.drug.key||""))}return{tableData:s.map(e=>e.row),filteredDrugs:s.map(e=>e.drug)}},[t,a,n,m,v]),{tableData:I,filteredDrugs:T}=(0,l.useMemo)(()=>b(),[b]),D=(0,l.useCallback)(async()=>{try{var e,t;c.setState({loading:!0});let a=await s.Z.get("/api/drugs-library?data="+JSON.stringify({returnDraftsIfExist:!0}));if(null===(e=a.data.errors)||void 0===e?void 0:e.length)throw Error(null===(t=a.data.errors)||void 0===t?void 0:t.join(", "));c.setState({drugs:a.data.data})}catch(e){k({title:"Error",message:e.message,variant:"error"})}finally{c.setState({loading:!1})}},[k]);!function(e){let{events:t}=e,a=(0,l.useMemo)(()=>t,[t]),i=(0,l.useRef)({eventsTimeouts:{},eventsTimestamps:{}});(0,l.useRef)(new Date().getTime());let s=(0,r.useRouter)();(0,l.useEffect)(()=>{a.forEach(e=>{let{name:t,action:a,delay:l=100,onEvent:r}=e;u.Z.on(t,function(){for(var e=arguments.length,n=Array(e),o=0;o<e;o++)n[o]=arguments[o];let u=()=>{var e,l;(!a||n[0]===a)&&(null===(e=r.callback)||void 0===e||e.call(r,...n),(null==r?void 0:r.refreshRouter)&&(console.log(t,"refreshing..."),s.refresh()),(null===(l=r.redirect)||void 0===l?void 0:l.to)&&(r.redirect.replace?s.replace(r.redirect.to):s.push(r.redirect.to)))},d=new Date().getTime();l?(clearTimeout(i.current.eventsTimeouts[t]),i.current.eventsTimeouts[t]=setTimeout(()=>{i.current.eventsTimestamps[t]=d,u()},l)):(i.current.eventsTimestamps[t]=new Date().getTime(),u())})})},[a,s])}({events:[{name:"data_changed",onEvent:{callback:async()=>{await D(),y.refresh()}}}]});let w=(0,l.useCallback)(async e=>{try{var t,a;c.setState(t=>({loading:!0,drugs:t.drugs.filter(t=>!e.includes(t.itemId))}));let l=await s.Z.delete("/api/drugs-library?data="+JSON.stringify({itemsIds:e}));if(null===(t=l.data.errors)||void 0===t?void 0:t.length)throw Error(null===(a=l.data.errors)||void 0===a?void 0:a.join(", "));y.refresh(),k({title:"",message:"Drug deleted successfully!",variant:"success"})}catch(e){k({title:"Error",message:e.message,variant:"error"})}finally{c.setState({loading:!1})}},[k,y.refresh]),C=(0,l.useCallback)(async e=>{try{var a,l;c.setState({loading:!0});let r=[],i=[],n=t;c.setState(t=>(n=!h&&e?[...t.drugs,e]:t.drugs.map(t=>t.itemId!==(null==e?void 0:e.itemId)?t:(e&&(t.key!==e.key&&i.push({old:t.key,new:e.key}),t.type!==e.type&&r.push(t.key)),{...t,...e})),{loading:!0,drugs:n}));let o={data:e?[e]:n,broadcastAction:!0},u=await s.Z.post("/api/drugs-library/save",o);if(null===(a=u.data.errors)||void 0===a?void 0:a.length)throw Error(null===(l=u.data.errors)||void 0===l?void 0:l.join(", "));await D(),y.refresh(),k({title:"",message:"Drug".concat(e?"":"s"," saved successfully!"),variant:"success"})}catch(e){k({title:"Error",message:e.message,variant:"error"})}finally{c.setState({loading:!1})}},[t,h,y.refresh]),S=(0,l.useCallback)(async e=>{try{var t,a;c.setState({loading:!0});let l={data:e.map(e=>({itemId:e})),broadcastAction:!0},r=await s.Z.post("/api/drugs-library/copy",l);if(null===(t=r.data.errors)||void 0===t?void 0:t.length)throw Error(null===(a=r.data.errors)||void 0===a?void 0:a.join(", "));await D(),y.refresh(),k({title:"",message:"Drug".concat(e.length<2?"":"s"," copied successfully!"),variant:"success"})}catch(e){k({title:"Error",message:e.message,variant:"error"})}finally{c.setState({loading:!1})}},[y.refresh]);(0,l.useEffect)(()=>{c.getState().initialised||(D(),c.setState({initialised:!0}))},[D]),(0,l.useCallback)(()=>{c.setState(d)},[]);let K=(0,l.useCallback)(e=>{c.setState({searchQuery:e})},[]),x=(0,l.useCallback)(e=>{c.setState({typeFilter:e})},[]),E=(0,l.useCallback)(e=>{c.setState({statusFilter:e})},[]),V=(0,l.useCallback)(e=>{c.setState({sortBy:e})},[]);return{...e,filteredDrugs:T,tableData:I,selectedItemId:h,addLink:e=>"?".concat(i.Z.stringify({...f,addItem:e})),editLink:e=>"?".concat(i.Z.stringify({...f,itemId:e})),getDrugs:D,deleteDrugs:w,saveDrugs:C,copyDrugs:S,setSearchQuery:K,setTypeFilter:x,setStatusFilter:E,setSortBy:V}}},78591:function(e,t,a){a.d(t,{s:function(){return l}});function l(e){let t=[],a=(e||"").split("\n").map(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.trim()}).map(e=>{let t=e.split(",");return{value:t[0],label:t[1]}}),l=a.map(e=>e.value),r=a.map(e=>e.label),i=a.filter(e=>!e.value||!e.label),s=l.filter((e,t)=>l.indexOf(e)!==t);return(r.filter((e,t)=>r.indexOf(e)!==t).length||s.length)&&t.push("Values contain duplicate data"),i.length&&t.push("Incorrect values format"),t}}}]);