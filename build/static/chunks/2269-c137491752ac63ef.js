"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2269],{18934:function(e,a,i){i.d(a,{U:function(){return s}});var n=i(2265),t=i(20920);function s(e){return{getDefaultValues:(0,n.useCallback)(()=>({fieldId:(null==e?void 0:e.fieldId)||(0,t.Z)(),type:(null==e?void 0:e.type)||"",key:(null==e?void 0:e.key)||"",label:(null==e?void 0:e.label)||"",refKey:(null==e?void 0:e.refKey)||"",calculation:(null==e?void 0:e.calculation)||"",condition:(null==e?void 0:e.condition)||"",dataType:(null==e?void 0:e.dataType)||"",defaultValue:(null==e?void 0:e.defaultValue)||"",format:(null==e?void 0:e.format)||"",minValue:(null==e?void 0:e.minValue)||"",maxValue:(null==e?void 0:e.maxValue)||"",minDate:(null==e?void 0:e.minDate)||"",maxDate:(null==e?void 0:e.maxDate)||"",minTime:(null==e?void 0:e.minTime)||"",maxTime:(null==e?void 0:e.maxTime)||"",minDateKey:(null==e?void 0:e.minDateKey)||"",maxDateKey:(null==e?void 0:e.maxDateKey)||"",minTimeKey:(null==e?void 0:e.minTimeKey)||"",maxTimeKey:(null==e?void 0:e.maxTimeKey)||"",values:(null==e?void 0:e.values)||"",confidential:(null==e?void 0:e.confidential)||!1,optional:(null==e?void 0:e.optional)||!1,printable:(null==e?void 0:e.printable)||!1,prePopulate:(null==e?void 0:e.prePopulate)||[],...e}),[e])}}},80929:function(e,a,i){i.d(a,{A:function(){return x}});var n=i(57437),t=i(2265),s=i(16463),l=i(12491),r=i(20920),o=i(5192),u=i(95317),d=i(50495),m=i(83102),c=i(67135),g=i(39661),v=i(44371);let f=e=>({itemId:"".concat((null==e?void 0:e.itemId)||(0,r.Z)()),key:"".concat((null==e?void 0:e.key)||""),drug:"".concat((null==e?void 0:e.drug)||""),minGestation:"".concat((null==e?void 0:e.minGestation)||""),maxGestation:"".concat((null==e?void 0:e.maxGestation)||""),minWeight:"".concat((null==e?void 0:e.minWeight)||""),maxWeight:"".concat((null==e?void 0:e.maxWeight)||""),minAge:"".concat((null==e?void 0:e.minAge)||""),maxAge:"".concat((null==e?void 0:e.maxAge)||""),dosage:"".concat((null==e?void 0:e.dosage)||""),dosageMultiplier:"".concat((null==e?void 0:e.dosageMultiplier)||""),dayOfLife:"".concat((null==e?void 0:e.dayOfLife)||""),dosageText:"".concat((null==e?void 0:e.dosageText)||""),managementText:"".concat((null==e?void 0:e.managementText)||""),gestationKey:"".concat((null==e?void 0:e.gestationKey)||""),weightKey:"".concat((null==e?void 0:e.weightKey)||""),diagnosisKey:"".concat((null==e?void 0:e.diagnosisKey)||""),administrationFrequency:"".concat((null==e?void 0:e.administrationFrequency)||""),drugUnit:"".concat((null==e?void 0:e.drugUnit)||""),routeOfAdministration:"".concat((null==e?void 0:e.routeOfAdministration)||""),ageKey:"".concat((null==e?void 0:e.ageKey)||"")});function x(e){let{disabled:a,item:i,floating:r,onChange:x}=e,[h,b]=(0,o.Z)(),[y,p]=(0,o.Z)(),[j,N]=(0,t.useState)(!1),[T,w]=(0,t.useState)(f(i)),K=(0,s.useRouter)(),A=(0,s.useSearchParams)(),D=(0,t.useMemo)(()=>l.Z.parse(A.toString()),[A]),{itemId:k,addDrug:C}=D,{keys:I,loading:F}=(0,v.a)();(0,t.useEffect)(()=>{N(!!k||!!C)},[k,C]),(0,t.useEffect)(()=>{w(f(i))},[i]);let G=(0,t.useCallback)(()=>{x({...T,minWeight:T.minWeight?Number(T.minWeight):null,maxWeight:T.maxWeight?Number(T.maxWeight):null,minGestation:T.minGestation?Number(T.minGestation):null,maxGestation:T.maxGestation?Number(T.maxGestation):null,minAge:T.minAge?Number(T.minAge):null,maxAge:T.maxAge?Number(T.maxAge):null,dosage:T.dosage?Number(T.dosage):null,dosageMultiplier:T.dosageMultiplier?Number(T.dosageMultiplier):null})},[T,i,x]),W=(0,t.useCallback)(()=>{N(!1),w(f()),K.push("?".concat(l.Z.stringify({...D,itemId:void 0,addDrug:void 0})));let e=(null==b?void 0:b.top)||0;setTimeout(()=>window.scrollTo({top:e}),500)},[D,b,K.push]),S=(0,t.useCallback)(()=>!!(T.key&&T.drug&&T.minWeight&&T.minGestation&&T.maxWeight&&T.maxGestation&&T.minAge&&T.maxAge&&T.managementText&&T.dosageText&&T.diagnosisKey&&T.administrationFrequency&&T.drugUnit&&T.routeOfAdministration&&T.ageKey&&T.dosage&&Number(T.minGestation||"0")<=Number(T.maxGestation||"0")&&Number(T.minWeight||"0")<=Number(T.maxWeight||"0")&&Number(T.minAge||"0")<=Number(T.maxAge||"0")),[T]),_=(0,t.useCallback)(()=>!S()||F||a,[S,F,a]),M=(0,n.jsxs)("div",{className:"flex flex-col gap-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(c._,{secondary:!0,htmlFor:"drug",children:"Drug *"}),(0,n.jsx)(m.I,{name:"drug",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:T.drug,disabled:a,onChange:e=>w(a=>({...a,drug:e.target.value}))})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(c._,{secondary:!0,htmlFor:"key",children:"Key *"}),(0,n.jsx)(m.I,{name:"key",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:T.key,disabled:a,onChange:e=>w(a=>({...a,key:e.target.value}))})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(c._,{secondary:!0,htmlFor:"diagnosisKey",children:"Diagnosis Key *"}),(0,n.jsx)(m.I,{name:"gestationKey",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:T.diagnosisKey,disabled:a,onChange:e=>w(a=>({...a,diagnosisKey:e.target.value}))})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(c._,{secondary:!0,htmlFor:"gestationKey",children:"Gestation Key *"}),(0,n.jsx)(m.I,{name:"gestationKey",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:T.gestationKey,disabled:a,onChange:e=>w(a=>({...a,gestationKey:e.target.value}))})]}),(0,n.jsxs)("div",{className:"flex gap-x-2",children:[(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)(c._,{secondary:!0,htmlFor:"minGestation",children:"Min Gestation (weeks) *"}),(0,n.jsx)(m.I,{name:"minGestation",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:T.minGestation,type:"number",disabled:a,onChange:e=>{let a=e.target.value,i=T.maxGestation;a||(i=""),w(e=>({...e,minGestation:a,maxGestation:i}))}})]}),(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)(c._,{secondary:!0,htmlFor:"maxGestation",error:Number(T.minGestation||"0")>Number(T.maxGestation||"0"),children:"Max Gestation (weeks) *"}),(0,n.jsx)(m.I,{name:"maxGestation",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:T.maxGestation,type:"number",disabled:a||!T.minGestation,min:T.minGestation,error:Number(T.minGestation||"0")>Number(T.maxGestation||"0"),onChange:e=>w(a=>({...a,maxGestation:e.target.value}))})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(c._,{secondary:!0,htmlFor:"weightKey",children:"Weight Key *"}),(0,n.jsx)(m.I,{name:"weightKey",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:T.weightKey,disabled:a,onChange:e=>w(a=>({...a,weightKey:e.target.value}))})]}),(0,n.jsxs)("div",{className:"flex gap-x-2",children:[(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)(c._,{secondary:!0,htmlFor:"minWeight",children:"Min Weight (grams) *"}),(0,n.jsx)(m.I,{name:"minWeight",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:T.minWeight,type:"number",disabled:a,onChange:e=>{let a=e.target.value,i=T.maxWeight;a||(i=""),w(e=>({...e,minWeight:a,maxWeight:i}))}})]}),(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)(c._,{secondary:!0,htmlFor:"maxWeight",error:Number(T.minWeight||"0")>Number(T.maxWeight||"0"),children:"Max Weight (grams) *"}),(0,n.jsx)(m.I,{name:"maxWeight",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:T.maxWeight,type:"number",disabled:a||!T.minWeight,min:T.minWeight,error:Number(T.minWeight||"0")>Number(T.maxWeight||"0"),onChange:e=>w(a=>({...a,maxWeight:e.target.value}))})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(c._,{secondary:!0,htmlFor:"ageKey",children:"Day of Life (Age) Key *"}),(0,n.jsx)(m.I,{name:"ageKey",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:T.ageKey,disabled:a,onChange:e=>w(a=>({...a,ageKey:e.target.value}))})]}),(0,n.jsxs)("div",{className:"flex gap-x-2",children:[(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)(c._,{secondary:!0,htmlFor:"minAge",children:"Min Day of Life (Age - hours) *"}),(0,n.jsx)(m.I,{name:"minAge",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:T.minAge,type:"number",disabled:a,onChange:e=>{let a=e.target.value,i=T.maxAge;a||(i=""),w(e=>({...e,minAge:a,maxAge:i}))}})]}),(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)(c._,{secondary:!0,htmlFor:"maxAge",error:Number(T.minAge||"0")>Number(T.maxAge||"0"),children:"Max Day of Life (Age - hours) *"}),(0,n.jsx)(m.I,{name:"maxAge",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:T.maxAge,type:"number",disabled:a||!T.minAge,min:T.minAge,error:Number(T.minAge||"0")>Number(T.maxAge||"0"),onChange:e=>w(a=>({...a,maxAge:e.target.value}))})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(c._,{secondary:!0,htmlFor:"dosage",children:"Dose (e.g. mg/kg) *"}),(0,n.jsx)(m.I,{name:"dosage",type:"number",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:T.dosage,disabled:a,onChange:e=>w(a=>({...a,dosage:e.target.value}))})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(c._,{secondary:!0,htmlFor:"dosageMultiplier",children:"Drug Dose Multiplier *"}),(0,n.jsx)(m.I,{name:"dosageMultiplier",type:"number",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:T.dosageMultiplier,disabled:a,onChange:e=>w(a=>({...a,dosageMultiplier:e.target.value}))})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(c._,{secondary:!0,htmlFor:"weight",children:"Dosage text *"}),(0,n.jsx)(m.I,{name:"dosageText",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:T.dosageText,disabled:a,onChange:e=>w(a=>({...a,dosageText:e.target.value}))})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(c._,{secondary:!0,htmlFor:"administrationFrequency",children:"Administration Frequency *"}),(0,n.jsx)(m.I,{name:"administrationFrequency",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:T.administrationFrequency,disabled:a,onChange:e=>w(a=>({...a,administrationFrequency:e.target.value}))})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(c._,{secondary:!0,htmlFor:"drugUnit",children:"Drug Unit *"}),(0,n.jsx)(m.I,{name:"drugUnit",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:T.drugUnit,disabled:a,onChange:e=>w(a=>({...a,drugUnit:e.target.value}))})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(c._,{secondary:!0,htmlFor:"routeOfAdministration",children:"Route of Administration *"}),(0,n.jsx)(m.I,{name:"routeOfAdministration",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:T.routeOfAdministration,disabled:a,onChange:e=>w(a=>({...a,routeOfAdministration:e.target.value}))})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(c._,{secondary:!0,htmlFor:"managementText",children:"Management text *"}),(0,n.jsx)(m.I,{name:"managementText",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:T.managementText,disabled:a,onChange:e=>w(a=>({...a,managementText:e.target.value}))})]})]});return(0,n.jsxs)(n.Fragment,{children:[F&&(0,n.jsx)(g.a,{overlay:!0}),(0,n.jsx)("div",{ref:h,children:!1===r?M:(0,n.jsx)(u.yo,{open:j,onOpenChange:e=>{e||W()},children:(0,n.jsxs)(u.ue,{hideCloseButton:!0,side:"right",className:"p-0 m-0 flex flex-col w-full max-w-full sm:max-w-[80%] md:max-w-[80%] lg:max-w-[50%]",children:[(0,n.jsxs)(u.Tu,{className:"flex flex-row items-center py-2 px-4 border-b border-b-border text-left sm:text-left",children:[(0,n.jsxs)(u.bC,{children:[C?"Add":"",k?"Edit":""," drug"]}),(0,n.jsx)(u.Ei,{className:"hidden"})]}),(0,n.jsx)("div",{ref:y,className:"flex-1 py-2 px-0 overflow-y-auto",children:(0,n.jsx)("div",{className:"px-4",children:M})}),(0,n.jsxs)("div",{className:"border-t border-t-border px-4 py-2 flex gap-x-2",children:[(0,n.jsx)("span",{className:"text-danger text-xs my-auto",children:"* Required"}),(0,n.jsx)("div",{className:"ml-auto"}),(0,n.jsx)(u.sw,{asChild:!0,children:(0,n.jsx)(d.z,{variant:"ghost",onClick:()=>{},children:"Cancel"})}),(0,n.jsx)(u.sw,{asChild:!0,children:(0,n.jsx)(d.z,{onClick:()=>G(),disabled:_(),children:"Save"})})]})]})})})]})}},76905:function(e,a,i){i.d(a,{Uv:function(){return s},VO:function(){return t},d4:function(){return n},fR:function(){return r}});let n=[{value:"allSearches",label:"Found in all searches"},{value:"admissionSearches",label:"Found in admission searches"},{value:"twinSearches",label:"Found in twin searches"}],t=[{label:"Days & hours",value:"days_hours"},{label:"Years & Months",value:"years_months"}],s=[{name:"date",label:"Date"},{name:"datetime",label:"Date + Time"},{name:"dropdown",label:"Dropdown"},{name:"number",label:"Number"},{name:"text",label:"Text"},{name:"time",label:"Time"},{name:"period",label:"Time period"}],l={calculation:null,condition:"",confidential:!1,dataType:null,defaultValue:null,format:null,type:null,key:null,refKey:null,label:null,minValue:null,maxValue:null,optional:!1,minDate:null,maxDate:null,minTime:null,maxTime:null,minDateKey:"",maxDateKey:"",minTimeKey:"",maxTimeKey:"",values:""},r={admission:[{...l,type:"dropdown",key:"BabyTransfered",values:"Y,Yes\nN,No",label:"Has the baby been transfered from another facility"},{...l,type:"text",key:"patientNUID",label:"Search patient's NUID",condition:"$BabyTransfered = 'Y'"},{...l,type:"dropdown",key:"BabyTwin",values:"Y,Yes\nN,No",label:"Does the baby have a twin?"},{...l,type:"text",key:"BabyTwinNUID",label:"Search twin's NUID",condition:"$BabyTwin = 'Y'"}],other:[{...l,type:"text",key:"patientNUID",values:"Y,Yes\nN,No",label:"Search patient's NUID"}]}},44371:function(e,a,i){i.d(a,{R:function(){return c},a:function(){return g}});var n=i(2265),t=i(16463),s=i(12491),l=i(38472),r=i(39099),o=i(53699),u=i(7752);let d={initialised:!1,loading:!1,keys:[],drugs:[]},m=(0,r.Ue)(e=>d);function c(){m.setState(d)}function g(){let e=m(),{drugs:a}=e,i=(0,t.useRouter)(),r=(0,t.useSearchParams)(),c=(0,n.useMemo)(()=>s.Z.parse(r.toString()),[r]),{itemId:g}=c,{alert:v}=(0,o.s)(),f=(0,n.useCallback)(async()=>{try{var e,a;m.setState({loading:!0});let i=await l.Z.get("/api/drugs-library?data="+JSON.stringify({returnDraftsIfExist:!0}));if(null===(e=i.data.errors)||void 0===e?void 0:e.length)throw Error(null===(a=i.data.errors)||void 0===a?void 0:a.join(", "));m.setState({drugs:i.data.data})}catch(e){v({title:"Error",message:e.message,variant:"error"})}finally{m.setState({loading:!1})}},[v]);!function(e){let{events:a}=e,i=(0,n.useMemo)(()=>a,[a]),s=(0,n.useRef)({eventsTimeouts:{},eventsTimestamps:{}});(0,n.useRef)(new Date().getTime());let l=(0,t.useRouter)();(0,n.useEffect)(()=>{i.forEach(e=>{let{name:a,action:i,delay:n=100,onEvent:t}=e;u.Z.on(a,function(){for(var e=arguments.length,r=Array(e),o=0;o<e;o++)r[o]=arguments[o];let u=()=>{var e,n;(!i||r[0]===i)&&(null===(e=t.callback)||void 0===e||e.call(t,...r),(null==t?void 0:t.refreshRouter)&&(console.log(a,"refreshing..."),l.refresh()),(null===(n=t.redirect)||void 0===n?void 0:n.to)&&(t.redirect.replace?l.replace(t.redirect.to):l.push(t.redirect.to)))},d=new Date().getTime();n?(clearTimeout(s.current.eventsTimeouts[a]),s.current.eventsTimeouts[a]=setTimeout(()=>{s.current.eventsTimestamps[a]=d,u()},n)):(s.current.eventsTimestamps[a]=new Date().getTime(),u())})})},[i,l])}({events:[{name:"data_changed",onEvent:{callback:async()=>{await f(),i.refresh()}}}]});let x=(0,n.useCallback)(async e=>{try{var a,n;m.setState(a=>({loading:!0,drugs:a.drugs.filter(a=>!e.includes(a.itemId))}));let t=await l.Z.delete("/api/drugs-library?data="+JSON.stringify({itemsIds:e}));if(null===(a=t.data.errors)||void 0===a?void 0:a.length)throw Error(null===(n=t.data.errors)||void 0===n?void 0:n.join(", "));i.refresh(),v({title:"",message:"Drug deleted successfully!",variant:"success"})}catch(e){v({title:"Error",message:e.message,variant:"error"})}finally{m.setState({loading:!1})}},[v,i.refresh]),h=(0,n.useCallback)(async e=>{try{var n,t;m.setState({loading:!0});let s=a;m.setState(a=>(s=!g&&e?[...a.drugs,e]:a.drugs.map(a=>a.itemId!==(null==e?void 0:e.itemId)?a:{...a,...e}),{loading:!0,drugs:s}));let r={data:e?[e]:s,broadcastAction:!0},o=await l.Z.post("/api/drugs-library/save",r);if(null===(n=o.data.errors)||void 0===n?void 0:n.length)throw Error(null===(t=o.data.errors)||void 0===t?void 0:t.join(", "));await f(),i.refresh(),v({title:"",message:"Drug".concat(e?"":"s"," saved successfully!"),variant:"success"})}catch(e){v({title:"Error",message:e.message,variant:"error"})}finally{m.setState({loading:!1})}},[a,g,i.refresh]);return(0,n.useEffect)(()=>{m.getState().initialised||(f(),m.setState({initialised:!0}))},[f]),(0,n.useCallback)(()=>{m.setState(d)},[]),{...e,selectedItemId:g,addLink:"?".concat(s.Z.stringify({...c,addDrug:1})),editLink:e=>"?".concat(s.Z.stringify({...c,itemId:e})),getDrugs:f,deleteDrugs:x,saveDrugs:h}}},78591:function(e,a,i){i.d(a,{s:function(){return n}});function n(e){let a=[],i=(e||"").split("\n").map(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.trim()}).map(e=>{let a=e.split(",");return{value:a[0],label:a[1]}}),n=i.map(e=>e.value),t=i.map(e=>e.label),s=i.filter(e=>!e.value||!e.label),l=n.filter((e,a)=>n.indexOf(e)!==a);return(t.filter((e,a)=>t.indexOf(e)!==a).length||l.length)&&a.push("Dropdown values contain duplicate data"),s.length&&a.push("Incorrect dropdown values format"),a}}}]);