(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5589],{51266:function(e,s,i){Promise.resolve().then(i.bind(i,55797)),Promise.resolve().then(i.bind(i,25704))},55797:function(e,s,i){"use strict";i.d(s,{Form:function(){return m}});var l=i(57437),a=i(2265),n=i(39343),r=i(27776),t=i(30998),c=i(16463),d=i(83102),o=i(50495),u=i(32243),h=i(37440);function m(e){let{sendAuthCode:s}=e,i=(0,c.useRouter)(),[m,f]=(0,a.useState)(!1),[x,p]=(0,a.useState)(!1),[v,j]=(0,a.useState)(!1),[y,g]=(0,a.useState)(),{formState:{errors:w},watch:N,setValue:S,register:b,handleSubmit:k}=(0,n.cI)({shouldUnregister:!1,defaultValues:{email:"",code:"",password:"",verifiedEmail:""}}),E=N("code"),C=N("email"),_=N("verifiedEmail"),I=(0,a.useMemo)(()=>C&&C===_,[C,_]),P=(0,a.useCallback)(async e=>{f(!0),s({email:e,tokenId:y}).then(s=>{let{tokenId:i}=s;p(!0),S("verifiedEmail",e),g(i)}).catch(e=>r.Am.error(e.message)).finally(()=>f(!1))},[y,S,s]),q=k(e=>{if(e.verifiedEmail!==e.email)P(e.email);else{f(!0);let s=(e,s)=>{e&&r.Am.error(e.message||e),s&&i.replace("/")};(0,t.signIn)("credentials",{...e,redirect:!1}).then(e=>s(null==e?void 0:e.error,null==e?void 0:e.ok)).catch(s).finally(()=>f(!1))}});return(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("form",{className:" flex flex-col gap-y-4 ",onSubmit:e=>{e.preventDefault(),q()},children:[(0,l.jsx)("div",{children:(0,l.jsx)(d.I,{type:"email",placeholder:"Email address",...b("email",{required:!0})})}),(0,l.jsx)("div",{className:(0,h.cn)("flex justify-center",I&&x?"":"hidden"),children:(0,l.jsx)(u.Zn,{maxLength:6,value:E,required:x,onChange:e=>{S("code",e),6===e.length&&q()},children:(0,l.jsx)(u.hf,{children:(()=>{let e=[];for(let s=0;s<6;s++)e.push((0,l.jsx)(u.cY,{index:s,className:"w-14"},s));return e})()})})}),(0,l.jsx)("div",{className:(0,h.cn)(I&&v?"":"hidden"),children:(0,l.jsx)(d.I,{type:"password",placeholder:"Password",...b("password",{required:v,disabled:m})})}),(0,l.jsxs)("div",{className:"flex flex-col gap-y-2",children:[(0,l.jsx)(o.z,{type:"submit",disabled:m,className:"w-full",children:m?"Please wait...":x||v?"Sign in":"Send verification code"}),I&&(0,l.jsxs)("div",{className:"flex flex-col items-end gap-y-1",children:[(0,l.jsx)("a",{href:"#",className:(0,h.cn)("text text-sm transition-colors text-secondary/60 hover:text-secondary",m&&"opacity-20"),onClick:e=>{e.preventDefault(),m||(S("code",""),S("password",""),v?(j(!1),p(!0)):(j(!0),p(!1)))},children:v?"Sign in with code":"Sign in with password"}),x&&(0,l.jsx)("a",{href:"#",className:(0,h.cn)("text text-sm transition-colors text-secondary/60 hover:text-secondary",m&&"opacity-20"),onClick:e=>{e.preventDefault(),m||P(C)},children:"Resend code"})]})]})]})})}}},function(e){e.O(0,[4868,2592,9343,9370,3666,7478,7023,1744],function(){return e(e.s=51266)}),_N_E=e.O()}]);