(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4665],{81905:function(e,r,t){Promise.resolve().then(t.bind(t,35832)),Promise.resolve().then(t.bind(t,25704))},35832:function(e,r,t){"use strict";t.d(r,{Form:function(){return y}});var n=t(57437),s=t(2265),i=t(39343),a=t(38472),l=t(83102),o=t(50495),d=t(53699);function c(e){let{email:r,sendAuthCode:t,onEmailVerified:c,isEmailRegistered:u}=e,{alert:f}=(0,d.s)(),[m,p]=(0,s.useState)(!1),{register:x,handleSubmit:h}=(0,i.cI)({shouldUnregister:!1,defaultValues:{email:r||""}}),v=h(async e=>{let{email:r}=e;try{p(!0);let e=await a.Z.get("/api/users/is-email-registered?email="+r),{errors:n,yes:s,isActive:i}=e.data;if(console.log(e),(null==n?void 0:n.length)||!s){var t;f({title:"Error",message:(null==n?void 0:null===(t=n.join)||void 0===t?void 0:t.call(n,", "))||"Email address not registered, are you sure that address is typed correctly?",variant:"error"})}else c({email:r,isActive:!!i})}catch(e){f({title:"Error",message:e.message,variant:"error"})}finally{p(!1)}});return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("form",{className:" flex flex-col gap-y-4 ",onSubmit:e=>{e.preventDefault(),v()},children:[(0,n.jsx)("div",{children:(0,n.jsx)(l.I,{type:"email",placeholder:"Email address",...x("email",{required:!0,disabled:m})})}),(0,n.jsx)("div",{className:"flex flex-col gap-y-2",children:(0,n.jsx)(o.z,{type:"submit",disabled:m,className:"w-full",children:m?"Please wait...":"Continue"})})]})})}var u=t(30998),f=t(16463),m=t(66431),p=t(32309),x=t(37440);let h=s.forwardRef((e,r)=>{let{className:t,containerClassName:s,...i}=e;return(0,n.jsx)(m.uZ,{ref:r,containerClassName:(0,x.cn)("flex items-center gap-2 has-[:disabled]:opacity-50",s),className:(0,x.cn)("disabled:cursor-not-allowed",t),...i})});h.displayName="InputOTP";let v=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,n.jsx)("div",{ref:r,className:(0,x.cn)("flex items-center",t),...s})});v.displayName="InputOTPGroup";let g=s.forwardRef((e,r)=>{let{index:t,className:i,...a}=e,{char:l,hasFakeCaret:o,isActive:d}=s.useContext(m.VM).slots[t];return(0,n.jsxs)("div",{ref:r,className:(0,x.cn)("relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md",d&&"z-10 ring-2 ring-ring ring-offset-background",i),...a,children:[l,o&&(0,n.jsx)("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center",children:(0,n.jsx)("div",{className:"h-4 w-px animate-caret-blink bg-foreground duration-1000"})})]})});function b(e){let{email:r,onSendCode:t,sendAuthCode:c,setPassword:m,shouldSetPassword:p}=e,{alert:b}=(0,d.s)();(0,f.useRouter)();let[y,j]=(0,s.useState)(!1),[w,N]=(0,s.useState)(!1),[E,C]=(0,s.useState)(!0),{watch:I,setValue:P,register:S,handleSubmit:k}=(0,i.cI)({shouldUnregister:!1,defaultValues:{email:r,code:"",password:"",passwordConfirm:""}}),_=I("code"),F=k(async e=>{try{if(j(!0),p){let{errors:t}=(await a.Z.post("/api/users/set-password",{...e,email:r})).data;if(null==t?void 0:t.length)throw Error(t.join(", "))}let t=await (0,u.signIn)("credentials",{...e,email:r,redirect:!1});if(null==t?void 0:t.ok)window.location.href="/";else throw Error((null==t?void 0:t.error)||"Failed to sign in")}catch(e){b({title:"Error",message:e.message,variant:"error"})}finally{j(!1)}});return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("form",{className:" flex flex-col gap-y-4 ",onSubmit:e=>{e.preventDefault(),F()},children:[(0,n.jsx)("div",{children:(0,n.jsx)(l.I,{type:"email",placeholder:"Email address",...S("email",{disabled:!0})})}),(0,n.jsx)("div",{className:(0,x.cn)("flex justify-center",w?"":"hidden"),children:(0,n.jsx)(h,{maxLength:6,value:_,required:w,onChange:e=>{P("code",e),6===e.length&&F()},children:(0,n.jsx)(v,{children:(()=>{let e=[];for(let r=0;r<6;r++)e.push((0,n.jsx)(g,{index:r,className:"w-14"},r));return e})()})})}),(0,n.jsx)("div",{className:(0,x.cn)(E?"":"hidden"),children:(0,n.jsx)(l.I,{type:"password",placeholder:"Password",...S("password",{required:E,disabled:y})})}),!!p&&(0,n.jsx)("div",{className:(0,x.cn)(E?"":"hidden"),children:(0,n.jsx)(l.I,{type:"password",placeholder:"Confirm password",...S("passwordConfirm",{required:!0,disabled:y})})}),(0,n.jsxs)("div",{className:"flex flex-col gap-y-2",children:[(0,n.jsx)(o.z,{type:"submit",disabled:y,className:"w-full",children:y?"Please wait...":"Sign in"}),(0,n.jsxs)("div",{className:(0,x.cn)("flex flex-col items-end gap-y-1",p&&"hidden"),children:[(0,n.jsx)("a",{href:"#",className:(0,x.cn)("text text-sm transition-colors text-secondary/60 hover:text-secondary",y&&"opacity-20"),onClick:e=>{e.preventDefault(),y||(P("code",""),P("password",""),E?(C(!1),N(!0),c({email:r})):(C(!0),N(!1)))},children:E?"Email me a sign in code":"Sign in with password"}),w&&(0,n.jsx)("a",{href:"#",className:(0,x.cn)("text text-sm transition-colors text-secondary/60 hover:text-secondary",y&&"opacity-20"),onClick:e=>{e.preventDefault(),y||t()},children:"Resend code"})]})]})]})})}function y(e){let{sendAuthCode:r,isEmailRegistered:t,setPassword:i}=e,[a,l]=(0,s.useState)("verifyEmailForm"),[o,d]=(0,s.useState)(""),[u,f]=(0,s.useState)(!1);return(0,n.jsxs)(n.Fragment,{children:["verifyEmailForm"===a&&(0,n.jsx)(c,{email:o,sendAuthCode:r,isEmailRegistered:t,onEmailVerified:e=>{let{email:r,isActive:t}=e;d(r),f(!t),l("signInForm")}}),"signInForm"===a&&(0,n.jsx)(b,{email:o,onSendCode:()=>{l("verifyEmailForm"),f(!1)},sendAuthCode:r,shouldSetPassword:u,setPassword:i})]})}g.displayName="InputOTPSlot",s.forwardRef((e,r)=>{let{...t}=e;return(0,n.jsx)("div",{ref:r,role:"separator",...t,children:(0,n.jsx)(p.Z,{})})}).displayName="InputOTPSeparator"},25704:function(e,r,t){"use strict";t.r(r),t.d(r,{Title:function(){return i}});var n=t(2265),s=t(20357);function i(e){let{children:r}=e;return(0,n.useEffect)(()=>{document.title=[s.env.NEXT_PUBLIC_APP_NAME,r].filter(e=>e).join(" - ")},[r]),(0,n.useEffect)(()=>()=>{document.title="".concat(s.env.NEXT_PUBLIC_APP_NAME)},[]),null}},50495:function(e,r,t){"use strict";t.d(r,{d:function(){return o},z:function(){return d}});var n=t(57437),s=t(2265),i=t(71538),a=t(12218),l=t(37440);let o=(0,a.j)("\n    inline-flex\n    items-center\n    justify-center\n    whitespace-nowrap\n    rounded-md\n    text-sm\n    font-medium\n    transition-colors\n    focus-visible:outline-none\n    disabled:pointer-events-none\n    disabled:opacity-50\n  ",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"border border-input bg-background hover:bg-primary/20","primary-outline":"border border-primary text-primary bg-transparent hover:bg-primary/20",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/90",ghost:"hover:bg-primary/20 hover:text-primary",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=s.forwardRef((e,r)=>{let{className:t,variant:s,size:a,asChild:d=!1,...c}=e,u=d?i.g7:"button";return(0,n.jsx)(u,{className:(0,l.cn)(o({variant:s,size:a,className:t})),ref:r,...c})});d.displayName="Button"},83102:function(e,r,t){"use strict";t.d(r,{I:function(){return a}});var n=t(57437),s=t(2265),i=t(37440);let a=s.forwardRef((e,r)=>{let{className:t,type:s,noRing:a,error:l,...o}=e;return(0,n.jsx)("input",{type:s,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a&&"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",l&&"border-danger",l&&!a&&"focus-visible:ring-danger",t),ref:r,...o})});a.displayName="Input"},53699:function(e,r,t){"use strict";t.d(r,{s:function(){return i}});var n=t(39099);let s={title:"",message:"",buttonLabel:"Ok",variant:"info",onClose:void 0},i=(0,n.Ue)(e=>({isOpen:!1,...s,alert:r=>e({isOpen:!0,...s,...r}),close:()=>e({isOpen:!1,onClose:void 0,...s})}))},37440:function(e,r,t){"use strict";t.d(r,{cn:function(){return i}});var n=t(44839),s=t(96164);function i(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,s.m6)((0,n.W)(r))}}},function(e){e.O(0,[4868,9343,9370,4870,7581,7478,7023,1744],function(){return e(e.s=81905)}),_N_E=e.O()}]);