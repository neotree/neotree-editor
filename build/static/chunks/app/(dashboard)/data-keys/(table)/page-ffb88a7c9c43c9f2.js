(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1967],{53473:function(e,a,t){Promise.resolve().then(t.bind(t,6047)),Promise.resolve().then(t.bind(t,25704))},6047:function(e,a,t){"use strict";t.d(a,{DataKeysTable:function(){return M}});var s=t(57437),n=t(23920),l=t(44380),r=t(17647),i=t(37440),d=t(39661),c=t(92513),o=t(87138),u=t(50495),x=t(64344),m=t(83146),f=t(46294);function h(){let{sort:e,filter:a,onSort:t,setFilter:l}=(0,n.M)();return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"p-4 flex flex-col gap-y-4",children:(0,s.jsxs)("div",{className:"flex flex-wrap items-center",children:[(0,s.jsx)("div",{className:"text-2xl",children:"Data keys"}),(0,s.jsxs)("div",{className:"flex-1 flex flex-wrap items-center justify-end gap-x-4",children:[(0,s.jsx)("div",{children:(0,s.jsxs)(f.Ph,{value:e,onValueChange:e=>t(e),children:[(0,s.jsx)(f.i4,{children:(0,s.jsx)(f.ki,{placeholder:"Sort"})}),(0,s.jsx)(f.Bw,{children:m.F4.map(e=>(0,s.jsx)(f.Ql,{value:e.value,children:(0,s.jsxs)("div",{className:"flex items-center gap-x-2 w-[160px]",children:[(0,s.jsx)(e.Icon,{className:"size-4"}),(0,s.jsx)("span",{children:e.label})]})},e.value))})]})}),(0,s.jsx)("div",{children:(0,s.jsxs)(f.Ph,{value:a,onValueChange:e=>l("all"===e?"":e),children:[(0,s.jsx)(f.i4,{children:(0,s.jsx)(f.ki,{placeholder:"All keys"})}),(0,s.jsxs)(f.Bw,{children:[(0,s.jsx)(f.Ql,{value:"all",children:"All keys"}),(0,s.jsx)(f.U$,{}),(0,s.jsxs)(f.DI,{children:[(0,s.jsx)(f.n5,{children:"Status"}),m.UQ.map(e=>(0,s.jsx)(f.Ql,{value:e.value,children:e.label},e.value))]}),(0,s.jsx)(f.U$,{}),(0,s.jsxs)(f.DI,{children:[(0,s.jsx)(f.n5,{children:"Types"}),m.y0.map(e=>(0,s.jsx)(f.Ql,{value:e.value,children:e.label},e.value))]})]})]})}),(0,s.jsx)(u.z,{asChild:!0,variant:"ghost",className:"w-auto h-auto",children:(0,s.jsxs)(o.default,{href:"/data-keys/new",children:[(0,s.jsx)(c.Z,{className:"size-4 mr-2"}),"Add"]})})]})]})}),(0,s.jsx)(x.Separator,{})]})}var p=t(2265),j=t(45188),g=t(75733),N=t(6649),y=t(90399),v=t(46910),w=t(76230),b=t(61386),k=t(71239);function C(e){let{rowIndex:a,disabled:t,setCurrentDataKeyUuid:l}=e,[r,c]=(0,p.useTransition)(),{dataKeys:u,deleteDataKeys:x}=(0,n.M)(),{confirm:m}=(0,w.t)(),f=u[a],h={isDraft:null==f?void 0:f.isDraft,userId:null==f?void 0:f.draftCreatedByUserId,dataType:"data key"},C=(0,k.v)(h);return(t=t||C,f)?(0,s.jsxs)("div",{className:"flex gap-x-2",children:[r&&(0,s.jsx)(d.a,{overlay:!0}),(0,s.jsx)(b.O,{...h}),(0,s.jsxs)(v.h_,{children:[(0,s.jsx)(v.$F,{children:(0,s.jsx)(j.Z,{className:"h-4 w-4"})}),(0,s.jsxs)(v.AW,{children:[(0,s.jsx)(v.Xi,{asChild:!0,onClick:()=>setTimeout(()=>c(()=>{}),0),children:(0,s.jsx)(o.default,{href:"/data-keys/edit/".concat(f.uuid),children:t?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(g.Z,{className:"h-4 w-4 mr-2"})," View"]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(N.Z,{className:"h-4 w-4 mr-2"})," Edit"]})})}),(0,s.jsxs)(v.Xi,{className:(0,i.cn)("text-destructive",t&&"hidden"),onClick:()=>setTimeout(()=>{m(()=>x([f.uuid]),{title:"Delete data key",message:"Are you sure?"})},0),children:[(0,s.jsx)(y.Z,{className:"h-4 w-4 mr-2"})," Delete"]})]})]})]}):null}var D=t(17501),z=t(58184),I=t(39343),Z=t(53853),E=t(67135),P=t(86466),_=t(90837);function R(e){var a;let{uuids:t}=e,[l,r]=(0,p.useState)(!1),{dataKeys:c,exporting:o,exportDataKeys:x,extractDataKeys:m}=(0,n.M)(),{sites:h,loading:j,loadSites:g}=(0,Z.k)({loadOnMount:!1,onLoadSitesError:()=>r(!1)}),{formState:{errors:N},reset:y,watch:v,setValue:w,handleSubmit:b,setError:k}=(0,I.cI)({defaultValues:{siteId:"",overwriteExisting:!1}}),C=v("siteId"),D=v("overwriteExisting"),R=o||j,S=!!C&&!R,V=b(async e=>{if(e.siteId){let a=m(t,{withNested:!0}).map(e=>e.uuid);await x({...e,uuids:a}),r(!1)}else k("siteId",{message:"Site is required"})});return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(_.Vq,{open:l,onOpenChange:e=>{y(),e&&g(),r(e)},children:[(0,s.jsx)(_.hg,{asChild:!0,children:(0,s.jsxs)(u.z,{className:"h-auto w-auto",children:[(0,s.jsx)(z.Z,{className:"h-4 w-4 mr-1"}),(0,s.jsx)("span",{children:t.length>1?"Export ".concat(t.length):"Export"})]})}),(0,s.jsxs)(_.cZ,{children:[(0,s.jsxs)(_.fK,{children:[(0,s.jsx)(_.$N,{children:"Export"}),(0,s.jsx)(_.Be,{className:"hidden",children:""})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-y-5",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(E._,{htmlFor:"siteId",children:"Site *"}),(0,s.jsxs)(f.Ph,{name:"siteId",onValueChange:e=>w("siteId",e,{shouldDirty:!0}),children:[(0,s.jsx)(f.i4,{children:(0,s.jsx)(f.ki,{placeholder:"Select site"})}),(0,s.jsx)(f.Bw,{children:(0,s.jsxs)(f.DI,{children:[(0,s.jsx)(f.n5,{children:"Sites"}),h.map(e=>{let{siteId:a,name:t}=e;return(0,s.jsx)(f.Ql,{value:a,children:t},a)})]})})]}),!!(null===(a=N.siteId)||void 0===a?void 0:a.message)&&(0,s.jsx)("div",{className:"text-xs text-danger mt-1",children:N.siteId.message})]}),(0,s.jsxs)("div",{className:(0,i.cn)("flex gap-x-2"),children:[(0,s.jsx)(P.X,{name:"overwriteExisting",id:"overwriteExisting",checked:D,onCheckedChange:()=>w("overwriteExisting",!D,{shouldDirty:!0})}),(0,s.jsx)(E._,{secondary:!0,htmlFor:"overwriteExisting",children:"Overwrite existing"})]}),R&&(0,s.jsx)(d.a,{overlay:!0})]}),(0,s.jsxs)(_.cN,{children:[(0,s.jsx)(_.GG,{asChild:!0,children:(0,s.jsx)(u.z,{variant:"ghost",children:"Cancel"})}),(0,s.jsxs)(u.z,{onClick:V,disabled:!S,children:[(0,s.jsx)(z.Z,{className:"h-4 w-4 mr-1"}),"Export"]})]})]})]})})}function S(e){let{disabled:a}=e,{confirm:t}=(0,w.t)(),{selected:l,setSelected:r,deleteDataKeys:i}=(0,n.M)();return a||!l.length?null:(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(D.h,{children:[(0,s.jsx)(u.z,{variant:"ghost",onClick:()=>r([]),children:"Cancel"}),(0,s.jsx)(R,{uuids:l.map(e=>e.uuid)}),(0,s.jsxs)(u.z,{variant:"destructive",onClick:()=>setTimeout(()=>{t(()=>i(l.map(e=>e.uuid)),{title:"Delete data keys",message:"Are you sure?"})},0),children:[(0,s.jsx)(y.Z,{className:"w-4 h-4 mr-2"}),"Delete",l.length>1?" ".concat(l.length," keys"):""]})]})})}var V=t(2814);function M(e){let{disabled:a}=e,{viewOnly:t}=(0,r.b)();a=a||t;let{dataKeys:c,selected:o,deleting:u,loadingDataKeys:x,setCurrentDataKeyUuid:m,setSelected:f,pagination:p,currentPage:j,itemsPerPage:g,setCurrentPage:N,searchValue:y,setSearchValue:v}=(0,n.M)(),w=e=>{N(e),f([])},b={selectable:!a,selectedIndexes:o.map(e=>e.index),onSelect:e=>f(e.map(e=>{var a;return{index:e,uuid:null===(a=c[e])||void 0===a?void 0:a.uuid}}).filter(e=>e.uuid)),getRowOptions(e){let{rowIndex:a}=e,s=c[a];return s?{className:(0,i.cn)(!t&&s.isDraft&&"bg-danger/20 hover:bg-danger/30")}:{}},search:{inputPlaceholder:"Search data keys",value:y,setValue:v},noDataMessage:(0,s.jsx)("div",{className:"mt-4 flex flex-col items-center justify-center gap-y-2",children:(0,s.jsx)("div",{children:"No data keys found."})}),columns:[{name:"Key"},{name:"Label"},{name:"Ref ID",cellClassName:"hidden"},{name:"Data type"},{name:"",align:"right",cellClassName:(0,i.cn)("w-10"),cellRenderer(e){let{rowIndex:t}=e;return(0,s.jsx)(C,{rowIndex:t,disabled:a,setCurrentDataKeyUuid:m})}}],data:c.map(e=>[e.name||"",e.label||"",e.refId||"",e.dataType||"",""])};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex flex-col gap-y-4",children:[(0,s.jsx)(h,{}),(0,s.jsx)(l.DataTable,{...b}),p&&p.totalPages>1&&(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)(V.tl,{children:(0,s.jsxs)(V.ng,{children:[(0,s.jsx)(V.nt,{children:(0,s.jsx)(V.dN,{onClick:()=>w(Math.max(1,j-1)),className:(0,i.cn)("cursor-pointer",1===j&&"pointer-events-none opacity-50")})}),(()=>{if(!p)return null;let{page:e,totalPages:a}=p,t=[];if(t.push(1),a<=7)for(let e=2;e<=a;e++)t.push(e);else{e>3&&t.push("ellipsis");for(let s=Math.max(2,e-1);s<=Math.min(a-1,e+1);s++)t.push(s);e<a-2&&t.push("ellipsis"),a>1&&t.push(a)}return t.map((a,t)=>"ellipsis"===a?(0,s.jsx)(V.nt,{children:(0,s.jsx)(V.Dj,{})},"ellipsis-".concat(t)):(0,s.jsx)(V.nt,{children:(0,s.jsx)(V.kN,{onClick:()=>w(a),isActive:a===e,className:(0,i.cn)("cursor-pointer"),children:a})},a))})(),(0,s.jsx)(V.nt,{children:(0,s.jsx)(V.$0,{onClick:()=>w(Math.min(p.totalPages,j+1)),className:(0,i.cn)("cursor-pointer",j===p.totalPages&&"pointer-events-none opacity-50")})})]})}),(0,s.jsxs)("div",{className:"text-sm text-muted-foreground text-center",children:["Showing ",(j-1)*g+1," to ",Math.min(j*g,p.total)," of ",p.total," entries"]})]})]}),(0,s.jsx)(S,{disabled:a}),(u||x)&&(0,s.jsx)(d.a,{overlay:!0})]})}},90837:function(e,a,t){"use strict";t.d(a,{$N:function(){return p},Be:function(){return j},GG:function(){return u},Vq:function(){return d},cN:function(){return h},cZ:function(){return m},fK:function(){return f},hg:function(){return c}});var s=t(57437),n=t(2265),l=t(13304),r=t(74697),i=t(37440);let d=l.fC,c=l.xz,o=l.h_,u=l.x8,x=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)(l.aV,{ref:a,className:(0,i.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...n})});x.displayName=l.aV.displayName;let m=n.forwardRef((e,a)=>{let{className:t,children:n,hideCloseButton:d,...c}=e;return(0,s.jsxs)(o,{children:[(0,s.jsx)(x,{}),(0,s.jsxs)(l.VY,{ref:a,className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...c,children:[n,!0!==d&&(0,s.jsxs)(l.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,s.jsx)(r.Z,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});m.displayName=l.VY.displayName;let f=e=>{let{className:a,...t}=e;return(0,s.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-1.5 text-center sm:text-left",a),...t})};f.displayName="DialogHeader";let h=e=>{let{className:a,...t}=e;return(0,s.jsx)("div",{className:(0,i.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...t})};h.displayName="DialogFooter";let p=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)(l.Dx,{ref:a,className:(0,i.cn)("text-lg font-semibold leading-none tracking-tight",t),...n})});p.displayName=l.Dx.displayName;let j=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)(l.dk,{ref:a,className:(0,i.cn)("text-sm text-muted-foreground",t),...n})});j.displayName=l.dk.displayName},2814:function(e,a,t){"use strict";t.d(a,{$0:function(){return h},Dj:function(){return p},dN:function(){return f},kN:function(){return m},ng:function(){return u},nt:function(){return x},tl:function(){return o}});var s=t(57437),n=t(2265),l=t(70518),r=t(87592),i=t(63550),d=t(37440),c=t(50495);let o=e=>{let{className:a,...t}=e;return(0,s.jsx)("nav",{role:"navigation","aria-label":"pagination",className:(0,d.cn)("mx-auto flex w-full justify-center",a),...t})};o.displayName="Pagination";let u=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)("ul",{ref:a,className:(0,d.cn)("flex flex-row items-center gap-1",t),...n})});u.displayName="PaginationContent";let x=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)("li",{ref:a,className:(0,d.cn)("",t),...n})});x.displayName="PaginationItem";let m=e=>{let{className:a,isActive:t,size:n="icon",...l}=e;return(0,s.jsx)("a",{"aria-current":t?"page":void 0,className:(0,d.cn)((0,c.d)({variant:t?"outline":"ghost",size:n}),a),...l})};m.displayName="PaginationLink";let f=e=>{let{className:a,children:t,...n}=e;return(0,s.jsxs)(m,{"aria-label":"Go to previous page",size:"default",className:(0,d.cn)("gap-1 pl-2.5",a),...n,children:[(0,s.jsx)(l.Z,{className:"h-4 w-4"}),t||(0,s.jsx)("span",{children:"Previous"})]})};f.displayName="PaginationPrevious";let h=e=>{let{className:a,children:t,...n}=e;return(0,s.jsxs)(m,{"aria-label":"Go to next page",size:"default",className:(0,d.cn)("gap-1 pr-2.5",a),...n,children:[t||(0,s.jsx)("span",{children:"Next"}),(0,s.jsx)(r.Z,{className:"h-4 w-4"})]})};h.displayName="PaginationNext";let p=e=>{let{className:a,...t}=e;return(0,s.jsxs)("span",{"aria-hidden":!0,className:(0,d.cn)("flex h-9 w-9 items-center justify-center",a),...t,children:[(0,s.jsx)(i.Z,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"More pages"})]})};p.displayName="PaginationEllipsis"},46294:function(e,a,t){"use strict";t.d(a,{Bw:function(){return p},DI:function(){return u},Ph:function(){return o},Ql:function(){return g},U$:function(){return N},i4:function(){return m},ki:function(){return x},n5:function(){return j}});var s=t(57437),n=t(2265),l=t(17549),r=t(42421),i=t(14392),d=t(22468),c=t(37440);let o=l.fC,u=l.ZA,x=l.B4,m=n.forwardRef((e,a)=>{let{className:t,children:n,error:i,...d}=e;return(0,s.jsxs)(l.xz,{ref:a,className:(0,c.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm placeholder:text-muted-foreground focus:outline-none disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",i&&"border-danger",t),...d,children:[n,(0,s.jsx)(l.JO,{asChild:!0,children:(0,s.jsx)(r.Z,{className:"h-4 w-4 opacity-50"})})]})});m.displayName=l.xz.displayName;let f=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)(l.u_,{ref:a,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",t),...n,children:(0,s.jsx)(i.Z,{className:"h-4 w-4"})})});f.displayName=l.u_.displayName;let h=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)(l.$G,{ref:a,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",t),...n,children:(0,s.jsx)(r.Z,{className:"h-4 w-4"})})});h.displayName=l.$G.displayName;let p=n.forwardRef((e,a)=>{let{className:t,children:n,position:r="popper",...i}=e;return(0,s.jsx)(l.h_,{children:(0,s.jsxs)(l.VY,{ref:a,className:(0,c.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===r&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:r,...i,children:[(0,s.jsx)(f,{}),(0,s.jsx)(l.l_,{className:(0,c.cn)("p-1","popper"===r&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:n}),(0,s.jsx)(h,{})]})})});p.displayName=l.VY.displayName;let j=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)(l.__,{ref:a,className:(0,c.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...n})});j.displayName=l.__.displayName;let g=n.forwardRef((e,a)=>{let{className:t,children:n,...r}=e;return(0,s.jsxs)(l.ck,{ref:a,className:(0,c.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...r,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(l.wU,{children:(0,s.jsx)(d.Z,{className:"h-4 w-4"})})}),(0,s.jsx)(l.eT,{children:n})]})});g.displayName=l.ck.displayName;let N=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)(l.Z0,{ref:a,className:(0,c.cn)("-mx-1 my-1 h-px bg-muted",t),...n})});N.displayName=l.Z0.displayName},64344:function(e,a,t){"use strict";t.d(a,{Separator:function(){return i}});var s=t(57437),n=t(2265),l=t(48484),r=t(37440);let i=n.forwardRef((e,a)=>{let{className:t,orientation:n="horizontal",decorative:i=!0,...d}=e;return(0,s.jsx)(l.f,{ref:a,decorative:i,orientation:n,className:(0,r.cn)("shrink-0 bg-border","horizontal"===n?"h-[1px] w-full":"h-full w-[1px]",t),...d})});i.displayName=l.f.displayName},53853:function(e,a,t){"use strict";t.d(a,{k:function(){return i}});var s=t(2265),n=t(38472),l=t(17647),r=t(53699);function i(e){let{loadOnMount:a=!0,onLoadSitesError:t}={...e},[i,d]=(0,s.useState)(!1),{alert:c}=(0,r.s)(),{getSites:o}=(0,l.b)(),[u,x]=(0,s.useState)([]),m=(0,s.useCallback)(async()=>{try{var e;d(!0);let a=(await n.Z.get("/api/sites?data="+JSON.stringify({types:["webeditor"]}))).data;if(null===(e=a.errors)||void 0===e?void 0:e.length)throw Error(a.errors.join(", "));x(a.data||[])}catch(e){c({title:"Error",message:"Failed to load sites: "+e.message,variant:"error",onClose:()=>null==t?void 0:t()})}finally{d(!1)}},[o,c,t]);return(0,s.useEffect)(()=>{a&&!u.length&&m()},[u,a,m]),{loading:i,sites:u,loadSites:m}}}},function(e){e.O(0,[4868,1086,7468,6044,8472,193,231,638,2254,4264,8872,7202,8064,4380,3920,6323,7478,7023,1744],function(){return e(e.s=53473)}),_N_E=e.O()}]);