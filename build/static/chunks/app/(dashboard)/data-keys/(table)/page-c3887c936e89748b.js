(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1967],{76052:function(e,t,a){Promise.resolve().then(a.bind(a,6047)),Promise.resolve().then(a.bind(a,25704))},6047:function(e,t,a){"use strict";a.d(t,{DataKeysTable:function(){return F}});var s=a(57437),r=a(23920),n=a(94638),l=a(17647),i=a(37440),d=a(83146),o=a(39661),c=a(92513),u=a(87138),x=a(50495),f=a(64344),h=a(46294);function m(){let{sort:e,filter:t,onSort:a,setFilter:n}=(0,r.M)();return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"p-4 flex flex-col gap-y-4",children:(0,s.jsxs)("div",{className:"flex flex-wrap items-center",children:[(0,s.jsx)("div",{className:"text-2xl",children:"Data keys"}),(0,s.jsxs)("div",{className:"flex-1 flex flex-wrap items-center justify-end gap-x-4",children:[(0,s.jsx)("div",{children:(0,s.jsxs)(h.Ph,{value:e,onValueChange:e=>a(e),children:[(0,s.jsx)(h.i4,{children:(0,s.jsx)(h.ki,{placeholder:"Sort"})}),(0,s.jsx)(h.Bw,{children:d.F4.map(e=>(0,s.jsx)(h.Ql,{value:e.value,children:(0,s.jsxs)("div",{className:"flex items-center gap-x-2 w-[120px]",children:[(0,s.jsx)(e.Icon,{className:"size-4"}),(0,s.jsx)("span",{children:e.label})]})},e.value))})]})}),(0,s.jsx)("div",{children:(0,s.jsxs)(h.Ph,{value:t,onValueChange:e=>n("all"===e?"":e),children:[(0,s.jsx)(h.i4,{children:(0,s.jsx)(h.ki,{placeholder:"All keys"})}),(0,s.jsxs)(h.Bw,{children:[(0,s.jsx)(h.Ql,{value:"all",children:"All keys"}),(0,s.jsx)(h.U$,{}),(0,s.jsxs)(h.DI,{children:[(0,s.jsx)(h.n5,{children:"Status"}),d.UQ.map(e=>(0,s.jsx)(h.Ql,{value:e.value,children:e.label},e.value))]}),(0,s.jsx)(h.U$,{}),(0,s.jsxs)(h.DI,{children:[(0,s.jsx)(h.n5,{children:"Types"}),d.y0.map(e=>(0,s.jsx)(h.Ql,{value:e.value,children:e.label},e.value))]})]})]})}),(0,s.jsx)(x.z,{asChild:!0,variant:"ghost",className:"w-auto h-auto",children:(0,s.jsxs)(u.default,{href:"/data-keys/new",children:[(0,s.jsx)(c.Z,{className:"size-4 mr-2"}),"Add"]})})]})]})}),(0,s.jsx)(f.Z,{})]})}var p=a(2265),j=a(45188),y=a(75733),g=a(6649),v=a(90399),N=a(46910),w=a(76230),b=a(12832),k=a(71239);function C(e){let{rowIndex:t,disabled:a,setCurrentDataKeyUuid:n}=e,[l,d]=(0,p.useTransition)(),{dataKeys:c,deleteDataKeys:x}=(0,r.M)(),{confirm:f}=(0,w.t)(),h=c[t],m={isDraft:null==h?void 0:h.isDraft,userId:null==h?void 0:h.draftCreatedByUserId,dataType:"data key"},C=(0,k.v)(m);return(a=a||C,h)?(0,s.jsxs)("div",{className:"flex gap-x-2",children:[l&&(0,s.jsx)(o.a,{overlay:!0}),(0,s.jsx)(b.O,{...m}),(0,s.jsxs)(N.h_,{children:[(0,s.jsx)(N.$F,{children:(0,s.jsx)(j.Z,{className:"h-4 w-4"})}),(0,s.jsxs)(N.AW,{children:[(0,s.jsx)(N.Xi,{asChild:!0,onClick:()=>setTimeout(()=>d(()=>{}),0),children:(0,s.jsx)(u.default,{href:"/data-keys/edit/".concat(h.uuid),children:a?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(y.Z,{className:"h-4 w-4 mr-2"})," View"]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(g.Z,{className:"h-4 w-4 mr-2"})," Edit"]})})}),(0,s.jsxs)(N.Xi,{className:(0,i.cn)("text-destructive",a&&"hidden"),onClick:()=>setTimeout(()=>{f(()=>x([h.uuid]),{title:"Delete data key",message:"Are you sure?"})},0),children:[(0,s.jsx)(v.Z,{className:"h-4 w-4 mr-2"})," Delete"]})]})]})]}):null}var Z=a(17501),D=a(58184),z=a(39343),I=a(53853),E=a(67135),_=a(86466),R=a(90837);function S(e){var t;let{uuids:a}=e,[n,l]=(0,p.useState)(!1),{dataKeys:d,exporting:c,exportDataKeys:u,extractDataKeys:f}=(0,r.M)(),{sites:m,loading:j,loadSites:y}=(0,I.k)({loadOnMount:!1,onLoadSitesError:()=>l(!1)}),{formState:{errors:g},reset:v,watch:N,setValue:w,handleSubmit:b,setError:k}=(0,z.cI)({defaultValues:{siteId:"",overwriteExisting:!1}}),C=N("siteId"),Z=N("overwriteExisting"),S=c||j,V=!!C&&!S,F=b(async e=>{if(e.siteId){let t=f(a,{withNested:!0}).map(e=>e.uuid);await u({...e,uuids:t}),l(!1)}else k("siteId",{message:"Site is required"})});return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(R.Vq,{open:n,onOpenChange:e=>{v(),e&&y(),l(e)},children:[(0,s.jsx)(R.hg,{asChild:!0,children:(0,s.jsxs)(x.z,{className:"h-auto w-auto",children:[(0,s.jsx)(D.Z,{className:"h-4 w-4 mr-1"}),(0,s.jsx)("span",{children:a.length>1?"Export ".concat(a.length):"Export"})]})}),(0,s.jsxs)(R.cZ,{children:[(0,s.jsxs)(R.fK,{children:[(0,s.jsx)(R.$N,{children:"Export"}),(0,s.jsx)(R.Be,{className:"hidden",children:""})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-y-5",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(E._,{htmlFor:"siteId",children:"Site *"}),(0,s.jsxs)(h.Ph,{name:"siteId",onValueChange:e=>w("siteId",e,{shouldDirty:!0}),children:[(0,s.jsx)(h.i4,{children:(0,s.jsx)(h.ki,{placeholder:"Select site"})}),(0,s.jsx)(h.Bw,{children:(0,s.jsxs)(h.DI,{children:[(0,s.jsx)(h.n5,{children:"Sites"}),m.map(e=>{let{siteId:t,name:a}=e;return(0,s.jsx)(h.Ql,{value:t,children:a},t)})]})})]}),!!(null===(t=g.siteId)||void 0===t?void 0:t.message)&&(0,s.jsx)("div",{className:"text-xs text-danger mt-1",children:g.siteId.message})]}),(0,s.jsxs)("div",{className:(0,i.cn)("flex gap-x-2"),children:[(0,s.jsx)(_.X,{name:"overwriteExisting",id:"overwriteExisting",checked:Z,onCheckedChange:()=>w("overwriteExisting",!Z,{shouldDirty:!0})}),(0,s.jsx)(E._,{secondary:!0,htmlFor:"overwriteExisting",children:"Overwrite existing"})]}),S&&(0,s.jsx)(o.a,{overlay:!0})]}),(0,s.jsxs)(R.cN,{children:[(0,s.jsx)(R.GG,{asChild:!0,children:(0,s.jsx)(x.z,{variant:"ghost",children:"Cancel"})}),(0,s.jsxs)(x.z,{onClick:F,disabled:!V,children:[(0,s.jsx)(D.Z,{className:"h-4 w-4 mr-1"}),"Export"]})]})]})]})})}function V(e){let{disabled:t}=e,{confirm:a}=(0,w.t)(),{selected:n,setSelected:l,deleteDataKeys:i}=(0,r.M)();return t||!n.length?null:(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(Z.h,{children:[(0,s.jsx)(x.z,{variant:"ghost",onClick:()=>l([]),children:"Cancel"}),(0,s.jsx)(S,{uuids:n.map(e=>e.uuid)}),(0,s.jsxs)(x.z,{variant:"destructive",onClick:()=>setTimeout(()=>{a(()=>i(n.map(e=>e.uuid)),{title:"Delete data keys",message:"Are you sure?"})},0),children:[(0,s.jsx)(v.Z,{className:"w-4 h-4 mr-2"}),"Delete",n.length>1?" ".concat(n.length," keys"):""]})]})})}function F(e){let{disabled:t}=e,{viewOnly:a}=(0,l.b)();t=t||a;let{dataKeys:c,selected:u,filter:x,deleting:f,loadingDataKeys:h,setCurrentDataKeyUuid:p,setSelected:j}=(0,r.M)(),y={selectable:!t,selectedIndexes:u.map(e=>e.index),filter:e=>{let t=c[e];return!x||(x===d.UQ[0].value?!(null==t?void 0:t.isDraft):x===d.UQ[1].value?!!(null==t?void 0:t.isDraft):(console.log(null==t?void 0:t.dataType,x),(null==t?void 0:t.dataType)===x))},onSelect:e=>j(e.map(e=>{var t;return{index:e,uuid:null===(t=c[e])||void 0===t?void 0:t.uuid}}).filter(e=>e.uuid)),getRowOptions(e){let{rowIndex:t}=e,s=c[t];return s?{className:(0,i.cn)(!a&&s.isDraft&&"bg-danger/20 hover:bg-danger/30")}:{}},search:{inputPlaceholder:"Search data keys"},noDataMessage:(0,s.jsx)("div",{className:"mt-4 flex flex-col items-center justify-center gap-y-2",children:(0,s.jsx)("div",{children:"No data keys saved."})}),columns:[{name:"Key"},{name:"Label"},{name:"Ref ID",cellClassName:"hidden"},{name:"Data type"},{name:"",align:"right",cellClassName:(0,i.cn)("w-10"),cellRenderer(e){let{rowIndex:a}=e;return(0,s.jsx)(C,{rowIndex:a,disabled:t,setCurrentDataKeyUuid:p})}}],data:c.map(e=>[e.name||"",e.label||"",e.refId||"",e.dataType||"",""])};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex flex-col gap-y-4",children:[(0,s.jsx)(m,{}),(0,s.jsx)(n.DataTable,{...y})]}),(0,s.jsx)(V,{disabled:t}),(f||h)&&(0,s.jsx)(o.a,{overlay:!0})]})}},90837:function(e,t,a){"use strict";a.d(t,{$N:function(){return p},Be:function(){return j},GG:function(){return u},Vq:function(){return d},cN:function(){return m},cZ:function(){return f},fK:function(){return h},hg:function(){return o}});var s=a(57437),r=a(2265),n=a(13304),l=a(74697),i=a(37440);let d=n.fC,o=n.xz,c=n.h_,u=n.x8,x=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.aV,{ref:t,className:(0,i.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...r})});x.displayName=n.aV.displayName;let f=r.forwardRef((e,t)=>{let{className:a,children:r,hideCloseButton:d,...o}=e;return(0,s.jsxs)(c,{children:[(0,s.jsx)(x,{}),(0,s.jsxs)(n.VY,{ref:t,className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...o,children:[r,!0!==d&&(0,s.jsxs)(n.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,s.jsx)(l.Z,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});f.displayName=n.VY.displayName;let h=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...a})};h.displayName="DialogHeader";let m=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,i.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};m.displayName="DialogFooter";let p=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.Dx,{ref:t,className:(0,i.cn)("text-lg font-semibold leading-none tracking-tight",a),...r})});p.displayName=n.Dx.displayName;let j=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.dk,{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",a),...r})});j.displayName=n.dk.displayName},46294:function(e,t,a){"use strict";a.d(t,{Bw:function(){return p},DI:function(){return u},Ph:function(){return c},Ql:function(){return y},U$:function(){return g},i4:function(){return f},ki:function(){return x},n5:function(){return j}});var s=a(57437),r=a(2265),n=a(48297),l=a(42421),i=a(14392),d=a(22468),o=a(37440);let c=n.fC,u=n.ZA,x=n.B4,f=r.forwardRef((e,t)=>{let{className:a,children:r,error:i,...d}=e;return(0,s.jsxs)(n.xz,{ref:t,className:(0,o.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm placeholder:text-muted-foreground focus:outline-none disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",i&&"border-danger",a),...d,children:[r,(0,s.jsx)(n.JO,{asChild:!0,children:(0,s.jsx)(l.Z,{className:"h-4 w-4 opacity-50"})})]})});f.displayName=n.xz.displayName;let h=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.u_,{ref:t,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",a),...r,children:(0,s.jsx)(i.Z,{className:"h-4 w-4"})})});h.displayName=n.u_.displayName;let m=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.$G,{ref:t,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",a),...r,children:(0,s.jsx)(l.Z,{className:"h-4 w-4"})})});m.displayName=n.$G.displayName;let p=r.forwardRef((e,t)=>{let{className:a,children:r,position:l="popper",...i}=e;return(0,s.jsx)(n.h_,{children:(0,s.jsxs)(n.VY,{ref:t,className:(0,o.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:l,...i,children:[(0,s.jsx)(h,{}),(0,s.jsx)(n.l_,{className:(0,o.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,s.jsx)(m,{})]})})});p.displayName=n.VY.displayName;let j=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.__,{ref:t,className:(0,o.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...r})});j.displayName=n.__.displayName;let y=r.forwardRef((e,t)=>{let{className:a,children:r,...l}=e;return(0,s.jsxs)(n.ck,{ref:t,className:(0,o.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...l,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(n.wU,{children:(0,s.jsx)(d.Z,{className:"h-4 w-4"})})}),(0,s.jsx)(n.eT,{children:r})]})});y.displayName=n.ck.displayName;let g=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.Z0,{ref:t,className:(0,o.cn)("-mx-1 my-1 h-px bg-muted",a),...r})});g.displayName=n.Z0.displayName},64344:function(e,t,a){"use strict";a.d(t,{Z:function(){return i}});var s=a(57437),r=a(2265),n=a(48484),l=a(37440);let i=r.forwardRef((e,t)=>{let{className:a,orientation:r="horizontal",decorative:i=!0,...d}=e;return(0,s.jsx)(n.f,{ref:t,decorative:i,orientation:r,className:(0,l.cn)("shrink-0 bg-border","horizontal"===r?"h-[1px] w-full":"h-full w-[1px]",a),...d})});i.displayName=n.f.displayName},53853:function(e,t,a){"use strict";a.d(t,{k:function(){return i}});var s=a(2265),r=a(38472),n=a(17647),l=a(53699);function i(e){let{loadOnMount:t=!0,onLoadSitesError:a}={...e},[i,d]=(0,s.useState)(!1),{alert:o}=(0,l.s)(),{getSites:c}=(0,n.b)(),[u,x]=(0,s.useState)([]),f=(0,s.useCallback)(async()=>{try{var e;d(!0);let t=(await r.Z.get("/api/sites?data="+JSON.stringify({types:["webeditor"]}))).data;if(null===(e=t.errors)||void 0===e?void 0:e.length)throw Error(t.errors.join(", "));x(t.data||[])}catch(e){o({title:"Error",message:"Failed to load sites: "+e.message,variant:"error",onClose:()=>null==a?void 0:a()})}finally{d(!1)}},[c,o,a]);return(0,s.useEffect)(()=>{t&&!u.length&&f()},[u,t,f]),{loading:i,sites:u,loadSites:f}}},75733:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.399.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,a(78030).Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},92513:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.399.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,a(78030).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},58184:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.399.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,a(78030).Z)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])},87138:function(e,t,a){"use strict";a.d(t,{default:function(){return r.a}});var s=a(231),r=a.n(s)},48484:function(e,t,a){"use strict";a.d(t,{f:function(){return o}});var s=a(2265),r=a(25171),n=a(57437),l="horizontal",i=["horizontal","vertical"],d=s.forwardRef((e,t)=>{let{decorative:a,orientation:s=l,...d}=e,o=i.includes(s)?s:l;return(0,n.jsx)(r.WV.div,{"data-orientation":o,...a?{role:"none"}:{"aria-orientation":"vertical"===o?o:void 0,role:"separator"},...d,ref:t})});d.displayName="Separator";var o=d}},function(e){e.O(0,[4868,1086,7468,6044,8472,193,231,638,2254,8872,2860,7202,3134,4638,3920,2481,7478,7023,1744],function(){return e(e.s=76052)}),_N_E=e.O()}]);