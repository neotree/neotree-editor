(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3638],{76923:function(e,s,t){Promise.resolve().then(t.bind(t,33283)),Promise.resolve().then(t.bind(t,25704))},33283:function(e,s,t){"use strict";t.d(s,{DrugsLibrary:function(){return k}});var r=t(57437),a=t(2265),n=t(87138),i=t(45188),l=t(6649),d=t(75733),c=t(6884),u=t(90399),o=t(37440),h=t(76230),g=t(39661),m=t(65120),x=t(46910),j=t(76942),f=t(50495),p=t(44371),y=t(17647),b=t(80929),N=t(42421);function v(e){let{addDrugLink:s,addFluidLink:t,disabled:a}=e;return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)(x.h_,{children:[(0,r.jsx)(x.$F,{asChild:!0,children:(0,r.jsxs)(f.z,{variant:"outline",disabled:!!a,children:[(0,r.jsx)("span",{children:"Add"}),(0,r.jsx)(N.Z,{className:"w-4 h-4 ml-2"})]})}),(0,r.jsxs)(x.AW,{children:[(0,r.jsx)(x.Xi,{asChild:!0,children:(0,r.jsx)(n.default,{href:s,children:"New drug"})}),(0,r.jsx)(x.Xi,{asChild:!0,children:(0,r.jsx)(n.default,{href:t,children:"New fluid"})})]})]})})}var w=t(38472);function k(e){let{locked:s}=e,{confirm:t}=(0,h.t)(),{viewOnly:N}=(0,y.b)(),{drugs:k,loading:C,addLink:F,selectedItemId:Z,editLink:_,saveDrugs:D,deleteDrugs:L,copyDrugs:I}=(0,p.a)();(0,a.useEffect)(()=>{(async()=>{try{s||await w.Z.post("/api/locks?data="+JSON.stringify({script:null,lockType:"drug_library"}))}catch(e){alert({title:"",message:e.message})}})()},[alert,s]);let[O,T]=(0,a.useState)(!!s),A=(0,a.useCallback)(e=>{T(s=>O!==e?e:s)},[]),E=(0,a.useMemo)(()=>N||!!O,[N,O]);return(0,r.jsxs)(r.Fragment,{children:[C&&(0,r.jsx)(g.a,{overlay:!0}),(0,r.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,r.jsx)(m.O,{scriptId:"",lockType:"drug_library",doneLoading:!0,onStatusChange:e=>A(e)},"drug-lib"),(0,r.jsx)(b.A,{disabled:E,item:k.filter(e=>e.itemId===Z)[0],onChange:D})]}),(0,r.jsx)(j.DataTable,{title:"Drugs & Fluids Library",headerActions:(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(v,{addDrugLink:F("drug"),addFluidLink:F("fluid"),disabled:E})}),getRowOptions:e=>{let{rowIndex:s}=e,t=k[s];return t?{className:(0,o.cn)(t.isDraft&&"bg-danger/20 hover:bg-danger/30")}:{}},columns:[{name:"Drug / Fluid"},{name:"Type",tdClassName:"w-[80px]"},{name:"Key"},{name:"Dosage text"},{name:"",align:"right",cellRenderer(e){let{value:s}=e,a=k.filter(e=>e.itemId===s)[0];return a?(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)(x.h_,{children:[(0,r.jsx)(x.$F,{asChild:!0,children:(0,r.jsx)(f.z,{variant:"ghost",size:"icon",className:"p-0 h-auto w-auto transition-colors rounded-full hover:text-primary hover:bg-transparent",children:(0,r.jsx)(i.Z,{className:"h-4 w-4"})})}),(0,r.jsxs)(x.AW,{children:[(0,r.jsx)(x.Xi,{asChild:!0,children:(0,r.jsx)(n.default,{href:_("".concat(s)),children:(0,r.jsx)(r.Fragment,{children:E?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d.Z,{className:"mr-2 h-4 w-4"})," View"]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.Z,{className:"mr-2 h-4 w-4"})," Edit"]})})})}),!E&&(0,r.jsx)(x.Xi,{onClick:()=>t(()=>I([a.itemId]),{title:"Copy drug",message:"Are you sure you want to copy drug?<br /> <b>".concat(a.drug,"</b>"),positiveLabel:"Yes, copy",negativeLabel:"Cancel"}),children:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c.Z,{className:"mr-2 h-4 w-4"})," Copy"]})}),!E&&(0,r.jsxs)(x.Xi,{onClick:()=>t(()=>L([a.itemId]),{title:"Delete drug",message:"Are you sure you want to delete drug?",positiveLabel:"Yes, delete",negativeLabel:"Cancel",danger:!0}),className:"text-danger focus:bg-danger focus:text-danger-foreground",children:[(0,r.jsx)(u.Z,{className:"mr-2 h-4 w-4"}),(0,r.jsx)("span",{children:"Delete"})]})]})]})}):null}}],data:k.map(e=>[e.drug||"",e.type||"",e.key||"",e.dosageText||"",e.itemId])})]})}},65120:function(e,s,t){"use strict";t.d(s,{O:function(){return d}});var r=t(57437),a=t(74453),n=t(63124),i=t(2265),l=t(38472);function d(e){let{scriptId:s,lockType:t,doneLoading:d,onStatusChange:c}=e,[u,o]=(0,i.useState)(void 0);return((0,i.useEffect)(()=>{let e=!0;return async function(){try{("script"===t&&d||"script"!==t)&&await l.Z.delete("/api/locks?data="+JSON.stringify({lockType:t}));let r=(await l.Z.get("/api/locks?data="+JSON.stringify({script:s||null,lockType:t}))).data;e&&(o(r),setTimeout(()=>null==c?void 0:c(r),0))}catch(e){console.error("Error fetching lock status:",e)}}(),()=>{e=!1}},[s]),void 0===u)?null:(0,r.jsx)("div",{className:"p-1 rounded ".concat(u?"bg-red-100":"bg-green-100"),children:u?(0,r.jsx)(a.Z,{className:"h-4 w-4 text-red-900"}):(0,r.jsx)(n.Z,{className:"h-4 w-4 text-green-900"})})}}},function(e){e.O(0,[4868,1086,7468,6044,9343,193,231,8472,638,1322,2860,3250,7654,6942,1863,929,7478,7023,1744],function(){return e(e.s=76923)}),_N_E=e.O()}]);