(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3638],{44119:function(e,t,s){Promise.resolve().then(s.bind(s,26251)),Promise.resolve().then(s.bind(s,25704))},26251:function(e,t,s){"use strict";s.d(t,{DrugsLibrary:function(){return O}});var r=s(57437),a=s(2265),i=s(37440),n=s(39661),l=s(44380),d=s(44371),o=s(17647),c=s(17501),u=s(80929),x=s(42421),h=s(87138),m=s(50495),f=s(46910);function g(e){let{addDrugLink:t,addFluidLink:s}=e;return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)(f.h_,{children:[(0,r.jsx)(f.$F,{asChild:!0,children:(0,r.jsxs)(m.z,{variant:"outline",children:[(0,r.jsx)("span",{children:"Add"}),(0,r.jsx)(x.Z,{className:"w-4 h-4 ml-2"})]})}),(0,r.jsxs)(f.AW,{children:[(0,r.jsx)(f.Xi,{asChild:!0,children:(0,r.jsx)(h.default,{href:t,children:"New drug"})}),(0,r.jsx)(f.Xi,{asChild:!0,children:(0,r.jsx)(h.default,{href:s,children:"New fluid"})})]})]})})}var j=s(58184),p=s(38472),v=s(39343),b=s(53853),y=s(67135),w=s(86466),N=s(53699),C=s(90837),k=s(46294);function I(e){var t;let{uuids:s}=e,[l,d]=(0,a.useState)(!1),[o,c]=(0,a.useState)(!1),{alert:u}=(0,N.s)(),{sites:x,loading:h,loadSites:f}=(0,b.k)({loadOnMount:!1,onLoadSitesError:()=>d(!1)}),{formState:{errors:g},reset:I,watch:E,setValue:F,register:D,handleSubmit:S,setError:Z}=(0,v.cI)({defaultValues:{siteId:"",overwriteExisting:!1}}),_=E("siteId"),L=E("overwriteExisting"),z=o||h,V=!!_&&!z,O=S(async e=>{try{var t;if(e.siteId||Z("siteId",{message:"Site is required"}),!V)return;c(!0);let r=(await p.Z.post("/api/drugs-library/export",{...e,uuids:s})).data;if(null===(t=r.errors)||void 0===t?void 0:t.length)throw Error(r.errors.join(", "));u({variant:"success",title:"Success",message:"Data exported successfully!",onClose:()=>d(!1)})}catch(e){u({variant:"error",title:"Error",message:"Failed to export: "+e.message})}finally{c(!1)}});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(C.Vq,{open:l,onOpenChange:e=>{I(),e&&f(),d(e)},children:[(0,r.jsx)(C.hg,{asChild:!0,children:(0,r.jsxs)(m.z,{className:"h-auto w-auto",children:[(0,r.jsx)(j.Z,{className:"h-4 w-4 mr-1"}),(0,r.jsx)("span",{children:s.length>1?"Export ".concat(s.length):"Export"})]})}),(0,r.jsxs)(C.cZ,{children:[(0,r.jsxs)(C.fK,{children:[(0,r.jsx)(C.$N,{children:"Export"}),(0,r.jsx)(C.Be,{className:"hidden",children:""})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-y-5",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(y._,{htmlFor:"siteId",children:"Site *"}),(0,r.jsxs)(k.Ph,{name:"siteId",onValueChange:e=>F("siteId",e,{shouldDirty:!0}),children:[(0,r.jsx)(k.i4,{children:(0,r.jsx)(k.ki,{placeholder:"Select site"})}),(0,r.jsx)(k.Bw,{children:(0,r.jsxs)(k.DI,{children:[(0,r.jsx)(k.n5,{children:"Sites"}),x.map(e=>{let{siteId:t,name:s}=e;return(0,r.jsx)(k.Ql,{value:t,children:s},t)})]})})]}),!!(null===(t=g.siteId)||void 0===t?void 0:t.message)&&(0,r.jsx)("div",{className:"text-xs text-danger mt-1",children:g.siteId.message})]}),(0,r.jsxs)("div",{className:(0,i.cn)("flex gap-x-2"),children:[(0,r.jsx)(w.X,{name:"overwriteExisting",id:"overwriteExisting",checked:L,onCheckedChange:()=>F("overwriteExisting",!L,{shouldDirty:!0})}),(0,r.jsx)(y._,{secondary:!0,htmlFor:"overwriteExisting",children:"Overwrite existing"})]})]}),(0,r.jsxs)(C.cN,{children:[(0,r.jsx)(C.GG,{asChild:!0,children:(0,r.jsx)(m.z,{variant:"ghost",children:"Cancel"})}),(0,r.jsxs)(m.z,{onClick:O,disabled:!V,children:[(0,r.jsx)(j.Z,{className:"h-4 w-4 mr-1"}),"Export"]})]})]})]}),z&&(0,r.jsx)(n.a,{overlay:!0})]})}var E=s(45188),F=s(6649),D=s(75733),S=s(6884),Z=s(90399),_=s(76230),L=s(12832),z=s(71239);function V(e){let{item:t,disabled:s,copyDrugs:a,deleteDrugs:i,editLink:n}=e,{confirm:l}=(0,_.t)(),d={isDraft:!!t.isDraft,userId:t.draftCreatedByUserId,dataType:t.type},o=(0,z.v)(d);return s=s||o,(0,r.jsxs)("div",{className:"flex gap-x-2",children:[(0,r.jsx)(L.O,{...d}),(0,r.jsxs)(f.h_,{children:[(0,r.jsx)(f.$F,{asChild:!0,children:(0,r.jsx)(m.z,{variant:"ghost",size:"icon",className:"p-0 h-auto w-auto transition-colors rounded-full hover:text-primary hover:bg-transparent",children:(0,r.jsx)(E.Z,{className:"h-4 w-4"})})}),(0,r.jsxs)(f.AW,{children:[(0,r.jsx)(f.Xi,{asChild:!0,children:(0,r.jsx)(h.default,{href:n("".concat(t.itemId)),children:(0,r.jsx)(r.Fragment,{children:s?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(D.Z,{className:"mr-2 h-4 w-4"})," View"]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(F.Z,{className:"mr-2 h-4 w-4"})," Edit"]})})})}),!s&&(0,r.jsx)(f.Xi,{onClick:()=>setTimeout(()=>{l(()=>a([t.itemId]),{title:"Copy drug",message:"Are you sure you want to copy drug?<br /> <b>".concat(t.drug,"</b>"),positiveLabel:"Yes, copy",negativeLabel:"Cancel"})},0),children:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(S.Z,{className:"mr-2 h-4 w-4"})," Copy"]})}),!s&&(0,r.jsxs)(f.Xi,{onClick:()=>setTimeout(()=>{l(()=>i([t.itemId]),{title:"Delete drug",message:"Are you sure you want to delete drug?",positiveLabel:"Yes, delete",negativeLabel:"Cancel",danger:!0})},0),className:"text-danger focus:bg-danger focus:text-danger-foreground",children:[(0,r.jsx)(Z.Z,{className:"mr-2 h-4 w-4"}),(0,r.jsx)("span",{children:"Delete"})]})]})]})]})}function O(e){let{}=e,{viewOnly:t}=(0,o.b)(),[s,x]=(0,a.useState)([]),{drugs:h,loading:m,addLink:f,selectedItemId:j,editLink:p,saveDrugs:v,deleteDrugs:b,copyDrugs:y}=(0,d.a)(),w=(0,a.useMemo)(()=>t,[t]);return(0,r.jsxs)(r.Fragment,{children:[m&&(0,r.jsx)(n.a,{overlay:!0}),(0,r.jsx)(u.A,{disabled:w,item:h.filter(e=>e.itemId===j)[0],onChange:v}),!!s.length&&(0,r.jsx)(c.h,{children:(0,r.jsx)(I,{uuids:h.filter((e,t)=>s.includes(t)).map(e=>e.itemId)})}),(0,r.jsx)(l.DataTable,{onSelect:x,selectable:!w,title:"Drugs & Fluids Library",search:{inputPlaceholder:"Search"},headerActions:(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(g,{addDrugLink:f("drug"),addFluidLink:f("fluid")})}),getRowOptions:e=>{let{rowIndex:t}=e,s=h[t];return s?{className:(0,i.cn)(s.isDraft&&"bg-danger/20 hover:bg-danger/30")}:{}},columns:[{name:"Drug / Fluid"},{name:"Type",tdClassName:"w-[80px]"},{name:"Key"},{name:"Dosage text"},{name:"",align:"right",cellRenderer(e){let{value:t}=e,s=h.filter(e=>e.itemId===t)[0];return s?(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(V,{item:s,disabled:w,copyDrugs:y,deleteDrugs:b,editLink:p})}):null}}],data:h.map(e=>[e.drug||"",e.type||"",e.key||"",e.dosageText||"",e.itemId])})]})}},95317:function(e,t,s){"use strict";s.d(t,{Ei:function(){return v},FF:function(){return j},Tu:function(){return g},aM:function(){return c},bC:function(){return p},sw:function(){return u},ue:function(){return f},yo:function(){return o}});var r=s(57437),a=s(2265),i=s(13304),n=s(13027),l=s(74697),d=s(37440);let o=i.fC,c=i.xz,u=i.x8,x=i.h_,h=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(i.aV,{className:(0,d.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...a,ref:t})});h.displayName=i.aV.displayName;let m=(0,n.j)("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),f=a.forwardRef((e,t)=>{let{side:s="right",className:a,children:n,hideCloseButton:o,...c}=e;return(0,r.jsxs)(x,{children:[(0,r.jsx)(h,{}),(0,r.jsxs)(i.VY,{ref:t,className:(0,d.cn)(m({side:s}),a),...c,children:[n,!0!==o&&(0,r.jsxs)(i.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[(0,r.jsx)(l.Z,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});f.displayName=i.VY.displayName;let g=e=>{let{className:t,...s}=e;return(0,r.jsx)("div",{className:(0,d.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...s})};g.displayName="SheetHeader";let j=e=>{let{className:t,...s}=e;return(0,r.jsx)("div",{className:(0,d.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s})};j.displayName="SheetFooter";let p=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(i.Dx,{ref:t,className:(0,d.cn)("text-lg font-semibold text-foreground",s),...a})});p.displayName=i.Dx.displayName;let v=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(i.dk,{ref:t,className:(0,d.cn)("text-sm text-muted-foreground",s),...a})});v.displayName=i.dk.displayName},93146:function(e,t,s){"use strict";s.d(t,{g:function(){return n}});var r=s(57437),a=s(2265),i=s(37440);let n=a.forwardRef((e,t)=>{let{className:s,noRing:a,...n}=e;return(0,r.jsx)("textarea",{className:(0,i.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a&&"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",s),ref:t,...n})});n.displayName="Textarea"},53853:function(e,t,s){"use strict";s.d(t,{k:function(){return l}});var r=s(2265),a=s(38472),i=s(17647),n=s(53699);function l(e){let{loadOnMount:t=!0,onLoadSitesError:s}={...e},[l,d]=(0,r.useState)(!1),{alert:o}=(0,n.s)(),{getSites:c}=(0,i.b)(),[u,x]=(0,r.useState)([]),h=(0,r.useCallback)(async()=>{try{var e;d(!0);let t=(await a.Z.get("/api/sites?data="+JSON.stringify({types:["webeditor"]}))).data;if(null===(e=t.errors)||void 0===e?void 0:e.length)throw Error(t.errors.join(", "));x(t.data||[])}catch(e){o({title:"Error",message:"Failed to load sites: "+e.message,variant:"error",onClose:()=>null==s?void 0:s()})}finally{d(!1)}},[c,o,s]);return(0,r.useEffect)(()=>{t&&!u.length&&h()},[u,t,h]),{loading:l,sites:u,loadSites:h}}}},function(e){e.O(0,[4868,1086,7468,6044,8472,193,231,638,2254,8872,2860,7202,3134,4913,4380,3920,2481,2670,929,7478,7023,1744],function(){return e(e.s=44119)}),_N_E=e.O()}]);