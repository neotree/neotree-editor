(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3638],{44119:function(e,r,t){Promise.resolve().then(t.bind(t,67464)),Promise.resolve().then(t.bind(t,25704))},67464:function(e,r,t){"use strict";t.d(r,{DrugsLibrary:function(){return V}});var s=t(57437),n=t(2265),i=t(87138),a=t(45188),l=t(6649),d=t(75733),c=t(6884),o=t(90399),u=t(37440),h=t(76230),x=t(39661),g=t(46910),m=t(76942),f=t(50495),j=t(44371),y=t(17647),p=t(17501),v=t(80929),w=t(42421);function k(e){let{addDrugLink:r,addFluidLink:t}=e;return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(g.h_,{children:[(0,s.jsx)(g.$F,{asChild:!0,children:(0,s.jsxs)(f.z,{variant:"outline",children:[(0,s.jsx)("span",{children:"Add"}),(0,s.jsx)(w.Z,{className:"w-4 h-4 ml-2"})]})}),(0,s.jsxs)(g.AW,{children:[(0,s.jsx)(g.Xi,{asChild:!0,children:(0,s.jsx)(i.default,{href:r,children:"New drug"})}),(0,s.jsx)(g.Xi,{asChild:!0,children:(0,s.jsx)(i.default,{href:t,children:"New fluid"})})]})]})})}var b=t(58184),C=t(38472),N=t(39343),Z=t(53853),I=t(67135),E=t(86466),D=t(53699),F=t(90837),S=t(46294);function U(e){var r;let{uuids:t}=e,[i,a]=(0,n.useState)(!1),[l,d]=(0,n.useState)(!1),{alert:c}=(0,D.s)(),{sites:o,loading:h,loadSites:g}=(0,Z.k)({loadOnMount:!1,onLoadSitesError:()=>a(!1)}),{formState:{errors:m},reset:j,watch:y,setValue:p,register:v,handleSubmit:w,setError:k}=(0,N.cI)({defaultValues:{siteId:"",overwriteExisting:!1}}),U=y("siteId"),V=y("overwriteExisting"),z=l||h,L=!!U&&!z,M=w(async e=>{try{var r;if(e.siteId||k("siteId",{message:"Site is required"}),!L)return;d(!0);let s=(await C.Z.post("/api/drugs-library/export",{...e,uuids:t})).data;if(null===(r=s.errors)||void 0===r?void 0:r.length)throw Error(s.errors.join(", "));c({variant:"success",title:"Success",message:"Data exported successfully!",onClose:()=>a(!1)})}catch(e){c({variant:"error",title:"Error",message:"Failed to export: "+e.message})}finally{d(!1)}});return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(F.Vq,{open:i,onOpenChange:e=>{j(),e&&g(),a(e)},children:[(0,s.jsx)(F.hg,{asChild:!0,children:(0,s.jsxs)(f.z,{className:"h-auto w-auto",children:[(0,s.jsx)(b.Z,{className:"h-4 w-4 mr-1"}),(0,s.jsx)("span",{children:t.length>1?"Export ".concat(t.length):"Export"})]})}),(0,s.jsxs)(F.cZ,{children:[(0,s.jsxs)(F.fK,{children:[(0,s.jsx)(F.$N,{children:"Export"}),(0,s.jsx)(F.Be,{className:"hidden",children:""})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-y-5",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(I._,{htmlFor:"siteId",children:"Site *"}),(0,s.jsxs)(S.Ph,{name:"siteId",onValueChange:e=>p("siteId",e,{shouldDirty:!0}),children:[(0,s.jsx)(S.i4,{children:(0,s.jsx)(S.ki,{placeholder:"Select site"})}),(0,s.jsx)(S.Bw,{children:(0,s.jsxs)(S.DI,{children:[(0,s.jsx)(S.n5,{children:"Sites"}),o.map(e=>{let{siteId:r,name:t}=e;return(0,s.jsx)(S.Ql,{value:r,children:t},r)})]})})]}),!!(null===(r=m.siteId)||void 0===r?void 0:r.message)&&(0,s.jsx)("div",{className:"text-xs text-danger mt-1",children:m.siteId.message})]}),(0,s.jsxs)("div",{className:(0,u.cn)("flex gap-x-2"),children:[(0,s.jsx)(E.X,{name:"overwriteExisting",id:"overwriteExisting",checked:V,onCheckedChange:()=>p("overwriteExisting",!V,{shouldDirty:!0})}),(0,s.jsx)(I._,{secondary:!0,htmlFor:"overwriteExisting",children:"Overwrite existing"})]})]}),(0,s.jsxs)(F.cN,{children:[(0,s.jsx)(F.GG,{asChild:!0,children:(0,s.jsx)(f.z,{variant:"ghost",children:"Cancel"})}),(0,s.jsxs)(f.z,{onClick:M,disabled:!L,children:[(0,s.jsx)(b.Z,{className:"h-4 w-4 mr-1"}),"Export"]})]})]})]}),z&&(0,s.jsx)(x.a,{overlay:!0})]})}function V(e){let{}=e,{confirm:r}=(0,h.t)(),{viewOnly:t}=(0,y.b)(),[w,b]=(0,n.useState)([]),{drugs:C,loading:N,addLink:Z,selectedItemId:I,editLink:E,saveDrugs:D,deleteDrugs:F,copyDrugs:S}=(0,j.a)(),V=(0,n.useMemo)(()=>t,[t]);return(0,s.jsxs)(s.Fragment,{children:[N&&(0,s.jsx)(x.a,{overlay:!0}),(0,s.jsx)(v.A,{disabled:V,item:C.filter(e=>e.itemId===I)[0],onChange:D}),!!w.length&&(0,s.jsx)(p.h,{children:(0,s.jsx)(U,{uuids:C.filter((e,r)=>w.includes(r)).map(e=>e.itemId)})}),(0,s.jsx)(m.DataTable,{onSelect:b,selectable:!V,title:"Drugs & Fluids Library",headerActions:(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(k,{addDrugLink:Z("drug"),addFluidLink:Z("fluid")})}),getRowOptions:e=>{let{rowIndex:r}=e,t=C[r];return t?{className:(0,u.cn)(t.isDraft&&"bg-danger/20 hover:bg-danger/30")}:{}},columns:[{name:"Drug / Fluid"},{name:"Type",tdClassName:"w-[80px]"},{name:"Key"},{name:"Dosage text"},{name:"",align:"right",cellRenderer(e){let{value:t}=e,n=C.filter(e=>e.itemId===t)[0];return n?(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(g.h_,{children:[(0,s.jsx)(g.$F,{asChild:!0,children:(0,s.jsx)(f.z,{variant:"ghost",size:"icon",className:"p-0 h-auto w-auto transition-colors rounded-full hover:text-primary hover:bg-transparent",children:(0,s.jsx)(a.Z,{className:"h-4 w-4"})})}),(0,s.jsxs)(g.AW,{children:[(0,s.jsx)(g.Xi,{asChild:!0,children:(0,s.jsx)(i.default,{href:E("".concat(t)),children:(0,s.jsx)(s.Fragment,{children:V?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d.Z,{className:"mr-2 h-4 w-4"})," View"]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.Z,{className:"mr-2 h-4 w-4"})," Edit"]})})})}),!V&&(0,s.jsx)(g.Xi,{onClick:()=>setTimeout(()=>{r(()=>S([n.itemId]),{title:"Copy drug",message:"Are you sure you want to copy drug?<br /> <b>".concat(n.drug,"</b>"),positiveLabel:"Yes, copy",negativeLabel:"Cancel"})},0),children:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c.Z,{className:"mr-2 h-4 w-4"})," Copy"]})}),!V&&(0,s.jsxs)(g.Xi,{onClick:()=>setTimeout(()=>{r(()=>F([n.itemId]),{title:"Delete drug",message:"Are you sure you want to delete drug?",positiveLabel:"Yes, delete",negativeLabel:"Cancel",danger:!0})},0),className:"text-danger focus:bg-danger focus:text-danger-foreground",children:[(0,s.jsx)(o.Z,{className:"mr-2 h-4 w-4"}),(0,s.jsx)("span",{children:"Delete"})]})]})]})}):null}}],data:C.map(e=>[e.drug||"",e.type||"",e.key||"",e.dosageText||"",e.itemId])})]})}},53853:function(e,r,t){"use strict";t.d(r,{k:function(){return l}});var s=t(2265),n=t(38472),i=t(17647),a=t(53699);function l(e){let{loadOnMount:r=!0,onLoadSitesError:t}={...e},[l,d]=(0,s.useState)(!1),{alert:c}=(0,a.s)(),{getSites:o}=(0,i.b)(),[u,h]=(0,s.useState)([]),x=(0,s.useCallback)(async()=>{try{var e;d(!0);let r=(await n.Z.get("/api/sites?data="+JSON.stringify({types:["webeditor"]}))).data;if(null===(e=r.errors)||void 0===e?void 0:e.length)throw Error(r.errors.join(", "));h(r.data||[])}catch(e){c({title:"Error",message:"Failed to load sites: "+e.message,variant:"error",onClose:()=>null==t?void 0:t()})}finally{d(!1)}},[o,c,t]);return(0,s.useEffect)(()=>{r&&!u.length&&x()},[u,r,x]),{loading:l,sites:u,loadSites:x}}},6884:function(e,r,t){"use strict";t.d(r,{Z:function(){return s}});/**
 * @license lucide-react v0.399.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,t(78030).Z)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]])},45188:function(e,r,t){"use strict";t.d(r,{Z:function(){return s}});/**
 * @license lucide-react v0.399.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,t(78030).Z)("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]])},75733:function(e,r,t){"use strict";t.d(r,{Z:function(){return s}});/**
 * @license lucide-react v0.399.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,t(78030).Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},6649:function(e,r,t){"use strict";t.d(r,{Z:function(){return s}});/**
 * @license lucide-react v0.399.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,t(78030).Z)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},90399:function(e,r,t){"use strict";t.d(r,{Z:function(){return s}});/**
 * @license lucide-react v0.399.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,t(78030).Z)("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]])},58184:function(e,r,t){"use strict";t.d(r,{Z:function(){return s}});/**
 * @license lucide-react v0.399.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,t(78030).Z)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])},87138:function(e,r,t){"use strict";t.d(r,{default:function(){return n.a}});var s=t(231),n=t.n(s)},20920:function(e,r,t){"use strict";t.d(r,{Z:function(){return d}});for(var s,n={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)},i=new Uint8Array(16),a=[],l=0;l<256;++l)a.push((l+256).toString(16).slice(1));var d=function(e,r,t){if(n.randomUUID&&!r&&!e)return n.randomUUID();var l=(e=e||{}).random||(e.rng||function(){if(!s&&!(s="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return s(i)})();if(l[6]=15&l[6]|64,l[8]=63&l[8]|128,r){t=t||0;for(var d=0;d<16;++d)r[t+d]=l[d];return r}return function(e,r=0){return(a[e[r+0]]+a[e[r+1]]+a[e[r+2]]+a[e[r+3]]+"-"+a[e[r+4]]+a[e[r+5]]+"-"+a[e[r+6]]+a[e[r+7]]+"-"+a[e[r+8]]+a[e[r+9]]+"-"+a[e[r+10]]+a[e[r+11]]+a[e[r+12]]+a[e[r+13]]+a[e[r+14]]+a[e[r+15]]).toLowerCase()}(l)}}},function(e){e.O(0,[4868,6834,6746,1441,9527,6801,1377,231,7776,8472,1565,323,8482,2860,6942,9875,929,7478,7023,1744],function(){return e(e.s=44119)}),_N_E=e.O()}]);