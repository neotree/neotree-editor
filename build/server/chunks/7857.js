exports.id=7857,exports.ids=[7857],exports.modules={39941:(e,t,a)=>{Promise.resolve().then(a.bind(a,25813)),Promise.resolve().then(a.bind(a,93254)),Promise.resolve().then(a.bind(a,71163)),Promise.resolve().then(a.bind(a,15086)),Promise.resolve().then(a.bind(a,25210)),Promise.resolve().then(a.bind(a,97043)),Promise.resolve().then(a.bind(a,8037)),Promise.resolve().then(a.bind(a,72346)),Promise.resolve().then(a.bind(a,3529)),Promise.resolve().then(a.bind(a,36617))},41120:(e,t,a)=>{Promise.resolve().then(a.t.bind(a,12994,23)),Promise.resolve().then(a.t.bind(a,96114,23)),Promise.resolve().then(a.t.bind(a,9727,23)),Promise.resolve().then(a.t.bind(a,79671,23)),Promise.resolve().then(a.t.bind(a,41868,23)),Promise.resolve().then(a.t.bind(a,84759,23))},52719:(e,t,a)=>{Promise.resolve().then(a.t.bind(a,79404,23))},71708:(e,t,a)=>{"use strict";a.d(t,{E:()=>i});var s=a(10326),r=a(92009);function i({width:e=0,height:t=0,containerWidth:a,...i}){i.sizes;let n={width:"100%",height:"auto"};if(t&&e&&a){let s=(0,r.a)({imageWidth:e,imageHeight:t,containerWidth:a});n.width=s.imageWidth,n.height=s.imageHeight}return s.jsx("img",{...i,src:i.src,style:{...n,...i.style}})}},11870:(e,t,a)=>{"use strict";a.d(t,{a:()=>i});var s=a(10326),r=a(3240);function i({overlay:e,transparent:t,padding:a="50px 0"}){return s.jsx(s.Fragment,{children:s.jsx("div",{style:{width:"100%",display:"flex",justifyContent:"center",alignItems:"center",...e?{height:"100%",position:"fixed",top:0,left:0,bottom:0,zIndex:999,backgroundColor:t?"transparent":"rgba(255,255,255,.6)"}:{padding:a}},children:s.jsx(r.Z,{style:{height:24,width:24},className:"animate-spin"})})})}},25813:(e,t,a)=>{"use strict";a.d(t,{AlertModal:()=>c});var s=a(10326),r=a(17577),i=a(12534),n=a(99440),d=a(96221),l=a(90772),o=a(77863);function c(){let{isOpen:e,title:t,message:a,variant:c,buttonLabel:f,close:u,onClose:g}=(0,d.s)(),h=(0,r.useCallback)(()=>{g?.(),u()},[u,g]);return s.jsx(n.aR,{open:e,onOpenChange:h,children:(0,s.jsxs)(n._T,{children:[(0,s.jsxs)(n.fY,{children:[s.jsx(n.f$,{className:(0,o.cn)(!t&&"hidden"),children:t||""}),s.jsx(n.yT,{className:"hidden",children:""}),!!a&&(0,s.jsxs)("div",{className:(0,o.cn)("flex gap-y-4 flex-col sm:items-start sm:flex-row sm:gap-x-4"),children:["error"===c&&s.jsx("div",{className:"flex justify-center",children:s.jsx(i.BJv,{className:"text-red-600 min-w-12 min-h-12 w-12 h-12"})}),"success"===c&&s.jsx("div",{className:"flex justify-center",children:s.jsx(i._rq,{className:"text-green-600 min-w-12 min-h-12 w-12 h-12"})}),s.jsx("div",{className:"flex-1 text-lg",children:s.jsx("div",{dangerouslySetInnerHTML:{__html:a}})})]})]}),s.jsx(n.xo,{children:s.jsx("div",{className:"flex justify-end",children:s.jsx(l.z,{onClick:h,variant:"outline",children:f})})})]})})}},93254:(e,t,a)=>{"use strict";a.d(t,{ConfirmModal:()=>o});var s=a(10326),r=a(99440),i=a(12534),n=a(46670),d=a(90772),l=a(77863);function o(){let{isOpen:e,danger:t,title:a,message:o,positiveLabel:c,negativeLabel:f,close:u,onConfirm:g}=(0,n.t)();return s.jsx(r.aR,{open:e,onOpenChange:u,children:(0,s.jsxs)(r._T,{className:"p-0 max-h-[80%] flex flex-col",children:[!!a&&s.jsx(r.fY,{className:"py-2 px-4",children:s.jsx(r.f$,{children:a})}),(0,s.jsxs)("div",{className:(0,l.cn)("px-4 flex-1 flex flex-col gap-y-4 items-center sm:items-start sm:flex-row sm:gap-x-4 overflow-y-auto",!a&&"py-2"),children:[t&&s.jsx(i.bcx,{className:"text-red-600 min-w-10 min-h-10 w-10 h-10"}),s.jsx("div",{dangerouslySetInnerHTML:{__html:o}})]}),(0,s.jsxs)(r.xo,{className:"px-4 py-2",children:[s.jsx(r.le,{children:f}),s.jsx(d.z,{variant:t?"destructive":void 0,asChild:!0,children:s.jsx(r.OL,{onClick:()=>g?.(),children:c})})]})]})})}},71163:(e,t,a)=>{"use strict";a.d(t,{FilesModal:()=>A});var s=a(10326),r=a(17577),i=a(62288),n=a(33071),d=a(11870),l=a(9900),o=a(79210),c=a(8037),f=a(3756),u=a(12534),g=a(99440),h=a(90772);function m(){let{unhandledErrors:e}=(0,l.Y)(),t=(0,r.useCallback)(()=>l.Y.setState({unhandledErrors:[]}),[]);return s.jsx(g.aR,{open:!!e.length,onOpenChange:e=>!e&&t(),children:(0,s.jsxs)(g._T,{children:[(0,s.jsxs)(g.fY,{children:[s.jsx(g.f$,{children:""}),s.jsx(g.yT,{children:""}),s.jsx("div",{className:"flex justify-center",children:s.jsx(u.BJv,{className:"text-red-600 min-w-12 min-h-12 w-12 h-12"})}),s.jsx("div",{className:"flex-1 text-lg",dangerouslySetInnerHTML:{__html:e.join("\n")}})]}),s.jsx(g.xo,{children:s.jsx("div",{className:"flex justify-end",children:s.jsx(h.z,{onClick:()=>t(),variant:"outline",children:"Okay"})})})]})})}var p=a(47463),y=a(39572),x=a(63685),v=a(2165),w=a(94464),b=a(77863),j=a(96221),I=a(92009),D=a(71708);function N({type:e,inputProps:t,fileDetails:a,onUpload:n}){let{closeModal:o}=(0,l.Y)(),[c,{width:f}]=(0,v.Z)(),[u,g]=(0,r.useState)([]),[m,N]=(0,r.useState)(!1),{alert:K}=(0,j.s)(),Z=(0,r.useCallback)(async()=>{let e=t?.multiple?u:[u[0]];try{N(!0);let t=[],s=[];for(let{file:r,metadata:i,fileId:n}of e)try{let e=new FormData;e.append("file",r),e.append("fileId",n||(0,p.Z)()),e.append("filename",r.name),e.append("contentType",r.type),e.append("size",`${r.size}`),e.append("metadata",JSON.stringify({...i})),a&&Object.keys(a).forEach(t=>{let s=a[t];e.append(t,JSON.stringify(s))});let d=(await w.Z.post("/api/files/upload",e)).data;if(d.errors)throw Error(`Failed to upload ${r.name}: ${t.join(", \n")}`);d.data&&s.push(d.data)}catch(e){t=[...t,e.message]}if(t.length)throw Error(t.join(", "));s.length&&n?.(s),g([]),K({title:"Success",message:`File${e.length>1?"s":""} uploaded successfully!`,variant:"success"})}catch(e){K({title:"Error",message:e.message,variant:"error"})}finally{N(!1)}},[n,K,u,t?.multiple,a]),P=(0,r.useCallback)(async e=>{try{let t=[];if(e.target.files?.length)for(let a=0;a<e.target.files.length;a++)t.push(e.target.files[a]);let a=[];for(let e of t){let t,s;let r=URL.createObjectURL(e),i={};if(`${e.type}`.includes("image"))try{let e=await (0,I.p)(r);i={...i,...e},t=r}catch(e){}a.push({fileId:(0,p.Z)(),file:e,url:r,imageURL:t,videoURL:s,metadata:i})}g(a)}catch(e){K({title:"Error",message:e.message})}},[K]);return(0,s.jsxs)(s.Fragment,{children:[m&&s.jsx(d.a,{overlay:!0}),(0,s.jsxs)("div",{className:"p-4 flex-1 overflow-y-auto",ref:c,children:[1===u.length&&u.map(e=>{let t=s.jsx(y.Z,{className:"w-20 h-20 text-muted-foreground"});return e.imageURL&&(t=s.jsx(D.E,{alt:"",width:e.metadata.width||0,height:e.metadata.height||0,containerWidth:f,src:e.imageURL||"/images/placeholder.png"})),(0,s.jsxs)("div",{className:(0,b.cn)(`
                                    flex
                                    flex-col
                                    gap-y-2
                                    w-full
                                    items-center
                                    justify-center
                                    text-xs
                                `,!(e.imageURL||e.videoURL)&&""),children:[t,s.jsx("span",{children:e.file.name})]},e.fileId)}),!u.length&&(0,s.jsxs)("div",{className:(0,b.cn)(`
                                relative
                                w-full
                                h-36
                                bg-primary/20
                                flex
                                flex-col
                                items-center
                                justify-center
                                text-primary
                                uppercase
                                font-bold
                                rounded-md
                                transition-colors
                                hover:bg-primary/30
                            `,!!u.length&&"hidden"),children:[s.jsx("div",{children:t?.placeholder||"Choose file"}),s.jsx("input",{...t,type:"file",accept:e,value:"",className:(0,b.cn)(`
                                    absolute
                                    left-0
                                    top-0
                                    w-full
                                    h-full
                                    opacity-0
                                `),onChange:P})]})]}),(0,s.jsxs)(i.cN,{className:"px-4 py-4",children:[!u.length&&s.jsx("div",{className:"flex-1"}),s.jsx(h.z,{variant:"ghost",onClick:()=>o(),children:"Cancel"}),!!u.length&&(0,s.jsxs)(s.Fragment,{children:[s.jsx("div",{className:"flex-1"}),s.jsx(h.z,{variant:"destructive",onClick:()=>g([]),children:"Clear"}),(0,s.jsxs)(h.z,{disabled:!u.length,onClick:()=>Z(),className:(0,b.cn)(!u.length&&"hidden"),children:[s.jsx(x.Z,{className:"h-4 w-4 mr-2"}),s.jsx("span",{children:"Upload"})]})]})]})]})}var K=a(41135),Z=a(65304);function P({file:e,...t}){let[a,n]=(0,r.useState)(!1),[d,o]=(0,r.useState)(!1),{selectMultiple:c,onSelectFiles:f,closeModal:u}=(0,l.Y)(),g=s.jsx(D.E,{...t,onLoad:()=>n(!0),className:(0,K.Z)(!a&&"hidden opacity-0",t.className)});return(0,s.jsxs)(s.Fragment,{children:[!a&&s.jsx(Z.O,{className:"h-24"}),(0,s.jsxs)(i.Vq,{open:d,onOpenChange:o,children:[s.jsx(i.hg,{children:g}),(0,s.jsxs)(i.cZ,{hideCloseButton:!0,className:"px-0 py-0 flex flex-col w-full max-w-xl max-h-[80%]",children:[(0,s.jsxs)(i.fK,{className:"p-0 m-0 h-0 overflow-hidden",children:[s.jsx(i.$N,{children:""}),s.jsx(i.Be,{children:""})]}),s.jsx("div",{className:"flex-1 overflow-y-auto px-4 py-2",children:g}),(0,s.jsxs)(i.cN,{className:"px-4 py-2",children:[s.jsx(i.GG,{asChild:!0,children:s.jsx(h.z,{variant:"ghost",children:"Close"})}),!!f&&s.jsx(i.GG,{asChild:!0,children:s.jsx(h.z,{onClick:()=>{f([e]),c||u()},children:"Select"})})]})]})]})]})}let _=[{label:"Files",value:"files"},{label:"Upload",value:"upload"}];function A(){let{isModalOpen:e,loading:t,files:a,lastFilesQueryDate:u,page:g,totalPages:h,totalRows:p,limit:y,closeModal:x,getFiles:v}=(0,l.Y)(),[w,j]=(0,r.useState)(_[0].value);return!u&&t?s.jsx(d.a,{overlay:!0}):(0,s.jsxs)(s.Fragment,{children:[t&&s.jsx(d.a,{overlay:!0}),s.jsx(c.SocketEventsListener,{events:[{name:"file_uploaded",onEvent:{callback(){u&&v({reset:!0})}}}]}),s.jsx(i.Vq,{open:e,onOpenChange:x,children:(0,s.jsxs)(i.cZ,{hideCloseButton:!0,className:"px-0 py-0 max-w-3xl max-h-[80%] flex flex-col",children:[(0,s.jsxs)(i.fK,{className:"p-0 m-0 h-0 overflow-hidden",children:[s.jsx(i.$N,{children:""}),s.jsx(i.Be,{children:""})]}),s.jsx(o.mQ,{className:"w-full [&>div]:w-full",value:w,onValueChange:e=>j(e),children:s.jsx(o.dr,{children:_.map(e=>s.jsx(o.SP,{value:e.value,className:"flex-1",children:e.label},e.value))})}),(0,s.jsxs)(s.Fragment,{children:[w===_[0].value&&(0,s.jsxs)(s.Fragment,{children:[s.jsx("div",{className:"p-4 flex-1 overflow-y-auto columns-1 sm:columns-2 md:columns-3 gap-4",children:a.map(e=>{let t={...e.metadata};return s.jsx(n.Zb,{className:"mb-4",children:s.jsx(n.aY,{className:"p-2 transition-all hover:scale-105",children:s.jsx("div",{children:s.jsx(P,{width:t.width||t.w,height:t.height||t.h,alt:e.filename,src:e.url,file:e})})})},e.fileId)})}),(0,s.jsxs)(i.cN,{className:"px-4 py-2 flex flex-row items-center",children:[(0,s.jsxs)("span",{className:(0,b.cn)("text-xs text-muted-foreground"),children:["Showing ",a.length," of ",p," files"]}),s.jsx("div",{className:"flex-1"}),s.jsx("div",{children:s.jsx(f.t,{currentPage:g,totalPages:h,disabled:t,limit:y,totalRows:p,collectionName:"Files",onPaginate:e=>v({page:e}),hideControls:!1,hideSummary:!0,hideNumbers:!0,nextLabel:"More",prevLabel:"",hidePrev:!0})})]})]}),w===_[1].value&&s.jsx(s.Fragment,{children:s.jsx(N,{onUpload:()=>j(_[0].value),type:"image/*"})})]})]})}),s.jsx(m,{})]})}},3756:(e,t,a)=>{"use strict";a.d(t,{t:()=>c});var s=a(10326),r=a(90670),i=a(24082),n=a(77863);let d="LEFT",l="RIGHT";function o(e,t,a=1){let s=e,r=[];for(;s<=t;)r.push(s),s+=a;return r}function c(e){let{currentPage:t,totalPages:a,disabled:c,limit:f=1,totalRows:u,collectionName:g="results",hideControls:h,hideSummary:m,hideNumbers:p,hideNext:y,hidePrev:x,classes:v}=e,w=function(e){let{currentPage:t=1,totalPages:a=0,onPaginate:s}=e,r=[{id:"first",label:void 0!==e.prevLabel?e.prevLabel:"Previous",disabled:t<2,isPrev:!0,isNext:!1,isEllipsis:!1,onClick:()=>s(t-1)}];return(function({totalPages:e=0,currentPage:t=1}){if(e>9){let a=[],s=t-2,r=t+2,i=e-1,n=s>2?s:2,c=r<i?r:i,f=7-(a=o(n,c)).length-1,u=n>2,g=c<i;return u&&!g?a=[d,...o(n-f,n-1),...a]:!u&&g?a=[...a,...o(c+1,c+f),l]:u&&g&&(a=[d,...a,l]),[1,...a,e]}return o(1,e)})(e).forEach(e=>{[d,l].includes(e)?r.push({label:"...",id:`${e}`,disabled:!1,isPrev:!1,isNext:!1,isEllipsis:!0,onClick:()=>{}}):r.push({id:`${e}`,label:`${e}`,disabled:t===e,isPrev:!1,isNext:!1,isEllipsis:!1,onClick:()=>s(Number(e))})}),r.push({id:"last",label:void 0!==e.nextLabel?e.nextLabel:"Next",disabled:a===t,isPrev:!1,isNext:!0,isEllipsis:!1,onClick:()=>s(t+1)}),r}(e);return h&&m?null:(0,s.jsxs)("div",{className:"flex flex-col justify-center items-center gap-y-2",children:[!m&&(0,s.jsxs)("div",{className:"text-xs opacity-50 min-w-10",children:["Showing ",u?(0,i.c)((t-1)*f+1):0,"\xa0-\xa0",(0,i.c)(Math.min(u,t*f)),"\xa0of\xa0",(0,i.c)(u,{separator:" "})," ",g]}),!h&&s.jsx(r.tl,{children:s.jsx(r.ng,{children:w.map(e=>s.jsx(r.nt,{children:(()=>{let i=`${t}`==`${e.label}`,d=e.disabled||c,l="opacity-50",o=()=>!d&&e.onClick();return e.isPrev?x?null:(d=d||1===t,s.jsx(r.dN,{href:"#",className:(0,n.cn)(1===t?l:""),onClick:e=>{e.stopPropagation(),e.preventDefault(),o()},children:s.jsx("span",{children:e.label})})):e.isEllipsis?p?null:s.jsx(r.Dj,{className:(0,n.cn)(d?l:"","hidden md:flex",v?.pageNumber)}):e.isNext?y?null:(d=d||t===a,s.jsx(r.$0,{href:"#",className:(0,n.cn)(d?l:""),onClick:e=>{e.stopPropagation(),e.preventDefault(),o()},children:s.jsx("span",{children:e.label})})):p?null:s.jsx(r.kN,{href:"#",className:(0,n.cn)(d?l:"","hidden md:flex",v?.pageNumber),isActive:i,onClick:e=>{e.stopPropagation(),e.preventDefault(),o()},children:e.label})})()},e.id))})})]})}},15086:(e,t,a)=>{"use strict";a.d(t,{AuthContextProvider:()=>i});var s=a(10326),r=a(77109);function i({children:e}){return s.jsx(r.SessionProvider,{children:e})}},25210:(e,t,a)=>{"use strict";a.d(t,{ChangeLogProvider:()=>n});var s=a(10326),r=a(17577);let i=(0,r.createContext)(void 0);function n({children:e}){let[t,a]=(0,r.useState)({});return s.jsx(i.Provider,{value:{...t,setCurrentEntity:e=>{a(e)},clearCurrentEntity:()=>{a({})}},children:e})}},97043:(e,t,a)=>{"use strict";a.d(t,{ThemeProvider:()=>i});var s=a(10326);a(17577);var r=a(14831);function i({children:e,...t}){return s.jsx(r.f,{...t,children:e})}},8037:(e,t,a)=>{"use strict";a.d(t,{SocketEventsListener:()=>i});var s=a(17577),r=a(35047);function i({events:e}){return(0,s.useRef)({eventsTimeouts:{},eventsTimestamps:{}}),(0,s.useRef)(new Date().getTime()),(0,r.useRouter)(),null}a(63697)},99440:(e,t,a)=>{"use strict";a.d(t,{OL:()=>p,_T:()=>f,aR:()=>l,f$:()=>h,fY:()=>u,le:()=>y,xo:()=>g,yT:()=>m});var s=a(10326),r=a(17577),i=a(95459),n=a(77863),d=a(90772);let l=i.fC;i.xz;let o=i.h_,c=r.forwardRef(({className:e,...t},a)=>s.jsx(i.aV,{className:(0,n.cn)("fixed inset-0 z-[99999999999] bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:a}));c.displayName=i.aV.displayName;let f=r.forwardRef(({className:e,...t},a)=>(0,s.jsxs)(o,{children:[s.jsx(c,{}),s.jsx(i.VY,{ref:a,className:(0,n.cn)("fixed left-[50%] top-[50%] z-[99999999999] grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t})]}));f.displayName=i.VY.displayName;let u=({className:e,...t})=>s.jsx("div",{className:(0,n.cn)("flex flex-col space-y-2 text-center sm:text-left",e),...t});u.displayName="AlertDialogHeader";let g=({className:e,...t})=>s.jsx("div",{className:(0,n.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});g.displayName="AlertDialogFooter";let h=r.forwardRef(({className:e,...t},a)=>s.jsx(i.Dx,{ref:a,className:(0,n.cn)("text-lg font-semibold",e),...t}));h.displayName=i.Dx.displayName;let m=r.forwardRef(({className:e,...t},a)=>s.jsx(i.dk,{ref:a,className:(0,n.cn)("text-sm text-muted-foreground",e),...t}));m.displayName=i.dk.displayName;let p=r.forwardRef(({className:e,...t},a)=>s.jsx(i.aU,{ref:a,className:(0,n.cn)((0,d.d)(),e),...t}));p.displayName=i.aU.displayName;let y=r.forwardRef(({className:e,...t},a)=>s.jsx(i.$j,{ref:a,className:(0,n.cn)((0,d.d)({variant:"outline"}),"mt-2 sm:mt-0",e),...t}));y.displayName=i.$j.displayName},90772:(e,t,a)=>{"use strict";a.d(t,{d:()=>l,z:()=>o});var s=a(10326),r=a(17577),i=a(34214),n=a(79360),d=a(77863);let l=(0,n.j)(`
    inline-flex
    items-center
    justify-center
    whitespace-nowrap
    rounded-md
    text-sm
    font-medium
    transition-colors
    focus-visible:outline-none
    disabled:pointer-events-none
    disabled:opacity-50
  `,{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"border border-input bg-background hover:bg-primary/20","primary-outline":"border border-primary text-primary bg-transparent hover:bg-primary/20",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/90",ghost:"hover:bg-primary/20 hover:text-primary",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),o=r.forwardRef(({className:e,variant:t,size:a,asChild:r=!1,...n},o)=>{let c=r?i.g7:"button";return s.jsx(c,{className:(0,d.cn)(l({variant:t,size:a,className:e})),ref:o,...n})});o.displayName="Button"},33071:(e,t,a)=>{"use strict";a.d(t,{Ol:()=>d,SZ:()=>o,Zb:()=>n,aY:()=>c,eW:()=>f,ll:()=>l});var s=a(10326),r=a(17577),i=a(77863);let n=r.forwardRef(({className:e,...t},a)=>s.jsx("div",{ref:a,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));n.displayName="Card";let d=r.forwardRef(({className:e,...t},a)=>s.jsx("div",{ref:a,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",e),...t}));d.displayName="CardHeader";let l=r.forwardRef(({className:e,...t},a)=>s.jsx("h3",{ref:a,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",e),...t}));l.displayName="CardTitle";let o=r.forwardRef(({className:e,...t},a)=>s.jsx("p",{ref:a,className:(0,i.cn)("text-sm text-muted-foreground",e),...t}));o.displayName="CardDescription";let c=r.forwardRef(({className:e,...t},a)=>s.jsx("div",{ref:a,className:(0,i.cn)("p-6 pt-0",e),...t}));c.displayName="CardContent";let f=r.forwardRef(({className:e,...t},a)=>s.jsx("div",{ref:a,className:(0,i.cn)("flex items-center p-6 pt-0",e),...t}));f.displayName="CardFooter"},62288:(e,t,a)=>{"use strict";a.d(t,{$N:()=>p,Be:()=>y,GG:()=>f,Vq:()=>l,cN:()=>m,cZ:()=>g,fK:()=>h,hg:()=>o});var s=a(10326),r=a(17577),i=a(37956),n=a(94019),d=a(77863);let l=i.fC,o=i.xz,c=i.h_,f=i.x8,u=r.forwardRef(({className:e,...t},a)=>s.jsx(i.aV,{ref:a,className:(0,d.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));u.displayName=i.aV.displayName;let g=r.forwardRef(({className:e,children:t,hideCloseButton:a,...r},l)=>(0,s.jsxs)(c,{children:[s.jsx(u,{}),(0,s.jsxs)(i.VY,{ref:l,className:(0,d.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...r,children:[t,!0!==a&&(0,s.jsxs)(i.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[s.jsx(n.Z,{className:"h-4 w-4"}),s.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));g.displayName=i.VY.displayName;let h=({className:e,...t})=>s.jsx("div",{className:(0,d.cn)("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});h.displayName="DialogHeader";let m=({className:e,...t})=>s.jsx("div",{className:(0,d.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});m.displayName="DialogFooter";let p=r.forwardRef(({className:e,...t},a)=>s.jsx(i.Dx,{ref:a,className:(0,d.cn)("text-lg font-semibold leading-none tracking-tight",e),...t}));p.displayName=i.Dx.displayName;let y=r.forwardRef(({className:e,...t},a)=>s.jsx(i.dk,{ref:a,className:(0,d.cn)("text-sm text-muted-foreground",e),...t}));y.displayName=i.dk.displayName},90670:(e,t,a)=>{"use strict";a.d(t,{$0:()=>m,Dj:()=>p,dN:()=>h,kN:()=>g,ng:()=>f,nt:()=>u,tl:()=>c});var s=a(10326),r=a(17577),i=a(11890),n=a(39183),d=a(15919),l=a(77863),o=a(90772);let c=({className:e,...t})=>s.jsx("nav",{role:"navigation","aria-label":"pagination",className:(0,l.cn)("mx-auto flex w-full justify-center",e),...t});c.displayName="Pagination";let f=r.forwardRef(({className:e,...t},a)=>s.jsx("ul",{ref:a,className:(0,l.cn)("flex flex-row items-center gap-1",e),...t}));f.displayName="PaginationContent";let u=r.forwardRef(({className:e,...t},a)=>s.jsx("li",{ref:a,className:(0,l.cn)("",e),...t}));u.displayName="PaginationItem";let g=({className:e,isActive:t,size:a="icon",...r})=>s.jsx("a",{"aria-current":t?"page":void 0,className:(0,l.cn)((0,o.d)({variant:t?"outline":"ghost",size:a}),e),...r});g.displayName="PaginationLink";let h=({className:e,children:t,...a})=>(0,s.jsxs)(g,{"aria-label":"Go to previous page",size:"default",className:(0,l.cn)("gap-1 pl-2.5",e),...a,children:[s.jsx(i.Z,{className:"h-4 w-4"}),t||s.jsx("span",{children:"Previous"})]});h.displayName="PaginationPrevious";let m=({className:e,children:t,...a})=>(0,s.jsxs)(g,{"aria-label":"Go to next page",size:"default",className:(0,l.cn)("gap-1 pr-2.5",e),...a,children:[t||s.jsx("span",{children:"Next"}),s.jsx(n.Z,{className:"h-4 w-4"})]});m.displayName="PaginationNext";let p=({className:e,...t})=>(0,s.jsxs)("span",{"aria-hidden":!0,className:(0,l.cn)("flex h-9 w-9 items-center justify-center",e),...t,children:[s.jsx(d.Z,{className:"h-4 w-4"}),s.jsx("span",{className:"sr-only",children:"More pages"})]});p.displayName="PaginationEllipsis"},65304:(e,t,a)=>{"use strict";a.d(t,{O:()=>i});var s=a(10326),r=a(77863);function i({className:e,...t}){return s.jsx("div",{className:(0,r.cn)("animate-pulse rounded-md bg-muted",e),...t})}},72346:(e,t,a)=>{"use strict";a.d(t,{Toaster:()=>n});var s=a(10326),r=a(14831),i=a(85999);let n=({...e})=>{let{theme:t="system"}=(0,r.F)();return s.jsx(i.x7,{theme:t,richColors:!0,position:"top-center",...e})}},79210:(e,t,a)=>{"use strict";a.d(t,{SP:()=>o,dr:()=>l,mQ:()=>d,nU:()=>c});var s=a(10326),r=a(17577),i=a(28407),n=a(77863);let d=i.fC,l=r.forwardRef(({className:e,...t},a)=>s.jsx(i.aV,{ref:a,className:(0,n.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...t}));l.displayName=i.aV.displayName;let o=r.forwardRef(({className:e,...t},a)=>s.jsx(i.xz,{ref:a,className:(0,n.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...t}));o.displayName=i.xz.displayName;let c=r.forwardRef(({className:e,...t},a)=>s.jsx(i.VY,{ref:a,className:(0,n.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));c.displayName=i.VY.displayName},3529:(e,t,a)=>{"use strict";a.d(t,{AppContextProvider:()=>y,b:()=>p});var s=a(10326),r=a(17577),i=a(14831),n=a(35047),d=a(60222),l=a(66562);let o=l.Z.get,c=l.Z.set,f=(l.Z.remove,{get:o,set:c});function u(){let e=f.get("mode");return e||(e="view",f.set("mode",e,{expires:31536e7})),e}var g=a(63697),h=a(8037);let m=(0,r.createContext)(null),p=()=>(0,r.useContext)(m);function y({children:e,...t}){let a=function(e){(0,n.useRouter)();let{isAdmin:t,isSuperUser:a,sys:s}=e,{setTheme:d}=(0,i.F)(),l=(0,r.useCallback)(()=>(t||a?u():"view")||"view",[a,t]),[o,c]=(0,r.useState)(l()),h=!t&&!a||"view"===o,m=(0,r.useCallback)((...e)=>{let t=function(e){return f.set("mode",e,{expires:31536e7}),u()}(...e);return g.Z.emit("mode_changed",l()),c(l()),t},[l]),p=(0,r.useCallback)(()=>{c(l())},[l]);return{...e,mode:o,viewOnly:h,onModeChange:p,getMode:u,setMode:m}}(t),[l,o]=(0,r.useState)(!1);return((0,d.Z)(()=>{o(!0)}),l)?(0,s.jsxs)(m.Provider,{value:a,children:[e,s.jsx(h.SocketEventsListener,{events:[{name:"mode_changed",onEvent:{callback:a.onModeChange}}]})]}):null}},96221:(e,t,a)=>{"use strict";a.d(t,{s:()=>i});var s=a(60114);let r={title:"",message:"",buttonLabel:"Ok",variant:"info",onClose:void 0},i=(0,s.Ue)(e=>({isOpen:!1,...r,alert:t=>e({isOpen:!0,...r,...t}),close:()=>e({isOpen:!1,onClose:void 0,...r})}))},46670:(e,t,a)=>{"use strict";a.d(t,{t:()=>i});var s=a(60114);let r={danger:!1,title:"Confirm",message:"Are you sure?",positiveLabel:"Ok",negativeLabel:"Cancel"},i=(0,s.Ue)(e=>({isOpen:!1,...r,confirm:(t,a)=>e({isOpen:!0,...r,...a,onConfirm:t}),close:()=>e({isOpen:!1,onConfirm:void 0,...r})}))},9900:(e,t,a)=>{"use strict";a.d(t,{Y:()=>i});var s=a(60114),r=a(94464);let i=(0,s.Ue)((e,t)=>{let a=async a=>{try{let{reset:s,...i}={...a};s&&(i.page=1),e({loading:!0,unhandledErrors:[]});let{data:n,errors:d,totalPages:l,totalRows:o,page:c}=(await r.Z.get(`/api/files?data=${JSON.stringify({...i,limit:i.limit||t().limit,page:i.page||t().page})}`)).data;if(d?.length)e({unhandledErrors:d});else{let a=s?n:[...t().files,...n];a=a.filter((e,t)=>t===a.map(e=>e.fileId).indexOf(e.fileId)),i.siteId&&i.siteId!==t().siteId&&(a=n),e({files:a,totalPages:l,totalRows:o,page:c,siteId:i.siteId||t().siteId,lastFilesQueryDate:n.length?new Date:null})}}catch(t){e({unhandledErrors:[t.message]})}finally{e({loading:!1})}};return{isModalOpen:!1,loading:!1,siteId:"",files:[],unhandledErrors:[],lastFilesQueryDate:null,page:1,limit:15,totalPages:1,totalRows:0,onSelectFiles:null,selectMultiple:!1,getFiles:a,openModal(s){e({onSelectFiles:s?.onSelectFiles||null,isModalOpen:!0}),t().lastFilesQueryDate||a()},closeModal:()=>e({isModalOpen:!1})}})},24082:(e,t,a)=>{"use strict";function s(e,t){let{decimals:a=0,separator:s=" "}={...t};isNaN(e=Number(`${e}`.replace(/[^a-z0-9.]+/gi,"")))&&(e="0");let r=(e=`${Number(e).toFixed(a>=0?a:2)}`).toString().split(".");return r[0]=r[0].replace(/\B(?=(\d{3})+(?!\d))/g,s),r.join(".")}a.d(t,{c:()=>s})},92009:(e,t,a)=>{"use strict";async function s(e){return new Promise((t,a)=>{let s=new Image;s.onload=function(){t({width:s.width,height:s.height})},s.onerror=function(e,t,s,r,i){a(i||Error("Failed to load image"))},s.src=e})}function r({imageWidth:e,imageHeight:t,containerWidth:a}){return e>a&&(t=a/e*t,e=a),{imageWidth:e,imageHeight:t}}a.d(t,{a:()=>r,p:()=>s})},63697:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});let s=(0,a(80057).io)(process.env.NEXT_PUBLIC_APP_URL)},77863:(e,t,a)=>{"use strict";a.d(t,{cn:()=>i});var s=a(41135),r=a(31009);function i(...e){return(0,r.m6)((0,s.W)(e))}},94136:(e,t,a)=>{"use strict";a.r(t),a.d(t,{$$ACTION_0:()=>f,$$ACTION_1:()=>m,$$ACTION_2:()=>y,exportDataKeys:()=>p,getDataKeys:()=>h,saveDataKeys:()=>c,saveDataKeysIfNotExist:()=>u,saveDataKeysUpdateIfExist:()=>g});var s=a(24330);a(60166);var r=a(16916),i=a(88778),n=a(5286),d=a(57435),l=a(66267),o=a(40618);let c=(0,s.j)("3a0d2e45b2393e17307a9bcfbe4fd2ee096e9f31",f);async function f(e){try{let t=await (0,l.isAllowed)();return await (0,i.MM)({...e,userId:t.user?.userId})}catch(e){return d.Z.error("saveDataKeys ERROR",e.message),{errors:[e.message],data:void 0,success:!1}}}let u=i.Jv,g=i.gy,h=(0,s.j)("9b5a511d36f35054112299c8168ff23e74730b0d",m);async function m(e){return await (0,r.aW)(e)}let p=(0,s.j)("90041e3ef5b6f3da78e75421c0239ae445c66d63",y);async function y({uuids:e,siteId:t,overwriteExisting:a}){try{let s=await (0,n.U)(t),i=await (0,r.aW)({dataKeysIds:e,returnDraftsIfExist:!0});if(i.errors?.length)return{success:!1,errors:i.errors};let d=[];if(i.data.length){if(a){let e=await s.post("/api/data-keys/save-and-update-if-exist",{data:i.data,broadcastAction:!0});e.data.errors&&(d=e.data.errors)}else{let e=await s.post("/api/data-keys/save-if-not-exist",{data:i.data,broadcastAction:!0});e.data.errors&&(d=e.data.errors)}}return{success:!d.length,errors:d.length?d:void 0}}catch(e){return{success:!1,errors:[e.message]}}}(0,o.h)([c,u,g,h,p]),(0,s.j)("2765783afbcbd3389809865445019eb362ccc203",c),(0,s.j)("5ec891f57cf5c05bc7e269d7b2f9e2a6cb8ac39e",u),(0,s.j)("2d54e8c0d2223cf05bd04ae114adaf6d75945de3",g),(0,s.j)("2e1b1572167e8449a14c811a6b2b3e462fa263d5",h),(0,s.j)("ed74efefdcb0734ec3f4ee2295f07fb7415f75db",p)},71271:(e,t,a)=>{"use strict";a.r(t),a.d(t,{$$ACTION_0:()=>R,$$ACTION_1:()=>k,countAllDrafts:()=>C,discardDrafts:()=>O,getEditorDetails:()=>_,publishData:()=>S,revalidatePath:()=>A});var s=a(24330);a(60166);var r=a(57708),i=a(88317),n=a(57435),d=a(66267),l=a(57745),o=a(34149),c=a(10413),f=a(93567);async function u(e){try{let{items:t,broadcastAction:a}={...e},s=["configKeys"===t?(0,l.K0)(f.pendingDeletion.configKeyId):void 0,"drugsLibrary"===t?(0,l.K0)(f.pendingDeletion.drugsLibraryItemId):void 0,"dataKeys"===t?(0,l.K0)(f.pendingDeletion.dataKeyId):void 0,"scripts"===t?(0,l.xD)((0,l.K0)(f.pendingDeletion.scriptId),(0,l.Ft)(f.pendingDeletion.screenId),(0,l.Ft)(f.pendingDeletion.diagnosisId)):void 0,"screens"===t?(0,l.K0)(f.pendingDeletion.screenId):void 0,"diagnoses"===t?(0,l.K0)(f.pendingDeletion.diagnosisId):void 0,e?.userId?(0,l.eq)(f.pendingDeletion.createdByUserId,e.userId):void 0];return await c.Z.delete(f.pendingDeletion).where(s.length?(0,l.xD)(...s):void 0),a&&i.Z.emit("data_changed","clear_pending_deletion"),{success:!0}}catch(e){return n.Z.error("_clearPendingDeletion ERROR",e.message),{success:!1,errors:[e.message]}}}async function g(e){try{let{items:t}={...e},a=await c.Z.query.pendingDeletion.findMany({where:(0,l.xD)("configKeys"===t?(0,l.K0)(f.pendingDeletion.configKeyId):void 0,e?.userId?(0,l.eq)(f.pendingDeletion.createdByUserId,e.userId):void 0)});a.length&&await c.Z.update(f.configKeys).set({deletedAt:new Date}).where((0,l.d3)(f.configKeys.configKeyId,a.map(e=>e.configKeyId)));let s=await c.Z.query.pendingDeletion.findMany({where:(0,l.xD)("drugsLibrary"===t?(0,l.K0)(f.pendingDeletion.drugsLibraryItemId):void 0,e?.userId?(0,l.eq)(f.pendingDeletion.createdByUserId,e.userId):void 0)}),r=await c.Z.query.pendingDeletion.findMany({where:(0,l.xD)("dataKeys"===t?(0,l.K0)(f.pendingDeletion.dataKeyId):void 0,e?.userId?(0,l.eq)(f.pendingDeletion.createdByUserId,e.userId):void 0)});r.length&&await c.Z.update(f.dataKeys).set({deletedAt:new Date,name:(0,o.i6)`CONCAT(${f.dataKeys.name}, '_', ${f.dataKeys.uuid})`}).where((0,l.d3)(f.dataKeys.uuid,r.map(e=>e.dataKeyId))),s.length&&await c.Z.update(f.drugsLibrary).set({deletedAt:new Date,key:(0,o.i6)`CONCAT(${f.drugsLibrary.key}, '_', ${f.drugsLibrary.itemId})`}).where((0,l.d3)(f.drugsLibrary.itemId,s.map(e=>e.drugsLibraryItemId)));let i=await c.Z.query.pendingDeletion.findMany({where:"scripts"===t?(0,l.xD)((0,l.K0)(f.pendingDeletion.scriptId),(0,l.Ft)(f.pendingDeletion.screenId),(0,l.Ft)(f.pendingDeletion.diagnosisId),e?.userId?(0,l.eq)(f.pendingDeletion.createdByUserId,e.userId):void 0):void 0});i.length&&(await c.Z.update(f.scripts).set({deletedAt:new Date}).where((0,l.d3)(f.scripts.scriptId,i.map(e=>e.scriptId))),await c.Z.update(f.screens).set({deletedAt:new Date}).where((0,l.d3)(f.screens.scriptId,i.map(e=>e.scriptId))),await c.Z.update(f.diagnoses).set({deletedAt:new Date}).where((0,l.d3)(f.diagnoses.scriptId,i.map(e=>e.scriptId))));let n=await c.Z.query.pendingDeletion.findMany({where:(0,l.xD)("screens"===t?(0,l.K0)(f.pendingDeletion.screenId):void 0,e?.userId?(0,l.eq)(f.pendingDeletion.createdByUserId,e.userId):void 0)});n.length&&await c.Z.update(f.screens).set({deletedAt:new Date}).where((0,l.d3)(f.screens.screenId,n.map(e=>e.screenId)));let d=await c.Z.query.pendingDeletion.findMany({where:(0,l.xD)("diagnoses"===t?(0,l.K0)(f.pendingDeletion.diagnosisId):void 0,e?.userId?(0,l.eq)(f.pendingDeletion.createdByUserId,e.userId):void 0)});return d.length&&await c.Z.update(f.diagnoses).set({deletedAt:new Date}).where((0,l.d3)(f.diagnoses.diagnosisId,d.map(e=>e.diagnosisId))),await u(e),{success:!0}}catch(e){return n.Z.error("_processPendingDeletion ERROR",e.message),{success:!1,errors:[e.message]}}}var h=a(25060),m=a(21162),p=a(45241),y=a(92963),x=a(17137),v=a(73543),w=a(20084),b=a(22418),j=a(88781),I=a(88778),D=a(16916);async function N({data:e,increaseVersion:t,broadcastAction:a,syncSilently:s}){try{let r=await c.Z.query.editorInfo.findFirst();if(r){let a=t?r.dataVersion+1:r.dataVersion;await c.Z.update(f.editorInfo).set({...e,dataVersion:a}).where((0,l.eq)(f.editorInfo.id,r.id))}return(r=await c.Z.query.editorInfo.findFirst())&&a&&!s&&i.Z.emit("data_changed","save_editor_info"),{data:r||null,success:!!r}}catch(e){return n.Z.error("_saveEditorInfo ERROR",e.message),{data:null,success:!1,errors:[e.message]}}}var K=a(18496),Z=a(36864),P=a(40618);async function _(){let e=[],t=!1;try{let a=await (0,K.y)();a.errors?.forEach(t=>e.push(t));let s=await h.Ur();s.errors?.forEach(t=>e.push(t));let{errors:r,...i}=await h.Yi();return r?.forEach(t=>e.push(t)),t=!!i.total||!!s.total,{pendingDeletion:s.total,drafts:i,errors:e.length?e:void 0,shouldPublishData:t,info:a.data}}catch(a){return n.Z.error("getEditorDetails ERROR",a.message),{errors:[a.message,...e],pendingDeletion:0,drafts:h.Ic,shouldPublishData:t,info:null}}}let A=(0,s.j)("e584eea53fe697cdba6835e3a5f23e256760fd14",R);async function R(e,t){return(0,r.revalidatePath)(e,t)}let C=(0,s.j)("6c4c8093da4330fc3d7393832fd9d8e2f17a4bd3",k);async function k(){try{let e=await x.G$(),t=await w.Py(),a=await j.G$(),s=await D.gc(),r=await m.co(),i=await m.ix(),n=await m.tW();return{configKeys:e.data.allDrafts,hospitals:t.data.allDrafts,drugsLibrary:a.data.allDrafts,screens:r.data.allDrafts,scripts:i.data.allDrafts,diagnoses:n.data.allDrafts,dataKeys:s.data.allDrafts}}catch(e){return n.Z.error("countAllDrafts ERROR",e.message),{screens:0,scripts:0,configKeys:0,hospitals:0,diagnoses:0}}}async function S({scope:e}){let t={success:!0};try{let a=await (0,d.isAllowed)(["create_config_keys","update_config_keys","create_scripts","update_scripts","create_diagnoses","update_diagnoses","create_screens","update_screens"]),s=a?.user?.userId||null,r=s;1===e&&(r=null);let l=await (0,K.y)(),o=(l.data?.dataVersion||1)+1,c=await y.h({userId:r,publisherUserId:s,dataVersion:o}),f=await v.fn({userId:r,publisherUserId:s,dataVersion:o}),u=await b.hA({userId:r,publisherUserId:s,dataVersion:o}),h=await I.Hc({userId:r,publisherUserId:s,dataVersion:o}),m=await p.Ls({userId:r,publisherUserId:s,dataVersion:o}),x=await p.Ry({userId:r,publisherUserId:s,dataVersion:o}),w=await p.gv({userId:r,publisherUserId:s,dataVersion:o}),j=await g({userId:r,publisherUserId:s||void 0});h.errors&&(t.success=!1,t.errors=[...t.errors||[],...h.errors]),c.errors&&(t.success=!1,t.errors=[...t.errors||[],...c.errors]),f.errors&&(t.success=!1,t.errors=[...t.errors||[],...f.errors]),u.errors&&(t.success=!1,t.errors=[...t.errors||[],...u.errors]),m.errors&&(t.success=!1,t.errors=[...t.errors||[],...m.errors]),x.errors&&(t.success=!1,t.errors=[...t.errors||[],...x.errors]),w.errors&&(t.success=!1,t.errors=[...t.errors||[],...w.errors]),j.errors&&(t.success=!1,t.errors=[...t.errors||[],...j.errors]);let D=await N({increaseVersion:t.success,broadcastAction:!0,data:{lastPublishDate:new Date}});if(t.success&&D.success&&D.data?.dataVersion&&s){let e=D.data.dataVersion,t=new Date,a=await (0,Z.C)({data:{entityId:"00000000-0000-0000-0000-000000000000",entityType:"release",action:"publish",dataVersion:e,changes:[{action:"publish",description:`Release v${e} published`,fromDataVersion:e-1,toDataVersion:e}],fullSnapshot:{dataVersion:e,publishedAt:t.toISOString(),publishedBy:s},previousSnapshot:{},baselineSnapshot:{dataVersion:e,publishedAt:t.toISOString(),publishedBy:s},description:`Release v${e} published`,changeReason:`Release v${e} published`,isActive:!1,userId:s}});a.success||n.Z.error("publishData release changelog warning",a.errors?.join(", ")||"Unknown error")}i.Z.emit("data_changed","publish_data")}catch(e){t.success=!1,t.errors=[e.message],n.Z.error("publishData ERROR",e.message)}finally{return t}}async function O({scope:e}){let t={success:!0};try{let t=await (0,d.isAllowed)(["delete_config_keys","delete_scripts","delete_diagnoses","delete_screens"]),a=t?.user?.userId;1===e&&(a=void 0),await y.sj({userId:a}),await v.q5({userId:a}),await b.Ms({userId:a}),await I.F$({userId:a}),await p.VQ({userId:a}),await p.In({userId:a}),await p.cF({userId:a}),await u({userId:a}),i.Z.emit("data_changed","discard_drafts")}catch(e){t.success=!1,t.errors=[e.message],n.Z.error("publishData ERROR",e.message)}finally{return t}}(0,P.h)([_,A,C,S,O]),(0,s.j)("49172b38c10122728aa1b2fc14d20f7760f2abd3",_),(0,s.j)("bc2ee616f8ba694d4ae301d1c34ff957771a7cfb",A),(0,s.j)("93f98a1a18e2ffbbcd9b86311fd7e5a2204d9828",C),(0,s.j)("3628525f9968b3410608c9eeaf253358ba48d9fe",S),(0,s.j)("f28667e6446bdcb1da1b47a90e98f363919ccac6",O)},82065:(e,t,a)=>{"use strict";a.r(t),a.d(t,{$$ACTION_0:()=>y,getSite:()=>g,getSites:()=>h,getSitesWithoutConfidentialData:()=>m,saveSites:()=>p});var s=a(24330);a(60166);var r=a(57435),i=a(10413),n=a(93567),d=a(88317),l=a(57745);async function o(e){let t={success:!1};try{let a=e.filter(e=>e.id),s=e.filter(e=>!e.id),r=[];for(let e of a)try{await i.Z.update(n.sites).set(e).where((0,l.eq)(n.sites.id,e.id))}catch(e){r.push(e.message)}s.length&&await i.Z.insert(n.sites).values(s),r.length?t.errors=r:t.success=!0}catch(e){t.success=!1,t.errors=[e.message],r.Z.error("_saveSites ERROR",e.message)}finally{return t?.errors?.length||d.Z.emit("data_changed","save_sites"),t}}var c=a(20123),f=a(66267),u=a(40618);let g=c.Ng,h=c.QF,m=c.YF,p=(0,s.j)("4bccbc621808e65939704fa615db3606c6862204",y);async function y(...e){try{return await (0,f.isAllowed)(),await o(...e)}catch(e){return r.Z.error("getSys ERROR",e.message),{errors:[e.message],data:void 0,success:!1}}}(0,u.h)([g,h,m,p]),(0,s.j)("85f6ad3db1fc721aba5aaf50300cb3f13c10a7dc",g),(0,s.j)("60d4bc4dbf8a7e1570162873f97e0d36be03fa83",h),(0,s.j)("65af2414f4ea72aa53dd5bd16d03045d9ac81d36",m),(0,s.j)("ea276d8b8dc674a1b891605b84c4b6addb452962",p)},60563:(e,t,a)=>{"use strict";a.r(t),a.d(t,{$$ACTION_0:()=>g,$$ACTION_1:()=>m,getSys:()=>u,updateSys:()=>h});var s=a(24330);a(60166);var r=a(57745),i=a(88317),n=a(57435),d=a(10413),l=a(93567);async function o(e={},t){let a={success:!1};try{for(let t of Object.keys(e))try{await d.Z.update(l.sys).set({value:e[t]}).where((0,r.eq)(l.sys.key,t))}catch(e){a.errors=[...a?.errors||[],e.message]}!a.errors?.length&&(a.success=!0,t?.broadcastAction&&i.Z.emit("update_system"))}catch(e){a.success=!1,a.errors=[e.message],n.Z.error("_updateSys ERROR",e.message)}finally{return a}}async function c(){let e={data:{}};try{let t=(await d.Z.query.sys.findMany()).reduce((e,t)=>({...e,[t.key]:t.value}),{});e.data=t}catch(t){e.errors=[t.message],n.Z.error("_getSys ERROR",t.message)}finally{return e}}var f=a(40618);let u=(0,s.j)("b5d1e928850507f1eade38e5d8700567fd19649e",g);async function g(...e){return await c(...e)}let h=(0,s.j)("9f6d32db3dcac1f6a722471c0a6a5f2465041eb1",m);async function m(...e){let t={success:!1};try{t=await o(...e)}catch(e){t.errors=[e.message],n.Z.error("getSys ERROR",e.message)}finally{return t}}(0,f.h)([u,h]),(0,s.j)("bb5715444ca1fc8c6b68cca354c0a3615e5615e2",u),(0,s.j)("559815287213d06ead0c877c60e184e5031ac06e",h)},99985:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>D,dynamic:()=>j,metadata:()=>I});var s=a(19510),r=a(81082),i=a.n(r),n=a(98100);a(3641);var d=a(68570);let l=(0,d.createProxy)(String.raw`/home/farai/Workbench/Neotree/neotree-editor/components/providers/auth-context-provider.tsx#AuthContextProvider`),o=(0,d.createProxy)(String.raw`/home/farai/Workbench/Neotree/neotree-editor/components/providers/theme-provider.tsx#ThemeProvider`),c=(0,d.createProxy)(String.raw`/home/farai/Workbench/Neotree/neotree-editor/components/ui/sonner.tsx#Toaster`),f=(0,d.createProxy)(String.raw`/home/farai/Workbench/Neotree/neotree-editor/components/modals/confirm.tsx#ConfirmModal`),u=(0,d.createProxy)(String.raw`/home/farai/Workbench/Neotree/neotree-editor/components/modals/alert.tsx#AlertModal`),g=(0,d.createProxy)(String.raw`/home/farai/Workbench/Neotree/neotree-editor/components/modals/files/index.tsx#FilesModal`);(0,d.createProxy)(String.raw`/home/farai/Workbench/Neotree/neotree-editor/contexts/app/index.tsx#AppContext`),(0,d.createProxy)(String.raw`/home/farai/Workbench/Neotree/neotree-editor/contexts/app/index.tsx#useAppContext`);let h=(0,d.createProxy)(String.raw`/home/farai/Workbench/Neotree/neotree-editor/contexts/app/index.tsx#AppContextProvider`);var m=a(60563),p=a(82065),y=a(40801),x=a(71271),v=a(94136);a(67272);let w=(0,d.createProxy)(String.raw`/home/farai/Workbench/Neotree/neotree-editor/components/socket-events-listener.tsx#SocketEventsListener`),b=(0,d.createProxy)(String.raw`/home/farai/Workbench/Neotree/neotree-editor/components/providers/changelog-context-provider.tsx#ChangeLogProvider`);(0,d.createProxy)(String.raw`/home/farai/Workbench/Neotree/neotree-editor/components/providers/changelog-context-provider.tsx#useChangeLogContext`);let j="force-dynamic",I={title:"Neotree",description:"Neotree",icons:[{media:"(prefers-color-scheme: light)",url:"/images/favicon.ico",href:"/images/favicon.ico"},{media:"(prefers-color-scheme: dark)",url:"/images/favicon.ico",href:"/images/favicon.ico"}]};async function D({children:e}){let[t,a,r]=await Promise.all([x.getEditorDetails(),(0,y.getAuthenticatedUserWithRoles)(),(0,m.getSys)()]);return s.jsx("html",{lang:"en",children:s.jsx("body",{className:i().className,suppressHydrationWarning:!0,children:s.jsx(n.Y,{children:s.jsx(l,{children:(0,s.jsxs)(o,{attribute:"class",defaultTheme:"light",enableSystem:!0,disableTransitionOnChange:!0,children:[s.jsx(h,{...x,...m,...t,...a,...v,sys:r,getSites:p.getSitesWithoutConfidentialData,children:(0,s.jsxs)(b,{children:[e,s.jsx(w,{events:[{name:"mode_changed",onEvent:{refreshRouter:!0}},{name:"update_system",onEvent:{refreshRouter:!0}},{name:"data_changed",onEvent:{refreshRouter:!0}}]})]})}),s.jsx(c,{}),s.jsx(f,{}),s.jsx(u,{}),s.jsx(g,{})]})})})})})}},96560:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>l});var s=a(19510),r=a(84101),i=a(2946),n=a(55848),d=a(57371);function l(){return s.jsx("div",{className:"w-full h-full flex items-center justify-center",children:(0,s.jsxs)("div",{className:"px-4 py-4 flex flex-col gap-y-5 text-center justify-center items-center",children:[s.jsx(r.T,{}),s.jsx("div",{className:"text-6xl sm:text-9xl font-extrabold text-secondary dark:text-secondary-foreground",children:"Four, Oh! Four"}),s.jsx("div",{children:"Sorry, can't find the page you're looking for."}),s.jsx(i.z,{variant:"outline",size:"lg",asChild:!0,children:s.jsx(d.default,{href:"/",replace:!0,children:(0,s.jsxs)(s.Fragment,{children:[s.jsx(n.Z,{className:"w-6 h-6 mr-2"}),s.jsx("span",{className:"text-xl",children:"Home"})]})})})]})})}},84101:(e,t,a)=>{"use strict";a.d(t,{T:()=>n});var s=a(19510),r=a(57371),i=a(50650);function n({size:e,href:t,className:a,variant:n="default",theme:d="auto"}){let l=s.jsx("div",{className:(0,i.cn)("font-bold text-primary",(()=>{switch(e){case"sm":return"w-20";case"lg":return"w-40";case"xl":return"w-80";case"2xl":return"w-[600px]";default:return"w-28"}})(),a),children:"icon"===n?s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"145.29",height:"78.354",viewBox:"0 0 145.29 78.354",className:"w-full h-auto",children:(0,s.jsxs)("g",{id:"Group_1377","data-name":"Group 1377",transform:"translate(0)",children:[s.jsx("path",{id:"Path_885","data-name":"Path 885",d:"M80.664,59.008a6.663,6.663,0,0,1-.159-1.541c-.006-.5.022-.993.056-1.487a20.31,20.31,0,0,1,2.705-8.488A13.118,13.118,0,0,1,87.514,43a7.745,7.745,0,0,1,6.009-1.066.191.191,0,0,1,0,.368l0,0A10.833,10.833,0,0,0,88.9,44.863a18.447,18.447,0,0,0-3.181,4.1A47.879,47.879,0,0,0,83.244,53.8c-.386.839-.754,1.695-1.125,2.559-.2.43-.363.868-.554,1.306l-.267.659c-.09.213-.178.459-.24.633l-.025.07a.193.193,0,0,1-.248.114A.2.2,0,0,1,80.664,59.008Z",transform:"translate(-3.081 -5.835)",fill:"#2b304a"}),s.jsx("path",{id:"Path_886","data-name":"Path 886",d:"M81.873,58.957c-.063-.175-.149-.42-.241-.633l-.267-.659c-.189-.438-.354-.876-.554-1.306-.37-.865-.739-1.72-1.123-2.559a48.218,48.218,0,0,0-2.477-4.838,18.487,18.487,0,0,0-3.18-4.1A10.833,10.833,0,0,0,69.409,42.3l0,0a.191.191,0,0,1-.13-.236.2.2,0,0,1,.135-.132A7.74,7.74,0,0,1,75.416,43a13.118,13.118,0,0,1,4.248,4.5,20.309,20.309,0,0,1,2.705,8.488c.033.493.063.989.056,1.487a6.664,6.664,0,0,1-.159,1.541.193.193,0,0,1-.368.019Z",transform:"translate(-9.675 -5.835)",fill:"#2b304a"}),(0,s.jsxs)("g",{id:"Group_1284","data-name":"Group 1284",transform:"translate(0 57.147)",children:[s.jsx("path",{id:"Path_887","data-name":"Path 887",d:"M48.5,63.117V74.659a1.605,1.605,0,1,1-3.208,0V63.491c0-3.291-2.042-5.416-5.041-5.416a5.163,5.163,0,0,0-5.333,5.416V74.659a1.605,1.605,0,1,1-3.208,0V56.784a1.61,1.61,0,0,1,1.625-1.666,1.629,1.629,0,0,1,1.584,1.666v.749a8.317,8.317,0,0,1,6.041-2.415C45.586,55.118,48.5,58.242,48.5,63.117Z",transform:"translate(-31.711 -55.118)",fill:"#2b304a"}),s.jsx("path",{id:"Path_888","data-name":"Path 888",d:"M65.279,64.493V64.7a1.772,1.772,0,0,1-1.958,2H48.988a7.165,7.165,0,0,0,7.458,6.668,8.063,8.063,0,0,0,5.292-1.958,1.666,1.666,0,0,1,1.084-.459,1.378,1.378,0,0,1,1.415,1.415,1.862,1.862,0,0,1-.792,1.46,10.79,10.79,0,0,1-7.04,2.5,10.605,10.605,0,0,1-.376-21.207A8.984,8.984,0,0,1,65.279,64.493Zm-16.166-.625H61.986a5.747,5.747,0,0,0-6.041-5.833A6.918,6.918,0,0,0,49.113,63.867Z",transform:"translate(-23.53 -55.118)",fill:"#2b304a"}),s.jsx("path",{id:"Path_889","data-name":"Path 889",d:"M81.9,65.7A10.625,10.625,0,1,1,71.273,55.118,10.563,10.563,0,0,1,81.9,65.7Zm-17.959.043a7.267,7.267,0,0,0,7.293,7.582,7.631,7.631,0,1,0-7.293-7.582Z",transform:"translate(-14.732 -55.118)",fill:"#2b304a"}),s.jsx("path",{id:"Path_890","data-name":"Path 890",d:"M82.669,55.407H87.71a1.437,1.437,0,1,1,0,2.874H82.669V69.364c0,2.667,1.376,3.875,4.292,3.875.708,0,1.208-.084,1.666-.084a1.291,1.291,0,0,1,1.458,1.25,1.431,1.431,0,0,1-1.166,1.458,8.954,8.954,0,0,1-2.624.292c-4.418,0-6.834-2.333-6.834-6.583V58.281H77.377a1.438,1.438,0,1,1,0-2.874h2.083",transform:"translate(-5.796 -54.948)",fill:"#2b304a"}),s.jsx("path",{id:"Path_891","data-name":"Path 891",d:"M98.757,56.909a1.5,1.5,0,0,1-1.625,1.5,5.984,5.984,0,0,0-6.334,6v10.25a1.605,1.605,0,1,1-3.208,0V56.784a1.611,1.611,0,0,1,1.626-1.666A1.627,1.627,0,0,1,90.8,56.784v1.5a8.145,8.145,0,0,1,6.334-2.875A1.526,1.526,0,0,1,98.757,56.909Z",transform:"translate(1.076 -55.118)",fill:"#2b304a"}),s.jsx("path",{id:"Path_892","data-name":"Path 892",d:"M115.537,64.493V64.7a1.772,1.772,0,0,1-1.958,2H99.246a7.166,7.166,0,0,0,7.459,6.668A8.059,8.059,0,0,0,112,71.409a1.673,1.673,0,0,1,1.084-.459,1.379,1.379,0,0,1,1.417,1.415,1.862,1.862,0,0,1-.792,1.46,10.791,10.791,0,0,1-7.042,2.5,10.605,10.605,0,0,1-.374-21.207A8.984,8.984,0,0,1,115.537,64.493Zm-16.166-.625h12.875a5.748,5.748,0,0,0-6.041-5.833A6.921,6.921,0,0,0,99.372,63.867Z",transform:"translate(5.961 -55.118)",fill:"#2b304a"}),s.jsx("path",{id:"Path_893","data-name":"Path 893",d:"M130.531,64.493V64.7a1.772,1.772,0,0,1-1.958,2H114.24a7.166,7.166,0,0,0,7.459,6.668,8.059,8.059,0,0,0,5.29-1.958,1.67,1.67,0,0,1,1.084-.459,1.379,1.379,0,0,1,1.417,1.415,1.862,1.862,0,0,1-.792,1.46,10.791,10.791,0,0,1-7.042,2.5,10.605,10.605,0,0,1-.374-21.207A8.984,8.984,0,0,1,130.531,64.493Zm-16.166-.625H127.24a5.749,5.749,0,0,0-6.041-5.833A6.919,6.919,0,0,0,114.366,63.867Z",transform:"translate(14.758 -55.118)",fill:"#2b304a"})]}),s.jsx("path",{id:"Path_894","data-name":"Path 894",d:"M69.853,22.729a1.984,1.984,0,0,1,.4,1.282,1.935,1.935,0,0,1-.611,1.365,1.81,1.81,0,0,1-1.452.438,2.047,2.047,0,0,1-1.206-.592l1.142-.335a1.771,1.771,0,0,0,.719-.4A5.347,5.347,0,0,0,69.853,22.729Z",transform:"translate(-11.015 -16.976)",fill:"#70a487"}),s.jsx("path",{id:"Path_895","data-name":"Path 895",d:"M70.662,26.239a11.037,11.037,0,0,1,1.073-1.157c.178-.186.308-.428.551-.5a1.653,1.653,0,0,1,.911-.008.1.1,0,0,1,.075.092,1.338,1.338,0,0,1-.309.9,1.393,1.393,0,0,1-.724.328,15.275,15.275,0,0,1-1.509.447.063.063,0,0,1-.078-.043A.069.069,0,0,1,70.662,26.239Z",transform:"translate(-8.864 -15.929)",fill:"#70a487"}),s.jsx("path",{id:"Path_896","data-name":"Path 896",d:"M72.955,21.678a1.327,1.327,0,0,1-.068,1.092,1.433,1.433,0,0,1-.993.754,1.536,1.536,0,0,1-1.173-.27,1.584,1.584,0,0,1-.6-.889,9.644,9.644,0,0,0,1.549-.008A3.35,3.35,0,0,0,72.955,21.678Z",transform:"translate(-9.176 -17.592)",fill:"#70a487"}),s.jsx("path",{id:"Path_897","data-name":"Path 897",d:"M81.24,26.792A13.745,13.745,0,0,0,78.51,22.63a7.648,7.648,0,0,0-4.118-2.34,7.9,7.9,0,0,0-4.6.687,10.032,10.032,0,0,0-3.757,2.717,8.985,8.985,0,0,0-1.479,8.549,7.885,7.885,0,0,0,6.184,5.476,1.318,1.318,0,0,1,1.084.982l.019.071a12.176,12.176,0,0,0,3.956,5.99,20.038,20.038,0,0,0,6.525,3.74c4.775,1.785,10.049,1.176,14.774-.8a23.673,23.673,0,0,0,6.414-4.113,20.209,20.209,0,0,0,2.585-2.78,14.245,14.245,0,0,0,1.89-3.166,5.645,5.645,0,0,0,.408-3.213,5.01,5.01,0,0,0-1.661-2.739,11.55,11.55,0,0,0-6.764-2.6l.168-.013a48.305,48.305,0,0,1-7.551.073c-1.242-.083-2.48-.187-3.713-.325l-1.845-.217a4.589,4.589,0,0,0-1.718-.027,15.026,15.026,0,0,0-6.3,3.351,11.97,11.97,0,0,0-2.417,2.707,4.6,4.6,0,0,0-.76,3.478,4.717,4.717,0,0,1,.557-3.594,12.335,12.335,0,0,1,2.306-2.937,15.473,15.473,0,0,1,6.452-3.811,6.707,6.707,0,0,1,1.956-.108l1.839.04c1.227.016,2.45,0,3.67-.036a53.618,53.618,0,0,0,7.2-.592.926.926,0,0,1,.148-.013h.021a13.292,13.292,0,0,1,8.353,2.751,7.582,7.582,0,0,1,2.658,4.022,8.228,8.228,0,0,1-.4,4.792c-2.329,5.611-7,9.549-12.25,11.917a25.592,25.592,0,0,1-8.4,2.122,20.71,20.71,0,0,1-8.649-1.25,21.868,21.868,0,0,1-7.488-4.446,14.962,14.962,0,0,1-4.646-7.6l1.1,1.054a9.839,9.839,0,0,1-5.093-2.648,10.939,10.939,0,0,1-2.842-4.857A10.542,10.542,0,0,1,69.3,19.7a9.073,9.073,0,0,1,5.3-.341,8.4,8.4,0,0,1,4.314,2.916A13.477,13.477,0,0,1,81.24,26.792Z",transform:"translate(-14.001 -19.103)",fill:"#70a487"})]})}):(0,s.jsxs)(s.Fragment,{children:[s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"145.29",height:"78.354",viewBox:"0 0 145.29 78.354",className:(0,i.cn)("w-full h-auto","auto"===d?"dark:hidden":"light"!==d&&"hidden"),children:(0,s.jsxs)("g",{id:"Group_1377","data-name":"Group 1377",transform:"translate(0)",children:[s.jsx("path",{id:"Path_885","data-name":"Path 885",d:"M80.664,59.008a6.663,6.663,0,0,1-.159-1.541c-.006-.5.022-.993.056-1.487a20.31,20.31,0,0,1,2.705-8.488A13.118,13.118,0,0,1,87.514,43a7.745,7.745,0,0,1,6.009-1.066.191.191,0,0,1,0,.368l0,0A10.833,10.833,0,0,0,88.9,44.863a18.447,18.447,0,0,0-3.181,4.1A47.879,47.879,0,0,0,83.244,53.8c-.386.839-.754,1.695-1.125,2.559-.2.43-.363.868-.554,1.306l-.267.659c-.09.213-.178.459-.24.633l-.025.07a.193.193,0,0,1-.248.114A.2.2,0,0,1,80.664,59.008Z",transform:"translate(-3.081 -5.835)",fill:"#2b304a"}),s.jsx("path",{id:"Path_886","data-name":"Path 886",d:"M81.873,58.957c-.063-.175-.149-.42-.241-.633l-.267-.659c-.189-.438-.354-.876-.554-1.306-.37-.865-.739-1.72-1.123-2.559a48.218,48.218,0,0,0-2.477-4.838,18.487,18.487,0,0,0-3.18-4.1A10.833,10.833,0,0,0,69.409,42.3l0,0a.191.191,0,0,1-.13-.236.2.2,0,0,1,.135-.132A7.74,7.74,0,0,1,75.416,43a13.118,13.118,0,0,1,4.248,4.5,20.309,20.309,0,0,1,2.705,8.488c.033.493.063.989.056,1.487a6.664,6.664,0,0,1-.159,1.541.193.193,0,0,1-.368.019Z",transform:"translate(-9.675 -5.835)",fill:"#2b304a"}),(0,s.jsxs)("g",{id:"Group_1284","data-name":"Group 1284",transform:"translate(0 57.147)",children:[s.jsx("path",{id:"Path_887","data-name":"Path 887",d:"M48.5,63.117V74.659a1.605,1.605,0,1,1-3.208,0V63.491c0-3.291-2.042-5.416-5.041-5.416a5.163,5.163,0,0,0-5.333,5.416V74.659a1.605,1.605,0,1,1-3.208,0V56.784a1.61,1.61,0,0,1,1.625-1.666,1.629,1.629,0,0,1,1.584,1.666v.749a8.317,8.317,0,0,1,6.041-2.415C45.586,55.118,48.5,58.242,48.5,63.117Z",transform:"translate(-31.711 -55.118)",fill:"#2b304a"}),s.jsx("path",{id:"Path_888","data-name":"Path 888",d:"M65.279,64.493V64.7a1.772,1.772,0,0,1-1.958,2H48.988a7.165,7.165,0,0,0,7.458,6.668,8.063,8.063,0,0,0,5.292-1.958,1.666,1.666,0,0,1,1.084-.459,1.378,1.378,0,0,1,1.415,1.415,1.862,1.862,0,0,1-.792,1.46,10.79,10.79,0,0,1-7.04,2.5,10.605,10.605,0,0,1-.376-21.207A8.984,8.984,0,0,1,65.279,64.493Zm-16.166-.625H61.986a5.747,5.747,0,0,0-6.041-5.833A6.918,6.918,0,0,0,49.113,63.867Z",transform:"translate(-23.53 -55.118)",fill:"#2b304a"}),s.jsx("path",{id:"Path_889","data-name":"Path 889",d:"M81.9,65.7A10.625,10.625,0,1,1,71.273,55.118,10.563,10.563,0,0,1,81.9,65.7Zm-17.959.043a7.267,7.267,0,0,0,7.293,7.582,7.631,7.631,0,1,0-7.293-7.582Z",transform:"translate(-14.732 -55.118)",fill:"#2b304a"}),s.jsx("path",{id:"Path_890","data-name":"Path 890",d:"M82.669,55.407H87.71a1.437,1.437,0,1,1,0,2.874H82.669V69.364c0,2.667,1.376,3.875,4.292,3.875.708,0,1.208-.084,1.666-.084a1.291,1.291,0,0,1,1.458,1.25,1.431,1.431,0,0,1-1.166,1.458,8.954,8.954,0,0,1-2.624.292c-4.418,0-6.834-2.333-6.834-6.583V58.281H77.377a1.438,1.438,0,1,1,0-2.874h2.083",transform:"translate(-5.796 -54.948)",fill:"#2b304a"}),s.jsx("path",{id:"Path_891","data-name":"Path 891",d:"M98.757,56.909a1.5,1.5,0,0,1-1.625,1.5,5.984,5.984,0,0,0-6.334,6v10.25a1.605,1.605,0,1,1-3.208,0V56.784a1.611,1.611,0,0,1,1.626-1.666A1.627,1.627,0,0,1,90.8,56.784v1.5a8.145,8.145,0,0,1,6.334-2.875A1.526,1.526,0,0,1,98.757,56.909Z",transform:"translate(1.076 -55.118)",fill:"#2b304a"}),s.jsx("path",{id:"Path_892","data-name":"Path 892",d:"M115.537,64.493V64.7a1.772,1.772,0,0,1-1.958,2H99.246a7.166,7.166,0,0,0,7.459,6.668A8.059,8.059,0,0,0,112,71.409a1.673,1.673,0,0,1,1.084-.459,1.379,1.379,0,0,1,1.417,1.415,1.862,1.862,0,0,1-.792,1.46,10.791,10.791,0,0,1-7.042,2.5,10.605,10.605,0,0,1-.374-21.207A8.984,8.984,0,0,1,115.537,64.493Zm-16.166-.625h12.875a5.748,5.748,0,0,0-6.041-5.833A6.921,6.921,0,0,0,99.372,63.867Z",transform:"translate(5.961 -55.118)",fill:"#2b304a"}),s.jsx("path",{id:"Path_893","data-name":"Path 893",d:"M130.531,64.493V64.7a1.772,1.772,0,0,1-1.958,2H114.24a7.166,7.166,0,0,0,7.459,6.668,8.059,8.059,0,0,0,5.29-1.958,1.67,1.67,0,0,1,1.084-.459,1.379,1.379,0,0,1,1.417,1.415,1.862,1.862,0,0,1-.792,1.46,10.791,10.791,0,0,1-7.042,2.5,10.605,10.605,0,0,1-.374-21.207A8.984,8.984,0,0,1,130.531,64.493Zm-16.166-.625H127.24a5.749,5.749,0,0,0-6.041-5.833A6.919,6.919,0,0,0,114.366,63.867Z",transform:"translate(14.758 -55.118)",fill:"#2b304a"})]}),s.jsx("path",{id:"Path_894","data-name":"Path 894",d:"M69.853,22.729a1.984,1.984,0,0,1,.4,1.282,1.935,1.935,0,0,1-.611,1.365,1.81,1.81,0,0,1-1.452.438,2.047,2.047,0,0,1-1.206-.592l1.142-.335a1.771,1.771,0,0,0,.719-.4A5.347,5.347,0,0,0,69.853,22.729Z",transform:"translate(-11.015 -16.976)",fill:"#70a487"}),s.jsx("path",{id:"Path_895","data-name":"Path 895",d:"M70.662,26.239a11.037,11.037,0,0,1,1.073-1.157c.178-.186.308-.428.551-.5a1.653,1.653,0,0,1,.911-.008.1.1,0,0,1,.075.092,1.338,1.338,0,0,1-.309.9,1.393,1.393,0,0,1-.724.328,15.275,15.275,0,0,1-1.509.447.063.063,0,0,1-.078-.043A.069.069,0,0,1,70.662,26.239Z",transform:"translate(-8.864 -15.929)",fill:"#70a487"}),s.jsx("path",{id:"Path_896","data-name":"Path 896",d:"M72.955,21.678a1.327,1.327,0,0,1-.068,1.092,1.433,1.433,0,0,1-.993.754,1.536,1.536,0,0,1-1.173-.27,1.584,1.584,0,0,1-.6-.889,9.644,9.644,0,0,0,1.549-.008A3.35,3.35,0,0,0,72.955,21.678Z",transform:"translate(-9.176 -17.592)",fill:"#70a487"}),s.jsx("path",{id:"Path_897","data-name":"Path 897",d:"M81.24,26.792A13.745,13.745,0,0,0,78.51,22.63a7.648,7.648,0,0,0-4.118-2.34,7.9,7.9,0,0,0-4.6.687,10.032,10.032,0,0,0-3.757,2.717,8.985,8.985,0,0,0-1.479,8.549,7.885,7.885,0,0,0,6.184,5.476,1.318,1.318,0,0,1,1.084.982l.019.071a12.176,12.176,0,0,0,3.956,5.99,20.038,20.038,0,0,0,6.525,3.74c4.775,1.785,10.049,1.176,14.774-.8a23.673,23.673,0,0,0,6.414-4.113,20.209,20.209,0,0,0,2.585-2.78,14.245,14.245,0,0,0,1.89-3.166,5.645,5.645,0,0,0,.408-3.213,5.01,5.01,0,0,0-1.661-2.739,11.55,11.55,0,0,0-6.764-2.6l.168-.013a48.305,48.305,0,0,1-7.551.073c-1.242-.083-2.48-.187-3.713-.325l-1.845-.217a4.589,4.589,0,0,0-1.718-.027,15.026,15.026,0,0,0-6.3,3.351,11.97,11.97,0,0,0-2.417,2.707,4.6,4.6,0,0,0-.76,3.478,4.717,4.717,0,0,1,.557-3.594,12.335,12.335,0,0,1,2.306-2.937,15.473,15.473,0,0,1,6.452-3.811,6.707,6.707,0,0,1,1.956-.108l1.839.04c1.227.016,2.45,0,3.67-.036a53.618,53.618,0,0,0,7.2-.592.926.926,0,0,1,.148-.013h.021a13.292,13.292,0,0,1,8.353,2.751,7.582,7.582,0,0,1,2.658,4.022,8.228,8.228,0,0,1-.4,4.792c-2.329,5.611-7,9.549-12.25,11.917a25.592,25.592,0,0,1-8.4,2.122,20.71,20.71,0,0,1-8.649-1.25,21.868,21.868,0,0,1-7.488-4.446,14.962,14.962,0,0,1-4.646-7.6l1.1,1.054a9.839,9.839,0,0,1-5.093-2.648,10.939,10.939,0,0,1-2.842-4.857A10.542,10.542,0,0,1,69.3,19.7a9.073,9.073,0,0,1,5.3-.341,8.4,8.4,0,0,1,4.314,2.916A13.477,13.477,0,0,1,81.24,26.792Z",transform:"translate(-14.001 -19.103)",fill:"#70a487"})]})}),s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"145.29",height:"78.354",viewBox:"0 0 145.29 78.354",className:(0,i.cn)("w-full h-auto","auto"===d?"hidden dark:hidden":"dark"!==d&&"hidden"),children:(0,s.jsxs)("g",{id:"Group_1378","data-name":"Group 1378",transform:"translate(0)",children:[s.jsx("path",{id:"Path_885","data-name":"Path 885",d:"M80.664,59.008a6.663,6.663,0,0,1-.159-1.541c-.006-.5.022-.993.056-1.487a20.31,20.31,0,0,1,2.705-8.488A13.118,13.118,0,0,1,87.514,43a7.745,7.745,0,0,1,6.009-1.066.191.191,0,0,1,0,.368l0,0A10.833,10.833,0,0,0,88.9,44.863a18.447,18.447,0,0,0-3.181,4.1A47.879,47.879,0,0,0,83.244,53.8c-.386.839-.754,1.695-1.125,2.559-.2.43-.363.868-.554,1.306l-.267.659c-.09.213-.178.459-.24.633l-.025.07a.193.193,0,0,1-.248.114A.2.2,0,0,1,80.664,59.008Z",transform:"translate(-3.081 -5.835)",fill:"#ffffff"}),s.jsx("path",{id:"Path_886","data-name":"Path 886",d:"M81.873,58.957c-.063-.175-.149-.42-.241-.633l-.267-.659c-.189-.438-.354-.876-.554-1.306-.37-.865-.739-1.72-1.123-2.559a48.218,48.218,0,0,0-2.477-4.838,18.487,18.487,0,0,0-3.18-4.1A10.833,10.833,0,0,0,69.409,42.3l0,0a.191.191,0,0,1-.13-.236.2.2,0,0,1,.135-.132A7.74,7.74,0,0,1,75.416,43a13.118,13.118,0,0,1,4.248,4.5,20.309,20.309,0,0,1,2.705,8.488c.033.493.063.989.056,1.487a6.664,6.664,0,0,1-.159,1.541.193.193,0,0,1-.368.019Z",transform:"translate(-9.675 -5.835)",fill:"#ffffff"}),(0,s.jsxs)("g",{id:"Group_1284","data-name":"Group 1284",transform:"translate(0 57.147)",children:[s.jsx("path",{id:"Path_887","data-name":"Path 887",d:"M48.5,63.117V74.659a1.605,1.605,0,1,1-3.208,0V63.491c0-3.291-2.042-5.416-5.041-5.416a5.163,5.163,0,0,0-5.333,5.416V74.659a1.605,1.605,0,1,1-3.208,0V56.784a1.61,1.61,0,0,1,1.625-1.666,1.629,1.629,0,0,1,1.584,1.666v.749a8.317,8.317,0,0,1,6.041-2.415C45.586,55.118,48.5,58.242,48.5,63.117Z",transform:"translate(-31.711 -55.118)",fill:"#ffffff"}),s.jsx("path",{id:"Path_888","data-name":"Path 888",d:"M65.279,64.493V64.7a1.772,1.772,0,0,1-1.958,2H48.988a7.165,7.165,0,0,0,7.458,6.668,8.063,8.063,0,0,0,5.292-1.958,1.666,1.666,0,0,1,1.084-.459,1.378,1.378,0,0,1,1.415,1.415,1.862,1.862,0,0,1-.792,1.46,10.79,10.79,0,0,1-7.04,2.5,10.605,10.605,0,0,1-.376-21.207A8.984,8.984,0,0,1,65.279,64.493Zm-16.166-.625H61.986a5.747,5.747,0,0,0-6.041-5.833A6.918,6.918,0,0,0,49.113,63.867Z",transform:"translate(-23.53 -55.118)",fill:"#ffffff"}),s.jsx("path",{id:"Path_889","data-name":"Path 889",d:"M81.9,65.7A10.625,10.625,0,1,1,71.273,55.118,10.563,10.563,0,0,1,81.9,65.7Zm-17.959.043a7.267,7.267,0,0,0,7.293,7.582,7.631,7.631,0,1,0-7.293-7.582Z",transform:"translate(-14.732 -55.118)",fill:"#ffffff"}),s.jsx("path",{id:"Path_890","data-name":"Path 890",d:"M82.669,55.407H87.71a1.437,1.437,0,1,1,0,2.874H82.669V69.364c0,2.667,1.376,3.875,4.292,3.875.708,0,1.208-.084,1.666-.084a1.291,1.291,0,0,1,1.458,1.25,1.431,1.431,0,0,1-1.166,1.458,8.954,8.954,0,0,1-2.624.292c-4.418,0-6.834-2.333-6.834-6.583V58.281H77.377a1.438,1.438,0,1,1,0-2.874h2.083",transform:"translate(-5.796 -54.948)",fill:"#ffffff"}),s.jsx("path",{id:"Path_891","data-name":"Path 891",d:"M98.757,56.909a1.5,1.5,0,0,1-1.625,1.5,5.984,5.984,0,0,0-6.334,6v10.25a1.605,1.605,0,1,1-3.208,0V56.784a1.611,1.611,0,0,1,1.626-1.666A1.627,1.627,0,0,1,90.8,56.784v1.5a8.145,8.145,0,0,1,6.334-2.875A1.526,1.526,0,0,1,98.757,56.909Z",transform:"translate(1.076 -55.118)",fill:"#ffffff"}),s.jsx("path",{id:"Path_892","data-name":"Path 892",d:"M115.537,64.493V64.7a1.772,1.772,0,0,1-1.958,2H99.246a7.166,7.166,0,0,0,7.459,6.668A8.059,8.059,0,0,0,112,71.409a1.673,1.673,0,0,1,1.084-.459,1.379,1.379,0,0,1,1.417,1.415,1.862,1.862,0,0,1-.792,1.46,10.791,10.791,0,0,1-7.042,2.5,10.605,10.605,0,0,1-.374-21.207A8.984,8.984,0,0,1,115.537,64.493Zm-16.166-.625h12.875a5.748,5.748,0,0,0-6.041-5.833A6.921,6.921,0,0,0,99.372,63.867Z",transform:"translate(5.961 -55.118)",fill:"#ffffff"}),s.jsx("path",{id:"Path_893","data-name":"Path 893",d:"M130.531,64.493V64.7a1.772,1.772,0,0,1-1.958,2H114.24a7.166,7.166,0,0,0,7.459,6.668,8.059,8.059,0,0,0,5.29-1.958,1.67,1.67,0,0,1,1.084-.459,1.379,1.379,0,0,1,1.417,1.415,1.862,1.862,0,0,1-.792,1.46,10.791,10.791,0,0,1-7.042,2.5,10.605,10.605,0,0,1-.374-21.207A8.984,8.984,0,0,1,130.531,64.493Zm-16.166-.625H127.24a5.749,5.749,0,0,0-6.041-5.833A6.919,6.919,0,0,0,114.366,63.867Z",transform:"translate(14.758 -55.118)",fill:"#ffffff"})]}),s.jsx("path",{id:"Path_894","data-name":"Path 894",d:"M69.853,22.729a1.984,1.984,0,0,1,.4,1.282,1.935,1.935,0,0,1-.611,1.365,1.81,1.81,0,0,1-1.452.438,2.047,2.047,0,0,1-1.206-.592l1.142-.335a1.771,1.771,0,0,0,.719-.4A5.347,5.347,0,0,0,69.853,22.729Z",transform:"translate(-11.015 -16.976)",fill:"#ffffff"}),s.jsx("path",{id:"Path_895","data-name":"Path 895",d:"M70.662,26.239a11.037,11.037,0,0,1,1.073-1.157c.178-.186.308-.428.551-.5a1.653,1.653,0,0,1,.911-.008.1.1,0,0,1,.075.092,1.338,1.338,0,0,1-.309.9,1.393,1.393,0,0,1-.724.328,15.275,15.275,0,0,1-1.509.447.063.063,0,0,1-.078-.043A.069.069,0,0,1,70.662,26.239Z",transform:"translate(-8.864 -15.929)",fill:"#ffffff"}),s.jsx("path",{id:"Path_896","data-name":"Path 896",d:"M72.955,21.678a1.327,1.327,0,0,1-.068,1.092,1.433,1.433,0,0,1-.993.754,1.536,1.536,0,0,1-1.173-.27,1.584,1.584,0,0,1-.6-.889,9.644,9.644,0,0,0,1.549-.008A3.35,3.35,0,0,0,72.955,21.678Z",transform:"translate(-9.176 -17.592)",fill:"#ffffff"}),s.jsx("path",{id:"Path_897","data-name":"Path 897",d:"M81.24,26.792A13.745,13.745,0,0,0,78.51,22.63a7.648,7.648,0,0,0-4.118-2.34,7.9,7.9,0,0,0-4.6.687,10.032,10.032,0,0,0-3.757,2.717,8.985,8.985,0,0,0-1.479,8.549,7.885,7.885,0,0,0,6.184,5.476,1.318,1.318,0,0,1,1.084.982l.019.071a12.176,12.176,0,0,0,3.956,5.99,20.038,20.038,0,0,0,6.525,3.74c4.775,1.785,10.049,1.176,14.774-.8a23.673,23.673,0,0,0,6.414-4.113,20.209,20.209,0,0,0,2.585-2.78,14.245,14.245,0,0,0,1.89-3.166,5.645,5.645,0,0,0,.408-3.213,5.01,5.01,0,0,0-1.661-2.739,11.55,11.55,0,0,0-6.764-2.6l.168-.013a48.305,48.305,0,0,1-7.551.073c-1.242-.083-2.48-.187-3.713-.325l-1.845-.217a4.589,4.589,0,0,0-1.718-.027,15.026,15.026,0,0,0-6.3,3.351,11.97,11.97,0,0,0-2.417,2.707,4.6,4.6,0,0,0-.76,3.478,4.717,4.717,0,0,1,.557-3.594,12.335,12.335,0,0,1,2.306-2.937,15.473,15.473,0,0,1,6.452-3.811,6.707,6.707,0,0,1,1.956-.108l1.839.04c1.227.016,2.45,0,3.67-.036a53.618,53.618,0,0,0,7.2-.592.926.926,0,0,1,.148-.013h.021a13.292,13.292,0,0,1,8.353,2.751,7.582,7.582,0,0,1,2.658,4.022,8.228,8.228,0,0,1-.4,4.792c-2.329,5.611-7,9.549-12.25,11.917a25.592,25.592,0,0,1-8.4,2.122,20.71,20.71,0,0,1-8.649-1.25,21.868,21.868,0,0,1-7.488-4.446,14.962,14.962,0,0,1-4.646-7.6l1.1,1.054a9.839,9.839,0,0,1-5.093-2.648,10.939,10.939,0,0,1-2.842-4.857A10.542,10.542,0,0,1,69.3,19.7a9.073,9.073,0,0,1,5.3-.341,8.4,8.4,0,0,1,4.314,2.916A13.477,13.477,0,0,1,81.24,26.792Z",transform:"translate(-14.001 -19.103)",fill:"#ffffff"})]})})]})});return t?s.jsx(r.default,{href:t,children:l}):l}},2946:(e,t,a)=>{"use strict";a.d(t,{z:()=>o});var s=a(19510),r=a(71159),i=a(43025),n=a(46145),d=a(50650);let l=(0,n.j)(`
    inline-flex
    items-center
    justify-center
    whitespace-nowrap
    rounded-md
    text-sm
    font-medium
    transition-colors
    focus-visible:outline-none
    disabled:pointer-events-none
    disabled:opacity-50
  `,{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"border border-input bg-background hover:bg-primary/20","primary-outline":"border border-primary text-primary bg-transparent hover:bg-primary/20",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/90",ghost:"hover:bg-primary/20 hover:text-primary",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),o=r.forwardRef(({className:e,variant:t,size:a,asChild:r=!1,...n},o)=>{let c=r?i.g7:"button";return s.jsx(c,{className:(0,d.cn)(l({variant:t,size:a,className:e})),ref:o,...n})});o.displayName="Button"},92963:(e,t,a)=>{"use strict";a.d(t,{sj:()=>f,LR:()=>u,h:()=>p,UZ:()=>c});var s=a(57745),r=a(81445),i=a(9576),n=a(57435),d=a(10413),l=a(93567),o=a(88317);async function c({data:e,broadcastAction:t,userId:a}){let c={success:!1};try{let t=[];for(let{configKeyId:n,...o}of e)try{let e=n||i.Z();if(!t.length){let t=n?await d.Z.query.configKeysDrafts.findFirst({where:(0,s.eq)(l.configKeysDrafts.configKeyDraftId,e)}):null,i=t||!n?null:await d.Z.query.configKeys.findFirst({where:(0,s.eq)(l.configKeys.configKeyId,e)});if(t){let a={...t.data,...o};await d.Z.update(l.configKeysDrafts).set({data:a,position:a.position}).where((0,s.eq)(l.configKeysDrafts.configKeyDraftId,e))}else{let t=o.position||i?.position;if(!t){let e=await d.Z.query.configKeys.findFirst({columns:{position:!0},orderBy:(0,r.C)(l.configKeys.position)}),a=await d.Z.query.configKeysDrafts.findFirst({columns:{position:!0},orderBy:(0,r.C)(l.configKeysDrafts.position)});t=Math.max(0,e?.position||0,a?.position||0)+1}let s={...i,...o,configKeyId:e,version:i?.version?i.version+1:1,position:t};await d.Z.insert(l.configKeysDrafts).values({data:s,configKeyDraftId:e,position:s.position,configKeyId:i?.configKeyId,createdByUserId:a})}}}catch(e){t.push(e.message)}t.length?c.errors=t:c.success=!0}catch(e){c.success=!1,c.errors=[e.message],n.Z.error("_saveConfigKeys ERROR",e.message)}finally{return!c?.errors?.length&&t&&o.Z.emit("data_changed","save_config_keys"),c}}async function f(e){try{return await d.Z.delete(l.configKeysDrafts).where(e?.userId?(0,s.eq)(l.configKeysDrafts.createdByUserId,e.userId):void 0),!0}catch(e){throw e}}async function u({configKeysIds:e,broadcastAction:t,userId:a}){let r={success:!1};try{if(e.length){await d.Z.delete(l.configKeysDrafts).where((0,s.d3)(l.configKeysDrafts.configKeyDraftId,e));let t=(await d.Z.select({configKeyId:l.configKeys.configKeyId,pendingDeletion:l.pendingDeletion.configKeyId}).from(l.configKeys).leftJoin(l.pendingDeletion,(0,s.eq)(l.pendingDeletion.configKeyId,l.configKeys.configKeyId)).where((0,s.d3)(l.configKeys.configKeyId,e))).filter(e=>!e.pendingDeletion).map(e=>({...e,createdByUserId:a}));t.length&&await d.Z.insert(l.pendingDeletion).values(t)}r.success=!0}catch(e){r.success=!1,r.errors=[e.message],n.Z.error("_deleteConfigKeys ERROR",e.message)}finally{return!r?.errors?.length&&t&&o.Z.emit("data_changed","delete_config_keys"),r}}async function g({previous:e,drafts:t,userId:a}){let s=[];try{let r=[];for(let i of t){let t=i?.data?.configKeyId;if(!t)continue;let n={version:i?.data?.version||1,configKeyId:t,changes:{}},d=1===(i?.data?.version||1);if(d)n.changes={action:"create_config_key",description:"Create config key",oldValues:[],newValues:[]};else{let a=e.find(e=>e.configKeyId===t),s=[],r=[];Object.keys({...i?.data}).filter(e=>!["version","draft"].includes(e)).forEach(e=>{let t=i.data[e],n={...a}[e];JSON.stringify(t)!==JSON.stringify(n)&&(s.push({[e]:n}),r.push({[e]:t}))}),n.changes={action:"update_config_key",description:"Update config key",oldValues:s,newValues:r}}if(r.push(n),a){let{...r}=i.data||{},l=JSON.parse(JSON.stringify(r)),o=d?{}:JSON.parse(JSON.stringify(e.find(e=>e.configKeyId===t)||{}));s.push({entityId:t,entityType:"config_key",action:d?"create":"update",version:n.version||1,changes:n.changes,fullSnapshot:l,previousSnapshot:o,baselineSnapshot:o,userId:a,configKeyId:t})}}r.length&&await d.Z.insert(l.configKeysHistory).values(r)}catch(e){n.Z.error(e.message)}return s}var h=a(34149),m=a(36864);async function p(e){let t={success:!1},a=[];try{let r=[],o=[],c=await d.Z.query.configKeysDrafts.findMany({where:e?.userId?(0,s.eq)(l.configKeysDrafts.createdByUserId,e?.userId):void 0});if(r=c.filter(e=>e.configKeyId),o=c.filter(e=>!e.configKeyId),r.length){let t=[];for(let{configKeyId:e,data:a}of(r.filter(e=>e.configKeyId).length&&(t=await d.Z.query.configKeys.findMany({where:(0,s.d3)(l.configKeys.configKeyId,r.filter(e=>e.configKeyId).map(e=>e.configKeyId))})),r)){let{configKeyId:t,id:r,oldConfigKeyId:i,createdAt:n,updatedAt:o,deletedAt:c,...f}=a,u={...f,publishDate:new Date};await d.Z.update(l.configKeys).set(u).where((0,s.eq)(l.configKeys.configKeyId,e)).returning()}let i=await g({drafts:r,previous:t,userId:e?.publisherUserId});a.push(...i.map(t=>({...t,dataVersion:e?.dataVersion})))}if(o.length){let t=[];for(let{id:e,data:a}of(o.filter(e=>e.configKeyId).length&&(t=await d.Z.query.configKeys.findMany({where:(0,s.d3)(l.configKeys.configKeyId,o.filter(e=>e.configKeyId).map(e=>e.configKeyId))})),o)){let t=a.configKeyId||(0,i.Z)(),s={...a,configKeyId:t};o=o.map(a=>(a.id===e&&(a.data.configKeyId=t),a)),await d.Z.insert(l.configKeys).values(s)}let r=await g({drafts:o,previous:t,userId:e?.publisherUserId});a.push(...r.map(t=>({...t,dataVersion:e?.dataVersion})))}await d.Z.delete(l.configKeysDrafts).where(e?.userId?(0,s.eq)(l.configKeysDrafts.createdByUserId,e.userId):void 0);let f=await d.Z.query.pendingDeletion.findMany({where:(0,s.xD)((0,s.K0)(l.pendingDeletion.configKeyId),e?.userId?(0,s.eq)(l.pendingDeletion.createdByUserId,e.userId):void 0),columns:{configKeyId:!0},with:{configKey:!0}});if((f=f.filter(e=>e.configKey)).length){let t=new Date;await d.Z.update(l.configKeys).set({deletedAt:t}).where((0,s.d3)(l.configKeys.configKeyId,f.map(e=>e.configKeyId)));let r=f.map(e=>({version:e.configKey.version,configKeyId:e.configKeyId,changes:{action:"delete_config_key",description:"Delete config key",oldValues:[{deletedAt:null}],newValues:[{deletedAt:t}]}}));if(await d.Z.insert(l.configKeysHistory).values(r),e?.publisherUserId)for(let s=0;s<f.length;s++){let i=f[s],n=r[s];if(!i?.configKeyId)continue;let d={...i.configKey??{},deletedAt:t};a.push({entityId:i.configKeyId,entityType:"config_key",action:"delete",version:n.version||1,dataVersion:e.dataVersion,changes:n.changes,fullSnapshot:JSON.parse(JSON.stringify(d)),previousSnapshot:JSON.parse(JSON.stringify(d)),baselineSnapshot:JSON.parse(JSON.stringify(d)),description:n.changes.description,userId:e.publisherUserId,configKeyId:i.configKeyId,isActive:!1})}}await d.Z.delete(l.pendingDeletion).where((0,s.xD)((0,s.or)((0,s.K0)(l.pendingDeletion.configKeyId),(0,s.K0)(l.pendingDeletion.configKeyDraftId)),e?.userId?(0,s.eq)(l.pendingDeletion.createdByUserId,e.userId):void 0));let u=[...r.map(e=>e.configKeyId),...f.map(e=>e.configKeyId)];if(u.length&&await d.Z.update(l.configKeys).set({version:(0,h.i6)`${l.configKeys.version} + 1`}).where((0,s.d3)(l.configKeys.configKeyId,u)),a.length){let e=await (0,m.F)({data:a,allowPartial:!0});e.errors?.length&&n.Z.error("_publishConfigKeys changelog warnings",e.errors.join(", "))}t.success=!0}catch(e){t.success=!1,t.errors=[e.message],n.Z.error("_publishConfigKeys ERROR",e)}finally{return t}}},17137:(e,t,a)=>{"use strict";a.d(t,{G$:()=>g,ZV:()=>u,SL:()=>c,aP:()=>o});var s=a(57745),r=a(30900),i=a(9576),n=a(10413),d=a(93567),l=a(57435);async function o(e){try{let{configKeysIds:t,returnDraftsIfExist:a}={...e},l=t||[],o=l?.length?(0,s.d3)(d.configKeysDrafts.configKeyDraftId,l.map(e=>r.Z(e)?e:i.Z())):void 0,c=[...o?[o]:[]],f=a?await n.Z.query.configKeysDrafts.findMany({where:(0,s.xD)(...c)}):[];l=l.filter(e=>!f.map(e=>e.configKeyDraftId).includes(e));let u=f.length?(0,s.Nl)(d.configKeys.configKeyId,f.map(e=>e.configKeyDraftId)):void 0,g=l?.length?(0,s.d3)(d.configKeys.configKeyId,l.filter(e=>r.Z(e))):void 0,h=l?.length?(0,s.d3)(d.configKeys.oldConfigKeyId,l.filter(e=>!r.Z(e))):void 0,m=[(0,s.Ft)(d.configKeys.deletedAt),(0,s.Ft)(d.pendingDeletion),...g&&h?[(0,s.or)(g,h)]:[],u],p=(await n.Z.select({configKey:d.configKeys,pendingDeletion:d.pendingDeletion}).from(d.configKeys).leftJoin(d.pendingDeletion,(0,s.eq)(d.pendingDeletion.configKeyId,d.configKeys.configKeyId)).where(m.length?(0,s.xD)(...m):void 0)).map(e=>e.configKey),y=p.length?await n.Z.query.pendingDeletion.findMany({where:(0,s.d3)(d.pendingDeletion.configKeyId,p.map(e=>e.configKeyId)),columns:{configKeyId:!0}}):[];return{data:[...p.map(e=>({...e,isDraft:!1,isDeleted:!1})),...f.map(e=>({...e.data,isDraft:!0,isDeleted:!1,draftCreatedByUserId:e.createdByUserId}))].sort((e,t)=>e.position-t.position).filter(e=>!y.map(e=>e.configKeyId).includes(e.configKeyId))}}catch(e){return l.Z.error("_getConfigKeys ERROR",e.message),{data:[],errors:[e.message]}}}async function c(e){let{configKeyId:t,returnDraftIfExists:a}={...e};try{if(!t)throw Error("Missing configKeyId");let e=r.Z(t)?(0,s.eq)(d.configKeys.configKeyId,t):void 0,i=r.Z(t)?void 0:(0,s.eq)(d.configKeys.oldConfigKeyId,t),l=e?(0,s.eq)(d.configKeysDrafts.configKeyDraftId,t):void 0,o=a&&l?await n.Z.query.configKeysDrafts.findFirst({where:e}):void 0,c=o?{...o.data,draftCreatedByUserId:o.createdByUserId,isDraft:!0,isDeleted:!1}:null;if(c)return{data:c};let f=await n.Z.query.configKeys.findFirst({where:(0,s.xD)((0,s.Ft)(d.configKeys.deletedAt),e||i),with:{draft:!0}});o=a?f?.draft:void 0;let u=o?.data||f;if(!(c=u?{...u,draftCreatedByUserId:o?.createdByUserId,isDraft:!!o?.data,isDeleted:!1}:null))return{data:null};return{data:c}}catch(e){return l.Z.error("_getConfigKey ERROR",e.message),{errors:[e.message]}}}var f=a(60938);let u={allPublished:0,publishedWithDrafts:0,allDrafts:0,newDrafts:0,pendingDeletion:0};async function g(){try{let[{count:e}]=await n.Z.select({count:(0,f.QX)()}).from(d.configKeysDrafts),[{count:t}]=await n.Z.select({count:(0,f.QX)()}).from(d.configKeysDrafts).where((0,s.Ft)(d.configKeysDrafts.configKeyId)),[{count:a}]=await n.Z.select({count:(0,f.QX)()}).from(d.configKeysDrafts).where((0,s.K0)(d.configKeysDrafts.configKeyId)),[{count:r}]=await n.Z.select({count:(0,f.QX)()}).from(d.pendingDeletion).where((0,s.K0)(d.pendingDeletion.configKeyId)),[{count:i}]=await n.Z.select({count:(0,f.QX)()}).from(d.configKeys);return{data:{allPublished:i,publishedWithDrafts:a,allDrafts:e,newDrafts:t,pendingDeletion:r}}}catch(e){return l.Z.error("_getConfigKeys ERROR",e.message),{data:u,errors:[e.message]}}}},18496:(e,t,a)=>{"use strict";a.d(t,{y:()=>i});var s=a(10413),r=a(57435);async function i(){try{return{data:await s.Z.query.editorInfo.findFirst()||null}}catch(e){return r.Z.error("_getEditorInfo ERROR",e.message),{data:null,errors:[e.message]}}}},25060:(e,t,a)=>{"use strict";a.d(t,{Yi:()=>u,Ur:()=>c,Nb:()=>o,Ic:()=>f});var s=a(60938),r=a(57435),i=a(93567),n=a(10413),d=a(81445);let l={configKeys:null,diagnoses:null,screens:null,scripts:null,configKeysDrafts:null,diagnosesDrafts:null,screensDrafts:null,scriptsDrafts:null,pendingDeletion:null,lastPublished:null,latestChangesDate:null};async function o(){try{let{lastPublishDate:e}={...await n.Z.query.editorInfo.findFirst()},t=await n.Z.select({configKeysDrafts:i.configKeysDrafts.updatedAt}).from(i.configKeysDrafts).orderBy((0,d.C)(i.configKeysDrafts.updatedAt)).limit(1),a=await n.Z.select({diagnosesDrafts:i.diagnosesDrafts.updatedAt}).from(i.diagnosesDrafts).orderBy((0,d.C)(i.diagnosesDrafts.updatedAt)).limit(1),s=await n.Z.select({screensDrafts:i.screensDrafts.updatedAt}).from(i.screensDrafts).orderBy((0,d.C)(i.screensDrafts.updatedAt)).limit(1),r=await n.Z.select({scriptsDrafts:i.scriptsDrafts.updatedAt}).from(i.scriptsDrafts).orderBy((0,d.C)(i.scriptsDrafts.updatedAt)).limit(1),o=await n.Z.select({configKeys:i.configKeys.updatedAt}).from(i.configKeys).orderBy((0,d.C)(i.configKeys.updatedAt)).limit(1),c=await n.Z.select({diagnoses:i.diagnoses.updatedAt}).from(i.diagnoses).orderBy((0,d.C)(i.diagnoses.updatedAt)).limit(1),f=await n.Z.select({screens:i.screens.updatedAt}).from(i.screens).orderBy((0,d.C)(i.screens.updatedAt)).limit(1),u=await n.Z.select({scripts:i.scripts.updatedAt}).from(i.scripts).orderBy((0,d.C)(i.scripts.updatedAt)).limit(1),g=await n.Z.select({pendingDeletion:i.pendingDeletion.createdAt}).from(i.pendingDeletion).orderBy((0,d.C)(i.pendingDeletion.createdAt)).limit(1),h={...l,...t[0],...a[0],...s[0],...r[0],...o[0],...c[0],...f[0],...u[0],...g[0],lastPublished:e||null},m=[e?new Date(e).getTime():null,...Object.values(h).filter(e=>e).map(e=>new Date(e).getTime())].filter(e=>e),p=e;return m.length&&(p=new Date(Math.max(...m))),{data:{...h,latestChangesDate:p}}}catch(e){return r.Z.error("_getDatesWhenUpdatesWereMade ERROR",e.message),{data:l,errors:[e.message]}}}async function c(){try{let e=await n.Z.select({count:(0,s.QX)()}).from(i.pendingDeletion);return{total:e[0]?.count||0}}catch(e){return r.Z.error("_countPendingDeletion ERROR",e.message),{total:0,errors:[e.message]}}}let f={scripts:0,screens:0,diagnoses:0,configKeys:0,hospitals:0,drugsLibraryItems:0,total:0,dataKeys:0};async function u(){let e={...f};try{let t=await n.Z.select({count:(0,s.QX)()}).from(i.scriptsDrafts);e.scripts=t[0]?.count||0;let a=await n.Z.select({count:(0,s.QX)()}).from(i.screensDrafts);e.screens=a[0]?.count||0;let r=await n.Z.select({count:(0,s.QX)()}).from(i.diagnosesDrafts);e.diagnoses=r[0]?.count||0;let d=await n.Z.select({count:(0,s.QX)()}).from(i.configKeysDrafts);e.configKeys=d[0]?.count||0;let l=await n.Z.select({count:(0,s.QX)()}).from(i.hospitalsDrafts);e.hospitals=l[0]?.count||0;let o=await n.Z.select({count:(0,s.QX)()}).from(i.drugsLibraryDrafts);e.drugsLibraryItems=o[0]?.count||0;let c=await n.Z.select({count:(0,s.QX)()}).from(i.dataKeysDrafts);return e.dataKeys=c[0]?.count||0,e.total=Object.values(e).reduce((e,t)=>e+t,0),{...e}}catch(t){return r.Z.error("_countDrafts ERROR",t.message),{...e,errors:[t.message]}}}},20123:(e,t,a)=>{"use strict";a.d(t,{Ng:()=>c,_U:()=>h,QF:()=>o,YF:()=>g});var s=a(57745),r=a(81445),i=a(30900),n=a(10413),d=a(93567),l=a(57435);async function o(e){try{let{sitesIds:t,types:a=[],envs:l=[],links:o=[]}={...e},c=t||[],f=c?.length?(0,s.d3)(d.sites.siteId,c.filter(e=>i.Z(e))):void 0;o.length&&[...o].forEach(e=>{o.push(e.replace("http:","https:")),o.push(e.replace("https","http"))});let u=[(0,s.Ft)(d.sites.deletedAt),f,a.length?(0,s.d3)(d.sites.type,a):void 0,l.length?(0,s.d3)(d.sites.env,l):void 0,o.length?(0,s.d3)(d.sites.link,o):void 0];return{data:(await n.Z.select({site:d.sites}).from(d.sites).where(u.length?(0,s.xD)(...u):void 0).orderBy((0,r.d)(d.sites.id))).map(e=>e.site)}}catch(e){return l.Z.error("_getSites ERROR",e.message),{data:[],errors:[e.message]}}}async function c(e){let{siteId:t}={...e};try{if(!t)throw Error("Missing siteId");let e=i.Z(t)?(0,s.eq)(d.sites.siteId,t):void 0;return{data:await n.Z.query.sites.findFirst({where:(0,s.xD)((0,s.Ft)(d.sites.deletedAt),e)})}}catch(e){return l.Z.error("_getSite ERROR",e.message),{errors:[e.message]}}}var f=a(8328);let u=()=>{let e=(0,f.w)();return{webeditor:{name:"Local editor",siteId:"fb76af5a-bf86-4050-821e-44f1bf316bf4",link:e.origin,type:"webeditor",apiKey:"localhost"},nodeapi:{name:"Local editor",siteId:"5cb4aa54-2cfe-49e2-9cdd-392a9b8c124e",link:e.origin,type:"webeditor",apiKey:"localhost"}}};async function g(e){try{let{types:t=[]}={...e},a=[...t.length?[(0,s.d3)(d.sites.type,t)]:[]],r=await n.Z.query.sites.findMany({where:a.length?(0,s.xD)(...a):void 0,columns:{siteId:!0,type:!0,name:!0,link:!0}});return u(),{data:[...r]}}catch(e){return l.Z.error("_getSites ERROR",e.message),{data:[],errors:[e.message]}}}async function h(e){try{let t=await n.Z.query.sites.findFirst({where:(0,s.eq)(d.sites.siteId,e),columns:{apiKey:!0,link:!0}}),a=t||null;if(!t){let t=u();Object.values(t).forEach(t=>{t.siteId===e&&(a={link:t.link,apiKey:t.apiKey})})}return{data:a}}catch(e){return l.Z.error("_getSiteApiKey ERROR",e.message),{data:null,errors:[e.message]}}}},8328:(e,t,a)=>{"use strict";a.d(t,{w:()=>r});var s=a(71615);function r(){let e=(0,s.headers)(),t=e.get("x-api-key"),a=e.get("x-bearer-token"),r=e.get("x-url"),i=e.get("x-next-url-host"),n=e.get("x-next-url-href"),d=e.get("x-next-url-port"),l=e.get("x-next-url-hostname"),o=e.get("x-next-url-pathname"),c=e.get("x-next-url-search"),f=e.get("x-next-url-protocol"),u=e.get("x-next-url-username"),g=e.get("x-next-url-locale"),h=e.get("x-next-url-origin"),m=e.get("x-geo-city"),p=e.get("x-geo-country");return{apiKey:t,bearerToken:a,url:r||"",host:i||"",href:n||"",port:d||"",hostname:l||"",pathname:o||"",search:c||"",protocol:f||"",username:u||"",locale:g||"",origin:h||"",city:m||"",country:p||"",region:e.get("x-geo-region")||"",latitude:e.get("x-geo-latitude")||"",longitude:e.get("x-geo-longitude")||""}}},3641:()=>{},5286:(e,t,a)=>{"use strict";a.d(t,{U:()=>n});var s=a(24263),r=a(57435),i=a(20123);async function n(e,t){let a=t?.link,n=t?.baseURL;if(!e)throw Error("AXIOS init error: missing siteId");if(!t){let t=await (0,i._U)(e);if(t.errors?.length)throw Error("AXIOS init error: "+t.errors.join(", "));if(!t.data)throw Error("AXIOS init error: site not found");a=t.data.link,n=t.data.apiKey}let d=s.Z.create({baseURL:a});return d.interceptors.request.use(async e=>(e.headers&&(e.headers["x-api-key"]=n),r.Z.log(`AXIOS [${e.method}]`,[`${a}/api`,e.url].join("")),e)),d.interceptors.response.use(e=>e,e=>new Promise((t,a)=>a(e))),d}},50650:(e,t,a)=>{"use strict";a.d(t,{cn:()=>i});var s=a(55761),r=a(62386);function i(...e){return(0,r.m6)((0,s.W)(e))}},67272:()=>{}};