"use strict";exports.id=3591,exports.ids=[3591,7636],exports.modules={96948:(e,a,t)=>{t.d(a,{Alert:()=>r});var l=t(96221),s=t(35047);function r(e){(0,s.useRouter)();let{alert:a}=(0,l.s)();return null}t(17577)},7636:(e,a,t)=>{t.d(a,{DataTable:()=>C});var l=t(10326),s=t(17577),r=t(9439),i=t(61541),n=t(99598),o=t(15940),d=t(77863),c=t(90772),u=t(53313),m=t(65304),h=t(61198),p=t(60097),f=t(79256),y=t(25696),b=t(91216),g=t(47206);let x=[{value:"asc",label:"Asc",Icon:f.Z},{value:"desc",label:"Desc",Icon:y.Z},{value:"hide",label:"Hide",divider:!0,Icon:b.Z}],v=({column:e,value:a,onFilter:t})=>{let s=x.filter(e=>e.value===a)[0],r=s?.Icon||g.Z;return(0,l.jsxs)(p.h_,{children:[l.jsx(p.$F,{asChild:!0,children:(0,l.jsxs)(c.z,{variant:"ghost",size:"sm",className:"   focus-visible:ring-0    focus-visible:ring-transparent    focus-visible:ring-offset-0   ",children:[l.jsx("span",{className:"mr-2",children:e.name}),l.jsx(r,{className:"w-4 h-4"})]})}),l.jsx(p.AW,{align:"end",children:x.filter(a=>"hide"!==a.value||!1!==e.canHide).map(e=>(0,l.jsxs)(p.Xi,{onClick:()=>t(e.value),className:(0,d.cn)(e.divider?"border-t":""),children:[l.jsx(e.Icon,{className:"w-4 h-4 mr-2"}),e.label]},e.value))})]})},w=(0,s.forwardRef)(({searchButton:e,hideSearchButton:a,...t},s)=>l.jsx(l.Fragment,{children:(0,l.jsxs)("div",{className:(0,d.cn)("flex w-full"),children:[l.jsx("div",{className:(0,d.cn)("relative w-full"),children:l.jsx("input",{ref:s,type:"search",placeholder:"Search",...t,className:(0,d.cn)("w-full pl-4 py-2 rounded-l-full border focus:outline-none focus:border-secondary bg-transparent",t.className)})}),!a&&l.jsx("button",{type:"button",className:(0,d.cn)("px-5 py-2.5 transition-colors bg-transparent border border-l-0 rounded-r-full hover:bg-secondary/10 disabled:opacity-50 disabled:cursor-not-allowed",e?.className),...e,children:l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"size-5",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"})})})]})}));function N({title:e,search:a,headerActions:t}){let r=!a&&!e&&!t,[i,n]=(0,s.useState)(a?.value||"");return r?null:l.jsx(l.Fragment,{children:l.jsx("div",{className:"px-4 py-4 flex flex-col gap-y-2",children:(0,l.jsxs)("div",{className:"flex flex-col gap-y-2 md:flex-row md:gap-y-0 md:gap-x-2",children:[(0,l.jsxs)("div",{className:(0,d.cn)("flex items-center gap-x-2",!e&&"hidden"),children:[!!e&&l.jsx("div",{className:(0,d.cn)("md:mr-auto","string"==typeof e?"text-2xl":""),children:e}),l.jsx("div",{className:"ml-auto"})]}),l.jsx("div",{className:(0,d.cn)("flex-1",!a&&"hidden"),children:!!a&&l.jsx("form",{onSubmit:e=>{e.preventDefault(),e.stopPropagation(),i&&a?.setValue?.(i)},children:l.jsx(w,{placeholder:a?.inputPlaceholder||"Search",value:i,onChange:e=>{let t=e.target.value;n(t),t||a?.setValue?.(t)},searchButton:{type:"submit"}})})}),l.jsx("div",{className:(0,d.cn)("flex flex-row flex-wrap gap-x-2 gap-y-1 md:ml-auto",!t&&"hidden"),children:t})]})})})}w.displayName="SearchInput";let C=e=>{let{selectable:a=!1,loading:t,sortable:p,tableClassname:f,tableRowClassname:y,tableBodyClassname:b,filter:g,onSort:x}=e,w=(0,s.useRef)(null),{searchValue:C,state:{columns:k,rows:j,skeletonRows:I,selected:S},setSearchValue:D,setState:T,setFilter:_,setSelected:A,toggleColumn:R}=function({props:e}){(0,s.useRef)(!1);let{selectable:a,sortable:t,selectedIndexes:l,columns:r,data:i,maxRows:n,search:o,onFilteredRowsChange:d,onSelect:c}=e,[u,m]=(0,s.useState)(""),p=(0,h.N)(o?.value||u),f=(0,s.useCallback)((e="")=>{m(e),o?.setValue?.(e)},[o]),[y,b]=(0,s.useState)({selected:{},columns:[],unfilteredRows:[],rows:[],skeletonRows:[]});(0,s.useCallback)(()=>a?{...l?.reduce((e,a)=>({...e,[a]:!0}),{})}:{},[l,a]);let g=(0,s.useCallback)(e=>{let a=[];b(t=>{let l=e.length===t.rows.length,s=Object.values(t.selected).filter(e=>e).length===t.rows.length,r={...t.selected};return e.forEach(e=>{r[e]=l?!s:!r[e]}),a=Object.keys(r).filter(e=>r[e]).map(e=>Number(e)),{...t,selected:r}}),c?.(a)},[b,c]);return{state:y,searchValue:p,setSearchValue:f,setState:b,setSelected:g,toggleColumn:e=>b(a=>{let t=[...a.columns].map(a=>({...a,filter:null,hidden:a.columnIndex===e?!a.hidden:a.hidden}));return{...a,columns:t}}),setFilter:(e,a)=>b(t=>{let l=[...t.columns].map(t=>{let l=t.columnIndex===e?a:null;return{...t,filter:l}}),s=l.filter(a=>a.columnIndex===e)[0],r=[...t.rows];return a&&(r=function({column:e,rows:a}){return a.sort((a,t)=>{let l=a.cells.filter(a=>a.columnIndex===e.columnIndex)[0].value||"",s=t.cells.filter(a=>a.columnIndex===e.columnIndex)[0].value||"",r=0;if("number"===e.filterType){let a=Number(l),t=Number(s);if(!(isNaN(a)||isNaN(t)))switch(e.filter){case"asc":r=a-t;break;case"desc":r=t-a}}else if("text"===e.filterType)switch(e.filter){case"asc":r=l.localeCompare(s);break;case"desc":r=s.localeCompare(l)}return r})}({rows:r,column:s})),{...t,columns:l,rows:r}})}}({props:e}),V=(0,s.useMemo)(()=>t?I:j,[t,I,j]),K=(0,s.useCallback)((e,a)=>{let t=[];T(l=>{let s=(0,i.q)([...l.rows],e,a);return t=s.map((e,a)=>({oldIndex:e.rowIndex,newIndex:a})),{...l,rows:s}}),x?.(e,a,t),A([])},[T,x,A]),P=!C&&p&&!e.rowRenderer;return(0,l.jsxs)(l.Fragment,{children:[l.jsx(N,{...e,search:e.search?{...e.search,value:C,setValue:D}:void 0}),l.jsx(r.ZP,{allowDrag:!!P,onSortEnd:K,draggedItemClassName:"opacity-90 z-[9999999999999]",customHolderRef:w,children:l.jsx("div",{className:"space-y-4",children:(0,l.jsxs)(o.iA,{className:(0,d.cn)("w-full overflow-x-auto",f),children:[l.jsx(o.xD,{className:(0,d.cn)(e.theadClassName),children:(0,l.jsxs)(o.SC,{children:[a&&l.jsx(o.ss,{className:(0,d.cn)(k[0]?.cellClassName,"w-8"),children:l.jsx(u.X,{disabled:t,checked:!!V.length&&Object.values(S).filter(e=>e).length===V.length,onCheckedChange:()=>A(V.map(e=>e.rowIndex))})}),P&&l.jsx(o.ss,{className:(0,d.cn)(k[0]?.cellClassName,"w-4")}),k.map(a=>l.jsx(o.ss,{colSpan:a.colSpan,align:a.align,className:(0,d.cn)(e.cellClassName,e.thClassName,a.cellClassName,a.thClassName,"px-2",a.hidden?"hidden":"",a.align?({left:"text-left",center:"text-center",right:"text-right",justify:"text-justify",char:""})[a.align]:""),children:(()=>{switch(a.filterType){case"number":case"text":return l.jsx(v,{column:a,value:a.filter,onFilter:e=>{"hide"===e?R(a.columnIndex):_(a.columnIndex,e)}});default:return l.jsx(c.z,{variant:"ghost",size:"sm",className:"   focus-visible:ring-0    focus-visible:ring-transparent    focus-visible:ring-offset-0   hover:bg-transparent   hover:text-primary   ",children:a.name||""})}})()},a.id))]})}),(0,l.jsxs)(o.RM,{ref:w,className:b,children:[!V.length&&l.jsx(o.SC,{className:"p-0",children:l.jsx(o.pj,{colSpan:k.length+(a?1:0)+(P?1:0),className:"p-4 text-center text-muted-foreground",children:e.noDataMessage||"No data to display"})}),V.map(i=>{if(g&&!g(i.rowIndex))return null;let c={...e.getRowOptions?.({rowIndex:i.rowIndex})};c={...c,className:(0,d.cn)(e.trClassName,"hover:bg-primary/10",S[i.rowIndex]?"bg-primary/10":"",y,c.className)};let h=[...a?[l.jsx(o.pj,{className:(0,d.cn)(k[0]?.cellClassName,"w-8"),children:l.jsx(u.X,{disabled:t,checked:!!S[i.rowIndex],onCheckedChange:()=>A([i.rowIndex])})},"select-checkbox")]:[],...P?[l.jsx(o.pj,{className:(0,d.cn)(k[0]?.cellClassName,"w-4 cursor-move"),children:l.jsx(r.TI,{children:l.jsx(n.Z,{className:"w-4 h-4 text-muted-foreground"})})},"sort-handle")]:[],...i.cells.map(a=>{let r=k[a.columnIndex],n={...e.getCellOptions?.({rowIndex:i.rowIndex,columnIndex:a.columnIndex})};return(0,s.createElement)(o.pj,{...n,key:a.id,colSpan:r.colSpan,align:r.align,className:(0,d.cn)(e.cellClassName,e.tdClassName,r.cellClassName,r.tdClassName,"px-4",n.className,r.hidden?"hidden":"")},t?l.jsx(m.O,{className:"h-4 w-[120px] bg-black/10 dark:bg-white/10"}):r.cellRenderer?r.cellRenderer(a):a.value)})];return e.rowRenderer?e.rowRenderer({props:c,cells:h,rowIndex:i.rowIndex}):l.jsx(r.TR,{children:l.jsx(o.SC,{...c,children:h})},i.id)})]})]})})})]})}},53313:(e,a,t)=>{t.d(a,{X:()=>o});var l=t(10326),s=t(17577),r=t(13635),i=t(32933),n=t(77863);let o=s.forwardRef(({className:e,...a},t)=>l.jsx(r.fC,{ref:t,className:(0,n.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...a,children:l.jsx(r.z$,{className:(0,n.cn)("flex items-center justify-center text-current"),children:l.jsx(i.Z,{className:"h-4 w-4"})})}));o.displayName=r.fC.displayName},15940:(e,a,t)=>{t.d(a,{RM:()=>o,SC:()=>d,iA:()=>i,pj:()=>u,ss:()=>c,xD:()=>n});var l=t(10326),s=t(17577),r=t(77863);let i=s.forwardRef(({className:e,...a},t)=>l.jsx("div",{className:"relative w-full overflow-auto",children:l.jsx("table",{ref:t,className:(0,r.cn)("w-full caption-bottom text-sm",e),...a})}));i.displayName="Table";let n=s.forwardRef(({className:e,...a},t)=>l.jsx("thead",{ref:t,className:(0,r.cn)("[&_tr]:border-b",e),...a}));n.displayName="TableHeader";let o=s.forwardRef(({className:e,...a},t)=>l.jsx("tbody",{ref:t,className:(0,r.cn)("[&_tr:last-child]:border-0",e),...a}));o.displayName="TableBody",s.forwardRef(({className:e,...a},t)=>l.jsx("tfoot",{ref:t,className:(0,r.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...a})).displayName="TableFooter";let d=s.forwardRef(({className:e,...a},t)=>l.jsx("tr",{ref:t,className:(0,r.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...a}));d.displayName="TableRow";let c=s.forwardRef(({className:e,...a},t)=>l.jsx("th",{ref:t,className:(0,r.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...a}));c.displayName="TableHead";let u=s.forwardRef(({className:e,...a},t)=>l.jsx("td",{ref:t,className:(0,r.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...a}));u.displayName="TableCell",s.forwardRef(({className:e,...a},t)=>l.jsx("caption",{ref:t,className:(0,r.cn)("mt-4 text-sm text-muted-foreground",e),...a})).displayName="TableCaption"},16722:(e,a,t)=>{t.d(a,{Uv:()=>r,VO:()=>s,d4:()=>l,fR:()=>n});let l=[{value:"allSearches",label:"Found in all searches"},{value:"admissionSearches",label:"Found in admission searches"},{value:"twinSearches",label:"Found in twin searches"}],s=[{label:"Days & hours",value:"days_hours"},{label:"Years & Months",value:"years_months"}],r=[{name:"date",label:"Date"},{name:"datetime",label:"Date + Time"},{name:"dropdown",label:"Dropdown"},{name:"multi_select",label:"Multiple choice list"},{name:"number",label:"Number"},{name:"text",label:"Text"},{name:"time",label:"Time"},{name:"period",label:"Time period"}],i={calculation:null,condition:"",confidential:!1,dataType:null,defaultValue:null,format:null,type:null,key:null,refKey:null,label:null,minValue:null,maxValue:null,optional:!1,minDate:null,maxDate:null,minTime:null,maxTime:null,minDateKey:"",maxDateKey:"",minTimeKey:"",maxTimeKey:"",values:"",editable:!1},n={admission:[{...i,type:"dropdown",key:"BabyTransfered",values:"Y,Yes\nN,No",label:"Has the baby been transfered from another facility"},{...i,type:"text",key:"patientNUID",label:"Search patient's NUID",condition:"$BabyTransfered = 'Y'"},{...i,type:"dropdown",key:"BabyTwin",values:"Y,Yes\nN,No",label:"Does the baby have a twin?"},{...i,type:"text",key:"BabyTwinNUID",label:"Search twin's NUID",condition:"$BabyTwin = 'Y'"}],other:[{...i,type:"text",key:"patientNUID",values:"Y,Yes\nN,No",label:"Search patient's NUID"}]}},58464:(e,a,t)=>{t.d(a,{$7:()=>o,F4:()=>p,PU:()=>i,Tf:()=>u,UQ:()=>f,_S:()=>n,m1:()=>c,ph:()=>m,uh:()=>d,y0:()=>h});var l=t(16722),s=t(75743),r=t(20698);let i={headerFormat:"",headerFields:[],footerFields:[],sections:[]},n="Example: ($key = true and $key2 = false) or $key3 = 'HD'",o={fontSize:{},fontWeight:{},fontStyle:{},textColor:{},backgroundColor:{},highlight:{}},d=[{value:"screens",label:"Screens"},{value:"diagnoses",label:"Diagnoses"},{value:"print",label:"Print"}],c=[{label:"Admission",value:"admission"},{label:"Discharge",value:"discharge"},{label:"Neolab",value:"neolab"},{label:"Daily Record",value:"drecord"},{label:"DFF Calculator",value:"dff_calculator"}],u=[{value:"checklist",label:"Checklist"},{value:"form",label:"Form"},{value:"management",label:"Management"},{value:"multi_select",label:"Multiple choice list"},{value:"single_select",label:"Single choice list"},{value:"progress",label:"Progress"},{value:"timer",label:"Timer"},{value:"yesno",label:"Yes/No"},{value:"drugs",label:"Drugs"},{value:"fluids",label:"Fluids"},{value:"zw_edliz_summary_table",label:"EDLIZ summary table (ZW)"},{value:"mwi_edliz_summary_table",label:"EDLIZ summary table (MWI)"},{value:"diagnosis",label:"Diagnosis"}],m=[{value:"risk",label:"Risk factor"},{value:"sign",label:"Sign/Symptom"}];({...u.reduce((e,a)=>{let t=a.value,l=a.value,s=[l,`${l}_option`];return"single_select"===t&&(s=[...s,"dropdown","dropdown_option"]),{...e,[l]:s}},{}),...l.Uv.reduce((e,a)=>{let t=a.name,l=a.name,s=[l,`${l}_option`];return"dropdown"===t&&(s=[...s,"single_select","single_select_option"]),{...e,[l]:s}},{})});let h=[{value:"checklist",label:"checklist",hasChildren:!0},{value:"multi_select",label:"multi_select",hasChildren:!0},{value:"single_select",label:"single_select",hasChildren:!0},{value:"yesno",label:"yesno",hasChildren:!1},{value:"zw_edliz_summary_table",label:"zw_edliz_summary_table",hasChildren:!0},{value:"mwi_edliz_summary_table",label:"mwi_edliz_summary_table",hasChildren:!0},{value:"diagnosis",label:"diagnosis",hasChildren:!0},{value:"diagnosis_symptom_sign",label:"diagnosis_symptom_sign",hasChildren:!1},{value:"diagnosis_symptom_risk",label:"diagnosis_symptom_risk",hasChildren:!1},{value:"date",label:"date",hasChildren:!1},{value:"datetime",label:"datetime",hasChildren:!1},{value:"dropdown",label:"dropdown",hasChildren:!0},{value:"number",label:"number",hasChildren:!1},{value:"text",label:"text",hasChildren:!1},{value:"timer",label:"timer",hasChildren:!1},{value:"period",label:"period",hasChildren:!1},{value:"option",label:"option",hasChildren:!1}],p=[{value:"label.asc",label:"Label (asc)",Icon:s.Z},{value:"label.desc",label:"Label (desc)",Icon:r.Z},{value:"key.asc",label:"Key (asc)",Icon:s.Z},{value:"key.desc",label:"Key (desc)",Icon:r.Z},{value:"type.asc",label:"Type (asc)",Icon:s.Z},{value:"type.desc",label:"Type (desc)",Icon:r.Z},{value:"refId.asc",label:"Ref ID (asc)",Icon:s.Z},{value:"refId.desc",label:"Ref ID (desc)",Icon:r.Z},{value:"createdAt.asc",label:"Creation date (asc)",Icon:s.Z},{value:"createdAt.desc",label:"Creation date (desc)",Icon:r.Z},{value:"updatedAt.asc",label:"Update date (asc)",Icon:s.Z},{value:"updatedAt.desc",label:"Update date (desc)",Icon:r.Z}],f=[{label:"Published",value:"published"},{label:"Drafts",value:"drafts"}]},49596:(e,a,t)=>{t.d(a,{DataKeysCtxProvider:()=>g,M:()=>b});var l=t(10326),s=t(17577),r=t(44099),i=t(93396),n=t(35047),o=t(96221),d=t(96948),c=t(58464),u=t(37530),m=t(3529),h=t(11877);let p=e=>e?.name||e?.label||e?.uniqueKey||"Data key",f=e=>e?{uuid:e.uuid||"",uniqueKey:e.uniqueKey||"",name:e.name||"",refId:e.refId||"",dataType:e.dataType||"",label:e.label||"",options:Array.isArray(e.options)?e.options:[],metadata:e.metadata||{},version:"number"==typeof e.version?e.version:Number(e.version||0)||0}:null,y=(0,s.createContext)(null),b=()=>{let e=(0,s.useContext)(y);if(!e)throw Error("useChart must be used within a <DataKeysCtxProvider />");return e};function g({children:e,prefetchDataKeys:a=!0}){(0,s.useRef)(!1);let t=(0,n.useRouter)(),{alert:b}=(0,o.s)(),{authenticatedUser:g}=(0,m.b)(),[x,v]=(0,i.v1)("uuid",{clearOnDefault:!0,shallow:!0,history:"push",defaultValue:""}),[w,N]=(0,s.useState)([]),[C,k]=(0,s.useState)(c.F4[0].value),[j,I]=(0,s.useState)(""),[S,D]=(0,s.useState)(""),[T,_]=(0,s.useState)(1),[A]=(0,s.useState)(100),[R,V]=(0,s.useState)(!1),[K,P]=(0,s.useState)([]),[Z,E]=(0,s.useState)(),F=(0,s.useCallback)(async e=>{V(!0);try{let a=new URLSearchParams;e?.names?.length&&a.set("names",JSON.stringify(e.names)),e?.uniqueKeys?.length&&a.set("uniqueKeys",JSON.stringify(e.uniqueKeys)),e?.dataKeysIds?.length&&a.set("dataKeysIds",JSON.stringify(e.dataKeysIds));let t=await r.Z.get(`/api/data-keys?${a.toString()}`),l=function(e,a=c.F4[0].value){let t=[...e],l=({key1:e,key2:a,sortDirection:t})=>{e=(e||"").trim().toLowerCase(),a=(a||"").trim().toLowerCase();let l=0;return"asc"===t?(e<a&&(l=-1),e>a&&(l=1)):(e>a&&(l=-1),e<a&&(l=1)),l};switch(a){case"refId.asc":t=e.sort((e,a)=>l({sortDirection:"asc",key1:(e.refId||"").trim(),key2:(a.refId||"").trim()}));break;case"refId.desc":t=e.sort((e,a)=>l({sortDirection:"desc",key1:(e.refId||"").trim(),key2:(a.refId||"").trim()}));break;case"key.desc":t=e.sort((e,a)=>l({sortDirection:"desc",key1:e.name,key2:a.name}));break;case"label.asc":t=e.sort((e,a)=>l({sortDirection:"asc",key1:(e.label||e.name||"").trim(),key2:(a.label||a.name||"").trim()}));break;case"label.desc":t=e.sort((e,a)=>l({sortDirection:"desc",key1:(e.label||e.name||"").trim(),key2:(a.label||a.name||"").trim()}));break;case"type.asc":t=e.sort((e,a)=>l({sortDirection:"asc",key1:(e.dataType||"").trim(),key2:(a.dataType||"").trim()}));break;case"type.desc":t=e.sort((e,a)=>l({sortDirection:"desc",key1:(e.dataType||"").trim(),key2:(a.dataType||"").trim()}));break;case"createdAt.asc":t=e.sort((e,a)=>l({sortDirection:"asc",key1:new Date(e.createdAt||"").getTime().toString(),key2:new Date(a.createdAt||"").getTime().toString()}));break;case"createdAt.desc":t=e.sort((e,a)=>l({sortDirection:"desc",key1:new Date(e.createdAt||"").getTime().toString(),key2:new Date(a.createdAt||"").getTime().toString()}));break;case"updatedAt.asc":t=e.sort((e,a)=>l({sortDirection:"asc",key1:new Date(e.updatedAt||"").getTime().toString(),key2:new Date(a.updatedAt||"").getTime().toString()}));break;case"updatedAt.desc":t=e.sort((e,a)=>l({sortDirection:"desc",key1:new Date(e.updatedAt||"").getTime().toString(),key2:new Date(a.updatedAt||"").getTime().toString()}));break;default:t=e.sort((e,a)=>l({sortDirection:"asc",key1:e.name,key2:a.name}))}return t}(t.data.data,C);P(l),E(t.data.errors),_(1)}catch(e){P([]),E([e.message])}finally{V(!1)}},[C]),M=(0,s.useMemo)(()=>{let e=[...K];if(j&&(e="published"===j?e.filter(e=>!e?.isDraft):"draft"===j?e.filter(e=>!!e?.isDraft):e.filter(e=>e?.dataType===j)),S){let{normalizedValue:a,isExactMatch:t}=(0,h.l)(S);a&&(e=e.filter(e=>[e.name||"",e.label||""].map(e=>e.toLowerCase()).some(e=>t?e===a:e.includes(a))))}return e},[K,j,S]),{dataKeys:z,pagination:$}=(0,s.useMemo)(()=>{if(!M.length)return{dataKeys:[],pagination:void 0};let e=function(e,a,t){let l=e.length,s=(a-1)*t;return{data:e.slice(s,s+t),pagination:{page:a,limit:t,total:l,totalPages:Math.ceil(l/t)}}}(M,T,A);return{dataKeys:e.data,pagination:e.pagination}},[M,T,A]),[O,U]=(0,s.useState)(!1),L=(0,s.useCallback)(async(e,a)=>{try{U(!0);let l=e.map(e=>({...e,version:"string"==typeof e.version?Number(e.version):e.version})),s=(await r.Z.post("/api/data-keys/save",{data:l,broadcastAction:!0})).data;s.errors?.length?b({title:"Error",message:s.errors.join(", "),variant:"error"}):(await F(),t.refresh(),b({message:"Data key saved!",variant:"success",onClose:()=>a?.()}))}catch(e){b({title:"Error",message:"Failed to save data key: "+e.message,onClose:()=>a?.(e.message)})}finally{U(!1)}},[b,t.refresh,F]),[B,H]=(0,s.useState)(!1),Y=(0,s.useCallback)(async e=>{if(!e.length)return;let a=g?.userId,t=g?.displayName;for(let l of e){if(!l?.uuid)continue;let e=f(l);if(!e)continue;let s=p(l);await (0,u.KL)({entityId:l.uuid,entityType:"dataKey",entityTitle:s,snapshot:e,userId:a,userName:t,description:`Marked "${s}" for deletion`})}},[g?.userId,g?.displayName]),q=(0,s.useCallback)(async e=>{let a=K.filter(a=>a?.uuid&&e.includes(a.uuid));try{H(!0);let l=(await r.Z.delete("/api/data-keys?data="+JSON.stringify({dataKeysIds:e,broadcastAction:!0}))).data;if(l.errors?.length)throw Error(l.errors[0]);await Y(a),N([]),await F(),t.refresh(),b({title:"Success",message:"Data keys deleted successfully!",variant:"success"})}catch(e){b({title:"Error",message:e.message,variant:"error"})}finally{H(!1)}},[t.refresh,b,F,K,Y]),[J,W]=(0,s.useState)(!1),X=(0,s.useCallback)(async e=>{try{W(!0);let a=(await r.Z.post("/api/data-keys/export",e)).data;if(a.errors?.length)throw Error(a.errors[0]);await F(),N([]),b({title:"Success",message:"Data exported successfully!",variant:"success"})}catch(e){b({title:"Error",message:e.message,variant:"error"})}finally{W(!1)}},[F,b]),Q=(0,s.useCallback)((e=c.F4[0].value)=>{k(e),N([]),_(1)},[]),G=(0,s.useCallback)((e,a)=>{let t=e.map(e=>K.find(a=>a.uniqueKey===e||a.uuid===e)).filter(e=>e);return a?.withNested&&t.filter(e=>e.options.length).forEach(e=>{let l=G(e.options,a);t=[...t,...l]}),t.filter((e,a)=>t.map(e=>e.uniqueKey).indexOf(e.uniqueKey)===a)},[K]);return Z?.length?l.jsx(d.Alert,{title:"Error",message:"Failed to load data keys: "+Z.join(", "),buttonLabel:"Try again",onClose:()=>F()}):l.jsx(l.Fragment,{children:l.jsx(y.Provider,{value:{loadingDataKeys:R,saving:O,exporting:J,deleting:B,dataKeys:z,allDataKeys:K,errors:Z,selected:w,currentDataKeyUuid:x,sort:C,filter:j,searchValue:S,pagination:$,currentPage:T,itemsPerPage:A,setCurrentPage:_,setSearchValue:D,extractDataKeys:G,deleteDataKeys:q,saveDataKeys:L,exportDataKeys:X,setCurrentDataKeyUuid:v,loadDataKeys:F,setSelected:N,setSort:k,onSort:Q,setFilter:I},children:e})})}},61198:(e,a,t)=>{t.d(a,{N:()=>s});var l=t(17577);function s(e,a){let[t,s]=(0,l.useState)(e);return t}},37530:(e,a,t)=>{t.d(a,{$u:()=>i,KL:()=>o});var l=t(24875);let s=new Set(["id","createdAt","updatedAt","deletedAt","oldScriptId","oldScreenId","oldDiagnosisId","oldConfigKeyId","version","publishDate","isDraft","isDeleted","draftCreatedByUserId","createdByUserId","updatedByUserId","createdBy","updatedBy"]);class r{constructor(e){this.originalSnapshot=null,this.isInitialized=!1,this.options=e}setSnapshot(e){this.isInitialized||(this.originalSnapshot=JSON.parse(JSON.stringify(e)),this.isInitialized=!0)}async trackChanges(e,a){if(!this.isInitialized||!this.originalSnapshot){this.setSnapshot(e);return}let t=this.detectChanges(this.originalSnapshot,e),s=new Map((await l.pb.getEntityChanges(this.options.entityId,this.options.entityType)).map(e=>[e.fieldPath,e])),r=this.resolveEntityTitle(e);for(let i of t){let t=s.get(i.path);t?await l.pb.updateChange(t.id,{newValue:i.newValue,timestamp:Date.now(),description:a,fullSnapshot:e,entityTitle:r}):await l.pb.addChange({entityId:this.options.entityId,entityType:this.options.entityType,action:"update",fieldPath:i.path,fieldName:i.name,oldValue:i.oldValue,newValue:i.newValue,userId:this.options.userId,userName:this.options.userName,description:a,fullSnapshot:e,entityTitle:r})}for(let[e,a]of Array.from(s))t.some(a=>a.path===e)||await l.pb.deleteChange(a.id);0===t.length&&await l.pb.clearEntityChanges(this.options.entityId,this.options.entityType)}resolveEntityTitle(e){if(this.options.resolveEntityTitle){let a=this.options.resolveEntityTitle(e);if(a&&a.toString().trim().length)return a.toString().trim()}let a=this.extractTitle(e);return a?a:"string"==typeof this.options.entityTitle&&this.options.entityTitle.trim().length?this.options.entityTitle.trim():this.extractTitle(this.originalSnapshot)||`${this.options.entityType} ${this.options.entityId}`}extractTitle(e){if(!e||"object"!=typeof e)return null;for(let a of["title","name","label","key","printTitle","displayName","sectionTitle","collectionLabel"]){let t=e[a];if("string"==typeof t&&t.trim().length)return t.trim()}return null}isMeaningfulValue(e){return null!=e&&("string"!=typeof e||""!==e.trim())}detectChanges(e,a,t=""){let l=[];return null==e?null!=a&&this.isMeaningfulValue(a)&&l.push({path:t||"root",name:t.split(".").pop()||"root",oldValue:e,newValue:a}):null==a?this.isMeaningfulValue(e)&&l.push({path:t||"root",name:t.split(".").pop()||"root",oldValue:e,newValue:a}):"object"!=typeof e||"object"!=typeof a?e!==a&&this.isMeaningfulValue(a)&&l.push({path:t||"root",name:t.split(".").pop()||"root",oldValue:e,newValue:a}):Array.isArray(e)&&Array.isArray(a)?JSON.stringify(e)!==JSON.stringify(a)&&l.push({path:t||"root",name:t.split(".").pop()||"root",oldValue:e,newValue:a}):Array.from(new Set([...Object.keys(e),...Object.keys(a)])).forEach(r=>{if(s.has(r))return;let i=t?`${t}.${r}`:r,n=e[r],o=a[r];(this.isMeaningfulValue(n)||this.isMeaningfulValue(o))&&("object"!=typeof n||"object"!=typeof o||null===n||null===o||Array.isArray(n)||Array.isArray(o)?JSON.stringify(n)!==JSON.stringify(o)&&this.isMeaningfulValue(o)&&l.push({path:i,name:r,oldValue:n,newValue:o}):l.push(...this.detectChanges(n,o,i)))}),l}async clearChanges(){await l.pb.clearEntityChanges(this.options.entityId,this.options.entityType),this.originalSnapshot=null,this.isInitialized=!1}async getPendingChanges(){return await l.pb.getEntityChanges(this.options.entityId,this.options.entityType)}}function i(e){return new r(e)}let n=["title","name","label","key","printTitle","sectionTitle","collectionLabel","drug","fluid","feed"];async function o({entityId:e,entityType:a,entityTitle:t,snapshot:s,userId:r,userName:i,description:o}){if(!e)return;let d=t?.trim()||function(e){if(!e||"object"!=typeof e)return null;for(let a of n){let t=e[a];if("string"==typeof t&&t.trim().length)return t.trim()}return null}(s)||`${a} ${e}`;await l.pb.clearEntityChanges(e,a),await l.pb.addChange({entityId:e,entityType:a,entityTitle:d,action:"delete",fieldPath:"entity",fieldName:d,oldValue:s??null,newValue:null,userId:r||void 0,userName:i||void 0,description:o||`Marked "${d}" for deletion`,fullSnapshot:s??null})}},11877:(e,a,t)=>{t.d(a,{l:()=>i,y:()=>r});let l=['"',"“"],s=['"',"”"];function r(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function i(e){let a=`${e??""}`.trim();if(!a)return{normalizedValue:"",isExactMatch:!1};let t=l.includes(a[0]),r=s.includes(a[a.length-1]),i=a.length>1&&t&&r;return{normalizedValue:(i?a.slice(1,-1):a).trim().toLowerCase(),isExactMatch:i}}},24569:(e,a,t)=>{t.d(a,{V:()=>r});var l=t(19510),s=t(50650);function r({className:e,...a}){return l.jsx("div",{...a,className:(0,s.cn)("w-full max-w-screen-xl mx-auto p-5",e)})}},46697:(e,a,t)=>{t.d(a,{Ol:()=>n,Zb:()=>i,aY:()=>d,ll:()=>o});var l=t(19510),s=t(71159),r=t(50650);let i=s.forwardRef(({className:e,...a},t)=>l.jsx("div",{ref:t,className:(0,r.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...a}));i.displayName="Card";let n=s.forwardRef(({className:e,...a},t)=>l.jsx("div",{ref:t,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",e),...a}));n.displayName="CardHeader";let o=s.forwardRef(({className:e,...a},t)=>l.jsx("h3",{ref:t,className:(0,r.cn)("text-2xl font-semibold leading-none tracking-tight",e),...a}));o.displayName="CardTitle",s.forwardRef(({className:e,...a},t)=>l.jsx("p",{ref:t,className:(0,r.cn)("text-sm text-muted-foreground",e),...a})).displayName="CardDescription";let d=s.forwardRef(({className:e,...a},t)=>l.jsx("div",{ref:t,className:(0,r.cn)("p-6 pt-0",e),...a}));d.displayName="CardContent",s.forwardRef(({className:e,...a},t)=>l.jsx("div",{ref:t,className:(0,r.cn)("flex items-center p-6 pt-0",e),...a})).displayName="CardFooter"},75644:(e,a,t)=>{t.d(a,{g2:()=>n});var l=t(68570);let s=(0,l.createProxy)(String.raw`C:\Users\HomePC\Neotree Projects\neotree-editor\contexts\data-keys\index.tsx`),{__esModule:r,$$typeof:i}=s;s.default,(0,l.createProxy)(String.raw`C:\Users\HomePC\Neotree Projects\neotree-editor\contexts\data-keys\index.tsx#DataKeysCtx`),(0,l.createProxy)(String.raw`C:\Users\HomePC\Neotree Projects\neotree-editor\contexts\data-keys\index.tsx#useDataKeysCtx`);let n=(0,l.createProxy)(String.raw`C:\Users\HomePC\Neotree Projects\neotree-editor\contexts\data-keys\index.tsx#DataKeysCtxProvider`)}};