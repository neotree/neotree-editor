exports.id=3940,exports.ids=[3940],exports.modules={81221:(e,s,r)=>{Promise.resolve().then(r.bind(r,79530)),Promise.resolve().then(r.bind(r,96948)),Promise.resolve().then(r.bind(r,10827)),Promise.resolve().then(r.t.bind(r,79404,23))},79530:(e,s,r)=>{"use strict";r.d(s,{DiagnosisForm:()=>q});var t=r(10326),a=r(17577),i=r(35047),n=r(90772),l=r(54432),d=r(87673),o=r(31048),c=r(8281),m=r(11870),h=r(77863),p=r(99463),x=r(74723),u=r(47463),y=r(44099),g=r(82617),j=r(96221),v=r(3529),f=r(58464),b=r(42954),k=r(61541),w=r(83855),N=r(39447),D=r(69508),C=r(47035),R=r(77228),F=r(62288),M=r(60097),I=r(46670),Z=r(29354);function $({disabled:e,selected:s,onDelete:r,onCopy:a}){return t.jsx(t.Fragment,{children:!!s.length&&t.jsx(Z.h,{children:(0,t.jsxs)(n.z,{variant:"destructive",className:"h-auto w-auto",disabled:e,onClick:()=>r(),children:[t.jsx(C.Z,{className:"h-4 w-4 mr-1"}),t.jsx("span",{children:s.length>1?`Delete ${s.length} symptoms`:"Delete symptom"})]})})})}var V=r(2025),S=r(88846),E=r(53313),P=r(61892),z=r(69486);function A({children:e,symptom:s,form:r,disabled:i,...d}){let{data:c,index:m}={...s},[p,y]=(0,a.useState)(!1),g=(0,a.useCallback)(()=>({symptomId:c?.symptomId||(0,u.Z)(),expression:c?.expression||"",name:c?.name||"",weight:c?.weight||null,type:c?.type||f.ph[0].value,position:c?.position||1,printable:c?.printable||!0,...c}),[c]),{reset:j,watch:v,register:b,handleSubmit:k,setValue:w}=(0,x.cI)({defaultValues:g()}),N=v("type"),D=v("name"),C=v("printable"),R=(0,a.useMemo)(()=>!!i,[i]),M=k(e=>{!(0,P.x)(m)&&c?r.setValue("symptoms",r.getValues("symptoms").map((s,r)=>({...s,...r===m?e:null}))):r.setValue("symptoms",[...r.getValues("symptoms"),e],{shouldDirty:!0}),y(!1)});return t.jsx(t.Fragment,{children:t.jsx(V.u,{open:p,title:c?"Add symptom":"Edit symptom",trigger:"function"==typeof e?e({extraProps:d}):e,onOpenChange:e=>{y(e),j(g())},actions:(0,t.jsxs)(t.Fragment,{children:[t.jsx("span",{className:(0,h.cn)("text-danger text-xs",R&&"hidden"),children:"* Required"}),t.jsx("div",{className:"flex-1"}),t.jsx(F.GG,{asChild:!0,children:t.jsx(n.z,{variant:"ghost",children:"Cancel"})}),t.jsx(n.z,{disabled:R,onClick:()=>M(),children:"Save"})]}),children:(0,t.jsxs)("div",{className:"flex flex-col gap-y-5",children:[t.jsx(z.D,{children:"Type"}),t.jsx("div",{children:t.jsx(S.E,{disabled:R,defaultValue:N,onValueChange:e=>w("type",e,{shouldDirty:!0}),className:"flex flex-col gap-y-4",children:f.ph.map(e=>(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[t.jsx(S.m,{value:e.value,id:e.value}),t.jsx(o._,{secondary:!0,htmlFor:e.value,children:e.label})]},e.value))})}),t.jsx(z.D,{children:"Properties"}),(0,t.jsxs)("div",{children:[t.jsx(o._,{error:!R&&!D,htmlFor:"name",children:"Name *"}),t.jsx(l.I,{...b("name",{disabled:R,required:!0}),name:"name",error:!R&&!D})]}),(0,t.jsxs)("div",{children:[t.jsx(o._,{htmlFor:"weight",children:"Weight "}),t.jsx(l.I,{...b("weight",{disabled:R}),name:"label",type:"number"}),(0,t.jsxs)("span",{className:"text-xs text-muted-foreground",children:["Must be in the range: 0.0 - 1.0 (",t.jsx("b",{children:"default 1.0"}),")"]})]}),(0,t.jsxs)("div",{children:[t.jsx(o._,{htmlFor:"expression",children:"Sign/Risk expression "}),t.jsx(l.I,{...b("expression",{disabled:R}),name:"label"}),(0,t.jsxs)("span",{className:"text-xs text-muted-foreground",children:["Example: ",t.jsx("b",{children:"($key = true and $key2 = false) or $key3 = 'HD'"})]})]}),t.jsx(z.D,{children:"Print"}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex-1 flex items-center space-x-2",children:[t.jsx(E.X,{id:"printable",disabled:R,checked:C,onCheckedChange:()=>w("printable",!C,{shouldDirty:!0})}),t.jsx(o._,{htmlFor:"printable",children:"Print"})]}),t.jsx("span",{className:"text-muted-foreground text-xs",children:"If not checked, data will not be display on the session summary and the printout."})]})]})})})}function _({form:e,disabled:s}){let[r,i]=(0,a.useState)([]),{confirm:l}=(0,I.t)(),d=e.watch("symptoms"),o=(0,a.useCallback)((s,r)=>{let t=(0,k.q)([...d],s,r);e.setValue("symptoms",t.map((e,s)=>({...e,position:s+1})),{shouldDirty:!0})},[e,d]),c=(0,a.useCallback)(s=>{let r=d.filter((e,r)=>s.includes(r)).map(e=>`<div class="font-bold text-danger">${e.name}</div>`).join("");l(()=>{let r=d.filter((e,r)=>!s.includes(r));e.setValue("symptoms",r.map((e,s)=>({...e,position:s+1})),{shouldDirty:!0}),i([])},{title:"Delete",message:`<p>Are you sure you want to delete ${s.length>1?`${s.length} symptoms: `:"symptom: "}</p> ${r}`,danger:!0,positiveLabel:"Delete"})},[e,d,l]),m=(0,a.useCallback)(s=>{let r=d.filter((e,r)=>s.includes(r)).map(e=>`<div class="font-bold">${e.name}</div>`).join("");l(()=>{let r=[...d,...d.filter((e,r)=>s.includes(r)).map((e,s)=>({...e,position:d.length+1+s}))];e.setValue("symptoms",r.map((e,s)=>({...e,position:s+1})),{shouldDirty:!0}),i([])},{title:"Duplicate",message:`<p>Are you sure you want to duplicate ${s.length>1?`${s.length} symptoms: `:"symptom: "}</p> ${r}`,positiveLabel:"Duplicate"})},[e,d,l]);return(0,t.jsxs)(t.Fragment,{children:[t.jsx(R.DataTable,{title:"Symptoms",sortable:!s,selectable:!s,onSort:o,selectedIndexes:r,onSelect:i,search:{inputPlaceholder:"Search symptoms"},headerActions:t.jsx(t.Fragment,{children:t.jsx(A,{form:e,disabled:s,children:!s&&t.jsx(F.hg,{asChild:!0,children:(0,t.jsxs)(n.z,{className:"text-primary border-primary",variant:"outline",children:[t.jsx(w.Z,{className:"h-4 w-4 mr-1"}),"New symptom"]})})})}),columns:[{name:"Type"},{name:"Name"},{name:"Action",align:"right",cellRenderer({rowIndex:r}){let a=d[r];return(0,t.jsxs)(M.h_,{children:[t.jsx(M.$F,{asChild:!0,children:t.jsx(n.z,{variant:"ghost",size:"icon",className:"p-0 h-auto w-auto transition-colors rounded-full hover:text-primary hover:bg-transparent",children:t.jsx(N.Z,{className:"h-4 w-4"})})}),(0,t.jsxs)(M.AW,{children:[t.jsx(M.Xi,{asChild:!0,children:t.jsx(A,{disabled:s,form:e,symptom:{data:a,index:r},children:({extraProps:e})=>(0,t.jsxs)(F.hg,{...e,className:(0,h.cn)(e?.className,"w-full"),children:[t.jsx(D.Z,{className:"w-4 h-4 mr-2"}),t.jsx("span",{children:s?"View":"Edit"})]})})}),(0,t.jsxs)(M.Xi,{onClick:()=>c([r]),className:(0,h.cn)("text-danger focus:bg-danger focus:text-danger-foreground"),disabled:s,children:[t.jsx(C.Z,{className:"mr-2 h-4 w-4"}),t.jsx("span",{children:"Delete"})]})]})]})}}],data:d.map(e=>[e.type,e.name,""])}),!s&&t.jsx($,{disabled:s,selected:r,onDelete:()=>c(r),onCopy:()=>m(r)})]})}function q(e){let s=(0,i.useRouter)(),r=function({formData:e,scriptId:s}){let r=(0,i.useRouter)(),[t,n]=(0,a.useState)(!1),{saveDiagnoses:l}=(0,g.h)(),{alert:d}=(0,j.s)(),{viewOnly:o}=(0,v.b)(),c=(0,a.useMemo)(()=>`/script/${s}?section=diagnoses`,[s]),m=(0,a.useCallback)(()=>({version:e?.version||1,scriptId:e?.scriptId||s,diagnosisId:e?.diagnosisId||(0,u.Z)(),name:e?.name||"",description:e?.description||"",key:e?.key||"",expression:e?.expression||"",expressionMeaning:e?.expressionMeaning||"",severityOrder:e?.severityOrder||null,symptoms:e?.symptoms||[],text1:e?.text1||"",text2:e?.text2||"",text3:e?.text3||"",image1:e?.image1||null,image2:e?.image2||null,image3:e?.image3||null,preferences:e?.preferences||f.$7}),[e,s]),h=(0,x.cI)({defaultValues:m()}),{formState:{dirtyFields:p},handleSubmit:b}=h,k=(0,a.useMemo)(()=>!!Object.keys(p).length,[p]),w=b(async e=>{try{n(!0);let s={...e,severityOrder:e.severityOrder?Number(e.severityOrder):null};if(!s.scriptId)throw Error("Diagnosis is missing script reference!");let t=(await y.Z.post("/api/diagnoses/save",{data:[s],broadcastAction:!0})).data;if(t.errors?.length)throw Error(t.errors.join(", "));r.refresh(),d({variant:"success",message:"Diagnosis draft was saved successfully!",onClose:()=>r.push(c)})}catch(e){d({variant:"error",message:"Failed to save draft: "+e.message})}finally{n(!1)}}),N=(0,a.useMemo)(()=>t||o,[t,o]);return{...h,formIsDirty:k,saving:t,scriptPageHref:c,disabled:N,save:w,getDefaultValues:m}}(e),{formIsDirty:k,saving:w,scriptPageHref:N,disabled:D,register:C,watch:R,setValue:F,save:M}=r,I=R("name"),Z=R("key"),$=R("image1"),V=R("image2"),S=R("image3"),E=R("preferences"),P=(0,a.useCallback)(()=>{s.push(N)},[s,N]);return(0,t.jsxs)(t.Fragment,{children:[w&&t.jsx(m.a,{overlay:!0}),(0,t.jsxs)("div",{className:"flex flex-col gap-y-5 [&>*]:px-4",children:[(0,t.jsxs)("div",{children:[t.jsx(o._,{htmlFor:"name",error:!D&&!I,children:"Name *"}),t.jsx(l.I,{...C("name",{disabled:D,required:!0}),name:"name",noRing:!1,error:!D&&!I})]}),(0,t.jsxs)("div",{className:"flex gap-x-2",children:[(0,t.jsxs)("div",{children:[t.jsx(o._,{htmlFor:"severityOrder",children:"Severity order"}),t.jsx(l.I,{...C("severityOrder",{disabled:D}),name:"severityOrder",noRing:!1,type:"number"})]}),(0,t.jsxs)("div",{className:"flex-1",children:[t.jsx(o._,{htmlFor:"key",error:!D&&!Z,children:"Key *"}),t.jsx(l.I,{...C("key",{disabled:D,required:!0}),name:"key",noRing:!1,error:!D&&!Z})]})]}),(0,t.jsxs)("div",{children:[t.jsx(o._,{htmlFor:"description",children:"Description"}),t.jsx(l.I,{...C("description",{disabled:D}),name:"description",noRing:!1}),t.jsx(p.w,{id:"description",title:"Description",disabled:D,data:E,onSave:e=>F("preferences",e,{shouldDirty:!0})})]}),(0,t.jsxs)("div",{children:[t.jsx(o._,{htmlFor:"expression",children:"Diagnosis expression (e.g. $Temp > 37 or $Gestation < 20)"}),t.jsx(l.I,{...C("expression",{disabled:D}),name:"expression",noRing:!1})]}),(0,t.jsxs)("div",{children:[t.jsx(o._,{htmlFor:"expressionMeaning",children:"Diagnosis expression (e.g. Temperature greater than 37 or Gestation period less than 20 weeks)"}),t.jsx(l.I,{...C("expressionMeaning",{disabled:D}),name:"expressionMeaning",noRing:!1})]}),[["text1",$],["text2",V],["text3",S]].map(([e,s],r)=>{let i=`image${r+1}`;return t.jsx(a.Fragment,{children:(0,t.jsxs)("div",{className:"flex gap-x-4",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)(o._,{htmlFor:`imageTextFields.${r}.text`,children:["Text ",r+1]}),t.jsx(d.g,{...C(e,{disabled:D}),name:`text${r}`,noRing:!1,rows:5}),t.jsx(p.w,{id:e,title:`Text ${r+1}`,disabled:D,data:E,onSave:e=>F("preferences",e,{shouldDirty:!0})})]}),t.jsx(b.M,{disabled:D,image:s,onChange:e=>F(i,e,{shouldDirty:!0})})]})},`imageTextFields.${r}`)})]}),(0,t.jsxs)("div",{className:"flex items-center justify-end gap-x-2 py-6 px-4",children:[t.jsx("span",{className:(0,h.cn)("text-danger text-xs",D&&"hidden"),children:"* Required"}),t.jsx("div",{className:"flex-1"}),t.jsx(n.z,{variant:"ghost",onClick:()=>P(),children:"Cancel"}),t.jsx(n.z,{disabled:D,onClick:()=>M(),children:"Save Draft"})]}),t.jsx(c.Z,{className:"my-20"}),t.jsx("div",{children:t.jsx(_,{disabled:D,form:r})})]})}},39447:(e,s,r)=>{"use strict";r.d(s,{Z:()=>t});/**
 * @license lucide-react v0.399.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let t=(0,r(62881).Z)("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]])},39572:(e,s,r)=>{"use strict";r.d(s,{Z:()=>t});/**
 * @license lucide-react v0.399.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let t=(0,r(62881).Z)("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]])},83855:(e,s,r)=>{"use strict";r.d(s,{Z:()=>t});/**
 * @license lucide-react v0.399.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let t=(0,r(62881).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},69508:(e,s,r)=>{"use strict";r.d(s,{Z:()=>t});/**
 * @license lucide-react v0.399.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let t=(0,r(62881).Z)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},47035:(e,s,r)=>{"use strict";r.d(s,{Z:()=>t});/**
 * @license lucide-react v0.399.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let t=(0,r(62881).Z)("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]])},63685:(e,s,r)=>{"use strict";r.d(s,{Z:()=>t});/**
 * @license lucide-react v0.399.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let t=(0,r(62881).Z)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])},89503:(e,s,r)=>{"use strict";r.d(s,{A:()=>l});var t=r(68570);let a=(0,t.createProxy)(String.raw`/home/farai/Workbench/Neotree/neotree-editor/app/(dashboard)/(scripts)/components/diagnoses/form.tsx`),{__esModule:i,$$typeof:n}=a;a.default;let l=(0,t.createProxy)(String.raw`/home/farai/Workbench/Neotree/neotree-editor/app/(dashboard)/(scripts)/components/diagnoses/form.tsx#DiagnosisForm`)},39755:(e,s,r)=>{"use strict";r.d(s,{Z:()=>t});/**
 * @license lucide-react v0.399.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let t=(0,r(27162).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},18623:(e,s,r)=>{"use strict";r.d(s,{ck:()=>A,fC:()=>z,z$:()=>_});var t=r(17577),a=r(82561),i=r(48051),n=r(93095),l=r(45226),d=r(15594),o=r(52067),c=r(17124),m=r(2566),h=r(53405),p=r(9815),x=r(10326),u="Radio",[y,g]=(0,n.b)(u),[j,v]=y(u),f=t.forwardRef((e,s)=>{let{__scopeRadio:r,name:n,checked:d=!1,required:o,disabled:c,value:m="on",onCheck:h,...p}=e,[u,y]=t.useState(null),g=(0,i.e)(s,e=>y(e)),v=t.useRef(!1),f=!u||!!u.closest("form");return(0,x.jsxs)(j,{scope:r,checked:d,disabled:c,children:[(0,x.jsx)(l.WV.button,{type:"button",role:"radio","aria-checked":d,"data-state":N(d),"data-disabled":c?"":void 0,disabled:c,value:m,...p,ref:g,onClick:(0,a.M)(e.onClick,e=>{d||h?.(),f&&(v.current=e.isPropagationStopped(),v.current||e.stopPropagation())})}),f&&(0,x.jsx)(w,{control:u,bubbles:!v.current,name:n,value:m,checked:d,required:o,disabled:c,style:{transform:"translateX(-100%)"}})]})});f.displayName=u;var b="RadioIndicator",k=t.forwardRef((e,s)=>{let{__scopeRadio:r,forceMount:t,...a}=e,i=v(b,r);return(0,x.jsx)(p.z,{present:t||i.checked,children:(0,x.jsx)(l.WV.span,{"data-state":N(i.checked),"data-disabled":i.disabled?"":void 0,...a,ref:s})})});k.displayName=b;var w=e=>{let{control:s,checked:r,bubbles:a=!0,...i}=e,n=t.useRef(null),l=(0,h.D)(r),d=(0,m.t)(s);return t.useEffect(()=>{let e=n.current,s=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(l!==r&&s){let t=new Event("click",{bubbles:a});s.call(e,r),e.dispatchEvent(t)}},[l,r,a]),(0,x.jsx)("input",{type:"radio","aria-hidden":!0,defaultChecked:r,...i,tabIndex:-1,ref:n,style:{...e.style,...d,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function N(e){return e?"checked":"unchecked"}var D=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],C="RadioGroup",[R,F]=(0,n.b)(C,[d.Pc,g]),M=(0,d.Pc)(),I=g(),[Z,$]=R(C),V=t.forwardRef((e,s)=>{let{__scopeRadioGroup:r,name:t,defaultValue:a,value:i,required:n=!1,disabled:m=!1,orientation:h,dir:p,loop:u=!0,onValueChange:y,...g}=e,j=M(r),v=(0,c.gm)(p),[f,b]=(0,o.T)({prop:i,defaultProp:a,onChange:y});return(0,x.jsx)(Z,{scope:r,name:t,required:n,disabled:m,value:f,onValueChange:b,children:(0,x.jsx)(d.fC,{asChild:!0,...j,orientation:h,dir:v,loop:u,children:(0,x.jsx)(l.WV.div,{role:"radiogroup","aria-required":n,"aria-orientation":h,"data-disabled":m?"":void 0,dir:v,...g,ref:s})})})});V.displayName=C;var S="RadioGroupItem",E=t.forwardRef((e,s)=>{let{__scopeRadioGroup:r,disabled:n,...l}=e,o=$(S,r),c=o.disabled||n,m=M(r),h=I(r),p=t.useRef(null),u=(0,i.e)(s,p),y=o.value===l.value,g=t.useRef(!1);return t.useEffect(()=>{let e=e=>{D.includes(e.key)&&(g.current=!0)},s=()=>g.current=!1;return document.addEventListener("keydown",e),document.addEventListener("keyup",s),()=>{document.removeEventListener("keydown",e),document.removeEventListener("keyup",s)}},[]),(0,x.jsx)(d.ck,{asChild:!0,...m,focusable:!c,active:y,children:(0,x.jsx)(f,{disabled:c,required:o.required,checked:y,...h,...l,name:o.name,ref:u,onCheck:()=>o.onValueChange(l.value),onKeyDown:(0,a.M)(e=>{"Enter"===e.key&&e.preventDefault()}),onFocus:(0,a.M)(l.onFocus,()=>{g.current&&p.current?.click()})})})});E.displayName=S;var P=t.forwardRef((e,s)=>{let{__scopeRadioGroup:r,...t}=e,a=I(r);return(0,x.jsx)(k,{...a,...t,ref:s})});P.displayName="RadioGroupIndicator";var z=V,A=E,_=P},90220:(e,s,r)=>{"use strict";r.d(s,{f:()=>o});var t=r(17577),a=r(45226),i=r(10326),n="horizontal",l=["horizontal","vertical"],d=t.forwardRef((e,s)=>{let{decorative:r,orientation:t=n,...d}=e,o=l.includes(t)?t:n;return(0,i.jsx)(a.WV.div,{"data-orientation":o,...r?{role:"none"}:{"aria-orientation":"vertical"===o?o:void 0,role:"separator"},...d,ref:s})});d.displayName="Separator";var o=d}};