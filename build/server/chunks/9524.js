exports.id=9524,exports.ids=[9524],exports.modules={45866:(e,t,r)=>{Promise.resolve().then(r.bind(r,10827)),Promise.resolve().then(r.bind(r,49596)),Promise.resolve().then(r.bind(r,82617))},69486:(e,t,r)=>{"use strict";r.d(t,{D:()=>l});var a=r(10326),s=r(77863);function l({children:e,className:t}){return a.jsx("div",{className:(0,s.cn)("pb-1 border-b border-b-primary",t),children:a.jsx("span",{className:"uppercase text-primary text-sm",children:e})})}},29354:(e,t,r)=>{"use strict";r.d(t,{h:()=>i});var a=r(10326),s=r(38178),l=r(77863);function i({children:e,className:t}){return(0,a.jsxs)(a.Fragment,{children:[a.jsx("div",{className:"h-16"}),a.jsx("div",{className:(0,l.cn)(`
                        fixed 
                        left-0 
                        bottom-0 
                        h-16 
                        w-full 
                        border-t 
                        border-t-border 
                        z-[1] 
                        bg-primary-foreground 
                        dark:bg-background 
                        shadow-md 
                        dark:shadow-foreground/10
                    `),children:a.jsx(s.V,{children:a.jsx("div",{className:(0,l.cn)("flex justify-end gap-x-4",t),children:e})})})]})}},18048:(e,t,r)=>{"use strict";r.d(t,{u:()=>n});var a=r(10326);r(17577);var s=r(62288),l=r(77863);let i=(0,r(60114).Ue)((e,t)=>({modals:{},open(t){e(e=>({modals:{...e.modals,[t]:!0}}))},toggle(r){let a=t().modals;e(e=>({modals:{...e.modals,[r]:!a[r]}}))},close(t){e(e=>({modals:{...e.modals,[t]:!1}}))},isOpen:e=>!!t().modals[e],set(t){e(e=>({modals:{...e.modals,...t}}))}}));function n({id:e,children:t,title:r,description:n,actions:o,trigger:d,contentProps:c,footerProps:u,...f}){let{close:h,isOpen:m,set:x}=i();return a.jsx(a.Fragment,{children:(0,a.jsxs)(s.Vq,{...f,open:(e?m(e):void 0)||f.open,onOpenChange:t=>{e&&x({[e]:t}),f?.onOpenChange?.(t)},children:[d,(0,a.jsxs)(s.cZ,{hideCloseButton:!0,className:(0,l.cn)("flex flex-col max-h-[90%] gap-y-4 p-0 m-0 sm:max-w-xl",c?.className),...c,children:[(0,a.jsxs)(s.fK,{className:(0,l.cn)(r||n?"":"hidden","border-b border-b-border px-4 py-4"),children:[a.jsx(s.$N,{className:(0,l.cn)(r?"":"hidden"),children:r}),a.jsx(s.Be,{className:(0,l.cn)(n?"":"hidden"),children:n})]}),a.jsx("div",{className:"flex-1 flex flex-col overflow-y-auto px-4 py-2",children:t}),a.jsx(s.cN,{className:(0,l.cn)("border-t border-t-border px-4 py-2 items-center w-full",o?"":"hidden",u?.className),...u,children:o})]})]})})}},99463:(e,t,r)=>{"use strict";r.d(t,{w:()=>h});var a=r(10326),s=r(17577),l=r(74723),i=r(58464),n=r(7890),o=r(34474),d=r(31048),c=r(53313),u=r(90772),f=r(77863);function h({id:e,label:t,hide:r,title:h,description:m,data:x,disabled:g,onSave:p}){let b=(0,s.useMemo)(()=>{let t=!1;return Object.values(x).forEach(r=>{r[e]&&(t=!0)}),t},[x,e]),{reset:y,watch:v,setValue:j,handleSubmit:w}=(0,l.cI)({defaultValues:{...i.$7,...x}}),N=v("fontSize"),R=v("fontWeight"),C=v("fontStyle"),$=v("textColor"),Z=w(p),[I,E]=(0,s.useState)(!1);return r?null:a.jsx(a.Fragment,{children:(0,a.jsxs)(n.yo,{onOpenChange:e=>{y({...i.$7,...x}),E(e)},children:[a.jsx(n.aM,{asChild:!0,children:a.jsx(u.z,{variant:"link",className:(0,f.cn)("p-0 text-xs",!b&&"text-muted-foreground/80 hover:text-muted-foreground"),children:t||`${b?"Update":"Set"} preferences`})}),(0,a.jsxs)(n.ue,{hideCloseButton:!0,className:"px-0 py-0 flex flex-col gap-y-4 h-full",children:[(0,a.jsxs)(n.Tu,{className:"px-4 py-4 border-b border-b-border",children:[a.jsx(n.bC,{children:h}),a.jsx(n.Ei,{className:m?"":"hidden",children:m})]}),a.jsx("div",{className:"flex-1 overflow-y-auto px-4 flex flex-col gap-y-6",children:I&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex gap-x-2 items-center",children:[a.jsx(d._,{secondary:!0,htmlFor:`fontSize.${e}`,children:"Font size"}),a.jsx("div",{children:(0,a.jsxs)(o.Ph,{value:N[e]||"default",required:!0,name:`fontSize.${e}`,disabled:g,onValueChange:t=>{let r=t||void 0;"default"===r&&(r=void 0),j(`fontSize.${e}`,r,{shouldDirty:!0})},children:[a.jsx(o.i4,{children:a.jsx(o.ki,{placeholder:"Default"})}),a.jsx(o.Bw,{children:a.jsx(o.DI,{children:[{label:"Default",value:"default"},{label:"Extra small",value:"xs"},{label:"Small",value:"sm"},{label:"Large",value:"lg"},{label:"Extra large",value:"xl"}].map(e=>a.jsx(o.Ql,{value:e.value,children:e.label},e.value))})})]})})]}),a.jsx("div",{children:(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[!!$[e]&&(0,a.jsxs)("div",{className:"flex gap-x-2 items-center",children:[a.jsx(d._,{secondary:!0,htmlFor:`textColor.${e}`,children:"Text color"}),a.jsx("input",{type:"color",value:$[e],onChange:t=>j(`textColor.${e}`,t.target.value,{shouldDirty:!0})})]}),(0,a.jsxs)("div",{className:"flex gap-x-2",children:[a.jsx(c.X,{id:`defaultTextColor.${e}`,name:`defaultTextColor.${e}`,disabled:g,checked:!$[e],onCheckedChange:()=>{let t=$[e]?void 0:"#000000";j(`textColor.${e}`,t,{shouldDirty:!0})}}),a.jsx(d._,{secondary:!0,htmlFor:`defaultTextColor.${e}`,children:"Default text color"})]})]})}),(0,a.jsxs)("div",{className:"flex gap-4 flex-wrap",children:[(0,a.jsxs)("div",{className:"flex gap-x-2",children:[a.jsx(c.X,{name:"bold",id:"bold",disabled:g,checked:"bold"===R[e],onCheckedChange:()=>j(`fontWeight.${e}`,R[e]?void 0:"bold",{shouldDirty:!0})}),a.jsx(d._,{secondary:!0,htmlFor:"bold",children:"Bold"})]}),(0,a.jsxs)("div",{className:"flex gap-x-2",children:[a.jsx(c.X,{name:"italic",id:"italic",disabled:g,checked:(C[e]||[]).includes("italic"),onCheckedChange:()=>{let t=C[e]||[];t.includes("italic")?t=t.filter(e=>"italic"!==e):t.push("italic"),t.length||(t=void 0),j(`fontStyle.${e}`,t,{shouldDirty:!0})}}),a.jsx(d._,{secondary:!0,htmlFor:"italic",children:"Italic"})]})]})]})}),(0,a.jsxs)(n.FF,{className:"px-4 py-4 border-t border-t-border",children:[a.jsx("div",{className:"ml-auto"}),a.jsx(n.sw,{asChild:!0,children:a.jsx(u.z,{variant:"outline",children:"Cancel"})}),a.jsx(n.sw,{asChild:!0,children:a.jsx(u.z,{disabled:g,onClick:()=>Z(),children:"Save"})})]})]})]})})}},54432:(e,t,r)=>{"use strict";r.d(t,{I:()=>i});var a=r(10326),s=r(17577),l=r(77863);let i=s.forwardRef(({className:e,type:t,noRing:r,error:s,...i},n)=>a.jsx("input",{type:t,className:(0,l.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r&&"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",s&&"border-danger",s&&!r&&"focus-visible:ring-danger",e),ref:n,...i}));i.displayName="Input"},88846:(e,t,r)=>{"use strict";r.d(t,{E:()=>o,m:()=>d});var a=r(10326),s=r(17577),l=r(18623),i=r(53982),n=r(77863);let o=s.forwardRef(({className:e,...t},r)=>a.jsx(l.fC,{className:(0,n.cn)("grid gap-2",e),...t,ref:r}));o.displayName=l.fC.displayName;let d=s.forwardRef(({className:e,...t},r)=>a.jsx(l.ck,{ref:r,className:(0,n.cn)("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:a.jsx(l.z$,{className:"flex items-center justify-center",children:a.jsx(i.Z,{className:"h-2.5 w-2.5 fill-current text-current"})})}));d.displayName=l.ck.displayName},87673:(e,t,r)=>{"use strict";r.d(t,{g:()=>i});var a=r(10326),s=r(17577),l=r(77863);let i=s.forwardRef(({className:e,noRing:t,...r},s)=>a.jsx("textarea",{className:(0,l.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t&&"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",e),ref:s,...r}));i.displayName="Textarea"},82617:(e,t,r)=>{"use strict";r.d(t,{ScriptsContextProvider:()=>u,h:()=>c});var a=r(10326),s=r(17577),l=r(35047),i=r(15491),n=r(44099),o=r(12260);let d=(0,s.createContext)(null),c=()=>(0,s.useContext)(d);function u({children:e,...t}){let r=function({}){let e=(0,l.useRouter)(),{scriptId:t}=(0,l.useParams)(),{parsed:r}=(0,o.l)(),[a,d]=(0,s.useState)(!1),[c,u]=(0,s.useState)({data:[]}),[f,h]=(0,s.useState)(!1),[m,x]=(0,s.useState)([]),g=(0,s.useCallback)(()=>{e.push("/")},[e]),p=(0,s.useCallback)(()=>{e.push(`/script/${t}?${i.Z.stringify({...r,section:"screens"})}`)},[e,r,t]),b=(0,s.useCallback)(()=>{e.push(`/script/${t}?${i.Z.stringify({...r,section:"diagnoses"})}`)},[e,r,t]),y=(0,s.useCallback)(async()=>{try{d(!0);let e=await n.Z.get("/api/screens/list?data="+JSON.stringify({returnDraftsIfExist:!0,scriptsIds:[t]}));if(e.data?.errors?.length)throw Error(e.data.errors.join(", "));u(e.data)}catch(e){alert({title:"",message:"Error: "+e.message,variant:"error"})}finally{d(!1)}},[t,open,alert]);return{screens:c,screensLoading:a,keys:m,keysLoading:f,loadKeys:(0,s.useCallback)(async()=>{try{h(!0);let e=await n.Z.get("/api/scripts/keys?data="+JSON.stringify({returnDraftsIfExist:!0,scriptsIds:[t]}));if(e.data?.errors?.length)throw Error(e.data.errors.join(", "));let r=e.data.data.reduce((e,t)=>[...e,...t.keys],[]);x(r)}catch(e){alert({title:"",message:"Error: "+e.message,variant:"error"})}finally{h(!1)}},[t,open,alert]),loadScreens:y,onCancelDiagnosisForm:b,onCancelScreenForm:p,onCancelScriptForm:g}}(t);return a.jsx(d.Provider,{value:{...t,...r},children:e})}},12260:(e,t,r)=>{"use strict";r.d(t,{l:()=>i});var a=r(35047),s=r(15491),l=r(17577);function i(){let e=(0,a.useRouter)(),t=(0,a.useSearchParams)(),r=(0,l.useMemo)(()=>t.toString(),[t]),i=(0,l.useMemo)(()=>s.Z.parse(t.toString()),[t]),n=(0,l.useCallback)(e=>s.Z.stringify({...i,...e}),[i]),o=(0,l.useCallback)(t=>{e.push(`?${n(t)}`)},[n,e]);return{parsed:i,stringified:r,replace:(0,l.useCallback)(t=>{e.replace(`?${n(t)}`)},[n,e]),push:o,toSearchParams:n}}},61892:(e,t,r)=>{"use strict";function a(e){return null==e||""===e}r.d(t,{x:()=>a})},41236:(e,t,r)=>{"use strict";r.d(t,{_:()=>o});var a=r(19510),s=r(57371),l=r(39755),i=r(24569),n=r(46697);function o({title:e,backLink:t,children:r}){return a.jsx("div",{className:"pb-20",children:a.jsx(i.V,{className:"flex flex-col gap-y-4",children:a.jsx(n.Zb,{children:(0,a.jsxs)(n.aY,{className:"p-0",children:[!!e&&(0,a.jsxs)("div",{className:"text-xl flex items-center gap-x-4 mb-4 p-4",children:[!!t&&a.jsx(s.default,{href:t,children:a.jsx(l.Z,{className:"h-5 w-5"})}),a.jsx("span",{children:e})]}),r]})})})})}},95602:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>b});var a=r(19510),s=r(58585),l=r(85576),i=r(47080),n=r(2111),o=r(68570);let d=(0,o.createProxy)(String.raw`/home/farai/Workbench/Neotree/neotree-editor-master/contexts/scripts/index.tsx`),{__esModule:c,$$typeof:u}=d;d.default,(0,o.createProxy)(String.raw`/home/farai/Workbench/Neotree/neotree-editor-master/contexts/scripts/index.tsx#ScriptsContext`),(0,o.createProxy)(String.raw`/home/farai/Workbench/Neotree/neotree-editor-master/contexts/scripts/index.tsx#useScriptsContext`);let f=(0,o.createProxy)(String.raw`/home/farai/Workbench/Neotree/neotree-editor-master/contexts/scripts/index.tsx#ScriptsContextProvider`);var h=r(85431),m=r(66267),x=r(24569),g=r(46697),p=r(75644);async function b({children:e}){let{user:t,yes:r}=await (0,m.canAccessPage)();if(t||(0,s.redirect)("/login"),!r)return a.jsx(x.V,{children:a.jsx(g.Zb,{children:a.jsx(g.aY,{className:"p-4 text-xl text-center text-danger bg-danger/10",children:"You don't have sufficient rights to access this page!"})})});let[o]=await Promise.all([(0,n.getHospitals)()]);return(0,a.jsxs)(a.Fragment,{children:[a.jsx(h.D,{children:"Scripts"}),a.jsx(p.g2,{children:a.jsx(f,{...l,...i,hospitals:o,getHospitals:n.getHospitals,children:e})})]})}},17162:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>n});var a=r(19510),s=r(21113),l=r(24569),i=r(46697);function n(){return a.jsx(l.V,{children:a.jsx(i.Zb,{children:a.jsx(i.aY,{className:"p-0",children:a.jsx(s.w,{loading:!0,maxRows:25,columns:[{name:"Key"},{name:"Label"},{name:"Description"},{name:"Action",align:"right",cellClassName:"w-20"}],data:[]})})})})}},47080:(e,t,r)=>{"use strict";r.r(t),r.d(t,{getFiles:()=>m,uploadFile:()=>x,uploadFileFromSite:()=>g});var a=r(24330);r(60166);var s=r(9576),l=r(61460),i=r(89114),n=r(57435),o=r(44652),d=r(66267),c=r(59271),u=r(49530),f=r(20123),h=r(40618);let m=i.Re;async function x(e,t){let r={success:!1,data:null};try{for(let a of(await (0,d.isAllowed)(["upload_files"]),Array.from(e.entries()))){let[i,n]=a;if("object"==typeof n){let a=Buffer.from(await n.arrayBuffer()),i=e.get("fileId")?.toString()||(0,s.Z)(),d={...(0,o.R)(e.get("metadata")?.toString()||"{}")},c=(e.get("size")?function(e,t){if("0"==`${e}`)return 0;let r=`${e||""}`.replaceAll(" ",""),[a,s]=(r=r.includes(".")?r.replaceAll(",",""):r.split(",").length>2?r.replaceAll(",",""):r.replaceAll(",",".")).split("."),l=!a||isNaN(Number(a))?"":a;return""==(l+=!s||isNaN(Number(s))?"":`.${s}`)||void 0===l||isNaN(Number(l))?t?.notNull?0:null:Number(l)}((0,o.R)(e.get("size")?.toString())):0)||n.size,u=e.get("filename")?.toString()||n.name,f=[i,u].filter(e=>e).join("__");(d.width||d.height)&&(f=`${f}?w=${d.width}&h=${d.height}`),r=await (0,l.G)({fileId:i,data:a,filename:f,size:c,contentType:e.get("contentType")?.toString()||n.type,metadata:d},t)}}}catch(e){r.success=!1,r.errors=[e.message],n.Z.error("uploadFile ERROR",e.message)}finally{return r}}async function g({fileId:e,siteURL:t}){try{let r=await (0,f.QF)({links:[t]});if(r.errors)throw Error(r.errors.join(", "));let{data:[a]}=r;if(!a)throw Error(`Site (${t}) was not found!`);let s=await (0,c.U)({baseURL:a.link,apiKey:a.apiKey}),n=await (0,i._I)(e);if(n.errors)throw Error(n.errors.join(", "));if(n?.data){let t=u.Z.stringify({...n.data.metadata});return t=t?`?${t}`:"",{data:{fileId:e,fileURL:[process.env.NEXT_PUBLIC_APP_URL,`/files/${e}${t}`].join("")}}}let o=(await s.get(`/api/files/${e}/download`)).data;if(o.errors)throw Error(o.errors.join(", "));if(!o.data)return{errors:["File not found"],data:null};await (0,l.G)({fileId:e,data:o.data.data,filename:o.data.filename,size:o.data.size,contentType:o.data.contentType,metadata:{...o.data.metadata}});let d=u.Z.stringify({...o.data.metadata});return d=d?`?${d}`:"",{data:{fileId:e,fileURL:[a.link,`/files/${e}${d}`].join("")}}}catch(e){return n.Z.error("downloadFileFromSite ERROR",e.message),{data:null,errors:[e.message]}}}(0,h.h)([m,x,g]),(0,a.j)("b8b7f31dbd943dea24b6f50846c5726097eed2b6",m),(0,a.j)("c0510f4977b119cc8ad2ab30703dd3471188c2de",x),(0,a.j)("eda86c5135bf9ed42d0ba911e5e86f10d5e38f37",g)},2111:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$ACTION_0:()=>x,$$ACTION_1:()=>p,$$ACTION_2:()=>y,$$ACTION_3:()=>j,$$ACTION_4:()=>N,countHospitals:()=>g,deleteHospitals:()=>m,getHospital:()=>v,getHospitals:()=>b,saveHospitals:()=>w});var a=r(24330);r(60166);var s=r(57745),l=r(57435),i=r(10413),n=r(88728),o=r(88317);async function d(e){let t={success:!1};try{let r=e.filter(e=>e.id),a=e.filter(e=>!e.id),l=[];for(let e of r)try{await i.Z.update(n.hospitals).set(e).where((0,s.eq)(n.hospitals.id,e.id))}catch(e){l.push(e.message)}a.length&&await i.Z.insert(n.hospitals).values(a),l.length?t.errors=l:t.success=!0}catch(e){t.success=!1,t.errors=[e.message],l.Z.error("_saveHospitals ERROR",e.message)}finally{return t?.errors?.length||o.Z.emit("data_changed","save_hospitals"),t}}async function c(e){let t={success:!1},{ids:r,hospitalsIds:a,confirmDeleteAll:d}={...e};try{let e=[r?.length?(0,s.d3)(n.hospitals.id,r):void 0,a?.length?(0,s.d3)(n.hospitals.hospitalId,a):void 0].filter(e=>e);if(!e.length&&!d)throw Error("Please confirm that you want to delete all the hospitals!");await i.Z.delete(n.hospitals).where((0,s.xD)(...e)),t.success=!0}catch(e){t.success=!1,t.errors=[e.message],l.Z.error("_deleteHospitals ERROR",e.message)}finally{return t?.errors?.length||o.Z.emit("data_changed","delete_hospitals"),t}}var u=r(88453),f=r(66267),h=r(40618);let m=(0,a.j)("d5c6b9491daa56650d239a681f4b7ef41eecdbba",x);async function x(...e){try{return await (0,f.isAllowed)(),await c(...e)}catch(e){return l.Z.error("deleteHospitals ERROR",e.message),{errors:[e.message],success:!1}}}let g=(0,a.j)("512d9beb792a3d4bcdd04c9eae6b9afe27f489d7",p);async function p(...e){try{return await (0,f.isAllowed)(),await (0,u.Py)(...e)}catch(e){return l.Z.error("countHospitals ERROR",e.message),{errors:[e.message],data:0}}}let b=(0,a.j)("c6587359cfe940e0386c1df8bc41d1447f620a00",y);async function y(...e){try{return await (0,f.isAllowed)(),await (0,u.O8)(...e)}catch(e){return l.Z.error("getHospitals ERROR",e.message),{errors:[e.message],data:[]}}}let v=(0,a.j)("f6a3e20114d0088487156ad1ed83fa447308a2c2",j);async function j(...e){return await (0,f.isAllowed)(),await (0,u.C9)(...e)}let w=(0,a.j)("022bf5b1fe01e26cfa7b1f6a0047ec026c4dcf1c",N);async function N(...e){try{return await (0,f.isAllowed)(),await d(...e)}catch(e){return l.Z.error("getSys ERROR",e.message),{errors:[e.message],data:void 0,success:!1}}}(0,h.h)([m,g,b,v,w]),(0,a.j)("73bf4fdecbc868eedca8795ad97dab204bd8e733",m),(0,a.j)("b4efaa4b05ecb7cadbe89680c6b2171ace31e9ce",g),(0,a.j)("8448ebc9389f802b020e8db31ea50a0da52f6bb6",b),(0,a.j)("1de8eac2e741b7fda1f80c8c2b40e9dfc9113033",v),(0,a.j)("4df001c0931c69623054287626dfa19f4f2755e4",w)},61460:(e,t,r)=>{"use strict";r.d(t,{G:()=>o});var a=r(88317),s=r(57435),l=r(10413),i=r(88728),n=r(89114);async function o(e,t){let r={success:!1,data:null};try{if(!e.fileId)throw Error("Missing fileId");if(!e.data)throw Error("No file uploaded");await l.Z.insert(i.files).values(e);let s=await (0,n._I)(e.fileId);if(!s)throw Error("Failed to upload file");r.success=!0,r.data=s.data,s.data&&t?.broadcastAction!==!1&&a.Z.emit("file_uploaded")}catch(e){r.success=!1,r.errors=[e.message],s.Z.error("_uploadFile ERROR",e.message)}finally{return r}}},89114:(e,t,r)=>{"use strict";r.d(t,{_I:()=>d,Re:()=>m,KU:()=>o});var a=r(57745),s=r(10413),l=r(88728),i=r(57435),n=r(44380);async function o(e){try{let t=await s.Z.query.files.findFirst({where:(0,a.eq)(l.files.fileId,e)});return{data:t?{...t,url:(0,n.TI)(`/files/${t.fileId}`)}:null}}catch(e){return i.Z.error("_getFiles ERROR",e.message),{errors:[e.message],data:null}}}async function d(e){try{let t=await s.Z.query.files.findFirst({where:(0,a.eq)(l.files.fileId,e),columns:{contentType:!0,fileId:!0,filename:!0,size:!0,metadata:!0,createdAt:!0}});return{data:t?{...t,url:(0,n.TI)(`/files/${t.fileId}`)}:null}}catch(e){return i.Z.error("_getFiles ERROR",e.message),{errors:[e.message],data:null}}}var c=r(34149),u=r(60938),f=r(81445),h=r(41502);async function m(e){try{let{filesIds:t,archived:r,searchValue:i,limit:o,page:d=1,uploadDateGTE:m,uploadDateLTE:x}={...e},g=Math.max(0,d),p=i?["%",i,"%"].join(""):"",b=[r?(0,a.K0)(l.files.deletedAt):(0,a.Ft)(l.files.deletedAt),...t?.length?[(0,a.d3)(l.files.fileId,t)]:[],...p?[(0,c.i6)`LOWER(screens.name) like LOWER(${p})`]:[],m?(0,a.eg)(l.files.createdAt,"string"==typeof m?new Date(m):m):void 0,x?(0,a.G)(l.files.createdAt,"string"==typeof x?new Date(x):x):void 0],y=s.Z.select({count:(0,u.QX)()}).from(l.files);b.length&&y.where((0,a.xD)(...b));let[{count:v}]=await y.execute(),j=1;v&&(j=(0,h.x)(o)?1:Math.ceil(v/o),g=Math.min(g,j));let w=(0,h.x)(o)?void 0:Math.max(0,(g-1)*o);return{data:(await s.Z.query.files.findMany({where:b.length?(0,a.xD)(...b):void 0,limit:o,offset:w,orderBy:(0,f.C)(l.files.createdAt),columns:{fileId:!0,contentType:!0,filename:!0,size:!0,metadata:!0,createdAt:!0}})).map(e=>({...e,url:(0,n.TI)(`/files/${e.fileId}`)})),searchValue:i,totalPages:j,totalRows:v,page:g,limit:o}}catch(e){return i.Z.error("_getFiles ERROR",e.message),{errors:[e.message],data:[],totalPages:0,totalRows:0,page:1}}}},88453:(e,t,r)=>{"use strict";r.d(t,{Py:()=>u,C9:()=>d,O8:()=>o});var a=r(57745),s=r(30900),l=r(10413),i=r(88728),n=r(57435);async function o(e){try{let{hospitalsIds:t}={...e},r=t||[],n=r?.length?(0,a.d3)(i.hospitals.hospitalId,r.filter(e=>s.Z(e))):void 0,o=r?.length?(0,a.d3)(i.hospitals.oldHospitalId,r.filter(e=>!s.Z(e))):void 0,d=[(0,a.Ft)(i.hospitals.deletedAt),...n&&o?[(0,a.or)(n,o)]:[]];return{data:(await l.Z.select({hospital:i.hospitals}).from(i.hospitals).where(d.length?(0,a.xD)(...d):void 0)).map(e=>e.hospital)}}catch(e){return n.Z.error("_getHospitals ERROR",e.message),{data:[],errors:[e.message]}}}async function d(e){let{hospitalId:t}={...e};try{if(!t)throw Error("Missing hospitalId");let e=s.Z(t)?(0,a.eq)(i.hospitals.hospitalId,t):void 0,r=s.Z(t)?void 0:(0,a.eq)(i.hospitals.oldHospitalId,t);return{data:await l.Z.query.hospitals.findFirst({where:(0,a.xD)((0,a.Ft)(i.hospitals.deletedAt),e||r)})}}catch(e){return n.Z.error("_getHospital ERROR",e.message),{errors:[e.message]}}}var c=r(60938);async function u(){try{let[{count:e}]=await l.Z.select({count:(0,c.QX)()}).from(i.hospitals);return{data:e}}catch(e){return n.Z.error("_getHospitals ERROR",e.message),{data:0,errors:[e.message]}}}},44652:(e,t,r)=>{"use strict";function a(e){try{return JSON.parse(e)}catch(e){return null}}r.d(t,{R:()=>a})}};