"use strict";exports.id=2179,exports.ids=[2179],exports.modules={82179:(e,i,s)=>{s.d(i,{A:()=>A});var a=s(10326),t=s(17577),r=s(35047),l=s(15491),n=s(47463),o=s(2165),d=s(7890),u=s(34474),c=s(81646),m=s(53313),g=s(90772),h=s(54432),x=s(87673),y=s(31048),v=s(11870),f=s(75172),p=s(58464),b=s(46670),j=s(79131);let N=[{value:"drug",label:"Drug"},{value:"fluid",label:"Fluid"}],F=(e,i="drug")=>({itemId:`${e?.itemId||(0,n.Z)()}`,type:`${e?.type||i}`,key:`${e?.key||""}`,keyId:`${e?.keyId||""}`,drug:`${e?.drug||""}`,minGestation:`${e?.minGestation===null?"":e?.minGestation}`,maxGestation:`${e?.maxGestation===null?"":e?.maxGestation}`,minWeight:`${e?.minWeight===null?"":e?.minWeight}`,maxWeight:`${e?.maxWeight===null?"":e?.maxWeight}`,minAge:`${e?.minAge===null?"":e?.minAge}`,maxAge:`${e?.maxAge===null?"":e?.maxAge}`,dosage:`${e?.dosage===null?"":e?.dosage}`,dosageMultiplier:`${e?.dosageMultiplier===null?"":e?.dosageMultiplier}`,hourlyFeed:`${e?.hourlyFeed===null?"":e?.hourlyFeed}`,hourlyFeedDivider:`${e?.hourlyFeedDivider===null?"":e?.hourlyFeedDivider}`,dayOfLife:`${e?.dayOfLife||""}`,dosageText:`${e?.dosageText||""}`,managementText:`${e?.managementText||""}`,gestationKey:`${e?.gestationKey||""}`,weightKey:`${e?.weightKey||""}`,diagnosisKey:`${e?.diagnosisKey||""}`,gestationKeyId:`${e?.gestationKeyId||""}`,weightKeyId:`${e?.weightKeyId||""}`,diagnosisKeyId:`${e?.diagnosisKeyId||""}`,condition:`${e?.condition||""}`,administrationFrequency:`${e?.administrationFrequency||""}`,drugUnit:`${e?.drugUnit||""}`,routeOfAdministration:`${e?.routeOfAdministration||""}`,ageKey:`${e?.ageKey||""}`,ageKeyId:`${e?.ageKeyId||""}`,validationType:`${e?.validationType||"default"}`});function A({disabled:e,item:i,floating:s,onChange:n}){let A=(0,r.useRouter)(),C=(0,r.useSearchParams)(),w=(0,t.useMemo)(()=>l.Z.parse(C.toString()),[C]),{itemId:k,addItem:I}=w,[$,K]=(0,o.Z)(),[G,S]=(0,o.Z)(),[D,T]=(0,t.useState)(!1),[W,M]=(0,t.useState)(F(i,I)),{keys:_,loading:L}=(0,f.a)(),{confirm:Z}=(0,b.t)(),q=(0,t.useCallback)(()=>{let e=()=>{n({...W,minWeight:W.minWeight?Number(W.minWeight):null,maxWeight:W.maxWeight?Number(W.maxWeight):null,minGestation:W.minGestation?Number(W.minGestation):null,maxGestation:W.maxGestation?Number(W.maxGestation):null,hourlyFeed:W.hourlyFeed?Number(W.hourlyFeed):null,hourlyFeedDivider:W.hourlyFeedDivider?Number(W.hourlyFeedDivider):null,minAge:W.minAge?Number(W.minAge):null,maxAge:W.maxAge?Number(W.maxAge):null,dosage:W.dosage?Number(W.dosage):null,dosageMultiplier:W.dosageMultiplier?Number(W.dosageMultiplier):null,type:W.type}),T(!1)};i&&W.key!==i?.key?Z(e,{danger:!0,title:"Confirm key change",message:`
                    <p class="text-xl">Are you sure you want to change key?</p>
                    <p>All references to the old key (${i.key}) will also be updated to: ${W.key}</p>
                `,positiveLabel:"Yes, keep changes",negativeLabel:"No, do not save"}):e()},[W,i,n]),O=(0,t.useCallback)(()=>{T(!1),M(F(void 0,I)),A.push(`?${l.Z.stringify({...w,itemId:void 0,addItem:void 0})}`);let e=K?.top||0;setTimeout(()=>window.scrollTo({top:e}),500)},[w,K,A.push]),{isFormComplete:E,isDrug:U,isFluid:z,validateWithCondition:R}=(0,t.useMemo)(()=>{let e="drug"===W.type,i="fluid"===W.type,s="condition"===W.validationType,a=!!(W.type&&W.key&&W.drug&&W.managementText&&W.dosageText&&W.administrationFrequency&&W.drugUnit&&W.routeOfAdministration&&W.dosage&&s?W.condition:W.weightKey&&W.minWeight&&W.maxWeight&&W.gestationKey&&W.minGestation&&W.maxGestation&&W.ageKey&&W.minAge&&W.maxAge&&Number(W.minGestation||"0")<=Number(W.maxGestation||"0")&&Number(W.minWeight||"0")<=Number(W.maxWeight||"0")&&Number(W.minAge||"0")<=Number(W.maxAge||"0")&&(!e||W.diagnosisKey)&&(!i||W.condition&&W.hourlyFeed&&W.hourlyFeedDivider&&Number(W.hourlyFeed||"0")<=Number(W.hourlyFeed||"0")&&Number(W.hourlyFeedDivider||"0")<=Number(W.hourlyFeedDivider||"0")));return{isDrug:e,isFluid:i,isFormComplete:a,validateWithCondition:s}},[W,I]),V=(0,t.useCallback)(()=>!E||L||e,[E,L,e]),B=(0,a.jsxs)("div",{className:"flex flex-col gap-y-4",children:[(0,a.jsxs)("div",{children:[a.jsx(y._,{secondary:!0,htmlFor:"type",children:"Type *"}),(0,a.jsxs)(u.Ph,{value:W.type,required:!0,name:"type",disabled:e,onValueChange:e=>{let s=F(i?.type===e?i:void 0,I);Z(()=>M(i=>({...i,type:e,hourlyFeed:s.hourlyFeed,hourlyFeedDivider:s.hourlyFeedDivider,condition:s.condition,diagnosisKey:s.diagnosisKey,drugUnit:s.drugUnit})),{danger:!0,title:"Confirm type change",message:`
                                <p class="text-xl">Are you sure you want to change type?</p>
                                <ol style="list-style:auto;margin:10px;">
                                    <li>Some fields will be cleared as they do not apply on all types!</li>
                                    <li>All references to this ${W.type} will be removed.</li>
                                </ol>
                            `,positiveLabel:"Yes, change type",negativeLabel:"No, keep the current type"})},children:[a.jsx(u.i4,{children:a.jsx(u.ki,{placeholder:"Select type"})}),a.jsx(u.Bw,{children:a.jsx(u.DI,{children:N.map(e=>a.jsx(u.Ql,{value:e.value,children:e.label},e.value))})})]})]}),(0,a.jsxs)("div",{children:[a.jsx(y._,{secondary:!0,htmlFor:"key",children:"Key *"}),a.jsx(h.I,{name:"key",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:W.key,disabled:e,onChange:e=>M(i=>({...i,key:e.target.value}))})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)(y._,{secondary:!0,htmlFor:"drug",children:[(0,j.Z)(W.type)," *"]}),a.jsx(h.I,{name:"drug",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:W.drug,disabled:e,onChange:e=>M(i=>({...i,drug:e.target.value}))})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)(y._,{secondary:!0,htmlFor:"condition",children:["Condition ",R?"*":""]}),a.jsx(x.g,{rows:3,name:"condition",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:W.condition,disabled:e,onChange:e=>M(i=>({...i,condition:e.target.value}))}),(0,a.jsxs)("span",{className:"font-bold opacity-50 text-xs",children:["e.g ",p._S]})]}),(0,a.jsxs)("div",{className:"flex gap-x-2",children:[a.jsx(m.X,{name:"validationType",id:"validationType",disabled:e,checked:"condition"===W.validationType,onCheckedChange:e=>M(e=>({...e,validationType:"condition"===e.validationType?"default":"condition"}))}),a.jsx(y._,{secondary:!0,htmlFor:"validationType",children:"Validate with conditional expression only"})]}),U&&(0,a.jsxs)("div",{children:[(0,a.jsxs)(y._,{secondary:!0,htmlFor:"diagnosisKey",children:["Diagnosis Key ",R?"":"*"]}),a.jsx(x.g,{rows:3,name:"gestationKey",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:W.diagnosisKey,disabled:e,onChange:e=>M(i=>({...i,diagnosisKey:e.target.value}))}),a.jsx("span",{className:"font-bold opacity-50 text-xs",children:"e.g NSep,Premature,Dehyd"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)(y._,{secondary:!0,htmlFor:"gestationKey",children:["Gestation Key ",R?"":"*"]}),a.jsx(c.L,{modal:!0,value:`${W.gestationKey||""}`,disabled:e,onChange:([e])=>{M(i=>({...i,gestationKey:e.name,gestationKeyId:e?.uniqueKey}))}})]}),(0,a.jsxs)("div",{className:"flex gap-x-2",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)(y._,{secondary:!0,htmlFor:"minGestation",children:["Min Gestation (weeks) ",R?"":"*"]}),a.jsx(h.I,{name:"minGestation",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:W.minGestation,type:"number",disabled:e,onChange:e=>{let i=e.target.value,s=W.maxGestation;i||(s=""),M(e=>({...e,minGestation:i,maxGestation:s}))}})]}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)(y._,{secondary:!0,htmlFor:"maxGestation",error:Number(W.minGestation||"0")>Number(W.maxGestation||"0"),children:["Max Gestation (weeks) ",R?"":"*"]}),a.jsx(h.I,{name:"maxGestation",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:W.maxGestation,type:"number",disabled:e||!W.minGestation,min:W.minGestation,error:Number(W.minGestation||"0")>Number(W.maxGestation||"0"),onChange:e=>M(i=>({...i,maxGestation:e.target.value}))})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)(y._,{secondary:!0,htmlFor:"weightKey",children:["Weight Key ",R?"":"*"]}),a.jsx(c.L,{modal:!0,value:`${W.weightKey||""}`,disabled:e,onChange:([e])=>{M(i=>({...i,weightKey:e.name,weightKeyId:e?.uniqueKey}))}})]}),(0,a.jsxs)("div",{className:"flex gap-x-2",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)(y._,{secondary:!0,htmlFor:"minWeight",children:["Min Weight (grams) ",R?"":"*"]}),a.jsx(h.I,{name:"minWeight",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:W.minWeight,type:"number",disabled:e,onChange:e=>{let i=e.target.value,s=W.maxWeight;i||(s=""),M(e=>({...e,minWeight:i,maxWeight:s}))}})]}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)(y._,{secondary:!0,htmlFor:"maxWeight",error:Number(W.minWeight||"0")>Number(W.maxWeight||"0"),children:["Max Weight (grams) ",R?"":"*"]}),a.jsx(h.I,{name:"maxWeight",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:W.maxWeight,type:"number",disabled:e||!W.minWeight,min:W.minWeight,error:Number(W.minWeight||"0")>Number(W.maxWeight||"0"),onChange:e=>M(i=>({...i,maxWeight:e.target.value}))})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)(y._,{secondary:!0,htmlFor:"ageKey",children:["Day of Life (Age) Key ",R?"":"*"]}),a.jsx(c.L,{modal:!0,value:`${W.ageKey||""}`,disabled:e,onChange:([e])=>{M(i=>({...i,ageKey:e.name,ageKeyId:e?.uniqueKey}))}})]}),(0,a.jsxs)("div",{className:"flex gap-x-2",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)(y._,{secondary:!0,htmlFor:"minAge",children:["Min Day of Life (Age - hours) ",R?"":"*"]}),a.jsx(h.I,{name:"minAge",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:W.minAge,type:"number",disabled:e,onChange:e=>{let i=e.target.value,s=W.maxAge;i||(s=""),M(e=>({...e,minAge:i,maxAge:s}))}})]}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)(y._,{secondary:!0,htmlFor:"maxAge",error:Number(W.minAge||"0")>Number(W.maxAge||"0"),children:["Max Day of Life (Age - hours) ",R?"":"*"]}),a.jsx(h.I,{name:"maxAge",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:W.maxAge,type:"number",disabled:e||!W.minAge,min:W.minAge,error:Number(W.minAge||"0")>Number(W.maxAge||"0"),onChange:e=>M(i=>({...i,maxAge:e.target.value}))})]})]}),z&&a.jsx(a.Fragment,{children:(0,a.jsxs)("div",{className:"flex gap-x-2",children:[(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx(y._,{secondary:!0,htmlFor:"hourlyFeed",children:"Hourly feed *"}),a.jsx(h.I,{name:"hourlyFeed",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:W.hourlyFeed,type:"number",disabled:e,onChange:e=>M(i=>({...i,hourlyFeed:e.target.value}))})]}),(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx(y._,{secondary:!0,htmlFor:"hourlyFeedDivider",children:"Hourly feed divider *"}),a.jsx(h.I,{name:"hourlyFeedDivider",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:W.hourlyFeedDivider,type:"number",disabled:e,onChange:e=>M(i=>({...i,hourlyFeedDivider:e.target.value}))})]})]})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)(y._,{secondary:!0,htmlFor:"dosage",children:["Dose (e.g. ",z?"ml/kg/24hrs":"mg/kg",") *"]}),a.jsx(h.I,{name:"dosage",type:"number",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:W.dosage,disabled:e,onChange:e=>M(i=>({...i,dosage:e.target.value}))})]}),(0,a.jsxs)("div",{children:[a.jsx(y._,{secondary:!0,htmlFor:"dosageMultiplier",children:"Drug Dose Multiplier *"}),a.jsx(h.I,{name:"dosageMultiplier",type:"number",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:W.dosageMultiplier,disabled:e,onChange:e=>M(i=>({...i,dosageMultiplier:e.target.value}))})]}),(0,a.jsxs)("div",{children:[a.jsx(y._,{secondary:!0,htmlFor:"drugUnit",children:"Drug Unit *"}),a.jsx(h.I,{name:"drugUnit",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:W.drugUnit,disabled:e,onChange:e=>M(i=>({...i,drugUnit:e.target.value}))})]}),(0,a.jsxs)("div",{children:[a.jsx(y._,{secondary:!0,htmlFor:"administrationFrequency",children:"Administration Frequency *"}),a.jsx(h.I,{name:"administrationFrequency",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:W.administrationFrequency,disabled:e,onChange:e=>M(i=>({...i,administrationFrequency:e.target.value}))})]}),(0,a.jsxs)("div",{children:[a.jsx(y._,{secondary:!0,htmlFor:"routeOfAdministration",children:"Route of Administration *"}),a.jsx(h.I,{name:"routeOfAdministration",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:W.routeOfAdministration,disabled:e,onChange:e=>M(i=>({...i,routeOfAdministration:e.target.value}))})]}),(0,a.jsxs)("div",{children:[a.jsx(y._,{secondary:!0,htmlFor:"managementText",children:"Management text *"}),a.jsx(h.I,{name:"managementText",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:W.managementText,disabled:e,onChange:e=>M(i=>({...i,managementText:e.target.value}))})]}),(0,a.jsxs)("div",{children:[a.jsx(y._,{secondary:!0,htmlFor:"weight",children:"Dosage text *"}),a.jsx(h.I,{name:"dosageText",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:W.dosageText,disabled:e,onChange:e=>M(i=>({...i,dosageText:e.target.value}))})]})]});return(0,a.jsxs)(a.Fragment,{children:[L&&a.jsx(v.a,{overlay:!0}),a.jsx("div",{ref:$,children:!1===s?B:a.jsx(d.yo,{open:D,onOpenChange:e=>{e||O()},children:(0,a.jsxs)(d.ue,{hideCloseButton:!0,side:"right",className:"p-0 m-0 flex flex-col w-full max-w-full sm:max-w-[80%] md:max-w-[80%] lg:max-w-[50%]",children:[(0,a.jsxs)(d.Tu,{className:"flex flex-row items-center py-2 px-4 border-b border-b-border text-left sm:text-left",children:[(0,a.jsxs)(d.bC,{children:[I?"Add":"",k?"Edit":""," ",i?.type||I]}),a.jsx(d.Ei,{className:"hidden"})]}),a.jsx("div",{ref:G,className:"flex-1 py-2 px-0 overflow-y-auto",children:a.jsx("div",{className:"px-4",children:B})}),(0,a.jsxs)("div",{className:"border-t border-t-border px-4 py-2 flex gap-x-2",children:[a.jsx("span",{className:"text-danger text-xs my-auto",children:"* Required"}),a.jsx("div",{className:"ml-auto"}),a.jsx(d.sw,{asChild:!0,children:a.jsx(g.z,{variant:"ghost",onClick:()=>{},children:"Cancel"})}),a.jsx(g.z,{onClick:()=>q(),disabled:V(),children:"Save"})]})]})})})]})}},81646:(e,i,s)=>{s.d(i,{L:()=>n});var a=s(10326),t=s(17577),r=s(35392),l=s(49596);function n({value:e,disabled:i,modal:s,multiple:n,placeholder:o,error:d,onChange:u,filterDataKeys:c}){let{dataKeys:m,extractDataKeys:g}=(0,l.M)(),h=(0,t.useMemo)(()=>m.filter(e=>!c||c(e)).map(e=>({label:e.name,value:e.uniqueKey,caption:e.dataType||"",description:e.label})),[m,c]);return a.jsx(a.Fragment,{children:a.jsx(r.V,{multiple:n,modal:s,error:d,placeholder:`${e||""}`||o||"Select key",search:{placeholder:"Search data keys"},options:h,onSelect:e=>{let i=g(e.map(e=>e.value)).map(e=>({...e,children:g(e.options)}));u?.(i)}})})}},35392:(e,i,s)=>{s.d(i,{V:()=>m});var a=s(10326),t=s(17577),r=s(47206),l=s(32933),n=s(90772),o=s(54432),d=s(62288),u=s(77863),c=s(61198);function m({options:e,selected:i,...s}){i=Array.isArray(i)?i:i?[i]:[];let t=e.map(e=>({...e,value:`${e.value}`})),r=i.map(e=>`${e}`);if(!s.multiple){let[e]=Array.isArray(r)?r:[r];e&&t.find(i=>i.value===e)}return a.jsx(g,{...s,options:t,selected:r})}function g({modal:e,header:i,placeholder:s,search:m,multiple:g=!1,error:h=!1,disabled:x=!1,selected:y,options:v=[],trigger:f,onTrigger:p,onSelect:b}){let[j,N]=(0,t.useState)(""),F=(0,c.N)(j),[A,C]=(0,t.useState)([]),w=(0,t.useMemo)(()=>y?Array.isArray(y)?y.map(e=>v.find(i=>i?.value===e)).map(e=>e):v.filter(e=>e?.value===y)||[]:[],[y,v]),k=(0,t.useMemo)(()=>v.map(e=>{let i=w.map(e=>e?.value).map(e=>`${e||""}`).filter(e=>e).includes(`${e?.value}`);return i=i||A.includes(e.value),{...e,isSelected:i}}).sort((e,i)=>(e.disabled?1:0)-(i.disabled?1:0)).sort((e,i)=>{let s=e.isSelected?1:0;return(i.isSelected?1:0)-s}).filter(e=>JSON.stringify([e.value||"",e.label||"",e.description||""]).toLowerCase().match(F.toLowerCase())),[v,F,w,A]);return a.jsx(a.Fragment,{children:(0,a.jsxs)(d.Vq,{modal:e,onOpenChange:()=>{N(""),C([])},children:[a.jsx(d.hg,{asChild:!0,children:f||(0,a.jsxs)(n.z,{disabled:x,variant:"outline",className:(0,u.cn)("justify-between w-full",h&&"border border-destructive hover:bg-destructive/10"),onClick:p,children:[a.jsx("span",{className:w.length?"":"opacity-50",children:w[0]?.label||s||""}),a.jsx(r.Z,{className:"size-4 opacity-50"})]})}),(0,a.jsxs)(d.cZ,{hideCloseButton:!0,className:"flex flex-col max-h-[90%] gap-y-4 p-0 m-0 sm:max-w-xl",children:[(0,a.jsxs)(d.fK,{className:"border-b border-b-border px-4 py-4",children:[a.jsx(d.$N,{className:"hidden",children:""}),a.jsx(d.Be,{className:"hidden",children:""}),(0,a.jsxs)("div",{className:"flex items-center gap-x-4",children:[m?a.jsx("div",{className:"flex-1",children:a.jsx(o.I,{type:"search",placeholder:m.placeholder||"",value:j,onChange:e=>N(e.target.value)})}):null,i]})]}),a.jsx("div",{className:"flex-1 flex flex-col gap-y-1 overflow-y-auto px-4 py-2 overflow-x-hidden",children:k.map(e=>{let i=g?"button":d.GG;return a.jsx(t.Fragment,{children:a.jsx(i,{onClick:()=>{e.disabled||(e.isSelected?g?C(i=>i.filter(i=>i!==e.value)):b?.(w.filter(i=>i.value!==e.value)):g?C(i=>[...i,e.value]):b?.([e]))},className:(0,u.cn)("flex flex-col gap-y-1 border border-border p-2 rounded-md items-start text-left",e.disabled?"opacity-50 cursor-not-allowed":"transition-colors hover:bg-primary/20",e.isSelected&&"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground"),children:(0,a.jsxs)("div",{className:"flex items-center",children:[e.isSelected?a.jsx(l.Z,{className:"size-4 mr-2"}):null,(0,a.jsxs)("div",{children:[e.caption?a.jsx("div",{className:"text-xs opacity-60",dangerouslySetInnerHTML:{__html:e.caption||""}}):null,a.jsx("p",{children:e.label}),e.description?a.jsx("div",{className:"text-xs opacity-60",dangerouslySetInnerHTML:{__html:e.description||""}}):null]})]})})},e.value)})}),(0,a.jsxs)(d.cN,{className:"border-t border-t-border px-4 py-2 items-center w-full gap-x-2",children:[a.jsx(d.GG,{asChild:!0,children:a.jsx(n.z,{variant:"ghost",children:"Close"})}),!!A.length&&a.jsx(d.GG,{asChild:!0,children:a.jsx(n.z,{onClick:()=>{b?.(A.map(e=>k.find(i=>i.value===e)).filter(e=>e))},children:"Save"})})]})]})]})})}},75172:(e,i,s)=>{s.d(i,{a:()=>c});var a=s(17577),t=s(35047),r=s(15491),l=s(44099),n=s(60114),o=s(96221);s(63697);let d={initialised:!1,loading:!1,keys:[],drugs:[]},u=(0,n.Ue)(e=>d);function c(){let e=u(),{drugs:i}=e,s=(0,t.useRouter)(),n=(0,t.useSearchParams)(),c=(0,a.useMemo)(()=>r.Z.parse(n.toString()),[n]),{itemId:m}=c,g=(0,a.useMemo)(()=>i.filter(e=>e.itemId===m||e.key===m)[0]?.itemId,[m,i]),{alert:h}=(0,o.s)(),x=(0,a.useCallback)(()=>{let e=[],s=i.map(e=>[e.drug||"",e.type||"",e.key||"",e.dosageText||"",e.itemId]);return{tableData:s=s.filter((s,a)=>(e.push(i[a]),!0)),filteredDrugs:e}},[i]),{tableData:y,filteredDrugs:v}=(0,a.useMemo)(()=>x(),[x]),f=(0,a.useCallback)(async()=>{try{u.setState({loading:!0});let e=await l.Z.get("/api/drugs-library?data="+JSON.stringify({returnDraftsIfExist:!0}));if(e.data.errors?.length)throw Error(e.data.errors?.join(", "));u.setState({drugs:e.data.data})}catch(e){h({title:"Error",message:e.message,variant:"error"})}finally{u.setState({loading:!1})}},[h]);!function({events:e}){(0,a.useMemo)(()=>e,[e]),(0,a.useRef)({eventsTimeouts:{},eventsTimestamps:{}}),(0,a.useRef)(new Date().getTime()),(0,t.useRouter)()}({events:[{name:"data_changed",onEvent:{callback:async()=>{await f(),s.refresh()}}}]});let p=(0,a.useCallback)(async e=>{try{u.setState(i=>({loading:!0,drugs:i.drugs.filter(i=>!e.includes(i.itemId))}));let i=await l.Z.delete("/api/drugs-library?data="+JSON.stringify({itemsIds:e}));if(i.data.errors?.length)throw Error(i.data.errors?.join(", "));s.refresh(),h({title:"",message:"Drug deleted successfully!",variant:"success"})}catch(e){h({title:"Error",message:e.message,variant:"error"})}finally{u.setState({loading:!1})}},[h,s.refresh]),b=(0,a.useCallback)(async e=>{try{u.setState({loading:!0});let a=[],t=[],r=i;u.setState(i=>(r=!g&&e?[...i.drugs,e]:i.drugs.map(i=>i.itemId!==e?.itemId?i:(e&&(i.key!==e.key&&t.push({old:i.key,new:e.key}),i.type!==e.type&&a.push(i.key)),{...i,...e})),{loading:!0,drugs:r}));let n={data:e?[e]:r,broadcastAction:!0},o=await l.Z.post("/api/drugs-library/save",n);if(o.data.errors?.length)throw Error(o.data.errors?.join(", "));await f(),s.refresh(),h({title:"",message:`Drug${e?"":"s"} saved successfully!`,variant:"success"})}catch(e){h({title:"Error",message:e.message,variant:"error"})}finally{u.setState({loading:!1})}},[i,g,s.refresh]),j=(0,a.useCallback)(async e=>{try{u.setState({loading:!0});let i={data:e.map(e=>({itemId:e})),broadcastAction:!0},a=await l.Z.post("/api/drugs-library/copy",i);if(a.data.errors?.length)throw Error(a.data.errors?.join(", "));await f(),s.refresh(),h({title:"",message:`Drug${e.length<2?"":"s"} copied successfully!`,variant:"success"})}catch(e){h({title:"Error",message:e.message,variant:"error"})}finally{u.setState({loading:!1})}},[s.refresh]);return(0,a.useCallback)(()=>{u.setState(d)},[]),{...e,filteredDrugs:v,tableData:y,selectedItemId:g,addLink:e=>`?${r.Z.stringify({...c,addItem:e})}`,editLink:e=>`?${r.Z.stringify({...c,itemId:e})}`,getDrugs:f,deleteDrugs:p,saveDrugs:b,copyDrugs:j}}},79131:(e,i,s)=>{s.d(i,{Z:()=>a});let a=e=>`${e||""}`.charAt(0).toUpperCase()+`${e||""}`.slice(1)}};