"use strict";exports.id=2179,exports.ids=[2179],exports.modules={82179:(e,a,i)=>{i.d(a,{A:()=>C});var s=i(10326),t=i(17577),r=i(35047),l=i(15491),n=i(47463),o=i(2165),d=i(7890),u=i(34474),g=i(81646),m=i(53313),c=i(90772),y=i(54432),h=i(87673),x=i(31048),f=i(11870),v=i(75172),b=i(58464),p=i(46670),j=i(79131),k=i(51605);let N=[{value:"drug",label:"Drug"},{value:"fluid",label:"Fluid"}],F=(e,a="drug")=>({itemId:`${e?.itemId||(0,n.Z)()}`,type:`${e?.type||a}`,key:`${e?.key||""}`,keyId:`${e?.keyId||""}`,drug:`${e?.drug||""}`,minGestation:`${e?.minGestation===null?"":e?.minGestation}`,maxGestation:`${e?.maxGestation===null?"":e?.maxGestation}`,minWeight:`${e?.minWeight===null?"":e?.minWeight}`,maxWeight:`${e?.maxWeight===null?"":e?.maxWeight}`,minAge:`${e?.minAge===null?"":e?.minAge}`,maxAge:`${e?.maxAge===null?"":e?.maxAge}`,dosage:`${e?.dosage===null?"":e?.dosage}`,dosageMultiplier:`${e?.dosageMultiplier===null?"":e?.dosageMultiplier}`,hourlyFeed:`${e?.hourlyFeed===null?"":e?.hourlyFeed}`,hourlyFeedDivider:`${e?.hourlyFeedDivider===null?"":e?.hourlyFeedDivider}`,dayOfLife:`${e?.dayOfLife||""}`,dosageText:`${e?.dosageText||""}`,managementText:`${e?.managementText||""}`,gestationKey:`${e?.gestationKey||""}`,weightKey:`${e?.weightKey||""}`,diagnosisKey:`${e?.diagnosisKey||""}`,gestationKeyId:`${e?.gestationKeyId||""}`,weightKeyId:`${e?.weightKeyId||""}`,diagnosisKeyId:`${e?.diagnosisKeyId||""}`,condition:`${e?.condition||""}`,administrationFrequency:`${e?.administrationFrequency||""}`,drugUnit:`${e?.drugUnit||""}`,routeOfAdministration:`${e?.routeOfAdministration||""}`,ageKey:`${e?.ageKey||""}`,ageKeyId:`${e?.ageKeyId||""}`,validationType:`${e?.validationType||"default"}`});function C({disabled:e,item:a,floating:i,onChange:n}){let C=(0,k.v)({isDraft:!!a?.isDraft,userId:a?.draftCreatedByUserId});e=e||C;let I=(0,r.useRouter)(),K=(0,r.useSearchParams)(),w=(0,t.useMemo)(()=>l.Z.parse(K.toString()),[K]),{itemId:A,addItem:$}=w,[D,_]=(0,o.Z)(),[G,T]=(0,o.Z)(),[W,S]=(0,t.useState)(!1),[M,L]=(0,t.useState)(F(a,$)),{keys:Z,loading:U}=(0,v.a)(),{confirm:q}=(0,p.t)(),E=(0,t.useCallback)(()=>{let e=()=>{n({...M,minWeight:M.minWeight?Number(M.minWeight):null,maxWeight:M.maxWeight?Number(M.maxWeight):null,minGestation:M.minGestation?Number(M.minGestation):null,maxGestation:M.maxGestation?Number(M.maxGestation):null,hourlyFeed:M.hourlyFeed?Number(M.hourlyFeed):null,hourlyFeedDivider:M.hourlyFeedDivider?Number(M.hourlyFeedDivider):null,minAge:M.minAge?Number(M.minAge):null,maxAge:M.maxAge?Number(M.maxAge):null,dosage:M.dosage?Number(M.dosage):null,dosageMultiplier:M.dosageMultiplier?Number(M.dosageMultiplier):null,type:M.type}),S(!1)};a&&M.key!==a?.key?q(e,{danger:!0,title:"Confirm key change",message:`
                    <p class="text-xl">Are you sure you want to change key?</p>
                    <p>All references to the old key (${a.key}) will also be updated to: ${M.key}</p>
                `,positiveLabel:"Yes, keep changes",negativeLabel:"No, do not save"}):e()},[M,a,n]),O=(0,t.useCallback)(()=>{S(!1),L(F(void 0,$)),I.push(`?${l.Z.stringify({...w,itemId:void 0,addItem:void 0})}`);let e=_?.top||0;setTimeout(()=>window.scrollTo({top:e}),500)},[w,_,I.push]),{isFormComplete:R,isDrug:V,isFluid:B,validateWithCondition:P}=(0,t.useMemo)(()=>{let e="drug"===M.type,a="fluid"===M.type,i="condition"===M.validationType,s=!!(M.type&&M.key&&M.drug&&M.managementText&&M.dosageText&&M.administrationFrequency&&M.drugUnit&&M.routeOfAdministration&&M.dosage&&i?M.condition:M.weightKey&&M.minWeight&&M.maxWeight&&M.gestationKey&&M.minGestation&&M.maxGestation&&M.ageKey&&M.minAge&&M.maxAge&&Number(M.minGestation||"0")<=Number(M.maxGestation||"0")&&Number(M.minWeight||"0")<=Number(M.maxWeight||"0")&&Number(M.minAge||"0")<=Number(M.maxAge||"0")&&(!e||M.diagnosisKey)&&(!a||M.condition&&M.hourlyFeed&&M.hourlyFeedDivider&&Number(M.hourlyFeed||"0")<=Number(M.hourlyFeed||"0")&&Number(M.hourlyFeedDivider||"0")<=Number(M.hourlyFeedDivider||"0")));return{isDrug:e,isFluid:a,isFormComplete:s,validateWithCondition:i}},[M,$]),z=(0,t.useCallback)(()=>!R||U||e,[R,U,e]),H=(0,s.jsxs)("div",{className:"flex flex-col gap-y-4",children:[(0,s.jsxs)("div",{children:[s.jsx(x._,{secondary:!0,htmlFor:"type",children:"Type *"}),(0,s.jsxs)(u.Ph,{value:M.type,required:!0,name:"type",disabled:e,onValueChange:e=>{let i=F(a?.type===e?a:void 0,$);q(()=>L(a=>({...a,type:e,hourlyFeed:i.hourlyFeed,hourlyFeedDivider:i.hourlyFeedDivider,condition:i.condition,diagnosisKey:i.diagnosisKey,drugUnit:i.drugUnit})),{danger:!0,title:"Confirm type change",message:`
                                <p class="text-xl">Are you sure you want to change type?</p>
                                <ol style="list-style:auto;margin:10px;">
                                    <li>Some fields will be cleared as they do not apply on all types!</li>
                                    <li>All references to this ${M.type} will be removed.</li>
                                </ol>
                            `,positiveLabel:"Yes, change type",negativeLabel:"No, keep the current type"})},children:[s.jsx(u.i4,{children:s.jsx(u.ki,{placeholder:"Select type"})}),s.jsx(u.Bw,{children:s.jsx(u.DI,{children:N.map(e=>s.jsx(u.Ql,{value:e.value,children:e.label},e.value))})})]})]}),(0,s.jsxs)("div",{children:[s.jsx(x._,{secondary:!0,htmlFor:"key",children:"Key *"}),s.jsx(y.I,{name:"key",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:M.key,disabled:e,onChange:e=>L(a=>({...a,key:e.target.value}))})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)(x._,{secondary:!0,htmlFor:"drug",children:[(0,j.Z)(M.type)," *"]}),s.jsx(y.I,{name:"drug",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:M.drug,disabled:e,onChange:e=>L(a=>({...a,drug:e.target.value}))})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)(x._,{secondary:!0,htmlFor:"condition",children:["Condition ",P?"*":""]}),s.jsx(h.g,{rows:3,name:"condition",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:M.condition,disabled:e,onChange:e=>L(a=>({...a,condition:e.target.value}))}),(0,s.jsxs)("span",{className:"font-bold opacity-50 text-xs",children:["e.g ",b._S]})]}),(0,s.jsxs)("div",{className:"flex gap-x-2",children:[s.jsx(m.X,{name:"validationType",id:"validationType",disabled:e,checked:"condition"===M.validationType,onCheckedChange:e=>L(e=>({...e,validationType:"condition"===e.validationType?"default":"condition"}))}),s.jsx(x._,{secondary:!0,htmlFor:"validationType",children:"Validate with conditional expression only"})]}),V&&(0,s.jsxs)("div",{children:[(0,s.jsxs)(x._,{secondary:!0,htmlFor:"diagnosisKey",children:["Diagnosis Key ",P?"":"*"]}),s.jsx(h.g,{rows:3,name:"gestationKey",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:M.diagnosisKey,disabled:e,onChange:e=>L(a=>({...a,diagnosisKey:e.target.value}))}),s.jsx("span",{className:"font-bold opacity-50 text-xs",children:"e.g NSep,Premature,Dehyd"})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)(x._,{secondary:!0,htmlFor:"gestationKey",children:["Gestation Key ",P?"":"*"]}),s.jsx(g.L,{modal:!0,value:`${M.gestationKey||""}`,disabled:e,onChange:([e])=>{L(a=>({...a,gestationKey:e.name,gestationKeyId:e?.uniqueKey}))}})]}),(0,s.jsxs)("div",{className:"flex gap-x-2",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)(x._,{secondary:!0,htmlFor:"minGestation",children:["Min Gestation (weeks) ",P?"":"*"]}),s.jsx(y.I,{name:"minGestation",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:M.minGestation,type:"number",disabled:e,onChange:e=>{let a=e.target.value,i=M.maxGestation;a||(i=""),L(e=>({...e,minGestation:a,maxGestation:i}))}})]}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)(x._,{secondary:!0,htmlFor:"maxGestation",error:Number(M.minGestation||"0")>Number(M.maxGestation||"0"),children:["Max Gestation (weeks) ",P?"":"*"]}),s.jsx(y.I,{name:"maxGestation",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:M.maxGestation,type:"number",disabled:e||!M.minGestation,min:M.minGestation,error:Number(M.minGestation||"0")>Number(M.maxGestation||"0"),onChange:e=>L(a=>({...a,maxGestation:e.target.value}))})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)(x._,{secondary:!0,htmlFor:"weightKey",children:["Weight Key ",P?"":"*"]}),s.jsx(g.L,{modal:!0,value:`${M.weightKey||""}`,disabled:e,onChange:([e])=>{L(a=>({...a,weightKey:e.name,weightKeyId:e?.uniqueKey}))}})]}),(0,s.jsxs)("div",{className:"flex gap-x-2",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)(x._,{secondary:!0,htmlFor:"minWeight",children:["Min Weight (grams) ",P?"":"*"]}),s.jsx(y.I,{name:"minWeight",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:M.minWeight,type:"number",disabled:e,onChange:e=>{let a=e.target.value,i=M.maxWeight;a||(i=""),L(e=>({...e,minWeight:a,maxWeight:i}))}})]}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)(x._,{secondary:!0,htmlFor:"maxWeight",error:Number(M.minWeight||"0")>Number(M.maxWeight||"0"),children:["Max Weight (grams) ",P?"":"*"]}),s.jsx(y.I,{name:"maxWeight",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:M.maxWeight,type:"number",disabled:e||!M.minWeight,min:M.minWeight,error:Number(M.minWeight||"0")>Number(M.maxWeight||"0"),onChange:e=>L(a=>({...a,maxWeight:e.target.value}))})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)(x._,{secondary:!0,htmlFor:"ageKey",children:["Day of Life (Age) Key ",P?"":"*"]}),s.jsx(g.L,{modal:!0,value:`${M.ageKey||""}`,disabled:e,onChange:([e])=>{L(a=>({...a,ageKey:e.name,ageKeyId:e?.uniqueKey}))}})]}),(0,s.jsxs)("div",{className:"flex gap-x-2",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)(x._,{secondary:!0,htmlFor:"minAge",children:["Min Day of Life (Age - hours) ",P?"":"*"]}),s.jsx(y.I,{name:"minAge",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:M.minAge,type:"number",disabled:e,onChange:e=>{let a=e.target.value,i=M.maxAge;a||(i=""),L(e=>({...e,minAge:a,maxAge:i}))}})]}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)(x._,{secondary:!0,htmlFor:"maxAge",error:Number(M.minAge||"0")>Number(M.maxAge||"0"),children:["Max Day of Life (Age - hours) ",P?"":"*"]}),s.jsx(y.I,{name:"maxAge",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:M.maxAge,type:"number",disabled:e||!M.minAge,min:M.minAge,error:Number(M.minAge||"0")>Number(M.maxAge||"0"),onChange:e=>L(a=>({...a,maxAge:e.target.value}))})]})]}),B&&s.jsx(s.Fragment,{children:(0,s.jsxs)("div",{className:"flex gap-x-2",children:[(0,s.jsxs)("div",{className:"flex-1",children:[s.jsx(x._,{secondary:!0,htmlFor:"hourlyFeed",children:"Hourly feed *"}),s.jsx(y.I,{name:"hourlyFeed",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:M.hourlyFeed,type:"number",disabled:e,onChange:e=>L(a=>({...a,hourlyFeed:e.target.value}))})]}),(0,s.jsxs)("div",{className:"flex-1",children:[s.jsx(x._,{secondary:!0,htmlFor:"hourlyFeedDivider",children:"Hourly feed divider *"}),s.jsx(y.I,{name:"hourlyFeedDivider",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:M.hourlyFeedDivider,type:"number",disabled:e,onChange:e=>L(a=>({...a,hourlyFeedDivider:e.target.value}))})]})]})}),(0,s.jsxs)("div",{children:[(0,s.jsxs)(x._,{secondary:!0,htmlFor:"dosage",children:["Dose (e.g. ",B?"ml/kg/24hrs":"mg/kg",") *"]}),s.jsx(y.I,{name:"dosage",type:"number",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:M.dosage,disabled:e,onChange:e=>L(a=>({...a,dosage:e.target.value}))})]}),(0,s.jsxs)("div",{children:[s.jsx(x._,{secondary:!0,htmlFor:"dosageMultiplier",children:"Drug Dose Multiplier *"}),s.jsx(y.I,{name:"dosageMultiplier",type:"number",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:M.dosageMultiplier,disabled:e,onChange:e=>L(a=>({...a,dosageMultiplier:e.target.value}))})]}),(0,s.jsxs)("div",{children:[s.jsx(x._,{secondary:!0,htmlFor:"drugUnit",children:"Drug Unit *"}),s.jsx(y.I,{name:"drugUnit",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:M.drugUnit,disabled:e,onChange:e=>L(a=>({...a,drugUnit:e.target.value}))})]}),(0,s.jsxs)("div",{children:[s.jsx(x._,{secondary:!0,htmlFor:"administrationFrequency",children:"Administration Frequency *"}),s.jsx(y.I,{name:"administrationFrequency",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:M.administrationFrequency,disabled:e,onChange:e=>L(a=>({...a,administrationFrequency:e.target.value}))})]}),(0,s.jsxs)("div",{children:[s.jsx(x._,{secondary:!0,htmlFor:"routeOfAdministration",children:"Route of Administration *"}),s.jsx(y.I,{name:"routeOfAdministration",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:M.routeOfAdministration,disabled:e,onChange:e=>L(a=>({...a,routeOfAdministration:e.target.value}))})]}),(0,s.jsxs)("div",{children:[s.jsx(x._,{secondary:!0,htmlFor:"managementText",children:"Management text *"}),s.jsx(y.I,{name:"managementText",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:M.managementText,disabled:e,onChange:e=>L(a=>({...a,managementText:e.target.value}))})]}),(0,s.jsxs)("div",{children:[s.jsx(x._,{secondary:!0,htmlFor:"weight",children:"Dosage text *"}),s.jsx(y.I,{name:"dosageText",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:M.dosageText,disabled:e,onChange:e=>L(a=>({...a,dosageText:e.target.value}))})]})]});return(0,s.jsxs)(s.Fragment,{children:[U&&s.jsx(f.a,{overlay:!0}),s.jsx("div",{ref:D,children:!1===i?H:s.jsx(d.yo,{open:W,onOpenChange:e=>{e||O()},children:(0,s.jsxs)(d.ue,{hideCloseButton:!0,side:"right",className:"p-0 m-0 flex flex-col w-full max-w-full sm:max-w-[80%] md:max-w-[80%] lg:max-w-[50%]",children:[(0,s.jsxs)(d.Tu,{className:"flex flex-row items-center py-2 px-4 border-b border-b-border text-left sm:text-left",children:[(0,s.jsxs)(d.bC,{children:[$?"Add":"",A?"Edit":""," ",a?.type||$]}),s.jsx(d.Ei,{className:"hidden"})]}),s.jsx("div",{ref:G,className:"flex-1 py-2 px-0 overflow-y-auto",children:s.jsx("div",{className:"px-4",children:H})}),(0,s.jsxs)("div",{className:"border-t border-t-border px-4 py-2 flex gap-x-2",children:[s.jsx("span",{className:"text-danger text-xs my-auto",children:"* Required"}),s.jsx("div",{className:"ml-auto"}),s.jsx(d.sw,{asChild:!0,children:s.jsx(c.z,{variant:"ghost",onClick:()=>{},children:"Cancel"})}),s.jsx(c.z,{onClick:()=>E(),disabled:z(),children:"Save"})]})]})})})]})}},75172:(e,a,i)=>{i.d(a,{a:()=>c});var s=i(17577),t=i(35047),r=i(15491),l=i(44099),n=i(60114),o=i(96221);i(63697);var d=i(11825);let u={value:"",filter:"all",searching:!1,results:[],unfilteredResults:[]},g={initialised:!1,loading:!1,keys:[],drugs:[],typeFilter:"",statusFilter:"",sortBy:"name-asc"},m=(0,n.Ue)(e=>g);function c(){let e=m(),{drugs:a,typeFilter:i,statusFilter:n,sortBy:c}=e,y=(0,t.useRouter)(),h=(0,t.useSearchParams)(),x=(0,s.useMemo)(()=>r.Z.parse(h.toString()),[h]),{itemId:f}=x,v=(0,s.useMemo)(()=>a.filter(e=>e.itemId===f||e.key===f)[0]?.itemId,[f,a]),{alert:b}=(0,o.s)(),[p,j]=(0,s.useState)(u),k=(0,s.useCallback)(()=>j(u),[]),N=(0,s.useCallback)(()=>{let e=[],s=p.value?new Set(p.results.map(e=>e.itemId)):void 0,t=a.map(e=>[e.drug||"",e.type||"",e.key||"",e.dosageText||"",e.itemId]),r=[...t=t.filter((t,r)=>{let l=a[r];if(!l)return!1;let o=!0;return s&&(o=s.has(l.itemId)),o&&i&&"all"!==i&&(o=(l.type||"").toLowerCase()===i.toLowerCase()),o&&n&&"all"!==n&&("draft"===n?o=!0===l.isDraft:"published"===n&&(o=!l.isDraft)),o&&e.push(a[r]),o})],l=[...e],o=r.map((e,a)=>({row:e,drug:l[a]}));switch(c){case"name-asc":o.sort((e,a)=>(e.drug.drug||"").localeCompare(a.drug.drug||""));break;case"name-desc":o.sort((e,a)=>(a.drug.drug||"").localeCompare(e.drug.drug||""));break;case"type-asc":o.sort((e,a)=>(e.drug.type||"").localeCompare(a.drug.type||""));break;case"type-desc":o.sort((e,a)=>(a.drug.type||"").localeCompare(e.drug.type||""));break;case"key-asc":o.sort((e,a)=>(e.drug.key||"").localeCompare(a.drug.key||""));break;case"key-desc":o.sort((e,a)=>(a.drug.key||"").localeCompare(e.drug.key||""))}return{tableData:o.map(e=>e.row),filteredDrugs:o.map(e=>e.drug)}},[a,p,i,n,c]),F=(0,s.useCallback)(async e=>{try{k();let a=`${e||""}`.trim();if(!a)return;j(e=>({...e,value:a,searching:!0}));let{data:i}=await l.Z.get(`/api/drugs-library/search?searchValue=${encodeURIComponent(a)}`);if(i.errors?.length)throw Error(i.errors.join(", "));j(e=>{let s=i.data||[];return{value:a,filter:e.filter,searching:!1,results:(0,d.UZ)({searchValue:a,filter:e.filter,results:s}),unfilteredResults:s}})}catch{k()}},[k]),{tableData:C,filteredDrugs:I}=(0,s.useMemo)(()=>N(),[N]),K=(0,s.useCallback)(async()=>{try{m.setState({loading:!0});let e=await l.Z.get("/api/drugs-library?data="+JSON.stringify({returnDraftsIfExist:!0}));if(e.data.errors?.length)throw Error(e.data.errors?.join(", "));m.setState({drugs:e.data.data})}catch(e){b({title:"Error",message:e.message,variant:"error"})}finally{m.setState({loading:!1})}},[b]);!function({events:e}){(0,s.useMemo)(()=>e,[e]),(0,s.useRef)({eventsTimeouts:{},eventsTimestamps:{}}),(0,s.useRef)(new Date().getTime()),(0,t.useRouter)()}({events:[{name:"data_changed",onEvent:{callback:async()=>{await K(),y.refresh()}}}]});let w=(0,s.useCallback)(async e=>{try{m.setState(a=>({loading:!0,drugs:a.drugs.filter(a=>!e.includes(a.itemId))}));let a=await l.Z.delete("/api/drugs-library?data="+JSON.stringify({itemsIds:e}));if(a.data.errors?.length)throw Error(a.data.errors?.join(", "));y.refresh(),b({title:"",message:"Drug deleted successfully!",variant:"success"})}catch(e){b({title:"Error",message:e.message,variant:"error"})}finally{m.setState({loading:!1})}},[b,y.refresh]),A=(0,s.useCallback)(async e=>{try{m.setState({loading:!0});let i=[],s=[],t=a;m.setState(a=>(t=!v&&e?[...a.drugs,e]:a.drugs.map(a=>a.itemId!==e?.itemId?a:(e&&(a.key!==e.key&&s.push({old:a.key,new:e.key}),a.type!==e.type&&i.push(a.key)),{...a,...e})),{loading:!0,drugs:t}));let r={data:e?[e]:t,broadcastAction:!0},n=await l.Z.post("/api/drugs-library/save",r);if(n.data.errors?.length)throw Error(n.data.errors?.join(", "));await K(),y.refresh(),b({title:"",message:`Drug${e?"":"s"} saved successfully!`,variant:"success"})}catch(e){b({title:"Error",message:e.message,variant:"error"})}finally{m.setState({loading:!1})}},[a,v,y.refresh]),$=(0,s.useCallback)(async e=>{try{m.setState({loading:!0});let a={data:e.map(e=>({itemId:e})),broadcastAction:!0},i=await l.Z.post("/api/drugs-library/copy",a);if(i.data.errors?.length)throw Error(i.data.errors?.join(", "));await K(),y.refresh(),b({title:"",message:`Drug${e.length<2?"":"s"} copied successfully!`,variant:"success"})}catch(e){b({title:"Error",message:e.message,variant:"error"})}finally{m.setState({loading:!1})}},[y.refresh]);(0,s.useCallback)(()=>{m.setState(g)},[]);let D=(0,s.useCallback)(e=>{m.setState({typeFilter:e})},[]),_=(0,s.useCallback)(e=>{m.setState({statusFilter:e})},[]),G=(0,s.useCallback)(e=>{m.setState({sortBy:e})},[]);return{...e,search:p,filteredDrugs:I,tableData:C,selectedItemId:v,addLink:e=>`?${r.Z.stringify({...x,addItem:e})}`,editLink:e=>`?${r.Z.stringify({...x,itemId:e})}`,getDrugs:K,deleteDrugs:w,saveDrugs:A,copyDrugs:$,setSearch:j,clearSearch:k,onSearch:F,setTypeFilter:D,setStatusFilter:_,setSortBy:G}}},11825:(e,a,i)=>{i.d(a,{UZ:()=>r,kv:()=>s});let s=[{value:"all",label:"All matches"},{value:"data_key",label:"Data keys only"},{value:"key_id",label:"Key IDs only"},{value:"label",label:"Label text only"},{value:"title",label:"Title only"},{value:"condition",label:"Conditional expression only"}],t={key:"data_key",gestationKey:"data_key",weightKey:"data_key",diagnosisKey:"data_key",ageKey:"data_key",preferenceKey:"data_key",keyId:"key_id",gestationKeyId:"key_id",weightKeyId:"key_id",diagnosisKeyId:"key_id",ageKeyId:"key_id",title:"title",dosageText:"label",managementText:"label",administrationFrequency:"label",routeOfAdministration:"label",type:"label",preferenceValue:"label",condition:"condition"};function r({searchValue:e,filter:a,results:i}){return"all"===a?i:i.map(i=>{let s=i.matches.filter(i=>!a||!!(t[i.field]===a&&`${i.fieldValue}`.toLowerCase().includes(`${e}`.toLowerCase())));return{...i,matches:s}}).filter(e=>e.matches.length)}}};