"use strict";exports.id=2179,exports.ids=[2179],exports.modules={82179:(e,i,s)=>{s.d(i,{A:()=>C});var a=s(10326),t=s(17577),r=s(35047),n=s(15491),l=s(47463),o=s(2165),d=s(7890),u=s(34474),c=s(81646),m=s(53313),g=s(90772),h=s(54432),x=s(87673),y=s(31048),v=s(11870),f=s(75172),p=s(58464),b=s(46670),j=s(79131),N=s(51605);let F=[{value:"drug",label:"Drug"},{value:"fluid",label:"Fluid"}],A=(e,i="drug")=>({itemId:`${e?.itemId||(0,l.Z)()}`,type:`${e?.type||i}`,key:`${e?.key||""}`,keyId:`${e?.keyId||""}`,drug:`${e?.drug||""}`,minGestation:`${e?.minGestation===null?"":e?.minGestation}`,maxGestation:`${e?.maxGestation===null?"":e?.maxGestation}`,minWeight:`${e?.minWeight===null?"":e?.minWeight}`,maxWeight:`${e?.maxWeight===null?"":e?.maxWeight}`,minAge:`${e?.minAge===null?"":e?.minAge}`,maxAge:`${e?.maxAge===null?"":e?.maxAge}`,dosage:`${e?.dosage===null?"":e?.dosage}`,dosageMultiplier:`${e?.dosageMultiplier===null?"":e?.dosageMultiplier}`,hourlyFeed:`${e?.hourlyFeed===null?"":e?.hourlyFeed}`,hourlyFeedDivider:`${e?.hourlyFeedDivider===null?"":e?.hourlyFeedDivider}`,dayOfLife:`${e?.dayOfLife||""}`,dosageText:`${e?.dosageText||""}`,managementText:`${e?.managementText||""}`,gestationKey:`${e?.gestationKey||""}`,weightKey:`${e?.weightKey||""}`,diagnosisKey:`${e?.diagnosisKey||""}`,gestationKeyId:`${e?.gestationKeyId||""}`,weightKeyId:`${e?.weightKeyId||""}`,diagnosisKeyId:`${e?.diagnosisKeyId||""}`,condition:`${e?.condition||""}`,administrationFrequency:`${e?.administrationFrequency||""}`,drugUnit:`${e?.drugUnit||""}`,routeOfAdministration:`${e?.routeOfAdministration||""}`,ageKey:`${e?.ageKey||""}`,ageKeyId:`${e?.ageKeyId||""}`,validationType:`${e?.validationType||"default"}`});function C({disabled:e,item:i,floating:s,onChange:l}){let C=(0,N.v)({isDraft:!!i?.isDraft,userId:i?.draftCreatedByUserId});e=e||C;let w=(0,r.useRouter)(),I=(0,r.useSearchParams)(),k=(0,t.useMemo)(()=>n.Z.parse(I.toString()),[I]),{itemId:K,addItem:$}=k,[G,S]=(0,o.Z)(),[D,W]=(0,o.Z)(),[T,_]=(0,t.useState)(!1),[M,L]=(0,t.useState)(A(i,$)),{keys:Z,loading:q}=(0,f.a)(),{confirm:O}=(0,b.t)(),E=(0,t.useCallback)(()=>{let e=()=>{l({...M,minWeight:M.minWeight?Number(M.minWeight):null,maxWeight:M.maxWeight?Number(M.maxWeight):null,minGestation:M.minGestation?Number(M.minGestation):null,maxGestation:M.maxGestation?Number(M.maxGestation):null,hourlyFeed:M.hourlyFeed?Number(M.hourlyFeed):null,hourlyFeedDivider:M.hourlyFeedDivider?Number(M.hourlyFeedDivider):null,minAge:M.minAge?Number(M.minAge):null,maxAge:M.maxAge?Number(M.maxAge):null,dosage:M.dosage?Number(M.dosage):null,dosageMultiplier:M.dosageMultiplier?Number(M.dosageMultiplier):null,type:M.type}),_(!1)};i&&M.key!==i?.key?O(e,{danger:!0,title:"Confirm key change",message:`
                    <p class="text-xl">Are you sure you want to change key?</p>
                    <p>All references to the old key (${i.key}) will also be updated to: ${M.key}</p>
                `,positiveLabel:"Yes, keep changes",negativeLabel:"No, do not save"}):e()},[M,i,l]),U=(0,t.useCallback)(()=>{_(!1),L(A(void 0,$)),w.push(`?${n.Z.stringify({...k,itemId:void 0,addItem:void 0})}`);let e=S?.top||0;setTimeout(()=>window.scrollTo({top:e}),500)},[k,S,w.push]),{isFormComplete:z,isDrug:R,isFluid:B,validateWithCondition:V}=(0,t.useMemo)(()=>{let e="drug"===M.type,i="fluid"===M.type,s="condition"===M.validationType,a=!!(M.type&&M.key&&M.drug&&M.managementText&&M.dosageText&&M.administrationFrequency&&M.drugUnit&&M.routeOfAdministration&&M.dosage&&s?M.condition:M.weightKey&&M.minWeight&&M.maxWeight&&M.gestationKey&&M.minGestation&&M.maxGestation&&M.ageKey&&M.minAge&&M.maxAge&&Number(M.minGestation||"0")<=Number(M.maxGestation||"0")&&Number(M.minWeight||"0")<=Number(M.maxWeight||"0")&&Number(M.minAge||"0")<=Number(M.maxAge||"0")&&(!e||M.diagnosisKey)&&(!i||M.condition&&M.hourlyFeed&&M.hourlyFeedDivider&&Number(M.hourlyFeed||"0")<=Number(M.hourlyFeed||"0")&&Number(M.hourlyFeedDivider||"0")<=Number(M.hourlyFeedDivider||"0")));return{isDrug:e,isFluid:i,isFormComplete:a,validateWithCondition:s}},[M,$]),H=(0,t.useCallback)(()=>!z||q||e,[z,q,e]),P=(0,a.jsxs)("div",{className:"flex flex-col gap-y-4",children:[(0,a.jsxs)("div",{children:[a.jsx(y._,{secondary:!0,htmlFor:"type",children:"Type *"}),(0,a.jsxs)(u.Ph,{value:M.type,required:!0,name:"type",disabled:e,onValueChange:e=>{let s=A(i?.type===e?i:void 0,$);O(()=>L(i=>({...i,type:e,hourlyFeed:s.hourlyFeed,hourlyFeedDivider:s.hourlyFeedDivider,condition:s.condition,diagnosisKey:s.diagnosisKey,drugUnit:s.drugUnit})),{danger:!0,title:"Confirm type change",message:`
                                <p class="text-xl">Are you sure you want to change type?</p>
                                <ol style="list-style:auto;margin:10px;">
                                    <li>Some fields will be cleared as they do not apply on all types!</li>
                                    <li>All references to this ${M.type} will be removed.</li>
                                </ol>
                            `,positiveLabel:"Yes, change type",negativeLabel:"No, keep the current type"})},children:[a.jsx(u.i4,{children:a.jsx(u.ki,{placeholder:"Select type"})}),a.jsx(u.Bw,{children:a.jsx(u.DI,{children:F.map(e=>a.jsx(u.Ql,{value:e.value,children:e.label},e.value))})})]})]}),(0,a.jsxs)("div",{children:[a.jsx(y._,{secondary:!0,htmlFor:"key",children:"Key *"}),a.jsx(h.I,{name:"key",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:M.key,disabled:e,onChange:e=>L(i=>({...i,key:e.target.value}))})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)(y._,{secondary:!0,htmlFor:"drug",children:[(0,j.Z)(M.type)," *"]}),a.jsx(h.I,{name:"drug",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:M.drug,disabled:e,onChange:e=>L(i=>({...i,drug:e.target.value}))})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)(y._,{secondary:!0,htmlFor:"condition",children:["Condition ",V?"*":""]}),a.jsx(x.g,{rows:3,name:"condition",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:M.condition,disabled:e,onChange:e=>L(i=>({...i,condition:e.target.value}))}),(0,a.jsxs)("span",{className:"font-bold opacity-50 text-xs",children:["e.g ",p._S]})]}),(0,a.jsxs)("div",{className:"flex gap-x-2",children:[a.jsx(m.X,{name:"validationType",id:"validationType",disabled:e,checked:"condition"===M.validationType,onCheckedChange:e=>L(e=>({...e,validationType:"condition"===e.validationType?"default":"condition"}))}),a.jsx(y._,{secondary:!0,htmlFor:"validationType",children:"Validate with conditional expression only"})]}),R&&(0,a.jsxs)("div",{children:[(0,a.jsxs)(y._,{secondary:!0,htmlFor:"diagnosisKey",children:["Diagnosis Key ",V?"":"*"]}),a.jsx(x.g,{rows:3,name:"gestationKey",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:M.diagnosisKey,disabled:e,onChange:e=>L(i=>({...i,diagnosisKey:e.target.value}))}),a.jsx("span",{className:"font-bold opacity-50 text-xs",children:"e.g NSep,Premature,Dehyd"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)(y._,{secondary:!0,htmlFor:"gestationKey",children:["Gestation Key ",V?"":"*"]}),a.jsx(c.L,{modal:!0,value:`${M.gestationKey||""}`,disabled:e,onChange:([e])=>{L(i=>({...i,gestationKey:e.name,gestationKeyId:e?.uniqueKey}))}})]}),(0,a.jsxs)("div",{className:"flex gap-x-2",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)(y._,{secondary:!0,htmlFor:"minGestation",children:["Min Gestation (weeks) ",V?"":"*"]}),a.jsx(h.I,{name:"minGestation",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:M.minGestation,type:"number",disabled:e,onChange:e=>{let i=e.target.value,s=M.maxGestation;i||(s=""),L(e=>({...e,minGestation:i,maxGestation:s}))}})]}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)(y._,{secondary:!0,htmlFor:"maxGestation",error:Number(M.minGestation||"0")>Number(M.maxGestation||"0"),children:["Max Gestation (weeks) ",V?"":"*"]}),a.jsx(h.I,{name:"maxGestation",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:M.maxGestation,type:"number",disabled:e||!M.minGestation,min:M.minGestation,error:Number(M.minGestation||"0")>Number(M.maxGestation||"0"),onChange:e=>L(i=>({...i,maxGestation:e.target.value}))})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)(y._,{secondary:!0,htmlFor:"weightKey",children:["Weight Key ",V?"":"*"]}),a.jsx(c.L,{modal:!0,value:`${M.weightKey||""}`,disabled:e,onChange:([e])=>{L(i=>({...i,weightKey:e.name,weightKeyId:e?.uniqueKey}))}})]}),(0,a.jsxs)("div",{className:"flex gap-x-2",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)(y._,{secondary:!0,htmlFor:"minWeight",children:["Min Weight (grams) ",V?"":"*"]}),a.jsx(h.I,{name:"minWeight",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:M.minWeight,type:"number",disabled:e,onChange:e=>{let i=e.target.value,s=M.maxWeight;i||(s=""),L(e=>({...e,minWeight:i,maxWeight:s}))}})]}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)(y._,{secondary:!0,htmlFor:"maxWeight",error:Number(M.minWeight||"0")>Number(M.maxWeight||"0"),children:["Max Weight (grams) ",V?"":"*"]}),a.jsx(h.I,{name:"maxWeight",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:M.maxWeight,type:"number",disabled:e||!M.minWeight,min:M.minWeight,error:Number(M.minWeight||"0")>Number(M.maxWeight||"0"),onChange:e=>L(i=>({...i,maxWeight:e.target.value}))})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)(y._,{secondary:!0,htmlFor:"ageKey",children:["Day of Life (Age) Key ",V?"":"*"]}),a.jsx(c.L,{modal:!0,value:`${M.ageKey||""}`,disabled:e,onChange:([e])=>{L(i=>({...i,ageKey:e.name,ageKeyId:e?.uniqueKey}))}})]}),(0,a.jsxs)("div",{className:"flex gap-x-2",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)(y._,{secondary:!0,htmlFor:"minAge",children:["Min Day of Life (Age - hours) ",V?"":"*"]}),a.jsx(h.I,{name:"minAge",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:M.minAge,type:"number",disabled:e,onChange:e=>{let i=e.target.value,s=M.maxAge;i||(s=""),L(e=>({...e,minAge:i,maxAge:s}))}})]}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)(y._,{secondary:!0,htmlFor:"maxAge",error:Number(M.minAge||"0")>Number(M.maxAge||"0"),children:["Max Day of Life (Age - hours) ",V?"":"*"]}),a.jsx(h.I,{name:"maxAge",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:M.maxAge,type:"number",disabled:e||!M.minAge,min:M.minAge,error:Number(M.minAge||"0")>Number(M.maxAge||"0"),onChange:e=>L(i=>({...i,maxAge:e.target.value}))})]})]}),B&&a.jsx(a.Fragment,{children:(0,a.jsxs)("div",{className:"flex gap-x-2",children:[(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx(y._,{secondary:!0,htmlFor:"hourlyFeed",children:"Hourly feed *"}),a.jsx(h.I,{name:"hourlyFeed",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:M.hourlyFeed,type:"number",disabled:e,onChange:e=>L(i=>({...i,hourlyFeed:e.target.value}))})]}),(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx(y._,{secondary:!0,htmlFor:"hourlyFeedDivider",children:"Hourly feed divider *"}),a.jsx(h.I,{name:"hourlyFeedDivider",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:M.hourlyFeedDivider,type:"number",disabled:e,onChange:e=>L(i=>({...i,hourlyFeedDivider:e.target.value}))})]})]})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)(y._,{secondary:!0,htmlFor:"dosage",children:["Dose (e.g. ",B?"ml/kg/24hrs":"mg/kg",") *"]}),a.jsx(h.I,{name:"dosage",type:"number",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:M.dosage,disabled:e,onChange:e=>L(i=>({...i,dosage:e.target.value}))})]}),(0,a.jsxs)("div",{children:[a.jsx(y._,{secondary:!0,htmlFor:"dosageMultiplier",children:"Drug Dose Multiplier *"}),a.jsx(h.I,{name:"dosageMultiplier",type:"number",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:M.dosageMultiplier,disabled:e,onChange:e=>L(i=>({...i,dosageMultiplier:e.target.value}))})]}),(0,a.jsxs)("div",{children:[a.jsx(y._,{secondary:!0,htmlFor:"drugUnit",children:"Drug Unit *"}),a.jsx(h.I,{name:"drugUnit",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:M.drugUnit,disabled:e,onChange:e=>L(i=>({...i,drugUnit:e.target.value}))})]}),(0,a.jsxs)("div",{children:[a.jsx(y._,{secondary:!0,htmlFor:"administrationFrequency",children:"Administration Frequency *"}),a.jsx(h.I,{name:"administrationFrequency",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:M.administrationFrequency,disabled:e,onChange:e=>L(i=>({...i,administrationFrequency:e.target.value}))})]}),(0,a.jsxs)("div",{children:[a.jsx(y._,{secondary:!0,htmlFor:"routeOfAdministration",children:"Route of Administration *"}),a.jsx(h.I,{name:"routeOfAdministration",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:M.routeOfAdministration,disabled:e,onChange:e=>L(i=>({...i,routeOfAdministration:e.target.value}))})]}),(0,a.jsxs)("div",{children:[a.jsx(y._,{secondary:!0,htmlFor:"managementText",children:"Management text *"}),a.jsx(h.I,{name:"managementText",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:M.managementText,disabled:e,onChange:e=>L(i=>({...i,managementText:e.target.value}))})]}),(0,a.jsxs)("div",{children:[a.jsx(y._,{secondary:!0,htmlFor:"weight",children:"Dosage text *"}),a.jsx(h.I,{name:"dosageText",className:"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",value:M.dosageText,disabled:e,onChange:e=>L(i=>({...i,dosageText:e.target.value}))})]})]});return(0,a.jsxs)(a.Fragment,{children:[q&&a.jsx(v.a,{overlay:!0}),a.jsx("div",{ref:G,children:!1===s?P:a.jsx(d.yo,{open:T,onOpenChange:e=>{e||U()},children:(0,a.jsxs)(d.ue,{hideCloseButton:!0,side:"right",className:"p-0 m-0 flex flex-col w-full max-w-full sm:max-w-[80%] md:max-w-[80%] lg:max-w-[50%]",children:[(0,a.jsxs)(d.Tu,{className:"flex flex-row items-center py-2 px-4 border-b border-b-border text-left sm:text-left",children:[(0,a.jsxs)(d.bC,{children:[$?"Add":"",K?"Edit":""," ",i?.type||$]}),a.jsx(d.Ei,{className:"hidden"})]}),a.jsx("div",{ref:D,className:"flex-1 py-2 px-0 overflow-y-auto",children:a.jsx("div",{className:"px-4",children:P})}),(0,a.jsxs)("div",{className:"border-t border-t-border px-4 py-2 flex gap-x-2",children:[a.jsx("span",{className:"text-danger text-xs my-auto",children:"* Required"}),a.jsx("div",{className:"ml-auto"}),a.jsx(d.sw,{asChild:!0,children:a.jsx(g.z,{variant:"ghost",onClick:()=>{},children:"Cancel"})}),a.jsx(g.z,{onClick:()=>E(),disabled:H(),children:"Save"})]})]})})})]})}},81646:(e,i,s)=>{s.d(i,{L:()=>l});var a=s(10326),t=s(17577),r=s(18905),n=s(49596);function l({value:e,disabled:i,modal:s,multiple:l,placeholder:o,error:d,onChange:u,filterDataKeys:c}){let{dataKeys:m,extractDataKeys:g}=(0,n.M)(),h=(0,t.useMemo)(()=>m.filter(e=>!c||c(e)).map(e=>({label:e.name,value:e.uniqueKey,caption:e.dataType||"",description:e.label})),[m,c]);return a.jsx(a.Fragment,{children:a.jsx(r.V,{multiple:l,modal:s,error:d,placeholder:`${e||""}`||o||"Select key",search:{placeholder:"Search data keys"},options:h,onSelect:e=>{let i=g(e.map(e=>e.value)).map(e=>({...e,children:g(e.options)}));u?.(i)}})})}},18905:(e,i,s)=>{s.d(i,{V:()=>c});var a=s(10326),t=s(17577),r=s(47206),n=s(32933),l=s(90772),o=s(54432),d=s(62288),u=s(77863);function c({options:e,selected:i,...s}){i=Array.isArray(i)?i:i?[i]:[];let t=e.map(e=>({...e,value:`${e.value}`})),r=i.map(e=>`${e}`);if(!s.multiple){let[e]=Array.isArray(r)?r:[r];e&&t.find(i=>i.value===e)}return a.jsx(m,{...s,options:t,selected:r})}function m({modal:e,header:i,placeholder:s,search:c,multiple:m=!1,error:g=!1,disabled:h=!1,selected:x,options:y=[],trigger:v,onTrigger:f,onSelect:p}){let[b,j]=(0,t.useState)(""),N=function(e,i){let[s,a]=(0,t.useState)(e);return s}(b),[F,A]=(0,t.useState)([]),C=(0,t.useMemo)(()=>x?Array.isArray(x)?x.map(e=>y.find(i=>i?.value===e)).map(e=>e):y.filter(e=>e?.value===x)||[]:[],[x,y]),w=(0,t.useMemo)(()=>y.map(e=>{let i=C.map(e=>e?.value).map(e=>`${e||""}`).filter(e=>e).includes(`${e?.value}`);return i=i||F.includes(e.value),{...e,isSelected:i}}).sort((e,i)=>(e.disabled?1:0)-(i.disabled?1:0)).sort((e,i)=>{let s=e.isSelected?1:0;return(i.isSelected?1:0)-s}).filter(e=>JSON.stringify([e.value||"",e.label||"",e.description||""]).toLowerCase().match(N.toLowerCase())),[y,N,C,F]);return a.jsx(a.Fragment,{children:(0,a.jsxs)(d.Vq,{modal:e,onOpenChange:()=>{j(""),A([])},children:[a.jsx(d.hg,{asChild:!0,children:v||(0,a.jsxs)(l.z,{disabled:h,variant:"outline",className:(0,u.cn)("justify-between w-full",g&&"border border-destructive hover:bg-destructive/10"),onClick:f,children:[a.jsx("span",{className:C.length?"":"opacity-50",children:C[0]?.label||s||""}),a.jsx(r.Z,{className:"size-4 opacity-50"})]})}),(0,a.jsxs)(d.cZ,{hideCloseButton:!0,className:"flex flex-col max-h-[90%] gap-y-4 p-0 m-0 sm:max-w-xl",children:[(0,a.jsxs)(d.fK,{className:"border-b border-b-border px-4 py-4",children:[a.jsx(d.$N,{className:"hidden",children:""}),a.jsx(d.Be,{className:"hidden",children:""}),(0,a.jsxs)("div",{className:"flex items-center gap-x-4",children:[c?a.jsx("div",{className:"flex-1",children:a.jsx(o.I,{type:"search",placeholder:c.placeholder||"",value:b,onChange:e=>j(e.target.value)})}):null,i]})]}),a.jsx("div",{className:"flex-1 flex flex-col gap-y-1 overflow-y-auto px-4 py-2 overflow-x-hidden",children:w.map(e=>{let i=m?"button":d.GG;return a.jsx(t.Fragment,{children:a.jsx(i,{onClick:()=>{e.disabled||(e.isSelected?m?A(i=>i.filter(i=>i!==e.value)):p?.(C.filter(i=>i.value!==e.value)):m?A(i=>[...i,e.value]):p?.([e]))},className:(0,u.cn)("flex flex-col gap-y-1 border border-border p-2 rounded-md items-start text-left",e.disabled?"opacity-50 cursor-not-allowed":"transition-colors hover:bg-primary/20",e.isSelected&&"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground"),children:(0,a.jsxs)("div",{className:"flex items-center",children:[e.isSelected?a.jsx(n.Z,{className:"size-4 mr-2"}):null,(0,a.jsxs)("div",{children:[e.caption?a.jsx("div",{className:"text-xs opacity-60",dangerouslySetInnerHTML:{__html:e.caption||""}}):null,a.jsx("p",{children:e.label}),e.description?a.jsx("div",{className:"text-xs opacity-60",dangerouslySetInnerHTML:{__html:e.description||""}}):null]})]})})},e.value)})}),(0,a.jsxs)(d.cN,{className:"border-t border-t-border px-4 py-2 items-center w-full gap-x-2",children:[a.jsx(d.GG,{asChild:!0,children:a.jsx(l.z,{variant:"ghost",children:"Close"})}),!!F.length&&a.jsx(d.GG,{asChild:!0,children:a.jsx(l.z,{onClick:()=>{p?.(F.map(e=>w.find(i=>i.value===e)).filter(e=>e))},children:"Save"})})]})]})]})})}},75172:(e,i,s)=>{s.d(i,{a:()=>c});var a=s(17577),t=s(35047),r=s(15491),n=s(44099),l=s(60114),o=s(96221);s(63697);let d={initialised:!1,loading:!1,keys:[],drugs:[]},u=(0,l.Ue)(e=>d);function c(){let e=u(),{drugs:i}=e,s=(0,t.useRouter)(),l=(0,t.useSearchParams)(),c=(0,a.useMemo)(()=>r.Z.parse(l.toString()),[l]),{itemId:m}=c,g=(0,a.useMemo)(()=>i.filter(e=>e.itemId===m||e.key===m)[0]?.itemId,[m,i]),{alert:h}=(0,o.s)(),x=(0,a.useCallback)(async()=>{try{u.setState({loading:!0});let e=await n.Z.get("/api/drugs-library?data="+JSON.stringify({returnDraftsIfExist:!0}));if(e.data.errors?.length)throw Error(e.data.errors?.join(", "));u.setState({drugs:e.data.data})}catch(e){h({title:"Error",message:e.message,variant:"error"})}finally{u.setState({loading:!1})}},[h]);!function({events:e}){(0,a.useMemo)(()=>e,[e]),(0,a.useRef)({eventsTimeouts:{},eventsTimestamps:{}}),(0,a.useRef)(new Date().getTime()),(0,t.useRouter)()}({events:[{name:"data_changed",onEvent:{callback:async()=>{await x(),s.refresh()}}}]});let y=(0,a.useCallback)(async e=>{try{u.setState(i=>({loading:!0,drugs:i.drugs.filter(i=>!e.includes(i.itemId))}));let i=await n.Z.delete("/api/drugs-library?data="+JSON.stringify({itemsIds:e}));if(i.data.errors?.length)throw Error(i.data.errors?.join(", "));s.refresh(),h({title:"",message:"Drug deleted successfully!",variant:"success"})}catch(e){h({title:"Error",message:e.message,variant:"error"})}finally{u.setState({loading:!1})}},[h,s.refresh]),v=(0,a.useCallback)(async e=>{try{u.setState({loading:!0});let a=[],t=[],r=i;u.setState(i=>(r=!g&&e?[...i.drugs,e]:i.drugs.map(i=>i.itemId!==e?.itemId?i:(e&&(i.key!==e.key&&t.push({old:i.key,new:e.key}),i.type!==e.type&&a.push(i.key)),{...i,...e})),{loading:!0,drugs:r}));let l={data:e?[e]:r,broadcastAction:!0},o=await n.Z.post("/api/drugs-library/save",l);if(o.data.errors?.length)throw Error(o.data.errors?.join(", "));await x(),s.refresh(),h({title:"",message:`Drug${e?"":"s"} saved successfully!`,variant:"success"})}catch(e){h({title:"Error",message:e.message,variant:"error"})}finally{u.setState({loading:!1})}},[i,g,s.refresh]),f=(0,a.useCallback)(async e=>{try{u.setState({loading:!0});let i={data:e.map(e=>({itemId:e})),broadcastAction:!0},a=await n.Z.post("/api/drugs-library/copy",i);if(a.data.errors?.length)throw Error(a.data.errors?.join(", "));await x(),s.refresh(),h({title:"",message:`Drug${e.length<2?"":"s"} copied successfully!`,variant:"success"})}catch(e){h({title:"Error",message:e.message,variant:"error"})}finally{u.setState({loading:!1})}},[s.refresh]);return(0,a.useCallback)(()=>{u.setState(d)},[]),{...e,selectedItemId:g,addLink:e=>`?${r.Z.stringify({...c,addItem:e})}`,editLink:e=>`?${r.Z.stringify({...c,itemId:e})}`,getDrugs:x,deleteDrugs:y,saveDrugs:v,copyDrugs:f}}}};