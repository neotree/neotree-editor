exports.id=7631,exports.ids=[7631],exports.modules={74393:(e,a,t)=>{Promise.resolve().then(t.bind(t,7636))},23973:(e,a,t)=>{Promise.resolve().then(t.bind(t,10827)),Promise.resolve().then(t.bind(t,49596)),Promise.resolve().then(t.bind(t,82617))},69486:(e,a,t)=>{"use strict";t.d(a,{D:()=>l});var r=t(10326),s=t(77863);function l({children:e,className:a}){return r.jsx("div",{className:(0,s.cn)("pb-1 border-b border-b-primary",a),children:r.jsx("span",{className:"uppercase text-primary text-sm",children:e})})}},29354:(e,a,t)=>{"use strict";t.d(a,{h:()=>i});var r=t(10326),s=t(38178),l=t(77863);function i({children:e,className:a}){return(0,r.jsxs)(r.Fragment,{children:[r.jsx("div",{className:"h-16"}),r.jsx("div",{className:(0,l.cn)(`
                        fixed 
                        left-0 
                        bottom-0 
                        h-16 
                        w-full 
                        border-t 
                        border-t-border 
                        z-[1] 
                        bg-primary-foreground 
                        dark:bg-background 
                        shadow-md 
                        dark:shadow-foreground/10
                    `),children:r.jsx(s.V,{children:r.jsx("div",{className:(0,l.cn)("flex justify-end gap-x-4",a),children:e})})})]})}},63148:(e,a,t)=>{"use strict";t.d(a,{_:()=>i});var r=t(10326),s=t(33071),l=t(77863);function i({color:e,children:a,errors:t=[]}){return r.jsx(r.Fragment,{children:r.jsx(s.Zb,{className:(0,l.cn)("bg-destructive/20 border-destructive text-destructive","warning"===e&&"bg-yellow-200/20 border-yellow-400 text-yellow-600"),children:(0,r.jsxs)(s.aY,{className:"flex flex-col gap-y-4 px-4 py-2",children:[a,!!t.length&&r.jsx("div",{children:t.map((e,a)=>{let t=`${a}`;return r.jsx("p",{children:e},t)})})]})})})}},54328:(e,a,t)=>{"use strict";t.d(a,{O:()=>f});var r=t(10326),s=t(17577),l=t(9015),i=t(30811),n=t(51605),d=t(77863),o=t(11870),c=t(94464),u=t(63148);let f=(0,s.forwardRef)(({isDraft:e,userId:a,dataType:t,card:f},x)=>{let m=(0,n.v)({isDraft:e,userId:a});(0,s.useImperativeHandle)(x,()=>({isLocked:m}),[m]);let{loading:h,error:p,user:g,getUser:b}=function({userId:e,loadOnMount:a=!1}){(0,s.useRef)(!1);let[t,r]=(0,s.useState)(!1),[l,i]=(0,s.useState)(null),[n,d]=(0,s.useState)(""),o=(0,s.useCallback)(async(a=e)=>{try{if(d(""),!t&&e){r(!0);let e=(await c.Z.get(`/api/users/${a}`)).data;i(e)}}catch(e){d(e.message)}finally{r(!1)}},[t,e]);return{loading:t,user:l,error:n,getUser:o}}({userId:a,loadOnMount:!!f}),y=(0,s.useCallback)(async e=>{e&&!h&&!g&&a&&b()},[a,g,h]);return f&&m&&!h?r.jsx(u._,{children:(0,r.jsxs)("div",{className:"flex items-center gap-x-4",children:[r.jsx(l.Z,{className:"w-4 h-4"}),g?(0,r.jsxs)("div",{children:[r.jsx("strong",{children:g.displayName})," is working on this ",t||""]}):null]})}):r.jsx(r.Fragment,{children:(0,r.jsxs)(i.J2,{onOpenChange:y,children:[r.jsx(i.xo,{asChild:!0,children:r.jsx("button",{disabled:!m,children:r.jsx(l.Z,{className:(0,d.cn)("w-4 h-4 text-destructive/80",!m&&"opacity-0")})})}),r.jsx(i.yk,{className:"p-0 text-sm max-w-[200px]",children:h?r.jsx("div",{className:"p-2 flex justify-center",children:r.jsx(o.a,{padding:0})}):p||!g?r.jsx("div",{className:"p-2 text-destructive bg-destructive/20",children:p||"Failed to load user!"}):(0,r.jsxs)("div",{className:"p-2",children:[r.jsx("strong",{children:g.displayName})," is working on this ",t||""]})})]})})});f.displayName="LockStatus"},18048:(e,a,t)=>{"use strict";t.d(a,{u:()=>n});var r=t(10326);t(17577);var s=t(62288),l=t(77863);let i=(0,t(60114).Ue)((e,a)=>({modals:{},open(a){e(e=>({modals:{...e.modals,[a]:!0}}))},toggle(t){let r=a().modals;e(e=>({modals:{...e.modals,[t]:!r[t]}}))},close(a){e(e=>({modals:{...e.modals,[a]:!1}}))},isOpen:e=>!!a().modals[e],set(a){e(e=>({modals:{...e.modals,...a}}))}}));function n({id:e,children:a,title:t,description:n,actions:d,trigger:o,contentProps:c,footerProps:u,...f}){let{close:x,isOpen:m,set:h}=i();return r.jsx(r.Fragment,{children:(0,r.jsxs)(s.Vq,{...f,open:(e?m(e):void 0)||f.open,onOpenChange:a=>{e&&h({[e]:a}),f?.onOpenChange?.(a)},children:[o,(0,r.jsxs)(s.cZ,{hideCloseButton:!0,className:(0,l.cn)("flex flex-col max-h-[90%] gap-y-4 p-0 m-0 sm:max-w-xl",c?.className),...c,children:[(0,r.jsxs)(s.fK,{className:(0,l.cn)(t||n?"":"hidden","border-b border-b-border px-4 py-4"),children:[r.jsx(s.$N,{className:(0,l.cn)(t?"":"hidden"),children:t}),r.jsx(s.Be,{className:(0,l.cn)(n?"":"hidden"),children:n})]}),r.jsx("div",{className:"flex-1 flex flex-col overflow-y-auto px-4 py-2",children:a}),r.jsx(s.cN,{className:(0,l.cn)("border-t border-t-border px-4 py-2 items-center w-full",d?"":"hidden",u?.className),...u,children:d})]})]})})}},99463:(e,a,t)=>{"use strict";t.d(a,{w:()=>x});var r=t(10326),s=t(17577),l=t(74723),i=t(58464),n=t(7890),d=t(34474),o=t(31048),c=t(53313),u=t(90772),f=t(77863);function x({id:e,label:a,hide:t,title:x,description:m,data:h,disabled:p,onSave:g}){let b=(0,s.useMemo)(()=>{let a=!1;return Object.values(h).forEach(t=>{t[e]&&(a=!0)}),a},[h,e]),{reset:y,watch:j,setValue:v,handleSubmit:w}=(0,l.cI)({defaultValues:{...i.$7,...h}}),N=j("fontSize"),R=j("fontWeight"),C=j("fontStyle"),$=j("textColor"),k=w(g),[S,Z]=(0,s.useState)(!1);return t?null:r.jsx(r.Fragment,{children:(0,r.jsxs)(n.yo,{onOpenChange:e=>{y({...i.$7,...h}),Z(e)},children:[r.jsx(n.aM,{asChild:!0,children:r.jsx(u.z,{variant:"link",className:(0,f.cn)("p-0 text-xs",!b&&"text-muted-foreground/80 hover:text-muted-foreground"),children:a||`${b?"Update":"Set"} preferences`})}),(0,r.jsxs)(n.ue,{hideCloseButton:!0,className:"px-0 py-0 flex flex-col gap-y-4 h-full",children:[(0,r.jsxs)(n.Tu,{className:"px-4 py-4 border-b border-b-border",children:[r.jsx(n.bC,{children:x}),r.jsx(n.Ei,{className:m?"":"hidden",children:m})]}),r.jsx("div",{className:"flex-1 overflow-y-auto px-4 flex flex-col gap-y-6",children:S&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex gap-x-2 items-center",children:[r.jsx(o._,{secondary:!0,htmlFor:`fontSize.${e}`,children:"Font size"}),r.jsx("div",{children:(0,r.jsxs)(d.Ph,{value:N[e]||"default",required:!0,name:`fontSize.${e}`,disabled:p,onValueChange:a=>{let t=a||void 0;"default"===t&&(t=void 0),v(`fontSize.${e}`,t,{shouldDirty:!0})},children:[r.jsx(d.i4,{children:r.jsx(d.ki,{placeholder:"Default"})}),r.jsx(d.Bw,{children:r.jsx(d.DI,{children:[{label:"Default",value:"default"},{label:"Extra small",value:"xs"},{label:"Small",value:"sm"},{label:"Large",value:"lg"},{label:"Extra large",value:"xl"}].map(e=>r.jsx(d.Ql,{value:e.value,children:e.label},e.value))})})]})})]}),r.jsx("div",{children:(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[!!$[e]&&(0,r.jsxs)("div",{className:"flex gap-x-2 items-center",children:[r.jsx(o._,{secondary:!0,htmlFor:`textColor.${e}`,children:"Text color"}),r.jsx("input",{type:"color",value:$[e],onChange:a=>v(`textColor.${e}`,a.target.value,{shouldDirty:!0})})]}),(0,r.jsxs)("div",{className:"flex gap-x-2",children:[r.jsx(c.X,{id:`defaultTextColor.${e}`,name:`defaultTextColor.${e}`,disabled:p,checked:!$[e],onCheckedChange:()=>{let a=$[e]?void 0:"#000000";v(`textColor.${e}`,a,{shouldDirty:!0})}}),r.jsx(o._,{secondary:!0,htmlFor:`defaultTextColor.${e}`,children:"Default text color"})]})]})}),(0,r.jsxs)("div",{className:"flex gap-4 flex-wrap",children:[(0,r.jsxs)("div",{className:"flex gap-x-2",children:[r.jsx(c.X,{name:"bold",id:"bold",disabled:p,checked:"bold"===R[e],onCheckedChange:()=>v(`fontWeight.${e}`,R[e]?void 0:"bold",{shouldDirty:!0})}),r.jsx(o._,{secondary:!0,htmlFor:"bold",children:"Bold"})]}),(0,r.jsxs)("div",{className:"flex gap-x-2",children:[r.jsx(c.X,{name:"italic",id:"italic",disabled:p,checked:(C[e]||[]).includes("italic"),onCheckedChange:()=>{let a=C[e]||[];a.includes("italic")?a=a.filter(e=>"italic"!==e):a.push("italic"),a.length||(a=void 0),v(`fontStyle.${e}`,a,{shouldDirty:!0})}}),r.jsx(o._,{secondary:!0,htmlFor:"italic",children:"Italic"})]})]})]})}),(0,r.jsxs)(n.FF,{className:"px-4 py-4 border-t border-t-border",children:[r.jsx("div",{className:"ml-auto"}),r.jsx(n.sw,{asChild:!0,children:r.jsx(u.z,{variant:"outline",children:"Cancel"})}),r.jsx(n.sw,{asChild:!0,children:r.jsx(u.z,{disabled:p,onClick:()=>k(),children:"Save"})})]})]})]})})}},54432:(e,a,t)=>{"use strict";t.d(a,{I:()=>i});var r=t(10326),s=t(17577),l=t(77863);let i=s.forwardRef(({className:e,type:a,noRing:t,error:s,...i},n)=>r.jsx("input",{type:a,className:(0,l.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t&&"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",s&&"border-danger",s&&!t&&"focus-visible:ring-danger",e),ref:n,...i}));i.displayName="Input"},34474:(e,a,t)=>{"use strict";t.d(a,{Bw:()=>p,DI:()=>u,Ph:()=>c,Ql:()=>b,U$:()=>y,i4:()=>x,ki:()=>f,n5:()=>g});var r=t(10326),s=t(17577),l=t(75334),i=t(941),n=t(96633),d=t(32933),o=t(77863);let c=l.fC,u=l.ZA,f=l.B4,x=s.forwardRef(({className:e,children:a,error:t,...s},n)=>(0,r.jsxs)(l.xz,{ref:n,className:(0,o.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm placeholder:text-muted-foreground focus:outline-none disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t&&"border-danger",e),...s,children:[a,r.jsx(l.JO,{asChild:!0,children:r.jsx(i.Z,{className:"h-4 w-4 opacity-50"})})]}));x.displayName=l.xz.displayName;let m=s.forwardRef(({className:e,...a},t)=>r.jsx(l.u_,{ref:t,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",e),...a,children:r.jsx(n.Z,{className:"h-4 w-4"})}));m.displayName=l.u_.displayName;let h=s.forwardRef(({className:e,...a},t)=>r.jsx(l.$G,{ref:t,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",e),...a,children:r.jsx(i.Z,{className:"h-4 w-4"})}));h.displayName=l.$G.displayName;let p=s.forwardRef(({className:e,children:a,position:t="popper",...s},i)=>r.jsx(l.h_,{children:(0,r.jsxs)(l.VY,{ref:i,className:(0,o.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===t&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:t,...s,children:[r.jsx(m,{}),r.jsx(l.l_,{className:(0,o.cn)("p-1","popper"===t&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),r.jsx(h,{})]})}));p.displayName=l.VY.displayName;let g=s.forwardRef(({className:e,...a},t)=>r.jsx(l.__,{ref:t,className:(0,o.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...a}));g.displayName=l.__.displayName;let b=s.forwardRef(({className:e,children:a,...t},s)=>(0,r.jsxs)(l.ck,{ref:s,className:(0,o.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...t,children:[r.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:r.jsx(l.wU,{children:r.jsx(d.Z,{className:"h-4 w-4"})})}),r.jsx(l.eT,{children:a})]}));b.displayName=l.ck.displayName;let y=s.forwardRef(({className:e,...a},t)=>r.jsx(l.Z0,{ref:t,className:(0,o.cn)("-mx-1 my-1 h-px bg-muted",e),...a}));y.displayName=l.Z0.displayName},87673:(e,a,t)=>{"use strict";t.d(a,{g:()=>i});var r=t(10326),s=t(17577),l=t(77863);let i=s.forwardRef(({className:e,noRing:a,...t},s)=>r.jsx("textarea",{className:(0,l.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a&&"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",e),ref:s,...t}));i.displayName="Textarea"},82617:(e,a,t)=>{"use strict";t.d(a,{ScriptsContextProvider:()=>u,h:()=>c});var r=t(10326),s=t(17577),l=t(35047),i=t(15491),n=t(94464),d=t(12260);let o=(0,s.createContext)(null),c=()=>(0,s.useContext)(o);function u({children:e,...a}){let t=function({}){let e=(0,l.useRouter)(),{scriptId:a}=(0,l.useParams)(),{parsed:t}=(0,d.l)(),[r,o]=(0,s.useState)(!1),[c,u]=(0,s.useState)({data:[]}),[f,x]=(0,s.useState)(!1),[m,h]=(0,s.useState)([]),p=(0,s.useCallback)(()=>{e.push("/")},[e]),g=(0,s.useCallback)(()=>{e.push(`/script/${a}?${i.Z.stringify({...t,section:"screens"})}`)},[e,t,a]),b=(0,s.useCallback)(()=>{e.push(`/script/${a}?${i.Z.stringify({...t,section:"diagnoses"})}`)},[e,t,a]),y=(0,s.useCallback)(async()=>{try{o(!0);let e=await n.Z.get("/api/screens/list?data="+JSON.stringify({returnDraftsIfExist:!0,scriptsIds:[a]}));if(e.data?.errors?.length)throw Error(e.data.errors.join(", "));u(e.data)}catch(e){alert({title:"",message:"Error: "+e.message,variant:"error"})}finally{o(!1)}},[a,open,alert]);return{screens:c,screensLoading:r,keys:m,keysLoading:f,loadKeys:(0,s.useCallback)(async()=>{try{x(!0);let{data:e}=await n.Z.get("/api/scripts/keys?data="+JSON.stringify({returnDraftsIfExist:!0,scriptsIds:[a]}));if(e?.errors?.length)throw Error(e.errors.join(", "));let t=e.data.reduce((e,a)=>[...e,...a.dataKeys],[]);h(t)}catch(e){alert({title:"",message:"Error: "+e.message,variant:"error"})}finally{x(!1)}},[a,open,alert]),loadScreens:y,onCancelDiagnosisForm:b,onCancelScreenForm:g,onCancelScriptForm:p}}(a);return r.jsx(o.Provider,{value:{...a,...t},children:e})}},51605:(e,a,t)=>{"use strict";t.d(a,{v:()=>s});var r=t(3529);function s({isDraft:e,userId:a}){let{authenticatedUser:t}=(0,r.b)();return!!(e&&a&&a!==t?.userId)}},12260:(e,a,t)=>{"use strict";t.d(a,{l:()=>i});var r=t(35047),s=t(15491),l=t(17577);function i(){let e=(0,r.useRouter)(),a=(0,r.useSearchParams)(),t=(0,l.useMemo)(()=>a.toString(),[a]),i=(0,l.useMemo)(()=>s.Z.parse(a.toString()),[a]),n=(0,l.useCallback)(e=>s.Z.stringify({...i,...e}),[i]),d=(0,l.useCallback)(a=>{e.push(`?${n(a)}`)},[n,e]);return{parsed:i,stringified:t,replace:(0,l.useCallback)(a=>{e.replace(`?${n(a)}`)},[n,e]),push:d,toSearchParams:n}}},61892:(e,a,t)=>{"use strict";function r(e){return null==e||""===e}t.d(a,{x:()=>r})},41236:(e,a,t)=>{"use strict";t.d(a,{_:()=>d});var r=t(19510),s=t(57371),l=t(39755),i=t(24569),n=t(46697);function d({title:e,backLink:a,children:t}){return r.jsx("div",{className:"pb-20",children:r.jsx(i.V,{className:"flex flex-col gap-y-4",children:r.jsx(n.Zb,{children:(0,r.jsxs)(n.aY,{className:"p-0",children:[!!e&&(0,r.jsxs)("div",{className:"text-xl flex items-center gap-x-4 mb-4 p-4",children:[!!a&&r.jsx(s.default,{href:a,children:r.jsx(l.Z,{className:"h-5 w-5"})}),r.jsx("span",{children:e})]}),t]})})})})}},95602:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>h});var r=t(19510),s=t(58585),l=t(85576),i=t(47080),n=t(57848),d=t(68570);(0,d.createProxy)(String.raw`/home/farai/Workbench/Neotree/neotree-editor/contexts/scripts/index.tsx#ScriptsContext`),(0,d.createProxy)(String.raw`/home/farai/Workbench/Neotree/neotree-editor/contexts/scripts/index.tsx#useScriptsContext`);let o=(0,d.createProxy)(String.raw`/home/farai/Workbench/Neotree/neotree-editor/contexts/scripts/index.tsx#ScriptsContextProvider`);var c=t(85431),u=t(66267),f=t(24569),x=t(46697),m=t(75644);async function h({children:e}){let{user:a,yes:t}=await (0,u.canAccessPage)();if(a||(0,s.redirect)("/login"),!t)return r.jsx(f.V,{children:r.jsx(x.Zb,{children:r.jsx(x.aY,{className:"p-4 text-xl text-center text-danger bg-danger/10",children:"You don't have sufficient rights to access this page!"})})});let[d]=await Promise.all([(0,n.getHospitals)()]);return(0,r.jsxs)(r.Fragment,{children:[r.jsx(c.D,{children:"Scripts"}),r.jsx(m.g2,{children:r.jsx(o,{...l,...i,hospitals:d,getHospitals:n.getHospitals,children:e})})]})}},17162:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>n});var r=t(19510),s=t(21113),l=t(24569),i=t(46697);function n(){return r.jsx(l.V,{children:r.jsx(i.Zb,{children:r.jsx(i.aY,{className:"p-0",children:r.jsx(s.w,{loading:!0,maxRows:25,columns:[{name:"Key"},{name:"Label"},{name:"Description"},{name:"Action",align:"right",cellClassName:"w-20"}],data:[]})})})})}},47080:(e,a,t)=>{"use strict";t.r(a),t.d(a,{getFiles:()=>m,uploadFile:()=>h,uploadFileFromSite:()=>p});var r=t(24330);t(60166);var s=t(9576),l=t(61460),i=t(89114),n=t(57435),d=t(44652),o=t(66267),c=t(59271),u=t(49530),f=t(20123),x=t(40618);let m=i.Re;async function h(e,a){let t={success:!1,data:null};try{for(let r of(await (0,o.isAllowed)(["upload_files"]),Array.from(e.entries()))){let[i,n]=r;if("object"==typeof n){let r=Buffer.from(await n.arrayBuffer()),i=e.get("fileId")?.toString()||(0,s.Z)(),o={...(0,d.R)(e.get("metadata")?.toString()||"{}")},c=(e.get("size")?function(e,a){if("0"==`${e}`)return 0;let t=`${e||""}`.replaceAll(" ",""),[r,s]=(t=t.includes(".")?t.replaceAll(",",""):t.split(",").length>2?t.replaceAll(",",""):t.replaceAll(",",".")).split("."),l=!r||isNaN(Number(r))?"":r;return""==(l+=!s||isNaN(Number(s))?"":`.${s}`)||void 0===l||isNaN(Number(l))?a?.notNull?0:null:Number(l)}((0,d.R)(e.get("size")?.toString())):0)||n.size,u=e.get("filename")?.toString()||n.name,f=[i,u].filter(e=>e).join("__");(o.width||o.height)&&(f=`${f}?w=${o.width}&h=${o.height}`),t=await (0,l.G)({fileId:i,data:r,filename:f,size:c,contentType:e.get("contentType")?.toString()||n.type,metadata:o},a)}}}catch(e){t.success=!1,t.errors=[e.message],n.Z.error("uploadFile ERROR",e.message)}finally{return t}}async function p({fileId:e,siteURL:a}){try{let t=await (0,f.QF)({links:[a]});if(t.errors)throw Error(t.errors.join(", "));let{data:[r]}=t;if(!r)throw Error(`Site (${a}) was not found!`);let s=await (0,c.U)({baseURL:r.link,apiKey:r.apiKey}),n=await (0,i._I)(e);if(n.errors)throw Error(n.errors.join(", "));if(n?.data){let a=u.Z.stringify({...n.data.metadata});return a=a?`?${a}`:"",{data:{fileId:e,fileURL:[process.env.NEXT_PUBLIC_APP_URL,`/files/${e}${a}`].join("")}}}let d=(await s.get(`/api/files/${e}/download`)).data;if(d.errors)throw Error(d.errors.join(", "));if(!d.data)return{errors:["File not found"],data:null};await (0,l.G)({fileId:e,data:d.data.data,filename:d.data.filename,size:d.data.size,contentType:d.data.contentType,metadata:{...d.data.metadata}});let o=u.Z.stringify({...d.data.metadata});return o=o?`?${o}`:"",{data:{fileId:e,fileURL:[r.link,`/files/${e}${o}`].join("")}}}catch(e){return n.Z.error("downloadFileFromSite ERROR",e.message),{data:null,errors:[e.message]}}}(0,x.h)([m,h,p]),(0,r.j)("33f7ec365e69486d849f3f98709dcbf216d851bc",m),(0,r.j)("488c9e37b52de03428b134f457aa4ea8ece4fe52",h),(0,r.j)("e31b76e619726a21814cc43436f8b721d6f473e3",p)},57848:(e,a,t)=>{"use strict";t.r(a),t.d(a,{$$ACTION_0:()=>c,$$ACTION_1:()=>f,$$ACTION_2:()=>m,$$ACTION_3:()=>p,$$ACTION_4:()=>b,countHospitals:()=>u,deleteHospitals:()=>o,getHospital:()=>h,getHospitals:()=>x,saveHospitals:()=>g});var r=t(24330);t(60166);var s=t(73543),l=t(20084),i=t(57435),n=t(66267),d=t(40618);let o=(0,r.j)("6de319d88ede8d5835179324860b5e1ff73d9704",c);async function c(e){try{let a=await (0,n.isAllowed)();return await (0,s.x0)({...e,userId:a.user?.userId})}catch(e){return i.Z.error("deleteHospitals ERROR",e.message),{errors:[e.message],success:!1}}}let u=(0,r.j)("71e5d401b0a17ddbc2421e65bac974cca1b7c7a7",f);async function f(...e){try{return await (0,n.isAllowed)(),await (0,l.Py)(...e)}catch(e){return i.Z.error("countHospitals ERROR",e.message),{errors:[e.message],data:l.SE}}}let x=(0,r.j)("154f78406dd26c01e23c8e2ef62c68bdf4e1abcf",m);async function m(...e){try{return await (0,n.isAllowed)(),await (0,l.O8)(...e)}catch(e){return i.Z.error("getHospitals ERROR",e.message),{errors:[e.message],data:[]}}}let h=(0,r.j)("543eca7d1d5d6f1f356da58f10c82babfdbf02f6",p);async function p(...e){return await (0,n.isAllowed)(),await (0,l.C9)(...e)}let g=(0,r.j)("5d9cef658a17d9e70bae50010807b43db6139a16",b);async function b(e){try{let a=await (0,n.isAllowed)();return await (0,s.rr)({...e,userId:a.user?.userId})}catch(e){return i.Z.error("getSys ERROR",e.message),{errors:[e.message],data:void 0,success:!1}}}(0,d.h)([o,u,x,h,g]),(0,r.j)("e7b323b5a91d3ba50c223a3ebae732dba4578b76",o),(0,r.j)("a73b0dc955eb46a83ccb322ce8d75df54bb64801",u),(0,r.j)("f7c1f5ff22d757d951b19ffc8a35ce8b645bb416",x),(0,r.j)("38b982b33c6c0b287d82028b1f16e51b649bb0d8",h),(0,r.j)("bacdad7028d175f340f534690829ca2e20a8ccf5",g)},21113:(e,a,t)=>{"use strict";t.d(a,{w:()=>r});let r=(0,t(68570).createProxy)(String.raw`/home/farai/Workbench/Neotree/neotree-editor/components/data-table/index.tsx#DataTable`)},61460:(e,a,t)=>{"use strict";t.d(a,{G:()=>d});var r=t(88317),s=t(57435),l=t(10413),i=t(93567),n=t(89114);async function d(e,a){let t={success:!1,data:null};try{if(!e.fileId)throw Error("Missing fileId");if(!e.data)throw Error("No file uploaded");await l.Z.insert(i.files).values(e);let s=await (0,n._I)(e.fileId);if(!s)throw Error("Failed to upload file");t.success=!0,t.data=s.data,s.data&&a?.broadcastAction!==!1&&r.Z.emit("file_uploaded")}catch(e){t.success=!1,t.errors=[e.message],s.Z.error("_uploadFile ERROR",e.message)}finally{return t}}},89114:(e,a,t)=>{"use strict";t.d(a,{_I:()=>o,Re:()=>m,KU:()=>d});var r=t(57745),s=t(10413),l=t(93567),i=t(57435),n=t(44380);async function d(e){try{let a=await s.Z.query.files.findFirst({where:(0,r.eq)(l.files.fileId,e)});return{data:a?{...a,url:(0,n.TI)(`/files/${a.fileId}`)}:null}}catch(e){return i.Z.error("_getFiles ERROR",e.message),{errors:[e.message],data:null}}}async function o(e){try{let a=await s.Z.query.files.findFirst({where:(0,r.eq)(l.files.fileId,e),columns:{contentType:!0,fileId:!0,filename:!0,size:!0,metadata:!0,createdAt:!0}});return{data:a?{...a,url:(0,n.TI)(`/files/${a.fileId}`)}:null}}catch(e){return i.Z.error("_getFiles ERROR",e.message),{errors:[e.message],data:null}}}var c=t(34149),u=t(60938),f=t(81445),x=t(41502);async function m(e){try{let{filesIds:a,archived:t,searchValue:i,limit:d,page:o=1,uploadDateGTE:m,uploadDateLTE:h}={...e},p=Math.max(0,o),g=i?["%",i,"%"].join(""):"",b=[t?(0,r.K0)(l.files.deletedAt):(0,r.Ft)(l.files.deletedAt),...a?.length?[(0,r.d3)(l.files.fileId,a)]:[],...g?[(0,c.i6)`LOWER(screens.name) like LOWER(${g})`]:[],m?(0,r.eg)(l.files.createdAt,"string"==typeof m?new Date(m):m):void 0,h?(0,r.G)(l.files.createdAt,"string"==typeof h?new Date(h):h):void 0],y=s.Z.select({count:(0,u.QX)()}).from(l.files);b.length&&y.where((0,r.xD)(...b));let[{count:j}]=await y.execute(),v=1;j&&(v=(0,x.x)(d)?1:Math.ceil(j/d),p=Math.min(p,v));let w=(0,x.x)(d)?void 0:Math.max(0,(p-1)*d);return{data:(await s.Z.query.files.findMany({where:b.length?(0,r.xD)(...b):void 0,limit:d,offset:w,orderBy:(0,f.C)(l.files.createdAt),columns:{fileId:!0,contentType:!0,filename:!0,size:!0,metadata:!0,createdAt:!0}})).map(e=>({...e,url:(0,n.TI)(`/files/${e.fileId}`)})),searchValue:i,totalPages:v,totalRows:j,page:p,limit:d}}catch(e){return i.Z.error("_getFiles ERROR",e.message),{errors:[e.message],data:[],totalPages:0,totalRows:0,page:1}}}},44652:(e,a,t)=>{"use strict";function r(e){try{return JSON.parse(e)}catch(e){return null}}t.d(a,{R:()=>r})}};