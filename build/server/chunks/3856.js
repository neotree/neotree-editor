exports.id=3856,exports.ids=[3856],exports.modules={14442:(e,t,s)=>{Promise.resolve().then(s.bind(s,25813)),Promise.resolve().then(s.bind(s,93254)),Promise.resolve().then(s.bind(s,15086)),Promise.resolve().then(s.bind(s,97043)),Promise.resolve().then(s.bind(s,32520)),Promise.resolve().then(s.bind(s,72346)),Promise.resolve().then(s.bind(s,9645))},69807:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,12994,23)),Promise.resolve().then(s.t.bind(s,96114,23)),Promise.resolve().then(s.t.bind(s,9727,23)),Promise.resolve().then(s.t.bind(s,79671,23)),Promise.resolve().then(s.t.bind(s,41868,23)),Promise.resolve().then(s.t.bind(s,84759,23))},40513:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,79404,23))},25813:(e,t,s)=>{"use strict";s.d(t,{AlertModal:()=>l});var r=s(10326),a=s(17577),i=s(12534),n=s(99440),d=s(96221),o=s(90772),c=s(77863);function l(){let{isOpen:e,title:t,message:s,variant:l,buttonLabel:f,close:p,onClose:u}=(0,d.s)(),g=(0,a.useCallback)(()=>{u?.(),p()},[p,u]);return r.jsx(n.aR,{open:e,onOpenChange:g,children:(0,r.jsxs)(n._T,{children:[(0,r.jsxs)(n.fY,{children:[r.jsx(n.f$,{className:(0,c.cn)(!t&&"hidden"),children:t}),!!s&&(0,r.jsxs)("div",{className:(0,c.cn)("flex gap-y-4 flex-col sm:items-start sm:flex-row sm:gap-x-4"),children:["error"===l&&r.jsx("div",{className:"flex justify-center",children:r.jsx(i.BJv,{className:"text-red-600 min-w-12 min-h-12 w-12 h-12"})}),"success"===l&&r.jsx("div",{className:"flex justify-center",children:r.jsx(i._rq,{className:"text-green-600 min-w-12 min-h-12 w-12 h-12"})}),r.jsx("div",{className:"flex-1 text-lg",children:s})]})]}),r.jsx(n.xo,{children:r.jsx("div",{className:"flex justify-end",children:r.jsx(o.z,{onClick:g,variant:"outline",children:f})})})]})})}},93254:(e,t,s)=>{"use strict";s.d(t,{ConfirmModal:()=>c});var r=s(10326),a=s(99440),i=s(12534),n=s(46670),d=s(90772),o=s(77863);function c(){let{isOpen:e,danger:t,title:s,message:c,positiveLabel:l,negativeLabel:f,close:p,onConfirm:u}=(0,n.t)();return r.jsx(a.aR,{open:e,onOpenChange:p,children:(0,r.jsxs)(a._T,{className:"p-0 max-h-[80%] flex flex-col",children:[!!s&&r.jsx(a.fY,{className:"py-2 px-4",children:r.jsx(a.f$,{children:s})}),(0,r.jsxs)("div",{className:(0,o.cn)("px-4 flex-1 flex flex-col gap-y-4 items-center sm:items-start sm:flex-row sm:gap-x-4 overflow-y-auto",!s&&"py-2"),children:[t&&r.jsx(i.bcx,{className:"text-red-600 min-w-10 min-h-10 w-10 h-10"}),r.jsx("div",{dangerouslySetInnerHTML:{__html:c}})]}),(0,r.jsxs)(a.xo,{className:"px-4 py-2",children:[r.jsx(a.le,{children:f}),r.jsx(d.z,{variant:t?"destructive":void 0,asChild:!0,children:r.jsx(a.OL,{onClick:()=>u?.(),children:l})})]})]})})}},15086:(e,t,s)=>{"use strict";s.d(t,{AuthContextProvider:()=>i});var r=s(10326),a=s(77109);function i({children:e}){return r.jsx(a.SessionProvider,{children:e})}},97043:(e,t,s)=>{"use strict";s.d(t,{ThemeProvider:()=>i});var r=s(10326);s(17577);var a=s(14831);function i({children:e,...t}){return r.jsx(a.f,{...t,children:e})}},32520:(e,t,s)=>{"use strict";s.d(t,{SocketEventsListener:()=>i});var r=s(17577),a=s(35047);function i({events:e}){return(0,r.useRef)({eventsTimeouts:{},eventsTimestamps:{}}),(0,r.useRef)(new Date().getTime()),(0,a.useRouter)(),null}(0,s(68848).io)("https://webeditor-dev.neotree.org")},99440:(e,t,s)=>{"use strict";s.d(t,{OL:()=>h,_T:()=>f,aR:()=>o,f$:()=>g,fY:()=>p,le:()=>m,xo:()=>u});var r=s(10326),a=s(17577),i=s(80440),n=s(77863),d=s(90772);let o=i.fC;i.xz;let c=i.h_,l=a.forwardRef(({className:e,...t},s)=>r.jsx(i.aV,{className:(0,n.cn)("fixed inset-0 z-[99999999999] bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:s}));l.displayName=i.aV.displayName;let f=a.forwardRef(({className:e,...t},s)=>(0,r.jsxs)(c,{children:[r.jsx(l,{}),r.jsx(i.VY,{ref:s,className:(0,n.cn)("fixed left-[50%] top-[50%] z-[99999999999] grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t})]}));f.displayName=i.VY.displayName;let p=({className:e,...t})=>r.jsx("div",{className:(0,n.cn)("flex flex-col space-y-2 text-center sm:text-left",e),...t});p.displayName="AlertDialogHeader";let u=({className:e,...t})=>r.jsx("div",{className:(0,n.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});u.displayName="AlertDialogFooter";let g=a.forwardRef(({className:e,...t},s)=>r.jsx(i.Dx,{ref:s,className:(0,n.cn)("text-lg font-semibold",e),...t}));g.displayName=i.Dx.displayName,a.forwardRef(({className:e,...t},s)=>r.jsx(i.dk,{ref:s,className:(0,n.cn)("text-sm text-muted-foreground",e),...t})).displayName=i.dk.displayName;let h=a.forwardRef(({className:e,...t},s)=>r.jsx(i.aU,{ref:s,className:(0,n.cn)((0,d.d)(),e),...t}));h.displayName=i.aU.displayName;let m=a.forwardRef(({className:e,...t},s)=>r.jsx(i.$j,{ref:s,className:(0,n.cn)((0,d.d)({variant:"outline"}),"mt-2 sm:mt-0",e),...t}));m.displayName=i.$j.displayName},90772:(e,t,s)=>{"use strict";s.d(t,{d:()=>o,z:()=>c});var r=s(10326),a=s(17577),i=s(34214),n=s(28671),d=s(77863);let o=(0,n.j)(`
    inline-flex
    items-center
    justify-center
    whitespace-nowrap
    rounded-md
    text-sm
    font-medium
    transition-colors
    focus-visible:outline-none
    disabled:pointer-events-none
    disabled:opacity-50
  `,{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"border border-input bg-background hover:bg-primary/20","primary-outline":"border border-primary text-primary bg-transparent hover:bg-primary/20",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/90",ghost:"hover:bg-primary/20 hover:text-primary",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=a.forwardRef(({className:e,variant:t,size:s,asChild:a=!1,...n},c)=>{let l=a?i.g7:"button";return r.jsx(l,{className:(0,d.cn)(o({variant:t,size:s,className:e})),ref:c,...n})});c.displayName="Button"},72346:(e,t,s)=>{"use strict";s.d(t,{Toaster:()=>n});var r=s(10326),a=s(14831),i=s(85999);let n=({...e})=>{let{theme:t="system"}=(0,a.F)();return r.jsx(i.x7,{theme:t,richColors:!0,position:"top-center",...e})}},9645:(e,t,s)=>{"use strict";s.d(t,{AppContextProvider:()=>o,b:()=>d});var r=s(10326),a=s(17577),i=s(14831);let n=(0,a.createContext)(null),d=()=>(0,a.useContext)(n);function o({children:e,...t}){let{authenticatedUser:s,mode:d,sys:o}=t,{setTheme:c}=(0,i.F)(),l=(0,a.useMemo)(()=>{let e=s?.role==="admin",t=s?.role==="super_user";return{isDefaultUser:!e&&!t,isAdmin:e,isSuperUser:t}},[s]),f=(0,a.useMemo)(()=>!l.isAdmin&&!l.isSuperUser||"view"===d,[l,d]),p={...t,...l,viewOnly:f};return r.jsx(n.Provider,{value:p,children:e})}},96221:(e,t,s)=>{"use strict";s.d(t,{s:()=>i});var r=s(60114);let a={title:"",message:"",buttonLabel:"Ok",variant:"info",onClose:void 0},i=(0,r.Ue)(e=>({isOpen:!1,...a,alert:t=>e({isOpen:!0,...a,...t}),close:()=>e({isOpen:!1,onClose:void 0,...a})}))},46670:(e,t,s)=>{"use strict";s.d(t,{t:()=>i});var r=s(60114);let a={danger:!1,title:"Confirm",message:"Are you sure?",positiveLabel:"Ok",negativeLabel:"Cancel"},i=(0,r.Ue)(e=>({isOpen:!1,...a,confirm:(t,s)=>e({isOpen:!0,...a,...s,onConfirm:t}),close:()=>e({isOpen:!1,onConfirm:void 0,...a})}))},77863:(e,t,s)=>{"use strict";s.d(t,{cn:()=>i});var r=s(41135),a=s(31009);function i(...e){return(0,a.m6)((0,r.W)(e))}},11844:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$ACTION_0:()=>U,$$ACTION_1:()=>L,countAllDrafts:()=>B,discardDrafts:()=>z,getCookie:()=>J,getEditorDetails:()=>H,getMode:()=>G,publishData:()=>X,revalidatePath:()=>F,setCookie:()=>Q,setMode:()=>Y});var r=s(24330);s(60166);var a=s(71615),i=s(57708),n=s(88317),d=s(57435),o=s(20706),c=s(57745),l=s(9576),f=s(10413),p=s(57418),u=s(34149),g=s(60938),h=s(81445),m=s(30900),y=s(41502);async function I(e){let t=m.Z(e)?(0,c.eq)(p.configKeys.configKeyId,e):(0,c.eq)(p.configKeys.oldConfigKeyId,e);return await f.Z.query.configKeys.findFirst({where:(0,c.xD)(t,(0,c.Ft)(p.configKeys.deletedAt)),columns:{id:!0,configKeyId:!0,oldConfigKeyId:!0,label:!0,key:!0,summary:!0,version:!0,position:!0}})}async function w({limit:e,page:t=1,configKeyIds:s,searchValue:r,archived:a}){t=Math.max(0,t);let i=[];if(a?i.push((0,c.K0)(p.configKeys.deletedAt)):i.push((0,c.Ft)(p.configKeys.deletedAt)),s?.length&&i.push((0,c.d3)(p.configKeys.configKeyId,s)),r=`${r||""}`.trim()){let e=["%",r,"%"].join("");i.push((0,u.i6)`LOWER(configKeys.name) like LOWER(${e})`)}let n=f.Z.select({count:(0,g.QX)()}).from(p.configKeys);i.length&&n.where((0,c.xD)(...i));let[{count:d}]=await n.execute(),o=1;d&&(t=Math.min(t,o=(0,y.x)(e)?1:Math.ceil(d/e)));let l=(0,y.x)(e)?void 0:Math.max(0,(t-1)*e),m=f.Z.select({id:p.configKeys.id,configKeyId:p.configKeys.configKeyId,oldConfigKeyId:p.configKeys.oldConfigKeyId,label:p.configKeys.label,key:p.configKeys.key,summary:p.configKeys.summary,version:p.configKeys.version,position:p.configKeys.position,configKeyDraftId:p.configKeysDrafts.configKeyDraftId}).from(p.configKeys).leftJoin(p.configKeysDrafts,(0,c.eq)(p.configKeys.configKeyId,p.configKeysDrafts.configKeyId)).orderBy((0,h.C)(p.configKeys.id));return(0,y.x)(e)||m.limit(e),l&&m.offset(l),i.length&&m.where((0,c.xD)(...i)),{page:t,limit:e,data:(await m.execute()).map(e=>({...e,publishedVersion:e.version})),totalRows:d,totalPages:o,searchValue:r,error:void 0}}let x={page:1,limit:void 0,totalRows:0,totalPages:1,data:[],searchValue:void 0,error:void 0};async function v(e){let t=x;try{t=await w({...e})}catch(e){d.Z.error("_getConfigKeys ERROR",e),t.error=e.message}finally{return t}}async function D(e){let t={success:!0};try{let e=await f.Z.query.configKeysDrafts.findMany({columns:{configKeyDraftId:!0,configKeyId:!0}}),s=e.filter(e=>!e.configKeyId),r=e.filter(e=>e.configKeyId).map(e=>({...e,configKeyId:e.configKeyId})),a=[];if(s.length){let{error:e}=await Z(s);e&&a.push(e)}r.length&&(await b(r)).forEach(e=>e.error&&a.push(e.error)),a.length&&(t.success=!1,t.errors=a)}catch(e){t.success=!1,t.errors=[e.message],d.Z.error("_publishConfigKeys ERROR",e.message)}finally{return t}}async function Z(e,t){let s={inserted:[],success:!1};try{let r=[],a=e.length?await f.Z.query.configKeysDrafts.findMany({where:(0,c.d3)(p.configKeysDrafts.configKeyDraftId,e.map(e=>e.configKeyDraftId))}):[],i=[];for(let{id:e,data:t}of(a.filter(e=>e.configKeyId).length&&(i=await f.Z.query.configKeys.findMany({where:(0,c.d3)(p.configKeys.configKeyId,a.filter(e=>e.configKeyId).map(e=>e.configKeyId))})),a)){let s=t.configKeyId||(0,l.Z)();r.push({...t,configKeyId:s}),a=a.map(t=>(t.id===e&&(t.data.configKeyId=s),t))}await f.Z.insert(p.configKeys).values(r);let d=await v({configKeyIds:r.map(e=>e.configKeyId)});s.inserted=t?.returnInserted?d.data:[],s.success=!0,await _({drafts:a,previous:i}),a.length&&await f.Z.delete(p.configKeysDrafts).where((0,c.d3)(p.configKeysDrafts.id,a.map(e=>e.id))),t?.broadcastAction&&n.Z.emit("data_changed","create_config_keys")}catch(e){s.error=e.message}finally{return s}}async function b(e,t){let s=[],r=e.length?await f.Z.query.configKeysDrafts.findMany({where:(0,c.d3)(p.configKeysDrafts.configKeyId,e.map(e=>e.configKeyId))}):[],a=[];for(let{configKeyId:e,data:i}of(r.filter(e=>e.configKeyId).length&&(a=await f.Z.query.configKeys.findMany({where:(0,c.d3)(p.configKeys.configKeyId,r.filter(e=>e.configKeyId).map(e=>e.configKeyId))})),r)){let a=e,{configKeyId:n,oldConfigKeyId:o,id:l,createdAt:u,updatedAt:g,deletedAt:h,...m}=i;try{let e={...m,publishDate:new Date};await f.Z.update(p.configKeys).set(e).where((0,c.eq)(p.configKeys.configKeyId,a));let r=t?.returnUpdated?await I(a):void 0;s.push({configKeyId:a,configKey:r})}catch(e){d.Z.error(`_updateConfigKeys configKeyId=${a}`,e.message),s.push({configKeyId:a,error:e.message}),r=r.filter(e=>e.data.configKeyId!==a)}}return await _({drafts:r,previous:a}),r.length&&await f.Z.delete(p.configKeysDrafts).where((0,c.d3)(p.configKeysDrafts.id,r.map(e=>e.id))),t?.broadcastAction&&n.Z.emit("data_changed","update_config_keys"),s}async function _({previous:e,drafts:t}){try{let s=[];for(let r of t){let t={version:r?.data?.version||1,configKeyId:r?.data?.configKeyId,changes:{}};if(r?.data?.version===1)t.changes={action:"create_config_key",description:"Create config key",oldValues:[],newValues:[]};else{let s=e.filter(e=>e.configKeyId===r?.data?.configKeyId)[0],a=[],i=[];Object.keys({...r?.data}).filter(e=>!["version","draft"].includes(e)).forEach(e=>{let t=r.data[e],n={...s}[e];JSON.stringify(t)!==JSON.stringify(n)&&(a.push({[e]:n}),i.push({[e]:t}))}),t.changes={action:"update_config_key",description:"Update config key",oldValues:a,newValues:i}}s.push(t)}await f.Z.insert(p.configKeysHistory).values(s)}catch(e){d.Z.error(e.message)}}var A=s(66267),j=s(28422);async function R(e){let t=e?.firstVersion?[(0,c.Ft)(p.configKeysDrafts.configKeyId)]:[];e?.configKeysDraftsIds&&t.push((0,c.d3)(p.configKeysDrafts.configKeyDraftId,e.configKeysDraftsIds)),e?.configKeysIds&&t.push((0,c.d3)(p.configKeysDrafts.configKeyId,e.configKeysIds));let s=f.Z.select({count:(0,g.QX)()}).from(p.configKeysDrafts);t.length&&s.where((0,c.xD)(...t));let r=await s.execute();return r[0]?.count||0}async function K(e){let t=f.Z.select({count:(0,g.QX)()}).from(p.screensDrafts);e?.firstVersion&&t.where((0,c.Ft)(p.screensDrafts.screenId)),e?.scriptId&&t.where((0,c.eq)(p.screensDrafts.scriptId,e.scriptId));let s=await t.execute();return s[0]?.count||0}async function P(e){let t=f.Z.select({count:(0,g.QX)()}).from(p.scriptsDrafts);e?.firstVersion&&t.where((0,c.Ft)(p.scriptsDrafts.scriptId));let s=await t.execute();return s[0]?.count||0}async function M(e){let t=await f.Z.delete(p.configKeysDrafts);return e?.broadcastAction&&n.Z.emit("data_changed","delete_screens_drafts"),t}async function S(e){let t=await f.Z.delete(p.screensDrafts);return e?.broadcastAction&&n.Z.emit("data_changed","delete_screens_drafts"),t}s(27457),s(57040);var N=s(18100);async function q(e){let t=await f.Z.query.scriptsDrafts.findMany({columns:{scriptDraftId:!0,scriptId:!0}}),s=await f.Z.delete(p.scriptsDrafts);return t.length&&(await (0,N.j)({restoreKeys:t.map(e=>`script_draft_${e.scriptDraftId}`)}),await f.Z.update(p.screensHistory).set({restoreKey:null}).where((0,c.d3)(p.screensHistory.restoreKey,t.map(e=>`script_draft_${e.scriptDraftId}`)))),e?.broadcastAction&&n.Z.emit("data_changed","delete_scripts_drafts"),s}async function E(e){let t=f.Z.select({count:(0,g.QX)()}).from(p.diagnosesDrafts);e?.firstVersion&&t.where((0,c.Ft)(p.diagnosesDrafts.diagnosisId)),e?.scriptId&&t.where((0,c.eq)(p.diagnosesDrafts.scriptId,e.scriptId));let s=await t.execute();return s[0]?.count||0}async function O(e){let t=await f.Z.delete(p.diagnosesDrafts);return e?.broadcastAction&&n.Z.emit("data_changed","delete_diagnoses_drafts"),t}s(85336);var V=s(28585);async function $(e){try{let{items:t,broadcastAction:s}={...e},r=["configKeys"===t?(0,c.K0)(p.pendingDeletion.configKeyId):void 0,"scripts"===t?(0,c.xD)((0,c.K0)(p.pendingDeletion.scriptId),(0,c.Ft)(p.pendingDeletion.screenId),(0,c.Ft)(p.pendingDeletion.diagnosisId)):void 0,"screens"===t?(0,c.K0)(p.pendingDeletion.screenId):void 0,"diagnoses"===t?(0,c.K0)(p.pendingDeletion.diagnosisId):void 0];return await f.Z.delete(p.pendingDeletion).where(r.length?(0,c.xD)(...r):void 0),s&&n.Z.emit("data_changed","clear_pending_deletion"),{success:!0}}catch(e){return d.Z.error("_clearPendingDeletion ERROR",e.message),{success:!1,errors:[e.message]}}}async function k(){try{let e=await f.Z.select({count:(0,g.QX)()}).from(p.pendingDeletion);return{total:e[0]?.count||0}}catch(e){return d.Z.log("_countPendingDeletion ERROR",e.message),{total:0,errors:[e.message]}}}let T={scripts:0,screens:0,diagnoses:0,configKeys:0,total:0};async function C(){let e={...T};try{let t=await f.Z.select({count:(0,g.QX)()}).from(p.scriptsDrafts);e.scripts=t[0]?.count||0;let s=await f.Z.select({count:(0,g.QX)()}).from(p.screensDrafts);e.screens=s[0]?.count||0;let r=await f.Z.select({count:(0,g.QX)()}).from(p.diagnosesDrafts);e.diagnoses=r[0]?.count||0;let a=await f.Z.select({count:(0,g.QX)()}).from(p.configKeysDrafts);return e.configKeys=a[0]?.count||0,e.total=e.configKeys+e.diagnoses+e.screens+e.scripts,{...e}}catch(t){return d.Z.log("_countDrafts ERROR",t.message),{...e,errors:[t.message]}}}var W=s(40618);async function H(){let e=[],t=!1;try{let s=await k();s.errors?.forEach(t=>e.push(t));let{errors:r,...a}=await C();r?.forEach(t=>e.push(t));let i=await G();return t="development"===i&&(!!a.total||!!s.total),{pendingDeletion:s.total,drafts:a,errors:e.length?e:void 0,shouldPublishData:t}}catch(s){return d.Z.log("getEditorDetails ERROR",s.message),{errors:[s.message,...e],pendingDeletion:0,drafts:T,shouldPublishData:t}}}let F=(0,r.j)("6631df3cf85446a0818ac2dde947f63d2fad6c89",U);async function U(e,t){return(0,i.revalidatePath)(e,t)}let B=(0,r.j)("64f3a633dace3ede963f725b16dc2b5f210bdd56",L);async function L(){try{let e=await R(),t=await K(),s=await P(),r=await E();return{configKeys:e,screens:t,scripts:s,diagnoses:r}}catch(e){return d.Z.error("countAllDrafts ERROR",e.message),{screens:0,scripts:0,configKeys:0,diagnoses:0}}}async function X(){let e={success:!0};try{await (0,A.isAllowed)(["create_config_keys","update_config_keys","create_scripts","update_scripts","create_diagnoses","update_diagnoses","create_screens","update_screens"]);let t=await D(),s=await (0,o.Ls)(),r=await (0,j.Ry)(),a=await (0,V.gv)();t.errors&&(e.success=!1,e.errors=[...e.errors||[],...t.errors]),s.errors&&(e.success=!1,e.errors=[...e.errors||[],...s.errors]),r.errors&&(e.success=!1,e.errors=[...e.errors||[],...r.errors]),a.errors&&(e.success=!1,e.errors=[...e.errors||[],...a.errors]),n.Z.emit("data_changed","publish_data")}catch(t){e.success=!1,e.errors=[t.message],d.Z.error("publishData ERROR",t.message)}finally{return e}}async function z(){let e={success:!0};try{await (0,A.isAllowed)(["delete_config_keys","delete_scripts","delete_diagnoses","delete_screens"]),await M(),await q(),await S(),await O(),await $(),n.Z.emit("data_changed","discard_drafts")}catch(t){e.success=!1,e.errors=[t.message],d.Z.error("publishData ERROR",t.message)}finally{return e}}async function J(e){let t=(0,a.cookies)().get(e);return t?.value||null}async function Q(e){(0,a.cookies)().set(e)}async function G(){let e="view";try{let t=await J("mode");t?e=t:await Q({name:"mode",value:e})}catch(e){d.Z.error("getMode ERROR",e.message)}finally{return e}}async function Y(e){try{await Q({name:"mode",value:e}),n.Z.emit("mode_changed",e)}catch(e){d.Z.error("setMode ERROR",e.message)}}(0,W.h)([H,F,B,X,z,J,Q,G,Y]),(0,r.j)("7b75f487e334a946b63829017d9aa902b59378e0",H),(0,r.j)("893d510641fbd37b4cbe2a75916de7869dd43ca6",F),(0,r.j)("3b2ac91bc81489809370d893a7d7c83a162e1a96",B),(0,r.j)("1deaec5322a5d4e3e3d426178bd61a39c0c28ae9",X),(0,r.j)("e8515d84060942f8f3866c65cc44204f02ef54e2",z),(0,r.j)("4958dc639faa75249a639ef7ce81c8c71ee4c24a",J),(0,r.j)("88f9dd170a821c7d7365f4d4939c7fe794c4c2e9",Q),(0,r.j)("98e38f6190d1550c36102fe6acadfd92953e95cf",G),(0,r.j)("ab746bc027c1a6df89eba1266023bcc3935f86c4",Y)},65376:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$ACTION_0:()=>I,getSites:()=>m,importRemoteScripts:()=>y});var r=s(24330);s(60166);var a=s(92237),i=s(57435),n=s(66267),d=s(29712),o=s(57745),c=s(88317),l=s(10413),f=s(57418),p=s(49530),u=s(20706);async function g({siteId:e,scriptsIds:t},s){let r={success:!1};try{if(!e)throw Error("Missing siteId");let a=await l.Z.query.sites.findFirst({where:(0,o.eq)(f.sites.siteId,e)});if(!a)throw Error("Site not found");let n="https://webeditor-dev.neotree.org",g=d.Z.create({baseURL:`${n}/api`});for(let{scriptId:e,overWriteExistingScriptWithId:s}of(g.interceptors.request.use(async e=>(e.headers&&(e.headers["x-api-key"]=a.apiKey),i.Z.error(e.method,[`${n}/api`,e.url].join("")),e)),g.interceptors.response.use(e=>e,e=>new Promise((t,s)=>s(e))),t)){let{data:t=[],errors:a}=(await g.get("/scripts/with-items?"+p.Z.stringify({scriptsIds:JSON.stringify([e])}))).data;if(a?.length)r.success=!1,r.errors=a;else{let e=await (0,u.gX)(t.map(e=>({...e,scriptId:s||e.scriptId})),{overWriteScriptId:!s});e.errors&&(r.success=!1,r.errors=[...r.errors||[],...e.errors])}}!r.errors?.length&&(r.success=!0,s?.broadcastAction&&c.Z.emit("data_changed","create_scripts_drafts"))}catch(t){let e=t.response?.data?.message||t.response?.data||t.message;r.success=!1,r.errors=[e],i.Z.error("importRemoteScripts ERROR",e)}finally{return r}}var h=s(40618);let m=a.Q,y=(0,r.j)("0c0d3a976a0d3670bfcd783a4eda74ef47d08486",I);async function I(...e){let t={success:!1};try{await (0,n.isAllowed)(["import_scripts"]),t=await g(...e)}catch(e){t.errors=[e.message],i.Z.error("importRemoteScripts ERROR",e.message)}finally{return t}}(0,h.h)([m,y]),(0,r.j)("fb88c3f5187f1ae67c65c11fdc8ca29dc4350c9d",m),(0,r.j)("eb767362e2857509ccd48c4eb7968f5169ef228f",y)},60563:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$ACTION_0:()=>u,$$ACTION_1:()=>h,getSys:()=>p,updateSys:()=>g});var r=s(24330);s(60166);var a=s(57745),i=s(88317),n=s(57435),d=s(10413),o=s(57418);async function c(e={},t){let s={success:!1};try{for(let t of Object.keys(e))try{await d.Z.update(o.sys).set({value:e[t]}).where((0,a.eq)(o.sys.key,t))}catch(e){s.errors=[...s?.errors||[],e.message]}!s.errors?.length&&(s.success=!0,t?.broadcastAction&&i.Z.emit("update_system"))}catch(e){s.success=!1,s.errors=[e.message],n.Z.error("_updateSys ERROR",e.message)}finally{return s}}async function l(){let e={data:{}};try{let t=(await d.Z.query.sys.findMany()).reduce((e,t)=>({...e,[t.key]:t.value}),{});e.data=t}catch(t){e.errors=[t.message],n.Z.error("_getSys ERROR",t.message)}finally{return e}}var f=s(40618);let p=(0,r.j)("458e0bb776cc3d544fd3487595ecc0d4d43114fc",u);async function u(...e){return await l(...e)}let g=(0,r.j)("33d8b15ec8dd98c91eac63d85211264cf0a630b8",h);async function h(...e){let t={success:!1};try{t=await c(...e)}catch(e){t.errors=[e.message],n.Z.error("getSys ERROR",e.message)}finally{return t}}(0,f.h)([p,g]),(0,r.j)("b0d634be4cc158e4043dd09673ee30e8e18999af",p),(0,r.j)("62ecd67a03f8f29d7d9a14399a69f12cd0186bad",g)},69684:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>T,metadata:()=>k});var r=s(19510),a=s(81082),i=s.n(a);s(3641);var n=s(68570);let d=(0,n.createProxy)(String.raw`/Users/lafarai/Werq/BWS/NeoTree/neotree-webeditor/components/providers/auth-context-provider.tsx`),{__esModule:o,$$typeof:c}=d;d.default;let l=(0,n.createProxy)(String.raw`/Users/lafarai/Werq/BWS/NeoTree/neotree-webeditor/components/providers/auth-context-provider.tsx#AuthContextProvider`),f=(0,n.createProxy)(String.raw`/Users/lafarai/Werq/BWS/NeoTree/neotree-webeditor/components/providers/theme-provider.tsx`),{__esModule:p,$$typeof:u}=f;f.default;let g=(0,n.createProxy)(String.raw`/Users/lafarai/Werq/BWS/NeoTree/neotree-webeditor/components/providers/theme-provider.tsx#ThemeProvider`),h=(0,n.createProxy)(String.raw`/Users/lafarai/Werq/BWS/NeoTree/neotree-webeditor/components/ui/sonner.tsx`),{__esModule:m,$$typeof:y}=h;h.default;let I=(0,n.createProxy)(String.raw`/Users/lafarai/Werq/BWS/NeoTree/neotree-webeditor/components/ui/sonner.tsx#Toaster`),w=(0,n.createProxy)(String.raw`/Users/lafarai/Werq/BWS/NeoTree/neotree-webeditor/components/modals/confirm.tsx`),{__esModule:x,$$typeof:v}=w;w.default;let D=(0,n.createProxy)(String.raw`/Users/lafarai/Werq/BWS/NeoTree/neotree-webeditor/components/modals/confirm.tsx#ConfirmModal`),Z=(0,n.createProxy)(String.raw`/Users/lafarai/Werq/BWS/NeoTree/neotree-webeditor/components/modals/alert.tsx`),{__esModule:b,$$typeof:_}=Z;Z.default;let A=(0,n.createProxy)(String.raw`/Users/lafarai/Werq/BWS/NeoTree/neotree-webeditor/components/modals/alert.tsx#AlertModal`),j=(0,n.createProxy)(String.raw`/Users/lafarai/Werq/BWS/NeoTree/neotree-webeditor/contexts/app/index.tsx`),{__esModule:R,$$typeof:K}=j;j.default,(0,n.createProxy)(String.raw`/Users/lafarai/Werq/BWS/NeoTree/neotree-webeditor/contexts/app/index.tsx#AppContext`),(0,n.createProxy)(String.raw`/Users/lafarai/Werq/BWS/NeoTree/neotree-webeditor/contexts/app/index.tsx#useAppContext`);let P=(0,n.createProxy)(String.raw`/Users/lafarai/Werq/BWS/NeoTree/neotree-webeditor/contexts/app/index.tsx#AppContextProvider`);var M=s(60563),S=s(65376),N=s(40801),q=s(11844);s(67272);let E=(0,n.createProxy)(String.raw`/Users/lafarai/Werq/BWS/NeoTree/neotree-webeditor/components/socket-events-listener.tsx`),{__esModule:O,$$typeof:V}=E;E.default;let $=(0,n.createProxy)(String.raw`/Users/lafarai/Werq/BWS/NeoTree/neotree-webeditor/components/socket-events-listener.tsx#SocketEventsListener`),k={title:"Neotree",description:"Neotree",icons:[{media:"(prefers-color-scheme: light)",url:"/images/favicon.ico",href:"/images/favicon.ico"},{media:"(prefers-color-scheme: dark)",url:"/images/favicon.ico",href:"/images/favicon.ico"}]};async function T({children:e}){let[t,s,a,n]=await Promise.all([q.getEditorDetails(),(0,N.getAuthenticatedUser)(),q.getMode(),(0,M.getSys)()]);return r.jsx("html",{lang:"en",children:r.jsx("body",{className:i().className,children:r.jsx(l,{children:(0,r.jsxs)(g,{attribute:"class",defaultTheme:"light",enableSystem:!0,disableTransitionOnChange:!0,children:[(0,r.jsxs)(P,{...q,...M,...t,sys:n,mode:a||"view",getSites:S.getSites,authenticatedUser:s,children:[e,r.jsx($,{events:[{name:"mode_changed",onEvent:{refreshRouter:!0}},{name:"update_system",onEvent:{refreshRouter:!0}},{name:"data_changed",onEvent:{refreshRouter:!0}}]})]}),r.jsx(I,{}),r.jsx(D,{}),r.jsx(A,{})]})})})})}},96560:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var r=s(19510),a=s(84101),i=s(2946),n=s(55848),d=s(57371);function o(){return r.jsx("div",{className:"w-full h-full flex items-center justify-center",children:(0,r.jsxs)("div",{className:"px-4 py-4 flex flex-col gap-y-5 text-center justify-center items-center",children:[r.jsx(a.T,{}),r.jsx("div",{className:"text-6xl sm:text-9xl font-extrabold text-secondary dark:text-secondary-foreground",children:"Four, Oh! Four"}),r.jsx("div",{children:"Sorry, can't find the page you're looking for."}),r.jsx(i.z,{variant:"outline",size:"lg",asChild:!0,children:r.jsx(d.default,{href:"/",replace:!0,children:(0,r.jsxs)(r.Fragment,{children:[r.jsx(n.Z,{className:"w-6 h-6 mr-2"}),r.jsx("span",{className:"text-xl",children:"Home"})]})})})]})})}},84101:(e,t,s)=>{"use strict";s.d(t,{T:()=>n});var r=s(19510),a=s(57371),i=s(50650);function n({size:e,href:t,className:s,variant:n="default",theme:d="auto"}){let o=r.jsx("div",{className:(0,i.cn)("font-bold text-primary",(()=>{switch(e){case"sm":return"w-20";case"lg":return"w-40";case"xl":return"w-80";case"2xl":return"w-[600px]";default:return"w-28"}})(),s),children:"icon"===n?r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"145.29",height:"78.354",viewBox:"0 0 145.29 78.354",className:"w-full h-auto",children:(0,r.jsxs)("g",{id:"Group_1377","data-name":"Group 1377",transform:"translate(0)",children:[r.jsx("path",{id:"Path_885","data-name":"Path 885",d:"M80.664,59.008a6.663,6.663,0,0,1-.159-1.541c-.006-.5.022-.993.056-1.487a20.31,20.31,0,0,1,2.705-8.488A13.118,13.118,0,0,1,87.514,43a7.745,7.745,0,0,1,6.009-1.066.191.191,0,0,1,0,.368l0,0A10.833,10.833,0,0,0,88.9,44.863a18.447,18.447,0,0,0-3.181,4.1A47.879,47.879,0,0,0,83.244,53.8c-.386.839-.754,1.695-1.125,2.559-.2.43-.363.868-.554,1.306l-.267.659c-.09.213-.178.459-.24.633l-.025.07a.193.193,0,0,1-.248.114A.2.2,0,0,1,80.664,59.008Z",transform:"translate(-3.081 -5.835)",fill:"#2b304a"}),r.jsx("path",{id:"Path_886","data-name":"Path 886",d:"M81.873,58.957c-.063-.175-.149-.42-.241-.633l-.267-.659c-.189-.438-.354-.876-.554-1.306-.37-.865-.739-1.72-1.123-2.559a48.218,48.218,0,0,0-2.477-4.838,18.487,18.487,0,0,0-3.18-4.1A10.833,10.833,0,0,0,69.409,42.3l0,0a.191.191,0,0,1-.13-.236.2.2,0,0,1,.135-.132A7.74,7.74,0,0,1,75.416,43a13.118,13.118,0,0,1,4.248,4.5,20.309,20.309,0,0,1,2.705,8.488c.033.493.063.989.056,1.487a6.664,6.664,0,0,1-.159,1.541.193.193,0,0,1-.368.019Z",transform:"translate(-9.675 -5.835)",fill:"#2b304a"}),(0,r.jsxs)("g",{id:"Group_1284","data-name":"Group 1284",transform:"translate(0 57.147)",children:[r.jsx("path",{id:"Path_887","data-name":"Path 887",d:"M48.5,63.117V74.659a1.605,1.605,0,1,1-3.208,0V63.491c0-3.291-2.042-5.416-5.041-5.416a5.163,5.163,0,0,0-5.333,5.416V74.659a1.605,1.605,0,1,1-3.208,0V56.784a1.61,1.61,0,0,1,1.625-1.666,1.629,1.629,0,0,1,1.584,1.666v.749a8.317,8.317,0,0,1,6.041-2.415C45.586,55.118,48.5,58.242,48.5,63.117Z",transform:"translate(-31.711 -55.118)",fill:"#2b304a"}),r.jsx("path",{id:"Path_888","data-name":"Path 888",d:"M65.279,64.493V64.7a1.772,1.772,0,0,1-1.958,2H48.988a7.165,7.165,0,0,0,7.458,6.668,8.063,8.063,0,0,0,5.292-1.958,1.666,1.666,0,0,1,1.084-.459,1.378,1.378,0,0,1,1.415,1.415,1.862,1.862,0,0,1-.792,1.46,10.79,10.79,0,0,1-7.04,2.5,10.605,10.605,0,0,1-.376-21.207A8.984,8.984,0,0,1,65.279,64.493Zm-16.166-.625H61.986a5.747,5.747,0,0,0-6.041-5.833A6.918,6.918,0,0,0,49.113,63.867Z",transform:"translate(-23.53 -55.118)",fill:"#2b304a"}),r.jsx("path",{id:"Path_889","data-name":"Path 889",d:"M81.9,65.7A10.625,10.625,0,1,1,71.273,55.118,10.563,10.563,0,0,1,81.9,65.7Zm-17.959.043a7.267,7.267,0,0,0,7.293,7.582,7.631,7.631,0,1,0-7.293-7.582Z",transform:"translate(-14.732 -55.118)",fill:"#2b304a"}),r.jsx("path",{id:"Path_890","data-name":"Path 890",d:"M82.669,55.407H87.71a1.437,1.437,0,1,1,0,2.874H82.669V69.364c0,2.667,1.376,3.875,4.292,3.875.708,0,1.208-.084,1.666-.084a1.291,1.291,0,0,1,1.458,1.25,1.431,1.431,0,0,1-1.166,1.458,8.954,8.954,0,0,1-2.624.292c-4.418,0-6.834-2.333-6.834-6.583V58.281H77.377a1.438,1.438,0,1,1,0-2.874h2.083",transform:"translate(-5.796 -54.948)",fill:"#2b304a"}),r.jsx("path",{id:"Path_891","data-name":"Path 891",d:"M98.757,56.909a1.5,1.5,0,0,1-1.625,1.5,5.984,5.984,0,0,0-6.334,6v10.25a1.605,1.605,0,1,1-3.208,0V56.784a1.611,1.611,0,0,1,1.626-1.666A1.627,1.627,0,0,1,90.8,56.784v1.5a8.145,8.145,0,0,1,6.334-2.875A1.526,1.526,0,0,1,98.757,56.909Z",transform:"translate(1.076 -55.118)",fill:"#2b304a"}),r.jsx("path",{id:"Path_892","data-name":"Path 892",d:"M115.537,64.493V64.7a1.772,1.772,0,0,1-1.958,2H99.246a7.166,7.166,0,0,0,7.459,6.668A8.059,8.059,0,0,0,112,71.409a1.673,1.673,0,0,1,1.084-.459,1.379,1.379,0,0,1,1.417,1.415,1.862,1.862,0,0,1-.792,1.46,10.791,10.791,0,0,1-7.042,2.5,10.605,10.605,0,0,1-.374-21.207A8.984,8.984,0,0,1,115.537,64.493Zm-16.166-.625h12.875a5.748,5.748,0,0,0-6.041-5.833A6.921,6.921,0,0,0,99.372,63.867Z",transform:"translate(5.961 -55.118)",fill:"#2b304a"}),r.jsx("path",{id:"Path_893","data-name":"Path 893",d:"M130.531,64.493V64.7a1.772,1.772,0,0,1-1.958,2H114.24a7.166,7.166,0,0,0,7.459,6.668,8.059,8.059,0,0,0,5.29-1.958,1.67,1.67,0,0,1,1.084-.459,1.379,1.379,0,0,1,1.417,1.415,1.862,1.862,0,0,1-.792,1.46,10.791,10.791,0,0,1-7.042,2.5,10.605,10.605,0,0,1-.374-21.207A8.984,8.984,0,0,1,130.531,64.493Zm-16.166-.625H127.24a5.749,5.749,0,0,0-6.041-5.833A6.919,6.919,0,0,0,114.366,63.867Z",transform:"translate(14.758 -55.118)",fill:"#2b304a"})]}),r.jsx("path",{id:"Path_894","data-name":"Path 894",d:"M69.853,22.729a1.984,1.984,0,0,1,.4,1.282,1.935,1.935,0,0,1-.611,1.365,1.81,1.81,0,0,1-1.452.438,2.047,2.047,0,0,1-1.206-.592l1.142-.335a1.771,1.771,0,0,0,.719-.4A5.347,5.347,0,0,0,69.853,22.729Z",transform:"translate(-11.015 -16.976)",fill:"#70a487"}),r.jsx("path",{id:"Path_895","data-name":"Path 895",d:"M70.662,26.239a11.037,11.037,0,0,1,1.073-1.157c.178-.186.308-.428.551-.5a1.653,1.653,0,0,1,.911-.008.1.1,0,0,1,.075.092,1.338,1.338,0,0,1-.309.9,1.393,1.393,0,0,1-.724.328,15.275,15.275,0,0,1-1.509.447.063.063,0,0,1-.078-.043A.069.069,0,0,1,70.662,26.239Z",transform:"translate(-8.864 -15.929)",fill:"#70a487"}),r.jsx("path",{id:"Path_896","data-name":"Path 896",d:"M72.955,21.678a1.327,1.327,0,0,1-.068,1.092,1.433,1.433,0,0,1-.993.754,1.536,1.536,0,0,1-1.173-.27,1.584,1.584,0,0,1-.6-.889,9.644,9.644,0,0,0,1.549-.008A3.35,3.35,0,0,0,72.955,21.678Z",transform:"translate(-9.176 -17.592)",fill:"#70a487"}),r.jsx("path",{id:"Path_897","data-name":"Path 897",d:"M81.24,26.792A13.745,13.745,0,0,0,78.51,22.63a7.648,7.648,0,0,0-4.118-2.34,7.9,7.9,0,0,0-4.6.687,10.032,10.032,0,0,0-3.757,2.717,8.985,8.985,0,0,0-1.479,8.549,7.885,7.885,0,0,0,6.184,5.476,1.318,1.318,0,0,1,1.084.982l.019.071a12.176,12.176,0,0,0,3.956,5.99,20.038,20.038,0,0,0,6.525,3.74c4.775,1.785,10.049,1.176,14.774-.8a23.673,23.673,0,0,0,6.414-4.113,20.209,20.209,0,0,0,2.585-2.78,14.245,14.245,0,0,0,1.89-3.166,5.645,5.645,0,0,0,.408-3.213,5.01,5.01,0,0,0-1.661-2.739,11.55,11.55,0,0,0-6.764-2.6l.168-.013a48.305,48.305,0,0,1-7.551.073c-1.242-.083-2.48-.187-3.713-.325l-1.845-.217a4.589,4.589,0,0,0-1.718-.027,15.026,15.026,0,0,0-6.3,3.351,11.97,11.97,0,0,0-2.417,2.707,4.6,4.6,0,0,0-.76,3.478,4.717,4.717,0,0,1,.557-3.594,12.335,12.335,0,0,1,2.306-2.937,15.473,15.473,0,0,1,6.452-3.811,6.707,6.707,0,0,1,1.956-.108l1.839.04c1.227.016,2.45,0,3.67-.036a53.618,53.618,0,0,0,7.2-.592.926.926,0,0,1,.148-.013h.021a13.292,13.292,0,0,1,8.353,2.751,7.582,7.582,0,0,1,2.658,4.022,8.228,8.228,0,0,1-.4,4.792c-2.329,5.611-7,9.549-12.25,11.917a25.592,25.592,0,0,1-8.4,2.122,20.71,20.71,0,0,1-8.649-1.25,21.868,21.868,0,0,1-7.488-4.446,14.962,14.962,0,0,1-4.646-7.6l1.1,1.054a9.839,9.839,0,0,1-5.093-2.648,10.939,10.939,0,0,1-2.842-4.857A10.542,10.542,0,0,1,69.3,19.7a9.073,9.073,0,0,1,5.3-.341,8.4,8.4,0,0,1,4.314,2.916A13.477,13.477,0,0,1,81.24,26.792Z",transform:"translate(-14.001 -19.103)",fill:"#70a487"})]})}):(0,r.jsxs)(r.Fragment,{children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"145.29",height:"78.354",viewBox:"0 0 145.29 78.354",className:(0,i.cn)("w-full h-auto","auto"===d?"dark:hidden":"light"!==d&&"hidden"),children:(0,r.jsxs)("g",{id:"Group_1377","data-name":"Group 1377",transform:"translate(0)",children:[r.jsx("path",{id:"Path_885","data-name":"Path 885",d:"M80.664,59.008a6.663,6.663,0,0,1-.159-1.541c-.006-.5.022-.993.056-1.487a20.31,20.31,0,0,1,2.705-8.488A13.118,13.118,0,0,1,87.514,43a7.745,7.745,0,0,1,6.009-1.066.191.191,0,0,1,0,.368l0,0A10.833,10.833,0,0,0,88.9,44.863a18.447,18.447,0,0,0-3.181,4.1A47.879,47.879,0,0,0,83.244,53.8c-.386.839-.754,1.695-1.125,2.559-.2.43-.363.868-.554,1.306l-.267.659c-.09.213-.178.459-.24.633l-.025.07a.193.193,0,0,1-.248.114A.2.2,0,0,1,80.664,59.008Z",transform:"translate(-3.081 -5.835)",fill:"#2b304a"}),r.jsx("path",{id:"Path_886","data-name":"Path 886",d:"M81.873,58.957c-.063-.175-.149-.42-.241-.633l-.267-.659c-.189-.438-.354-.876-.554-1.306-.37-.865-.739-1.72-1.123-2.559a48.218,48.218,0,0,0-2.477-4.838,18.487,18.487,0,0,0-3.18-4.1A10.833,10.833,0,0,0,69.409,42.3l0,0a.191.191,0,0,1-.13-.236.2.2,0,0,1,.135-.132A7.74,7.74,0,0,1,75.416,43a13.118,13.118,0,0,1,4.248,4.5,20.309,20.309,0,0,1,2.705,8.488c.033.493.063.989.056,1.487a6.664,6.664,0,0,1-.159,1.541.193.193,0,0,1-.368.019Z",transform:"translate(-9.675 -5.835)",fill:"#2b304a"}),(0,r.jsxs)("g",{id:"Group_1284","data-name":"Group 1284",transform:"translate(0 57.147)",children:[r.jsx("path",{id:"Path_887","data-name":"Path 887",d:"M48.5,63.117V74.659a1.605,1.605,0,1,1-3.208,0V63.491c0-3.291-2.042-5.416-5.041-5.416a5.163,5.163,0,0,0-5.333,5.416V74.659a1.605,1.605,0,1,1-3.208,0V56.784a1.61,1.61,0,0,1,1.625-1.666,1.629,1.629,0,0,1,1.584,1.666v.749a8.317,8.317,0,0,1,6.041-2.415C45.586,55.118,48.5,58.242,48.5,63.117Z",transform:"translate(-31.711 -55.118)",fill:"#2b304a"}),r.jsx("path",{id:"Path_888","data-name":"Path 888",d:"M65.279,64.493V64.7a1.772,1.772,0,0,1-1.958,2H48.988a7.165,7.165,0,0,0,7.458,6.668,8.063,8.063,0,0,0,5.292-1.958,1.666,1.666,0,0,1,1.084-.459,1.378,1.378,0,0,1,1.415,1.415,1.862,1.862,0,0,1-.792,1.46,10.79,10.79,0,0,1-7.04,2.5,10.605,10.605,0,0,1-.376-21.207A8.984,8.984,0,0,1,65.279,64.493Zm-16.166-.625H61.986a5.747,5.747,0,0,0-6.041-5.833A6.918,6.918,0,0,0,49.113,63.867Z",transform:"translate(-23.53 -55.118)",fill:"#2b304a"}),r.jsx("path",{id:"Path_889","data-name":"Path 889",d:"M81.9,65.7A10.625,10.625,0,1,1,71.273,55.118,10.563,10.563,0,0,1,81.9,65.7Zm-17.959.043a7.267,7.267,0,0,0,7.293,7.582,7.631,7.631,0,1,0-7.293-7.582Z",transform:"translate(-14.732 -55.118)",fill:"#2b304a"}),r.jsx("path",{id:"Path_890","data-name":"Path 890",d:"M82.669,55.407H87.71a1.437,1.437,0,1,1,0,2.874H82.669V69.364c0,2.667,1.376,3.875,4.292,3.875.708,0,1.208-.084,1.666-.084a1.291,1.291,0,0,1,1.458,1.25,1.431,1.431,0,0,1-1.166,1.458,8.954,8.954,0,0,1-2.624.292c-4.418,0-6.834-2.333-6.834-6.583V58.281H77.377a1.438,1.438,0,1,1,0-2.874h2.083",transform:"translate(-5.796 -54.948)",fill:"#2b304a"}),r.jsx("path",{id:"Path_891","data-name":"Path 891",d:"M98.757,56.909a1.5,1.5,0,0,1-1.625,1.5,5.984,5.984,0,0,0-6.334,6v10.25a1.605,1.605,0,1,1-3.208,0V56.784a1.611,1.611,0,0,1,1.626-1.666A1.627,1.627,0,0,1,90.8,56.784v1.5a8.145,8.145,0,0,1,6.334-2.875A1.526,1.526,0,0,1,98.757,56.909Z",transform:"translate(1.076 -55.118)",fill:"#2b304a"}),r.jsx("path",{id:"Path_892","data-name":"Path 892",d:"M115.537,64.493V64.7a1.772,1.772,0,0,1-1.958,2H99.246a7.166,7.166,0,0,0,7.459,6.668A8.059,8.059,0,0,0,112,71.409a1.673,1.673,0,0,1,1.084-.459,1.379,1.379,0,0,1,1.417,1.415,1.862,1.862,0,0,1-.792,1.46,10.791,10.791,0,0,1-7.042,2.5,10.605,10.605,0,0,1-.374-21.207A8.984,8.984,0,0,1,115.537,64.493Zm-16.166-.625h12.875a5.748,5.748,0,0,0-6.041-5.833A6.921,6.921,0,0,0,99.372,63.867Z",transform:"translate(5.961 -55.118)",fill:"#2b304a"}),r.jsx("path",{id:"Path_893","data-name":"Path 893",d:"M130.531,64.493V64.7a1.772,1.772,0,0,1-1.958,2H114.24a7.166,7.166,0,0,0,7.459,6.668,8.059,8.059,0,0,0,5.29-1.958,1.67,1.67,0,0,1,1.084-.459,1.379,1.379,0,0,1,1.417,1.415,1.862,1.862,0,0,1-.792,1.46,10.791,10.791,0,0,1-7.042,2.5,10.605,10.605,0,0,1-.374-21.207A8.984,8.984,0,0,1,130.531,64.493Zm-16.166-.625H127.24a5.749,5.749,0,0,0-6.041-5.833A6.919,6.919,0,0,0,114.366,63.867Z",transform:"translate(14.758 -55.118)",fill:"#2b304a"})]}),r.jsx("path",{id:"Path_894","data-name":"Path 894",d:"M69.853,22.729a1.984,1.984,0,0,1,.4,1.282,1.935,1.935,0,0,1-.611,1.365,1.81,1.81,0,0,1-1.452.438,2.047,2.047,0,0,1-1.206-.592l1.142-.335a1.771,1.771,0,0,0,.719-.4A5.347,5.347,0,0,0,69.853,22.729Z",transform:"translate(-11.015 -16.976)",fill:"#70a487"}),r.jsx("path",{id:"Path_895","data-name":"Path 895",d:"M70.662,26.239a11.037,11.037,0,0,1,1.073-1.157c.178-.186.308-.428.551-.5a1.653,1.653,0,0,1,.911-.008.1.1,0,0,1,.075.092,1.338,1.338,0,0,1-.309.9,1.393,1.393,0,0,1-.724.328,15.275,15.275,0,0,1-1.509.447.063.063,0,0,1-.078-.043A.069.069,0,0,1,70.662,26.239Z",transform:"translate(-8.864 -15.929)",fill:"#70a487"}),r.jsx("path",{id:"Path_896","data-name":"Path 896",d:"M72.955,21.678a1.327,1.327,0,0,1-.068,1.092,1.433,1.433,0,0,1-.993.754,1.536,1.536,0,0,1-1.173-.27,1.584,1.584,0,0,1-.6-.889,9.644,9.644,0,0,0,1.549-.008A3.35,3.35,0,0,0,72.955,21.678Z",transform:"translate(-9.176 -17.592)",fill:"#70a487"}),r.jsx("path",{id:"Path_897","data-name":"Path 897",d:"M81.24,26.792A13.745,13.745,0,0,0,78.51,22.63a7.648,7.648,0,0,0-4.118-2.34,7.9,7.9,0,0,0-4.6.687,10.032,10.032,0,0,0-3.757,2.717,8.985,8.985,0,0,0-1.479,8.549,7.885,7.885,0,0,0,6.184,5.476,1.318,1.318,0,0,1,1.084.982l.019.071a12.176,12.176,0,0,0,3.956,5.99,20.038,20.038,0,0,0,6.525,3.74c4.775,1.785,10.049,1.176,14.774-.8a23.673,23.673,0,0,0,6.414-4.113,20.209,20.209,0,0,0,2.585-2.78,14.245,14.245,0,0,0,1.89-3.166,5.645,5.645,0,0,0,.408-3.213,5.01,5.01,0,0,0-1.661-2.739,11.55,11.55,0,0,0-6.764-2.6l.168-.013a48.305,48.305,0,0,1-7.551.073c-1.242-.083-2.48-.187-3.713-.325l-1.845-.217a4.589,4.589,0,0,0-1.718-.027,15.026,15.026,0,0,0-6.3,3.351,11.97,11.97,0,0,0-2.417,2.707,4.6,4.6,0,0,0-.76,3.478,4.717,4.717,0,0,1,.557-3.594,12.335,12.335,0,0,1,2.306-2.937,15.473,15.473,0,0,1,6.452-3.811,6.707,6.707,0,0,1,1.956-.108l1.839.04c1.227.016,2.45,0,3.67-.036a53.618,53.618,0,0,0,7.2-.592.926.926,0,0,1,.148-.013h.021a13.292,13.292,0,0,1,8.353,2.751,7.582,7.582,0,0,1,2.658,4.022,8.228,8.228,0,0,1-.4,4.792c-2.329,5.611-7,9.549-12.25,11.917a25.592,25.592,0,0,1-8.4,2.122,20.71,20.71,0,0,1-8.649-1.25,21.868,21.868,0,0,1-7.488-4.446,14.962,14.962,0,0,1-4.646-7.6l1.1,1.054a9.839,9.839,0,0,1-5.093-2.648,10.939,10.939,0,0,1-2.842-4.857A10.542,10.542,0,0,1,69.3,19.7a9.073,9.073,0,0,1,5.3-.341,8.4,8.4,0,0,1,4.314,2.916A13.477,13.477,0,0,1,81.24,26.792Z",transform:"translate(-14.001 -19.103)",fill:"#70a487"})]})}),r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"145.29",height:"78.354",viewBox:"0 0 145.29 78.354",className:(0,i.cn)("w-full h-auto","auto"===d?"hidden dark:hidden":"dark"!==d&&"hidden"),children:(0,r.jsxs)("g",{id:"Group_1378","data-name":"Group 1378",transform:"translate(0)",children:[r.jsx("path",{id:"Path_885","data-name":"Path 885",d:"M80.664,59.008a6.663,6.663,0,0,1-.159-1.541c-.006-.5.022-.993.056-1.487a20.31,20.31,0,0,1,2.705-8.488A13.118,13.118,0,0,1,87.514,43a7.745,7.745,0,0,1,6.009-1.066.191.191,0,0,1,0,.368l0,0A10.833,10.833,0,0,0,88.9,44.863a18.447,18.447,0,0,0-3.181,4.1A47.879,47.879,0,0,0,83.244,53.8c-.386.839-.754,1.695-1.125,2.559-.2.43-.363.868-.554,1.306l-.267.659c-.09.213-.178.459-.24.633l-.025.07a.193.193,0,0,1-.248.114A.2.2,0,0,1,80.664,59.008Z",transform:"translate(-3.081 -5.835)",fill:"#ffffff"}),r.jsx("path",{id:"Path_886","data-name":"Path 886",d:"M81.873,58.957c-.063-.175-.149-.42-.241-.633l-.267-.659c-.189-.438-.354-.876-.554-1.306-.37-.865-.739-1.72-1.123-2.559a48.218,48.218,0,0,0-2.477-4.838,18.487,18.487,0,0,0-3.18-4.1A10.833,10.833,0,0,0,69.409,42.3l0,0a.191.191,0,0,1-.13-.236.2.2,0,0,1,.135-.132A7.74,7.74,0,0,1,75.416,43a13.118,13.118,0,0,1,4.248,4.5,20.309,20.309,0,0,1,2.705,8.488c.033.493.063.989.056,1.487a6.664,6.664,0,0,1-.159,1.541.193.193,0,0,1-.368.019Z",transform:"translate(-9.675 -5.835)",fill:"#ffffff"}),(0,r.jsxs)("g",{id:"Group_1284","data-name":"Group 1284",transform:"translate(0 57.147)",children:[r.jsx("path",{id:"Path_887","data-name":"Path 887",d:"M48.5,63.117V74.659a1.605,1.605,0,1,1-3.208,0V63.491c0-3.291-2.042-5.416-5.041-5.416a5.163,5.163,0,0,0-5.333,5.416V74.659a1.605,1.605,0,1,1-3.208,0V56.784a1.61,1.61,0,0,1,1.625-1.666,1.629,1.629,0,0,1,1.584,1.666v.749a8.317,8.317,0,0,1,6.041-2.415C45.586,55.118,48.5,58.242,48.5,63.117Z",transform:"translate(-31.711 -55.118)",fill:"#ffffff"}),r.jsx("path",{id:"Path_888","data-name":"Path 888",d:"M65.279,64.493V64.7a1.772,1.772,0,0,1-1.958,2H48.988a7.165,7.165,0,0,0,7.458,6.668,8.063,8.063,0,0,0,5.292-1.958,1.666,1.666,0,0,1,1.084-.459,1.378,1.378,0,0,1,1.415,1.415,1.862,1.862,0,0,1-.792,1.46,10.79,10.79,0,0,1-7.04,2.5,10.605,10.605,0,0,1-.376-21.207A8.984,8.984,0,0,1,65.279,64.493Zm-16.166-.625H61.986a5.747,5.747,0,0,0-6.041-5.833A6.918,6.918,0,0,0,49.113,63.867Z",transform:"translate(-23.53 -55.118)",fill:"#ffffff"}),r.jsx("path",{id:"Path_889","data-name":"Path 889",d:"M81.9,65.7A10.625,10.625,0,1,1,71.273,55.118,10.563,10.563,0,0,1,81.9,65.7Zm-17.959.043a7.267,7.267,0,0,0,7.293,7.582,7.631,7.631,0,1,0-7.293-7.582Z",transform:"translate(-14.732 -55.118)",fill:"#ffffff"}),r.jsx("path",{id:"Path_890","data-name":"Path 890",d:"M82.669,55.407H87.71a1.437,1.437,0,1,1,0,2.874H82.669V69.364c0,2.667,1.376,3.875,4.292,3.875.708,0,1.208-.084,1.666-.084a1.291,1.291,0,0,1,1.458,1.25,1.431,1.431,0,0,1-1.166,1.458,8.954,8.954,0,0,1-2.624.292c-4.418,0-6.834-2.333-6.834-6.583V58.281H77.377a1.438,1.438,0,1,1,0-2.874h2.083",transform:"translate(-5.796 -54.948)",fill:"#ffffff"}),r.jsx("path",{id:"Path_891","data-name":"Path 891",d:"M98.757,56.909a1.5,1.5,0,0,1-1.625,1.5,5.984,5.984,0,0,0-6.334,6v10.25a1.605,1.605,0,1,1-3.208,0V56.784a1.611,1.611,0,0,1,1.626-1.666A1.627,1.627,0,0,1,90.8,56.784v1.5a8.145,8.145,0,0,1,6.334-2.875A1.526,1.526,0,0,1,98.757,56.909Z",transform:"translate(1.076 -55.118)",fill:"#ffffff"}),r.jsx("path",{id:"Path_892","data-name":"Path 892",d:"M115.537,64.493V64.7a1.772,1.772,0,0,1-1.958,2H99.246a7.166,7.166,0,0,0,7.459,6.668A8.059,8.059,0,0,0,112,71.409a1.673,1.673,0,0,1,1.084-.459,1.379,1.379,0,0,1,1.417,1.415,1.862,1.862,0,0,1-.792,1.46,10.791,10.791,0,0,1-7.042,2.5,10.605,10.605,0,0,1-.374-21.207A8.984,8.984,0,0,1,115.537,64.493Zm-16.166-.625h12.875a5.748,5.748,0,0,0-6.041-5.833A6.921,6.921,0,0,0,99.372,63.867Z",transform:"translate(5.961 -55.118)",fill:"#ffffff"}),r.jsx("path",{id:"Path_893","data-name":"Path 893",d:"M130.531,64.493V64.7a1.772,1.772,0,0,1-1.958,2H114.24a7.166,7.166,0,0,0,7.459,6.668,8.059,8.059,0,0,0,5.29-1.958,1.67,1.67,0,0,1,1.084-.459,1.379,1.379,0,0,1,1.417,1.415,1.862,1.862,0,0,1-.792,1.46,10.791,10.791,0,0,1-7.042,2.5,10.605,10.605,0,0,1-.374-21.207A8.984,8.984,0,0,1,130.531,64.493Zm-16.166-.625H127.24a5.749,5.749,0,0,0-6.041-5.833A6.919,6.919,0,0,0,114.366,63.867Z",transform:"translate(14.758 -55.118)",fill:"#ffffff"})]}),r.jsx("path",{id:"Path_894","data-name":"Path 894",d:"M69.853,22.729a1.984,1.984,0,0,1,.4,1.282,1.935,1.935,0,0,1-.611,1.365,1.81,1.81,0,0,1-1.452.438,2.047,2.047,0,0,1-1.206-.592l1.142-.335a1.771,1.771,0,0,0,.719-.4A5.347,5.347,0,0,0,69.853,22.729Z",transform:"translate(-11.015 -16.976)",fill:"#ffffff"}),r.jsx("path",{id:"Path_895","data-name":"Path 895",d:"M70.662,26.239a11.037,11.037,0,0,1,1.073-1.157c.178-.186.308-.428.551-.5a1.653,1.653,0,0,1,.911-.008.1.1,0,0,1,.075.092,1.338,1.338,0,0,1-.309.9,1.393,1.393,0,0,1-.724.328,15.275,15.275,0,0,1-1.509.447.063.063,0,0,1-.078-.043A.069.069,0,0,1,70.662,26.239Z",transform:"translate(-8.864 -15.929)",fill:"#ffffff"}),r.jsx("path",{id:"Path_896","data-name":"Path 896",d:"M72.955,21.678a1.327,1.327,0,0,1-.068,1.092,1.433,1.433,0,0,1-.993.754,1.536,1.536,0,0,1-1.173-.27,1.584,1.584,0,0,1-.6-.889,9.644,9.644,0,0,0,1.549-.008A3.35,3.35,0,0,0,72.955,21.678Z",transform:"translate(-9.176 -17.592)",fill:"#ffffff"}),r.jsx("path",{id:"Path_897","data-name":"Path 897",d:"M81.24,26.792A13.745,13.745,0,0,0,78.51,22.63a7.648,7.648,0,0,0-4.118-2.34,7.9,7.9,0,0,0-4.6.687,10.032,10.032,0,0,0-3.757,2.717,8.985,8.985,0,0,0-1.479,8.549,7.885,7.885,0,0,0,6.184,5.476,1.318,1.318,0,0,1,1.084.982l.019.071a12.176,12.176,0,0,0,3.956,5.99,20.038,20.038,0,0,0,6.525,3.74c4.775,1.785,10.049,1.176,14.774-.8a23.673,23.673,0,0,0,6.414-4.113,20.209,20.209,0,0,0,2.585-2.78,14.245,14.245,0,0,0,1.89-3.166,5.645,5.645,0,0,0,.408-3.213,5.01,5.01,0,0,0-1.661-2.739,11.55,11.55,0,0,0-6.764-2.6l.168-.013a48.305,48.305,0,0,1-7.551.073c-1.242-.083-2.48-.187-3.713-.325l-1.845-.217a4.589,4.589,0,0,0-1.718-.027,15.026,15.026,0,0,0-6.3,3.351,11.97,11.97,0,0,0-2.417,2.707,4.6,4.6,0,0,0-.76,3.478,4.717,4.717,0,0,1,.557-3.594,12.335,12.335,0,0,1,2.306-2.937,15.473,15.473,0,0,1,6.452-3.811,6.707,6.707,0,0,1,1.956-.108l1.839.04c1.227.016,2.45,0,3.67-.036a53.618,53.618,0,0,0,7.2-.592.926.926,0,0,1,.148-.013h.021a13.292,13.292,0,0,1,8.353,2.751,7.582,7.582,0,0,1,2.658,4.022,8.228,8.228,0,0,1-.4,4.792c-2.329,5.611-7,9.549-12.25,11.917a25.592,25.592,0,0,1-8.4,2.122,20.71,20.71,0,0,1-8.649-1.25,21.868,21.868,0,0,1-7.488-4.446,14.962,14.962,0,0,1-4.646-7.6l1.1,1.054a9.839,9.839,0,0,1-5.093-2.648,10.939,10.939,0,0,1-2.842-4.857A10.542,10.542,0,0,1,69.3,19.7a9.073,9.073,0,0,1,5.3-.341,8.4,8.4,0,0,1,4.314,2.916A13.477,13.477,0,0,1,81.24,26.792Z",transform:"translate(-14.001 -19.103)",fill:"#ffffff"})]})})]})});return t?r.jsx(a.default,{href:t,children:o}):o}},2946:(e,t,s)=>{"use strict";s.d(t,{z:()=>c});var r=s(19510),a=s(71159),i=s(43025),n=s(60791),d=s(50650);let o=(0,n.j)(`
    inline-flex
    items-center
    justify-center
    whitespace-nowrap
    rounded-md
    text-sm
    font-medium
    transition-colors
    focus-visible:outline-none
    disabled:pointer-events-none
    disabled:opacity-50
  `,{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"border border-input bg-background hover:bg-primary/20","primary-outline":"border border-primary text-primary bg-transparent hover:bg-primary/20",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/90",ghost:"hover:bg-primary/20 hover:text-primary",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=a.forwardRef(({className:e,variant:t,size:s,asChild:a=!1,...n},c)=>{let l=a?i.g7:"button";return r.jsx(l,{className:(0,d.cn)(o({variant:t,size:s,className:e})),ref:c,...n})});c.displayName="Button"},18100:(e,t,s)=>{"use strict";s.d(t,{j:()=>o});var r=s(57745),a=s(88317),i=s(10413),n=s(57435),d=s(57418);async function o({restoreKeys:e},t){let s={success:!1};try{let n=e.length?await i.Z.query.screensHistory.findMany({where:(0,r.d3)(d.screensHistory.restoreKey,e),columns:{id:!0,screenId:!0}}):[],o=n.map(e=>e.screenId);o.length&&(await i.Z.update(d.screens).set({deletedAt:null}).where((0,r.d3)(d.screens.screenId,o)),await i.Z.delete(d.screensHistory).where((0,r.d3)(d.screensHistory.id,n.map(e=>e.id)))),!s.errors?.length&&(s.success=!0,o.length&&t?.broadcastAction&&t?.broadcastAction&&a.Z.emit("data_changed","update_screens"))}catch(e){s.success=!1,s.errors=[e.message],n.Z.error("_restoreScreens ERROR",e.message)}finally{return s}}},20706:(e,t,s)=>{"use strict";s.d(t,{gX:()=>h,Ls:()=>m});var r=s(57745),a=s(9576),i=s(88317),n=s(57435),d=s(10413),o=s(57418),c=s(57040),l=s(28422),f=s(18100),p=s(28585);async function u(e,t){let s={success:!1};try{let{diagnosisIds:a,scriptsIds:n,restoreKey:c,force:l}={...e},f=[...a||n?[(0,r.or)(a?.filter(e=>e)?.length?(0,r.d3)(o.diagnoses.diagnosisId,a):void 0,n?.filter(e=>e)?.length?(0,r.d3)(o.diagnoses.scriptId,n):void 0)]:[]];if(!f.length&&!l)throw Error("You&apos;re trying to delete all the diagnoses, please provide a force parameter.");let p=await d.Z.query.diagnoses.findMany({where:(0,r.xD)(...f)}),u=new Date;await d.Z.update(o.diagnoses).set({deletedAt:u}).where((0,r.xD)(...f)),p.length&&await d.Z.delete(o.diagnosesDrafts).where((0,r.xD)((0,r.K0)(o.diagnosesDrafts.diagnosisId),(0,r.d3)(o.diagnosesDrafts.diagnosisId,p.map(e=>e.diagnosisId)))),await d.Z.insert(o.diagnosesHistory).values(p.map(e=>({version:e.version,diagnosisId:e.diagnosisId,scriptId:e.scriptId,restoreKey:c,changes:{action:"delete_diagnosis",dediagnosision:"Delete diagnosis",oldValues:[{deletedAt:null}],newValues:[{deletedAt:u}]}}))),!s.errors?.length&&(s.success=!0,t?.broadcastAction&&i.Z.emit("data_changed","delete_diagnoses"))}catch(e){n.Z.error("_deleteDiagnoses ERROR",e.message),s.success=!1,s.errors=[e.message]}finally{return s}}async function g(e,t){let s={success:!1};try{let{screenIds:a,scriptsIds:n,restoreKey:c,force:l}={...e},f=[...a||n?[(0,r.or)(a?.filter(e=>e)?.length?(0,r.d3)(o.screens.screenId,a):void 0,n?.filter(e=>e)?.length?(0,r.d3)(o.screens.scriptId,n):void 0)]:[]];if(!f.length&&!l)throw Error("You&apos;re trying to delete all the screens, please provide a force parameter.");let p=await d.Z.query.screens.findMany({where:(0,r.xD)(...f)}),u=new Date;await d.Z.update(o.screens).set({deletedAt:u}).where((0,r.xD)(...f)),p.length&&await d.Z.delete(o.screensDrafts).where((0,r.xD)((0,r.K0)(o.screensDrafts.screenId),(0,r.d3)(o.screensDrafts.screenId,p.map(e=>e.screenId)))),await d.Z.insert(o.screensHistory).values(p.map(e=>({version:e.version,screenId:e.screenId,scriptId:e.scriptId,restoreKey:c,changes:{action:"delete_screen",descreenion:"Delete screen",oldValues:[{deletedAt:null}],newValues:[{deletedAt:u}]}}))),!s.errors?.length&&(s.success=!0,t?.broadcastAction&&i.Z.emit("data_changed","delete_screens"))}catch(e){n.Z.error("_deleteScreens ERROR",e.message),s.success=!1,s.errors=[e.message]}finally{return s}}async function h(e,t){let s={success:!1};try{let n=t?.overWriteScriptId===void 0||t.overWriteScriptId,l=await (0,c.Tx)(),f=(l.data.length?Math.max(...l.data.map(e=>e.position)):0)+1;for(let{screens:t=[],diagnoses:i=[],...c}of e)try{let e=await (n?null:d.Z.query.scripts.findFirst({where:(0,r.eq)(o.scripts.scriptId,c.scriptId),with:{draft:!0}})),l=await (n?null:e?.draft||d.Z.query.scriptsDrafts.findFirst({where:(0,r.eq)(o.scriptsDrafts.scriptDraftId,c.scriptId)})),p={...function(e){let t=(0,a.Z)(),s={...e,scriptId:t,version:1,oldScriptId:void 0,publishDate:void 0,createdAt:void 0,deletedAt:void 0,updatedAt:void 0,isDraft:void 0,publishedVersion:void 0};return["id","oldScriptId","publishDate","createdAt","deletedAt","updatedAt","isDraft","publishedVersion","draft"].forEach(e=>{delete s[e]}),s}(c),position:f};for(let i of(f++,p.scriptId=l?.scriptDraftId||e?.scriptId||p.scriptId,p.position=l?.data?.position||e?.position||f,p.version=l?.data?.version||(e?.version?e.version+1:p.version),l?await d.Z.update(o.scriptsDrafts).set({data:p}).where((0,r.eq)(o.scriptsDrafts.scriptDraftId,l.scriptDraftId)):await d.Z.insert(o.scriptsDrafts).values([{data:p,scriptDraftId:p.scriptId,scriptId:e?.scriptId,position:p.position}]),(l||e)&&(await g({scriptsIds:[p.scriptId],restoreKey:`script_draft_${p.scriptId}`}),await d.Z.delete(o.screensDrafts).where((0,r.eq)(o.screensDrafts.scriptDraftId,p.scriptId))),t)){let e=function(e){let t=(0,a.Z)(),s={...e,screenId:t,version:1};return["id","scriptId","oldScreenId","oldScriptId","publishDate","createdAt","deletedAt","updatedAt","isDraft","publishedVersion","draft"].forEach(e=>{delete s[e]}),s}(i);try{await d.Z.insert(o.screensDrafts).values([{data:e,position:e.position,screenDraftId:e.screenId,scriptDraftId:p.scriptId,type:e.type}])}catch(e){s.success=!1,s.errors=s.errors||[],s.errors.push(`Failed to save script: ${c.title} (${e.message})`)}}for(let t of((l||e)&&(await u({scriptsIds:[p.scriptId],restoreKey:`script_draft_${p.scriptId}`}),await d.Z.delete(o.diagnosesDrafts).where((0,r.eq)(o.diagnosesDrafts.scriptDraftId,p.scriptId))),i)){let e=function(e){let t=(0,a.Z)(),s={...e,diagnosisId:t,version:1};return["id","scriptId","oldDiagnosisId","oldScriptId","publishDate","createdAt","deletedAt","updatedAt","isDraft","publishedVersion","draft"].forEach(e=>{delete s[e]}),s}(t);try{await d.Z.insert(o.diagnosesDrafts).values([{data:e,position:e.position,diagnosisDraftId:e.diagnosisId,scriptDraftId:p.scriptId}])}catch(e){s.success=!1,s.errors=s.errors||[],s.errors.push(`Failed to save script: ${c.title} (${e.message})`)}}}catch(e){s.success=!1,s.errors=s.errors||[],s.errors.push(`Failed to save script: ${c.title} (${e.message})`)}!s.errors?.length&&(s.success=!0,t?.broadcastAction&&i.Z.emit("data_changed","create_scripts_drafts"))}catch(t){let e=t.response?.data?.message||t.response?.data||t.message;s.success=!1,s.errors=[e],n.Z.error("importScripts ERROR",e)}finally{return s}}async function m(){let e={success:!0};try{let t=await d.Z.query.scriptsDrafts.findMany({columns:{scriptDraftId:!0,scriptId:!0}}),s=t.filter(e=>!e.scriptId).map(e=>({scriptDraftId:e.scriptDraftId})),r=t.filter(e=>e.scriptId).map(e=>({scriptId:e.scriptId})),a=[];if(r.length){let e=await I(r);e.data.forEach(e=>e.errors?.forEach(e=>a.push(e))),e.errors?.forEach(e=>a.push(e))}if(s.length){let e=await y(s);e.errors?.forEach(e=>a.push(e))}a.length&&(e.success=!1,e.errors=a)}catch(t){e.success=!1,e.errors=[t.message],n.Z.error("_publishScripts ERROR",t.message)}finally{return e}}async function y(e,t){let s={inserted:[],success:!1};try{let n=[],u=e.length?await d.Z.query.scriptsDrafts.findMany({where:(0,r.d3)(o.scriptsDrafts.scriptDraftId,e.map(e=>e.scriptDraftId))}):[],g=[];for(let{id:e,data:t}of(u.filter(e=>e.scriptId).length&&(g=await d.Z.query.scripts.findMany({where:(0,r.d3)(o.scripts.scriptId,u.filter(e=>e.scriptId).map(e=>e.scriptId))})),u)){let s=t.scriptId||(0,a.Z)();n.push({...t,scriptId:s}),u=u.map(t=>(t.id===e&&(t.data.scriptId=s),t))}await d.Z.insert(o.scripts).values(n);let h=await (0,c.Tw)({scriptIds:n.map(e=>e.scriptId)});for(let{scriptId:e}of h.data){let t=u.filter(t=>t.data.scriptId===e)[0];await d.Z.update(o.screensDrafts).set({scriptId:e}).where((0,r.eq)(o.screensDrafts.scriptDraftId,t.scriptDraftId)),await d.Z.update(o.diagnosesDrafts).set({scriptId:e}).where((0,r.eq)(o.diagnosesDrafts.scriptDraftId,t.scriptDraftId))}let m=await (0,l.Ry)({scriptsReferences:e.map(e=>e.scriptDraftId)});m.errors&&(s.errors=[...s.errors||[],...m.errors]);let y=await (0,p.gv)({scriptsReferences:e.map(e=>e.scriptDraftId)});y.errors&&(s.errors=[...s.errors||[],...y.errors]),s.inserted=t?.returnInserted?h.data:[],s.success=!0,await w({drafts:u,previous:g}),u.length&&(await d.Z.delete(o.scriptsDrafts).where((0,r.d3)(o.scriptsDrafts.id,u.map(e=>e.id))),u.length&&(await (0,f.j)({restoreKeys:u.map(e=>`script_draft_${e.scriptDraftId}`)}),await d.Z.update(o.screensHistory).set({restoreKey:null}).where((0,r.d3)(o.screensHistory.restoreKey,u.map(e=>`script_draft_${e.scriptDraftId}`))))),t?.broadcastAction&&i.Z.emit("data_changed","create_scripts")}catch(e){s.errors=[e.message],n.Z.error("_createScripts ERROR",e.message)}finally{return s}}async function I(e,t){let s={data:[]};try{let a=e.length?await d.Z.query.scriptsDrafts.findMany({where:(0,r.d3)(o.scriptsDrafts.scriptId,e.map(e=>e.scriptId))}):[],p=[];for(let{scriptId:e,data:i}of(a.filter(e=>e.scriptId).length&&(p=await d.Z.query.scripts.findMany({where:(0,r.d3)(o.scripts.scriptId,a.filter(e=>e.scriptId).map(e=>e.scriptId))})),a)){let l=e,{scriptId:f,id:p,oldScriptId:u,createdAt:g,updatedAt:h,deletedAt:m,...y}=i;try{let e={...y,publishDate:new Date};await d.Z.update(o.scripts).set(e).where((0,r.eq)(o.scripts.scriptId,l));let a=t?.returnUpdated?await (0,c.bK)(l):void 0;s.data.push({scriptId:l,script:a})}catch(e){n.Z.error(`_updateScripts scriptId=${l}`,e.message),s.data.push({scriptId:l,errors:[e.message]}),a=a.filter(e=>e.data.scriptId!==l)}}await w({drafts:a,previous:p});let u=await (0,l.Ry)({scriptsReferences:e.map(e=>e.scriptId)});u.errors&&(s.errors=[...s.errors||[],...u.errors]),a.length&&(await d.Z.delete(o.scriptsDrafts).where((0,r.d3)(o.scriptsDrafts.id,a.map(e=>e.id))),a.length&&(await (0,f.j)({restoreKeys:a.map(e=>`script_draft_${e.scriptDraftId}`)}),await d.Z.update(o.screensHistory).set({restoreKey:null}).where((0,r.d3)(o.screensHistory.restoreKey,a.map(e=>`script_draft_${e.scriptDraftId}`))))),t?.broadcastAction&&i.Z.emit("data_changed","update_scripts")}catch(e){n.Z.error("_updateScripts ERROR",e),s.errors=[e.message,...s.errors||[]]}finally{return s}}async function w({previous:e,drafts:t}){try{let s=[];for(let r of t){let t={version:r?.data?.version||1,scriptId:r?.data?.scriptId,changes:{}};if(r?.data?.version===1)t.changes={action:"create_script",description:"Create script",oldValues:[],newValues:[]};else{let s=e.filter(e=>e.scriptId===r?.data?.scriptId)[0],a=[],i=[];Object.keys({...r?.data}).filter(e=>!["version","draft"].includes(e)).forEach(e=>{let t=r.data[e],n={...s}[e];JSON.stringify(t)!==JSON.stringify(n)&&(a.push({[e]:n}),i.push({[e]:t}))}),t.changes={action:"update_script",description:"Update script",oldValues:a,newValues:i}}s.push(t)}await d.Z.insert(o.scriptsHistory).values(s)}catch(e){n.Z.error(e.message)}}},28585:(e,t,s)=>{"use strict";s.d(t,{gv:()=>l});var r=s(57745),a=s(9576),i=s(57435),n=s(88317),d=s(10413),o=s(57418),c=s(85336);async function l(e){let{scriptsReferences:t,diagnosesReferences:s}={...e},a={success:!0},n=[];try{let e=[],c=[];if(t?.length||s?.length){let a=await d.Z.query.diagnosesDrafts.findMany({where:(0,r.or)(t?.length?(0,r.d3)(o.diagnosesDrafts.scriptId,t):void 0,t?.length?(0,r.d3)(o.diagnosesDrafts.scriptDraftId,t):void 0,s?.length?(0,r.d3)(o.diagnosesDrafts.diagnosisId,s):void 0,s?.length?(0,r.d3)(o.diagnosesDrafts.diagnosisDraftId,s):void 0),columns:{diagnosisId:!0,diagnosisDraftId:!0}});e=a.filter(e=>e.diagnosisId).map(e=>({diagnosisId:e.diagnosisId})),c=a.filter(e=>!e.diagnosisId).map(e=>({diagnosisDraftId:e.diagnosisDraftId}))}else{let t=await d.Z.query.diagnosesDrafts.findMany({where:(0,r.K0)(o.diagnosesDrafts.scriptId),columns:{diagnosisId:!0,diagnosisDraftId:!0}});e=t.filter(e=>e.diagnosisId).map(e=>({diagnosisId:e.diagnosisId})),c=t.filter(e=>!e.diagnosisId).map(e=>({diagnosisDraftId:e.diagnosisDraftId}))}if(e.length&&(await p(e)).forEach(e=>e.error&&n.push(e.error)),c.length){let e=await f(c);e.errors?.forEach(e=>n.push(e))}n.length&&(a.success=!1,a.errors=n,i.Z.error("_publishDiagnoses ERRORS",n))}catch(e){a.success=!1,a.errors=[e.message],i.Z.error("_publishDiagnoses ERROR",e)}finally{return a}}async function f(e,t){let s={inserted:[],success:!1};try{let i=[],l=e.length?await d.Z.query.diagnosesDrafts.findMany({where:(0,r.d3)(o.diagnosesDrafts.diagnosisDraftId,e.map(e=>e.diagnosisDraftId))}):[],f=[];for(let{id:e,scriptId:t,data:n}of(l.filter(e=>e.diagnosisId).length&&(f=await d.Z.query.diagnoses.findMany({where:(0,r.d3)(o.diagnoses.diagnosisId,l.filter(e=>e.diagnosisId).map(e=>e.diagnosisId))})),l)){let r=n.diagnosisId||(0,a.Z)(),c=n.scriptId||t,f={...n,diagnosisId:r,scriptId:c};i.push(f),l=l.map(t=>(t.id===e&&(t.data.diagnosisId=r),t));try{await d.Z.insert(o.diagnoses).values(f)}catch(e){s.errors=[...s.errors||[],`Error inserting ${n.name} - ${e.message}`]}}let p=await (0,c.XA)({diagnosisIds:i.map(e=>e.diagnosisId)});s.inserted=t?.returnInserted?p.data:[],s.success=!0,await u({drafts:l,previous:f}),l.length&&await d.Z.delete(o.diagnosesDrafts).where((0,r.d3)(o.diagnosesDrafts.id,l.map(e=>e.id))),t?.broadcastAction&&n.Z.emit("data_changed","create_diagnoses")}catch(e){s.errors=[e.message],i.Z.error("_createDiagnoses ERROR",e.message)}finally{return s}}async function p(e,t){let s=[],a=e.length?await d.Z.query.diagnosesDrafts.findMany({where:(0,r.d3)(o.diagnosesDrafts.diagnosisId,e.map(e=>e.diagnosisId))}):[],l=[];for(let{diagnosisId:e,data:n}of(a.filter(e=>e.diagnosisId).length&&(l=await d.Z.query.diagnoses.findMany({where:(0,r.d3)(o.diagnoses.diagnosisId,a.filter(e=>e.diagnosisId).map(e=>e.diagnosisId))})),a)){let l=e,{diagnosisId:f,id:p,oldDiagnosisId:u,createdAt:g,updatedAt:h,deletedAt:m,...y}=n;try{let e={...y,publishDate:new Date};await d.Z.update(o.diagnoses).set(e).where((0,r.eq)(o.diagnoses.diagnosisId,l));let a=t?.returnUpdated?await (0,c.Ew)(l):void 0;s.push({diagnosisId:l,diagnosis:a})}catch(e){i.Z.error(`_updateDiagnoses diagnosisId=${l}`,e.message),s.push({diagnosisId:l,error:e.message}),a=a.filter(e=>e.data.diagnosisId!==l)}}return await u({drafts:a,previous:l}),a.length&&await d.Z.delete(o.diagnosesDrafts).where((0,r.d3)(o.diagnosesDrafts.id,a.map(e=>e.id))),t?.broadcastAction&&n.Z.emit("data_changed","create_diagnoses"),s}async function u({previous:e,drafts:t}){try{let s=[];for(let r of t){let t={version:r?.data?.version||1,diagnosisId:r?.data?.diagnosisId,scriptId:r?.data?.scriptId,changes:{}};if(r?.data?.version===1)t.changes={action:"create_diagnosis",dediagnosision:"Create diagnosis",oldValues:[],newValues:[]};else{let s=e.filter(e=>e.diagnosisId===r?.data?.diagnosisId)[0],a=[],i=[];Object.keys({...r?.data}).filter(e=>!["version","draft"].includes(e)).forEach(e=>{let t=r.data[e],n={...s}[e];JSON.stringify(t)!==JSON.stringify(n)&&(a.push({[e]:n}),i.push({[e]:t}))}),t.changes={action:"update_diagnosis",dediagnosision:"Update diagnosis",oldValues:a,newValues:i}}s.push(t)}await d.Z.insert(o.diagnosesHistory).values(s)}catch(e){i.Z.error(e.message)}}s(57040)},28422:(e,t,s)=>{"use strict";s.d(t,{Ry:()=>l});var r=s(57745),a=s(9576),i=s(57435),n=s(88317),d=s(10413),o=s(57418),c=s(27457);async function l(e){let{scriptsReferences:t,screensReferences:s}={...e},a={success:!0},n=[];try{let e=[],c=[];if(t?.length||s?.length){let a=await d.Z.query.screensDrafts.findMany({where:(0,r.or)(t?.length?(0,r.d3)(o.screensDrafts.scriptId,t):void 0,t?.length?(0,r.d3)(o.screensDrafts.scriptDraftId,t):void 0,s?.length?(0,r.d3)(o.screensDrafts.screenId,s):void 0,s?.length?(0,r.d3)(o.screensDrafts.screenDraftId,s):void 0),columns:{screenId:!0,screenDraftId:!0}});e=a.filter(e=>e.screenId).map(e=>({screenId:e.screenId})),c=a.filter(e=>!e.screenId).map(e=>({screenDraftId:e.screenDraftId}))}else{let t=await d.Z.query.screensDrafts.findMany({where:(0,r.K0)(o.screensDrafts.scriptId),columns:{screenId:!0,screenDraftId:!0}});e=t.filter(e=>e.screenId).map(e=>({screenId:e.screenId})),c=t.filter(e=>!e.screenId).map(e=>({screenDraftId:e.screenDraftId}))}if(e.length&&(await p(e)).forEach(e=>e.error&&n.push(e.error)),c.length){let e=await f(c);e.errors?.forEach(e=>n.push(e))}n.length&&(a.success=!1,a.errors=n,i.Z.error("_publishScreens ERRORS",n))}catch(e){a.success=!1,a.errors=[e.message],i.Z.error("_publishScreens ERROR",e)}finally{return a}}async function f(e,t){let s={inserted:[],success:!1};try{let i=[],l=e.length?await d.Z.query.screensDrafts.findMany({where:(0,r.d3)(o.screensDrafts.screenDraftId,e.map(e=>e.screenDraftId))}):[],f=[];for(let{id:e,scriptId:t,data:n}of(l.filter(e=>e.screenId).length&&(f=await d.Z.query.screens.findMany({where:(0,r.d3)(o.screens.screenId,l.filter(e=>e.screenId).map(e=>e.screenId))})),l)){let r=n.screenId||(0,a.Z)(),c=n.scriptId||t,f={...n,screenId:r,scriptId:c};i.push(f),l=l.map(t=>(t.id===e&&(t.data.screenId=r),t));try{await d.Z.insert(o.screens).values(f)}catch(e){s.errors=[...s.errors||[],`Error inserting ${n.title} - ${e.message}`]}}let p=await (0,c.uK)({screenIds:i.map(e=>e.screenId)});s.inserted=t?.returnInserted?p.data:[],s.success=!0,await u({drafts:l,previous:f}),l.length&&await d.Z.delete(o.screensDrafts).where((0,r.d3)(o.screensDrafts.id,l.map(e=>e.id))),t?.broadcastAction&&n.Z.emit("data_changed","create_screens")}catch(e){s.errors=[e.message],i.Z.error("_createScreens ERROR",e.message)}finally{return s}}async function p(e,t){let s=[],a=e.length?await d.Z.query.screensDrafts.findMany({where:(0,r.d3)(o.screensDrafts.screenId,e.map(e=>e.screenId))}):[],l=[];for(let{screenId:e,data:n}of(a.filter(e=>e.screenId).length&&(l=await d.Z.query.screens.findMany({where:(0,r.d3)(o.screens.screenId,a.filter(e=>e.screenId).map(e=>e.screenId))})),a)){let l=e,{screenId:f,id:p,oldScreenId:u,createdAt:g,updatedAt:h,deletedAt:m,...y}=n;try{let e={...y,publishDate:new Date};await d.Z.update(o.screens).set(e).where((0,r.eq)(o.screens.screenId,l));let a=t?.returnUpdated?await (0,c.NB)(l):void 0;s.push({screenId:l,screen:a})}catch(e){i.Z.error(`_updateScreens screenId=${l}`,e.message),s.push({screenId:l,error:e.message}),a=a.filter(e=>e.data.screenId!==l)}}return await u({drafts:a,previous:l}),a.length&&await d.Z.delete(o.screensDrafts).where((0,r.d3)(o.screensDrafts.id,a.map(e=>e.id))),t?.broadcastAction&&n.Z.emit("data_changed","create_screens"),s}async function u({previous:e,drafts:t}){try{let s=[];for(let r of t){let t={version:r?.data?.version||1,screenId:r?.data?.screenId,scriptId:r?.data?.scriptId,changes:{}};if(r?.data?.version===1)t.changes={action:"create_screen",descreenion:"Create screen",oldValues:[],newValues:[]};else{let s=e.filter(e=>e.screenId===r?.data?.screenId)[0],a=[],i=[];Object.keys({...r?.data}).filter(e=>!["version","draft"].includes(e)).forEach(e=>{let t=r.data[e],n={...s}[e];JSON.stringify(t)!==JSON.stringify(n)&&(a.push({[e]:n}),i.push({[e]:t}))}),t.changes={action:"update_screen",descreenion:"Update screen",oldValues:a,newValues:i}}s.push(t)}await d.Z.insert(o.screensHistory).values(s)}catch(e){i.Z.error(e.message)}}s(57040)},57040:(e,t,s)=>{"use strict";s.d(t,{bK:()=>u,Tw:()=>m,Tx:()=>p});var r=s(57745),a=s(34149),i=s(60938),n=s(81445),d=s(30900),o=s(57435),c=s(41502),l=s(10413),f=s(57418);async function p(e){let t={data:[]};try{let s=await l.Z.query.scriptsDrafts.findMany({where:e?.length?(0,r.or)((0,r.d3)(f.scriptsDrafts.scriptId,e),(0,r.d3)(f.scriptsDrafts.scriptDraftId,e)):void 0,columns:{scriptId:!0,scriptDraftId:!0,data:!0}}),a=await l.Z.query.scripts.findMany({where:(0,r.xD)((0,r.Ft)(f.scripts.deletedAt),...s.length?[(0,r.Nl)(f.scripts.scriptId,s.map(e=>e.data.scriptId))]:[]),columns:{scriptId:!0,position:!0,title:!0}});return t.data=[...t.data,...s.map(e=>({scriptReference:e.scriptDraftId,scriptId:e.scriptId||void 0,scriptDraftId:e.scriptDraftId,isDraft:!0,title:e.data.title,position:e.data.position}))],t.data=[...t.data,...a.map(e=>({scriptReference:e.scriptId,scriptId:e.scriptId,isDraft:!1,title:e.title,position:e.position}))].sort((e,t)=>e.position-t.position),t}catch(e){t.error=e.message,o.Z.error("_listScripts ERROR",e.message)}finally{return t}}async function u(e){let t=d.Z(e)?(0,r.eq)(f.scripts.scriptId,e):(0,r.eq)(f.scripts.oldScriptId,e),s=await l.Z.query.scripts.findFirst({where:(0,r.xD)(t,(0,r.Ft)(f.scripts.deletedAt)),columns:{id:!0,scriptId:!0,oldScriptId:!0,publishDate:!0,createdAt:!0,updatedAt:!0,version:!0,type:!0,position:!0,title:!0,printTitle:!0,description:!0,hospitalId:!0,exportable:!0,nuidSearchEnabled:!0,nuidSearchFields:!0}});return s?{...s,nuidSearchFields:s.nuidSearchFields}:null}async function g({limit:e,page:t=1,scriptIds:s,searchValue:d,archived:o}){t=Math.max(0,t);let p=[];if(o?p.push((0,r.K0)(f.scripts.deletedAt)):p.push((0,r.Ft)(f.scripts.deletedAt)),s?.length&&p.push((0,r.d3)(f.scripts.scriptId,s)),d=`${d||""}`.trim()){let e=["%",d,"%"].join("");p.push((0,a.i6)`LOWER(scripts.name) like LOWER(${e})`)}let u=l.Z.select({count:(0,i.QX)()}).from(f.scripts);p.length&&u.where((0,r.xD)(...p));let[{count:g}]=await u.execute(),h=1;g&&(t=Math.min(t,h=(0,c.x)(e)?1:Math.ceil(g/e)));let m=(0,c.x)(e)?void 0:Math.max(0,(t-1)*e),y=l.Z.select({id:f.scripts.id,scriptId:f.scripts.scriptId,oldScriptId:f.scripts.oldScriptId,publishDate:f.scripts.publishDate,createdAt:f.scripts.createdAt,updatedAt:f.scripts.updatedAt,version:f.scripts.version,type:f.scripts.type,position:f.scripts.position,title:f.scripts.title,printTitle:f.scripts.printTitle,description:f.scripts.description,hospitalId:f.scripts.hospitalId,exportable:f.scripts.exportable,nuidSearchEnabled:f.scripts.nuidSearchEnabled,scriptDraftId:f.scriptsDrafts.scriptDraftId}).from(f.scripts).leftJoin(f.scriptsDrafts,(0,r.eq)(f.scripts.scriptId,f.scriptsDrafts.scriptId)).orderBy((0,n.C)(f.scripts.position));return(0,c.x)(e)||y.limit(e),m&&y.offset(m),p.length&&y.where((0,r.xD)(...p)),{page:t,limit:e,data:(await y.execute()).map(e=>({...e,publishedVersion:e.version})),totalRows:g,totalPages:h,searchValue:d,error:void 0}}let h={page:1,limit:void 0,totalRows:0,totalPages:1,data:[],searchValue:void 0,error:void 0};async function m(e){let t=h;try{t=await g({...e})}catch(e){o.Z.error("_getScripts ERROR",e),t.error=e.message}finally{return t}}},85336:(e,t,s)=>{"use strict";s.d(t,{Ew:()=>p,XA:()=>h});var r=s(57745),a=s(34149),i=s(60938),n=s(81445),d=s(30900),o=s(41502),c=s(10413),l=s(57418),f=s(57435);async function p(e){let t=d.Z(e)?(0,r.eq)(l.diagnoses.diagnosisId,e):(0,r.eq)(l.diagnoses.oldDiagnosisId,e),s=await c.Z.query.diagnoses.findFirst({where:(0,r.xD)(t,(0,r.Ft)(l.diagnoses.deletedAt))});return s?{...s,symptoms:s.symptoms,image1:s.image1,image2:s.image2,image3:s.image3}:null}async function u({limit:e,page:t=1,diagnosisIds:s,searchValue:d,archived:f,scriptsIds:p}){t=Math.max(0,t);let u=[];if(f?u.push((0,r.K0)(l.diagnoses.deletedAt)):u.push((0,r.Ft)(l.diagnoses.deletedAt)),s?.length&&u.push((0,r.d3)(l.diagnoses.diagnosisId,s)),p?.length&&u.push((0,r.d3)(l.diagnoses.scriptId,p)),d=`${d||""}`.trim()){let e=["%",d,"%"].join("");u.push((0,a.i6)`LOWER(diagnoses.name) like LOWER(${e})`)}let g=c.Z.select({count:(0,i.QX)()}).from(l.diagnoses);u.length&&g.where((0,r.xD)(...u));let[{count:h}]=await g.execute(),m=1;h&&(t=Math.min(t,m=(0,o.x)(e)?1:Math.ceil(h/e)));let y=(0,o.x)(e)?void 0:Math.max(0,(t-1)*e),I=c.Z.select({id:l.diagnoses.id,diagnosisId:l.diagnoses.diagnosisId,oldDiagnosisId:l.diagnoses.oldDiagnosisId,version:l.diagnoses.version,scriptId:l.diagnoses.scriptId,key:l.diagnoses.key,position:l.diagnoses.position,name:l.diagnoses.name,description:l.diagnoses.description,source:l.diagnoses.source,expression:l.diagnoses.expression,severityOrder:l.diagnoses.severityOrder,expressionMeaning:l.diagnoses.expressionMeaning,text1:l.diagnoses.text1,text2:l.diagnoses.text2,text3:l.diagnoses.text3,image1:l.diagnoses.image1,image2:l.diagnoses.image2,image3:l.diagnoses.image3,symptoms:l.diagnoses.symptoms,publishDate:l.diagnoses.publishDate,createdAt:l.diagnoses.createdAt,updatedAt:l.diagnoses.updatedAt,deletedAt:l.diagnoses.deletedAt,diagnosisDraftId:l.diagnosesDrafts.diagnosisDraftId,scriptDraftId:l.diagnosesDrafts.scriptDraftId}).from(l.diagnoses).leftJoin(l.diagnosesDrafts,(0,r.eq)(l.diagnoses.diagnosisId,l.diagnosesDrafts.diagnosisId)).orderBy((0,n.C)(l.diagnoses.position));return(0,o.x)(e)||I.limit(e),y&&I.offset(y),u.length&&I.where((0,r.xD)(...u)),{page:t,limit:e,data:(await I.execute()).map(e=>({...e,publishedVersion:e.version,isDraft:!1,diagnosisDraftId:e.diagnosisDraftId,scriptDraftId:e.scriptDraftId})),totalRows:h,totalPages:m,searchValue:d,error:void 0}}let g={page:1,limit:void 0,totalRows:0,totalPages:1,data:[],searchValue:void 0,error:void 0};async function h(e){let t=g;try{t=await u({...e})}catch(e){f.Z.error("_getDiagnoses ERROR",e),t.error=e.message}finally{return t}}},27457:(e,t,s)=>{"use strict";s.d(t,{NB:()=>p,uK:()=>h});var r=s(57745),a=s(34149),i=s(60938),n=s(81445),d=s(30900),o=s(41502),c=s(10413),l=s(57418),f=s(57435);async function p(e){let t=d.Z(e)?(0,r.eq)(l.screens.screenId,e):(0,r.eq)(l.screens.oldScreenId,e),s=await c.Z.query.screens.findFirst({where:(0,r.xD)(t,(0,r.Ft)(l.screens.deletedAt))});return s?{...s,fields:s.fields,items:s.items,image1:s.image1,image2:s.image2,image3:s.image3}:null}async function u({limit:e,page:t=1,screenIds:s,searchValue:d,archived:f,scriptsIds:p}){t=Math.max(0,t);let u=[];if(f?u.push((0,r.K0)(l.screens.deletedAt)):u.push((0,r.Ft)(l.screens.deletedAt)),s?.length&&u.push((0,r.d3)(l.screens.screenId,s)),p?.length&&u.push((0,r.d3)(l.screens.scriptId,p)),d=`${d||""}`.trim()){let e=["%",d,"%"].join("");u.push((0,a.i6)`LOWER(screens.name) like LOWER(${e})`)}let g=c.Z.select({count:(0,i.QX)()}).from(l.screens);u.length&&g.where((0,r.xD)(...u));let[{count:h}]=await g.execute(),m=1;h&&(t=Math.min(t,m=(0,o.x)(e)?1:Math.ceil(h/e)));let y=(0,o.x)(e)?void 0:Math.max(0,(t-1)*e),I=c.Z.select({id:l.screens.id,screenId:l.screens.screenId,oldScreenId:l.screens.oldScreenId,version:l.screens.version,scriptId:l.screens.scriptId,type:l.screens.type,position:l.screens.position,sectionTitle:l.screens.sectionTitle,condition:l.screens.condition,epicId:l.screens.epicId,storyId:l.screens.storyId,refId:l.screens.refId,step:l.screens.step,actionText:l.screens.actionText,contentText:l.screens.contentText,title:l.screens.title,title1:l.screens.title1,title2:l.screens.title2,title3:l.screens.title3,title4:l.screens.title4,instructions:l.screens.instructions,instructions2:l.screens.instructions2,instructions3:l.screens.instructions3,instructions4:l.screens.instructions4,text1:l.screens.text1,text2:l.screens.text2,text3:l.screens.text3,image1:l.screens.image1,image2:l.screens.image2,image3:l.screens.image3,hcwDiagnosesInstructions:l.screens.hcwDiagnosesInstructions,suggestedDiagnosesInstructions:l.screens.suggestedDiagnosesInstructions,notes:l.screens.notes,dataType:l.screens.dataType,confidential:l.screens.confidential,key:l.screens.key,label:l.screens.label,negativeLabel:l.screens.negativeLabel,positiveLabel:l.screens.positiveLabel,timerValue:l.screens.timerValue,multiplier:l.screens.multiplier,minValue:l.screens.minValue,maxValue:l.screens.maxValue,exportable:l.screens.exportable,skippable:l.screens.skippable,prePopulate:l.screens.prePopulate,fields:l.screens.fields,items:l.screens.items,publishDate:l.screens.publishDate,createdAt:l.screens.createdAt,updatedAt:l.screens.updatedAt,deletedAt:l.screens.deletedAt,screenDraftId:l.screensDrafts.screenDraftId,scriptDraftId:l.screensDrafts.scriptDraftId}).from(l.screens).leftJoin(l.screensDrafts,(0,r.eq)(l.screens.screenId,l.screensDrafts.screenId)).orderBy((0,n.C)(l.screens.position));return(0,o.x)(e)||I.limit(e),y&&I.offset(y),u.length&&I.where((0,r.xD)(...u)),{page:t,limit:e,data:(await I.execute()).map(e=>({...e,publishedVersion:e.version,isDraft:!1,screenDraftId:e.screenDraftId,scriptDraftId:e.scriptDraftId})),totalRows:h,totalPages:m,searchValue:d,error:void 0}}let g={page:1,limit:void 0,totalRows:0,totalPages:1,data:[],searchValue:void 0,error:void 0};async function h(e){let t=g;try{t=await u({...e})}catch(e){f.Z.error("_getScreens ERROR",e),t.error=e.message}finally{return t}}},3641:()=>{},50650:(e,t,s)=>{"use strict";s.d(t,{cn:()=>i});var r=s(55761),a=s(62386);function i(...e){return(0,a.m6)((0,r.W)(e))}},67272:()=>{}};