"use strict";exports.id=3442,exports.ids=[3442],exports.modules={13442:(e,r,t)=>{t.r(r),t.d(r,{$$ACTION_0:()=>p,$$ACTION_1:()=>y,$$ACTION_10:()=>K,$$ACTION_11:()=>k,$$ACTION_12:()=>U,$$ACTION_13:()=>B,$$ACTION_14:()=>L,$$ACTION_15:()=>q,$$ACTION_2:()=>m,$$ACTION_3:()=>E,$$ACTION_4:()=>S,$$ACTION_5:()=>A,$$ACTION_6:()=>v,$$ACTION_7:()=>_,$$ACTION_8:()=>D,$$ACTION_9:()=>C,copyDiagnoses:()=>er,copyScreens:()=>ee,copyScripts:()=>V,countDiagnoses:()=>$,countScreens:()=>b,countScripts:()=>X,deleteDiagnoses:()=>T,deleteScreens:()=>j,deleteScripts:()=>G,deleteScriptsItems:()=>z,getDiagnoses:()=>Z,getDiagnosis:()=>N,getScreen:()=>I,getScreens:()=>w,getScript:()=>Y,getScripts:()=>W,getScriptsWithItems:()=>H,listScreens:()=>R,saveDiagnoses:()=>x,saveScreens:()=>O,saveScriptDiagnoses:()=>M,saveScriptScreens:()=>J,saveScripts:()=>P,saveScriptsWithItems:()=>Q});var s=t(24330);t(60166);var a=t(9576),c=t(49530),i=t(91966),o=t(13269),n=t(57435),d=t(88317),f=t(29712),l=t(20123);async function u(e,r){let t=r?.link,s=r?.baseURL;if(!e)throw Error("AXIOS init error: missing siteId");if(!r){let r=await (0,l._U)(e);if(r.errors?.length)throw Error("AXIOS init error: "+r.errors.join(", "));if(!r.data)throw Error("AXIOS init error: site not found");t=r.data.link,s=r.data.apiKey}let a=f.Z.create({baseURL:t});return a.interceptors.request.use(async e=>(e.headers&&(e.headers["x-api-key"]=s),n.Z.log(`AXIOS [${e.method}]`,[`${t}/api`,e.url].join("")),e)),a.interceptors.response.use(e=>e,e=>new Promise((r,t)=>t(e))),a}var h=t(66267),g=t(40618);let b=(0,s.j)("a2e7b4988cfc6b7df9260c32c67b8103d16b6a63",p);async function p(...e){try{return await (0,h.isAllowed)(),await o.co(...e)}catch(e){return n.Z.error("countScreens ERROR",e.message),{errors:[e.message],data:o.W0}}}let w=(0,s.j)("24e9022c17df53d67760e50f19d5b72e1d9f2298",y);async function y(...e){try{return await (0,h.isAllowed)(),await o.uK(...e)}catch(e){return n.Z.error("getScreens ERROR",e.message),{errors:[e.message],data:[]}}}let R=(0,s.j)("2b05dfa4d85f1776010bd756bbe743a77279c5f0",m);async function m(...e){try{return await (0,h.isAllowed)(),await o.f(...e)}catch(e){return n.Z.error("listScreens ERROR",e.message),{errors:[e.message],data:[]}}}let I=(0,s.j)("6123354a6875ef294f61d0d76e293db3234e1acb",E);async function E(...e){return await (0,h.isAllowed)(),await o.NB(...e)}let j=(0,s.j)("3d4cdf9ab314e4f05d60c3c024838c1ffb7a179b",S);async function S(...e){try{return await (0,h.isAllowed)(),await i.GH(...e)}catch(e){return n.Z.error("deleteScreens ERROR",e.message),{errors:[e.message],success:!1}}}let O=(0,s.j)("58f6b10942247b738e77ec22491a1c4dc8dc587f",A);async function A(...e){try{return await (0,h.isAllowed)(),await i.uD(...e)}catch(e){return n.Z.error("getSys ERROR",e.message),{errors:[e.message],data:void 0,success:!1}}}let $=(0,s.j)("918fd34e7772e4f05468ba9d34dea1b2530f7d31",v);async function v(...e){try{return await (0,h.isAllowed)(),await o.tW(...e)}catch(e){return n.Z.error("countDiagnoses ERROR",e.message),{errors:[e.message],data:o.GM}}}let Z=(0,s.j)("69843cc46605f6b66907f7f6bd317a2bc6a08208",_);async function _(...e){try{return await (0,h.isAllowed)(),await o.XA(...e)}catch(e){return n.Z.error("getDiagnoses ERROR",e.message),{errors:[e.message],data:[]}}}let N=(0,s.j)("7f6eea2375b17a3349caf9e6b2af51f2e105ef95",D);async function D(...e){return await (0,h.isAllowed)(),await o.Ew(...e)}let T=(0,s.j)("4711250dfbda7886c1c5b452c2a35b4b719c58bd",C);async function C(...e){try{return await (0,h.isAllowed)(),await i.Bx(...e)}catch(e){return n.Z.error("deleteDiagnoses ERROR",e.message),{errors:[e.message],success:!1}}}let x=(0,s.j)("53f9f76d9eb95d55e021dfd9f72f3e6f7a448f66",K);async function K(...e){try{return await (0,h.isAllowed)(),await i.Pk(...e)}catch(e){return n.Z.error("getSys ERROR",e.message),{errors:[e.message],data:void 0,success:!1}}}let X=(0,s.j)("cff30b30c5ae15f469ecb042540e0dceea6bbe46",k);async function k(...e){try{return await (0,h.isAllowed)(),await o.ix(...e)}catch(e){return n.Z.error("countScripts ERROR",e.message),{errors:[e.message],data:o.Zu}}}let W=(0,s.j)("d441e022601289dbe4635f999123ca45fd11f8aa",U);async function U(...e){try{return await (0,h.isAllowed)(),await o.Tw(...e)}catch(e){return n.Z.error("getScripts ERROR",e.message),{errors:[e.message],data:[]}}}let Y=(0,s.j)("da0f93f25c15ffc0fb2d164906cacdfd2b215970",B);async function B(...e){return await (0,h.isAllowed)(),await o.bK(...e)}let G=(0,s.j)("cbe929ca83cfcd7af92d59cab55b054c157fe66a",L);async function L(...e){try{return await (0,h.isAllowed)(),await i.Es(...e)}catch(e){return n.Z.error("deleteScripts ERROR",e.message),{errors:[e.message],success:!1}}}let P=(0,s.j)("5cf954e3640411c38a559d06cb934be3b350ceb2",q);async function q(...e){try{return await (0,h.isAllowed)(),await i.Or(...e)}catch(e){return n.Z.error("getSys ERROR",e.message),{errors:[e.message],data:void 0,success:!1}}}async function H(e){let r=[],t=[];try{let s=e?.returnDraftsIfExist!==!1,a=await o.Tw({...e,returnDraftsIfExist:s});for(let e of(a.errors?.forEach(e=>t.push(e)),a.data)){let a=await o.uK({scriptsIds:[e.scriptId],returnDraftsIfExist:s}),c=await o.XA({scriptsIds:[e.scriptId],returnDraftsIfExist:s});a.errors?.forEach(e=>t.push(e)),c.errors?.forEach(e=>t.push(e)),r.push({...e,screens:a.data,diagnoses:c.data})}if(t.length)return{errors:t,data:[]};return{data:r}}catch(e){return n.Z.error("getScriptsWithItems ERROR",e.message),{data:[],errors:[e.message]}}}async function J({screens:e,scriptId:r}){try{let t=0,s=[],c=await o.bK({scriptId:r,returnDraftIfExists:!0});if(c.errors?.length)throw Error(c.errors.join(", "));if(!c.data)throw Error("Script not found");for(let i of e){let{id:e,publishDate:o,createdAt:n,updatedAt:d,isDraft:f,deletedAt:l,version:u,oldScriptId:h,oldScreenId:g,screenId:b,scriptId:p,position:w,...y}=i,R=(0,a.Z)(),m=await O({data:[{...y,scriptId:r,oldScriptId:c.data.oldScriptId,screenId:R,version:1}]});m.errors?.forEach(e=>s.push(`(screenId=${b}) ${e||""}`)),!m.errors?.length&&t++}if(s.length)return{errors:s,saved:t,success:!1};return{saved:t,success:!0}}catch(e){return n.Z.error("saveScriptScreens ERROR",e.message),{saved:0,success:!1,errors:[e.message]}}}async function M({diagnoses:e,scriptId:r}){try{let t=0,s=[],c=await o.bK({scriptId:r,returnDraftIfExists:!0});if(c.errors?.length)throw Error(c.errors.join(", "));if(!c.data)throw Error("Script not found");for(let i of e){let{id:e,publishDate:o,createdAt:n,updatedAt:d,isDraft:f,deletedAt:l,version:u,oldDiagnosisId:h,diagnosisId:g,scriptId:b,position:p,...w}=i,y=(0,a.Z)(),R=await x({data:[{...w,scriptId:r,oldScriptId:c.data.oldScriptId,diagnosisId:y,version:1}]});R.errors?.forEach(e=>s.push(`(diagnosisId=${g}) ${e||""}`)),!R.errors?.length&&t++}if(s.length)return{errors:s,saved:t,success:!1};return{saved:t,success:!0}}catch(e){return n.Z.error("saveScriptDiagnoses ERROR",e.message),{saved:0,success:!1,errors:[e.message]}}}async function z({scriptsIds:e}){try{let r=[],t=await j({scriptsIds:e});t.errors?.forEach(e=>r.push(e));let s=await T({scriptsIds:e});if(s.errors?.forEach(e=>r.push(e)),r.length)return{errors:r,success:!1};return{success:!0}}catch(e){return n.Z.error("deleteScriptsItems ERROR",e.message),{success:!1,errors:[e.message]}}}let F={scripts:0,screens:0,diagnoses:0};async function Q({data:e}){let r={...F};try{let t=[];for(let{overWriteScriptWithId:s,...c}of e){let e=s?await Y({scriptId:s,returnDraftIfExists:!0}):{data:null};if(e.errors?.forEach(e=>t.push(e)),t.length)continue;if(s&&!e?.data){t.push("Overwrite script was not found");continue}if(e?.data){let r=await z({scriptsIds:[e.data.scriptId]});if(r.errors?.forEach(e=>t.push(e)),t.length)continue}let{id:i,screens:o=[],diagnoses:n=[],publishDate:d,createdAt:f,updatedAt:l,isDraft:u,deletedAt:h,version:g,oldScriptId:b,scriptId:p,position:w,...y}=c,R=e?.data?.scriptId||(0,a.Z)(),m=await P({data:[{...y,scriptId:R,version:1}]});if(m.errors?.forEach(e=>t.push(e)),t.length)continue;r.scripts++;let I=await J({scriptId:R,screens:o});r.screens+=I.saved;let E=await M({scriptId:R,diagnoses:n});r.diagnoses+=E.saved}if(t.length)return{success:!1,errors:t,info:r};return{success:!0,info:r}}catch(e){return n.Z.error("saveScriptsWithItems ERROR",e.message),{success:!1,errors:[e.message],info:r}}}async function V(e){let r={...F},{scriptsIds:t=[],confirmCopyAll:s,toRemoteSiteId:a,fromRemoteSiteId:i,broadcastAction:o,overWriteScriptWithId:f}={...e};try{if(!t.length&&!s)throw Error("You&apos;re about copy all the scripts, please confirm this action!");let e=i?{data:[]}:await H({scriptsIds:t});if(e.errors)return{success:!1,errors:e.errors,info:r};if(i){let s=await u(i),a=(await s.get("/api/scripts/with-items?"+c.Z.stringify({scriptsIds:JSON.stringify(t)}))).data;if(a.errors)return{success:!1,errors:a.errors,info:r};e=a}let n={success:!0,info:r};if(e.data.length){if(a){let r=await u(a);n=(await r.post("/api/scripts/with-items?",{data:e.data.map(e=>({...e,hospitalId:void 0,hospitalName:void 0}))})).data}else n=await Q({data:e.data.map(e=>({...e,overWriteScriptWithId:f,hospitalId:void 0,hospitalName:void 0}))})}return o&&!n?.errors?.length&&d.Z.emit("data_changed","copy_scripts"),n}catch(e){return n.Z.error("copyScripts ERROR",e.response?.data?.errors?.join(", ")||e.message),{errors:e.response?.data?.errors||[e.message],success:!1,info:r}}}async function ee(e){let r=0,{screensIds:t=[],fromScriptsIds:s=[],toScriptsIds:a=[],confirmCopyAll:c,broadcastAction:i}={...e};try{let e=[];if(!s.length&&!t.length&&!c)throw Error("You&apos;re about to copy all the screens, please confirm this action!");let n=await o.uK({scriptsIds:s,screensIds:t,returnDraftsIfExist:!0});if(n.errors?.length)throw Error(n.errors.join(", "));if(a.length)for(let t of a){let s=await J({scriptId:t,screens:n.data});s.errors?.forEach(r=>e.push(r)),!e.length&&r++}else{let t=n.data.reduce((e,r)=>({...e,[r.scriptId]:[...e[r.scriptId]||[],r]}),{});for(let s of Object.keys(t)){let a=await J({scriptId:s,screens:t[s]});a.errors?.forEach(r=>e.push(r)),e.length||(r+=a.saved)}}return i&&!e.length&&d.Z.emit("data_changed","copy_scripts"),{copied:r,success:!e.length,errors:e.length?e:void 0}}catch(e){return n.Z.error("copyScreens ERROR",e.message),{errors:[e.message],success:!1,copied:r}}}async function er(e){let r=0,{diagnosesIds:t=[],fromScriptsIds:s=[],toScriptsIds:a=[],confirmCopyAll:c,broadcastAction:i}={...e};try{let e=[];if(!s.length&&!t.length&&!c)throw Error("You&apos;re about to copy all the diagnoses, please confirm this action!");let n=await o.XA({scriptsIds:s,diagnosesIds:t,returnDraftsIfExist:!0});if(n.errors?.length)throw Error(n.errors.join(", "));if(a.length)for(let t of a){let s=await M({scriptId:t,diagnoses:n.data});s.errors?.forEach(r=>e.push(r)),!e.length&&r++}else{let t=n.data.reduce((e,r)=>({...e,[r.scriptId]:[...e[r.scriptId]||[],r]}),{});for(let s of Object.keys(t)){let a=await M({scriptId:s,diagnoses:t[s]});a.errors?.forEach(r=>e.push(r)),e.length||(r+=a.saved)}}return i&&!e.length&&d.Z.emit("data_changed","copy_scripts"),{copied:r,success:!e.length,errors:e.length?e:void 0}}catch(e){return n.Z.error("copyDiagnoses ERROR",e.message),{errors:[e.message],success:!1,copied:r}}}(0,g.h)([b,w,R,I,j,O,$,Z,N,T,x,X,W,Y,G,P,H,J,M,z,Q,V,ee,er]),(0,s.j)("cacd45d910d4b65cb3f324cf9672e3646e810c63",b),(0,s.j)("7d58668c31eeffabd01a5b2295f50ad523f6ff48",w),(0,s.j)("42e4b9688dc312127a5365a13e7414df11037beb",R),(0,s.j)("587fd5e694cdad0e0d69f3bd2be4d1523b04080a",I),(0,s.j)("1f5bb0a9d8929c6ad1573f083d45c933517f2d54",j),(0,s.j)("e3e4dec2821749c1437a0c6c83fa62dfd79ba423",O),(0,s.j)("1030ca5fc7f151f66a2338c6922d8a43ed6f626b",$),(0,s.j)("4d61f45e2d8e57a8d86f98f4e5c466d54ebf2661",Z),(0,s.j)("059442040631e29b07aaa96466f7ebaa6953be8a",N),(0,s.j)("2c4fbbbc1c4cfce02ce8fb0badead2e106b47161",T),(0,s.j)("f85f5365206d33120bb2736267ff7bcd51f71c0f",x),(0,s.j)("bab42513b214aae1153d5c5ac7b3c23ff73e428c",X),(0,s.j)("60ccc7703580a23b3f92e3609f6e295bbbb8384c",W),(0,s.j)("e8ae8a831670d823e1ef9449df9f4c763f6ca35a",Y),(0,s.j)("915561a61fc394f4a4c063651fe1fb32cc654097",G),(0,s.j)("1e6f561ba736dbb2c2e3eece058add991778f14c",P),(0,s.j)("313dea07c27ed07f3ca7806e1c36ce1ce1940435",H),(0,s.j)("bbe883c3261ff1f7ca61fc17185dc8508f58ef73",J),(0,s.j)("0eb201c75243185ed56886599d37101806743fec",M),(0,s.j)("4b0367b37d47d9bce59582d76b66de96dc2d78d5",z),(0,s.j)("48b0d448354494034bc34ba2d1d50ba6d15d770b",Q),(0,s.j)("d8290b9469ed086d8eed034d4d4104ead5588b92",V),(0,s.j)("cffc4b98270715e5857f29eee9b710c56883a647",ee),(0,s.j)("580699050265db71e8951b840d05391c5b2d6f10",er)}};