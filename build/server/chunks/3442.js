"use strict";exports.id=3442,exports.ids=[3442],exports.modules={13442:(e,r,t)=>{t.r(r),t.d(r,{$$ACTION_0:()=>p,$$ACTION_1:()=>y,$$ACTION_10:()=>K,$$ACTION_11:()=>k,$$ACTION_12:()=>U,$$ACTION_13:()=>B,$$ACTION_14:()=>L,$$ACTION_15:()=>q,$$ACTION_2:()=>m,$$ACTION_3:()=>E,$$ACTION_4:()=>S,$$ACTION_5:()=>A,$$ACTION_6:()=>v,$$ACTION_7:()=>_,$$ACTION_8:()=>D,$$ACTION_9:()=>C,copyDiagnoses:()=>er,copyScreens:()=>ee,copyScripts:()=>V,countDiagnoses:()=>$,countScreens:()=>b,countScripts:()=>X,deleteDiagnoses:()=>T,deleteScreens:()=>j,deleteScripts:()=>G,deleteScriptsItems:()=>z,getDiagnoses:()=>Z,getDiagnosis:()=>N,getScreen:()=>I,getScreens:()=>w,getScript:()=>Y,getScripts:()=>W,getScriptsWithItems:()=>H,listScreens:()=>R,saveDiagnoses:()=>x,saveScreens:()=>O,saveScriptDiagnoses:()=>M,saveScriptScreens:()=>J,saveScripts:()=>P,saveScriptsWithItems:()=>Q});var s=t(24330);t(60166);var a=t(9576),c=t(49530),i=t(91966),o=t(13269),n=t(57435),d=t(88317),f=t(29712),l=t(20123);async function u(e,r){let t=r?.link,s=r?.baseURL;if(!e)throw Error("AXIOS init error: missing siteId");if(!r){let r=await (0,l._U)(e);if(r.errors?.length)throw Error("AXIOS init error: "+r.errors.join(", "));if(!r.data)throw Error("AXIOS init error: site not found");t=r.data.link,s=r.data.apiKey}let a=f.Z.create({baseURL:t});return a.interceptors.request.use(async e=>(e.headers&&(e.headers["x-api-key"]=s),n.Z.log(`AXIOS [${e.method}]`,[`${t}/api`,e.url].join("")),e)),a.interceptors.response.use(e=>e,e=>new Promise((r,t)=>t(e))),a}var h=t(66267),g=t(40618);let b=(0,s.j)("40b145514ce2d3b1ae607938c89148266b56a8b6",p);async function p(...e){try{return await (0,h.isAllowed)(),await o.co(...e)}catch(e){return n.Z.error("countScreens ERROR",e.message),{errors:[e.message],data:o.W0}}}let w=(0,s.j)("a65a38b7d2d05c44cdae52ce646012fc9a3fe3be",y);async function y(...e){try{return await (0,h.isAllowed)(),await o.uK(...e)}catch(e){return n.Z.error("getScreens ERROR",e.message),{errors:[e.message],data:[]}}}let R=(0,s.j)("02c4c045adfbba673fa679b0d9e57ba0a7a3fe57",m);async function m(...e){try{return await (0,h.isAllowed)(),await o.f(...e)}catch(e){return n.Z.error("listScreens ERROR",e.message),{errors:[e.message],data:[]}}}let I=(0,s.j)("c6c283fce13019dcd503404f01d9b11992de1859",E);async function E(...e){return await (0,h.isAllowed)(),await o.NB(...e)}let j=(0,s.j)("91d850b366e3e66362841da64c8e728f242c9f45",S);async function S(...e){try{return await (0,h.isAllowed)(),await i.GH(...e)}catch(e){return n.Z.error("deleteScreens ERROR",e.message),{errors:[e.message],success:!1}}}let O=(0,s.j)("11ea0bb480f0dbe2c7312511c726e75dc4b44efb",A);async function A(...e){try{return await (0,h.isAllowed)(),await i.uD(...e)}catch(e){return n.Z.error("getSys ERROR",e.message),{errors:[e.message],data:void 0,success:!1}}}let $=(0,s.j)("b19612aece4a5dc97cc502a4674195dcd1ff2bf8",v);async function v(...e){try{return await (0,h.isAllowed)(),await o.tW(...e)}catch(e){return n.Z.error("countDiagnoses ERROR",e.message),{errors:[e.message],data:o.GM}}}let Z=(0,s.j)("974b797430aafc6123bb148d679484de4cfd8494",_);async function _(...e){try{return await (0,h.isAllowed)(),await o.XA(...e)}catch(e){return n.Z.error("getDiagnoses ERROR",e.message),{errors:[e.message],data:[]}}}let N=(0,s.j)("34650f198459f4157c47017d568900d718328ad9",D);async function D(...e){return await (0,h.isAllowed)(),await o.Ew(...e)}let T=(0,s.j)("ddbb3e4ae1f85132a1e4233fc0148732d98526b6",C);async function C(...e){try{return await (0,h.isAllowed)(),await i.Bx(...e)}catch(e){return n.Z.error("deleteDiagnoses ERROR",e.message),{errors:[e.message],success:!1}}}let x=(0,s.j)("a2d53919990580fe6a5935e605bbb584f051ccfb",K);async function K(...e){try{return await (0,h.isAllowed)(),await i.Pk(...e)}catch(e){return n.Z.error("getSys ERROR",e.message),{errors:[e.message],data:void 0,success:!1}}}let X=(0,s.j)("a9a6f99f41bdc739a9556a8ad03f022e378d4fc5",k);async function k(...e){try{return await (0,h.isAllowed)(),await o.ix(...e)}catch(e){return n.Z.error("countScripts ERROR",e.message),{errors:[e.message],data:o.Zu}}}let W=(0,s.j)("1e6ab24a34b196734a61d26235de22b681996450",U);async function U(...e){try{return await (0,h.isAllowed)(),await o.Tw(...e)}catch(e){return n.Z.error("getScripts ERROR",e.message),{errors:[e.message],data:[]}}}let Y=(0,s.j)("b9109e8b1cc9590040584d1910070aad44069358",B);async function B(...e){return await (0,h.isAllowed)(),await o.bK(...e)}let G=(0,s.j)("78f879acee6a2f25ddfa87b814e0e18e454d1901",L);async function L(...e){try{return await (0,h.isAllowed)(),await i.Es(...e)}catch(e){return n.Z.error("deleteScripts ERROR",e.message),{errors:[e.message],success:!1}}}let P=(0,s.j)("211c716bf4baac7f1cb483421fd62128ea76f129",q);async function q(...e){try{return await (0,h.isAllowed)(),await i.Or(...e)}catch(e){return n.Z.error("getSys ERROR",e.message),{errors:[e.message],data:void 0,success:!1}}}async function H(e){let r=[],t=[];try{let s=e?.returnDraftsIfExist!==!1,a=await o.Tw({...e,returnDraftsIfExist:s});for(let e of(a.errors?.forEach(e=>t.push(e)),a.data)){let a=await o.uK({scriptsIds:[e.scriptId],returnDraftsIfExist:s}),c=await o.XA({scriptsIds:[e.scriptId],returnDraftsIfExist:s});a.errors?.forEach(e=>t.push(e)),c.errors?.forEach(e=>t.push(e)),r.push({...e,screens:a.data,diagnoses:c.data})}if(t.length)return{errors:t,data:[]};return{data:r}}catch(e){return n.Z.error("getScriptsWithItems ERROR",e.message),{data:[],errors:[e.message]}}}async function J({screens:e,scriptId:r}){try{let t=0,s=[],c=await o.bK({scriptId:r,returnDraftIfExists:!0});if(c.errors?.length)throw Error(c.errors.join(", "));if(!c.data)throw Error("Script not found");for(let i of e){let{id:e,publishDate:o,createdAt:n,updatedAt:d,isDraft:f,deletedAt:l,version:u,oldScriptId:h,oldScreenId:g,screenId:b,scriptId:p,position:w,...y}=i,R=(0,a.Z)(),m=await O({data:[{...y,scriptId:r,oldScriptId:c.data.oldScriptId,screenId:R,version:1}]});m.errors?.forEach(e=>s.push(`(screenId=${b}) ${e||""}`)),!m.errors?.length&&t++}if(s.length)return{errors:s,saved:t,success:!1};return{saved:t,success:!0}}catch(e){return n.Z.error("saveScriptScreens ERROR",e.message),{saved:0,success:!1,errors:[e.message]}}}async function M({diagnoses:e,scriptId:r}){try{let t=0,s=[],c=await o.bK({scriptId:r,returnDraftIfExists:!0});if(c.errors?.length)throw Error(c.errors.join(", "));if(!c.data)throw Error("Script not found");for(let i of e){let{id:e,publishDate:o,createdAt:n,updatedAt:d,isDraft:f,deletedAt:l,version:u,oldDiagnosisId:h,diagnosisId:g,scriptId:b,position:p,...w}=i,y=(0,a.Z)(),R=await x({data:[{...w,scriptId:r,oldScriptId:c.data.oldScriptId,diagnosisId:y,version:1}]});R.errors?.forEach(e=>s.push(`(diagnosisId=${g}) ${e||""}`)),!R.errors?.length&&t++}if(s.length)return{errors:s,saved:t,success:!1};return{saved:t,success:!0}}catch(e){return n.Z.error("saveScriptDiagnoses ERROR",e.message),{saved:0,success:!1,errors:[e.message]}}}async function z({scriptsIds:e}){try{let r=[],t=await j({scriptsIds:e});t.errors?.forEach(e=>r.push(e));let s=await T({scriptsIds:e});if(s.errors?.forEach(e=>r.push(e)),r.length)return{errors:r,success:!1};return{success:!0}}catch(e){return n.Z.error("deleteScriptsItems ERROR",e.message),{success:!1,errors:[e.message]}}}let F={scripts:0,screens:0,diagnoses:0};async function Q({data:e}){let r={...F};try{let t=[];for(let{overWriteScriptWithId:s,...c}of e){let e=s?await Y({scriptId:s,returnDraftIfExists:!0}):{data:null};if(e.errors?.forEach(e=>t.push(e)),t.length)continue;if(s&&!e?.data){t.push("Overwrite script was not found");continue}if(e?.data){let r=await z({scriptsIds:[e.data.scriptId]});if(r.errors?.forEach(e=>t.push(e)),t.length)continue}let{id:i,screens:o=[],diagnoses:n=[],publishDate:d,createdAt:f,updatedAt:l,isDraft:u,deletedAt:h,version:g,oldScriptId:b,scriptId:p,position:w,...y}=c,R=e?.data?.scriptId||(0,a.Z)(),m=await P({data:[{...y,scriptId:R,version:1}]});if(m.errors?.forEach(e=>t.push(e)),t.length)continue;r.scripts++;let I=await J({scriptId:R,screens:o});r.screens+=I.saved;let E=await M({scriptId:R,diagnoses:n});r.diagnoses+=E.saved}if(t.length)return{success:!1,errors:t,info:r};return{success:!0,info:r}}catch(e){return n.Z.error("saveScriptsWithItems ERROR",e.message),{success:!1,errors:[e.message],info:r}}}async function V(e){let r={...F},{scriptsIds:t=[],confirmCopyAll:s,toRemoteSiteId:a,fromRemoteSiteId:i,broadcastAction:o,overWriteScriptWithId:f}={...e};try{if(!t.length&&!s)throw Error("You&apos;re about copy all the scripts, please confirm this action!");let e=i?{data:[]}:await H({scriptsIds:t});if(e.errors)return{success:!1,errors:e.errors,info:r};if(i){let s=await u(i),a=(await s.get("/api/scripts/with-items?"+c.Z.stringify({scriptsIds:JSON.stringify(t)}))).data;if(a.errors)return{success:!1,errors:a.errors,info:r};e=a}let n={success:!0,info:r};if(e.data.length){if(a){let r=await u(a);n=(await r.post("/api/scripts/with-items?",{data:e.data.map(e=>({...e,hospitalId:void 0,hospitalName:void 0}))})).data}else n=await Q({data:e.data.map(e=>({...e,overWriteScriptWithId:f,hospitalId:void 0,hospitalName:void 0}))})}return o&&!n?.errors?.length&&d.Z.emit("data_changed","copy_scripts"),n}catch(e){return n.Z.error("copyScripts ERROR",e.response?.data?.errors?.join(", ")||e.message),{errors:e.response?.data?.errors||[e.message],success:!1,info:r}}}async function ee(e){let r=0,{screensIds:t=[],fromScriptsIds:s=[],toScriptsIds:a=[],confirmCopyAll:c,broadcastAction:i}={...e};try{let e=[];if(!s.length&&!t.length&&!c)throw Error("You&apos;re about to copy all the screens, please confirm this action!");let n=await o.uK({scriptsIds:s,screensIds:t,returnDraftsIfExist:!0});if(n.errors?.length)throw Error(n.errors.join(", "));if(a.length)for(let t of a){let s=await J({scriptId:t,screens:n.data});s.errors?.forEach(r=>e.push(r)),!e.length&&r++}else{let t=n.data.reduce((e,r)=>({...e,[r.scriptId]:[...e[r.scriptId]||[],r]}),{});for(let s of Object.keys(t)){let a=await J({scriptId:s,screens:t[s]});a.errors?.forEach(r=>e.push(r)),e.length||(r+=a.saved)}}return i&&!e.length&&d.Z.emit("data_changed","copy_scripts"),{copied:r,success:!e.length,errors:e.length?e:void 0}}catch(e){return n.Z.error("copyScreens ERROR",e.message),{errors:[e.message],success:!1,copied:r}}}async function er(e){let r=0,{diagnosesIds:t=[],fromScriptsIds:s=[],toScriptsIds:a=[],confirmCopyAll:c,broadcastAction:i}={...e};try{let e=[];if(!s.length&&!t.length&&!c)throw Error("You&apos;re about to copy all the diagnoses, please confirm this action!");let n=await o.XA({scriptsIds:s,diagnosesIds:t,returnDraftsIfExist:!0});if(n.errors?.length)throw Error(n.errors.join(", "));if(a.length)for(let t of a){let s=await M({scriptId:t,diagnoses:n.data});s.errors?.forEach(r=>e.push(r)),!e.length&&r++}else{let t=n.data.reduce((e,r)=>({...e,[r.scriptId]:[...e[r.scriptId]||[],r]}),{});for(let s of Object.keys(t)){let a=await M({scriptId:s,diagnoses:t[s]});a.errors?.forEach(r=>e.push(r)),e.length||(r+=a.saved)}}return i&&!e.length&&d.Z.emit("data_changed","copy_scripts"),{copied:r,success:!e.length,errors:e.length?e:void 0}}catch(e){return n.Z.error("copyDiagnoses ERROR",e.message),{errors:[e.message],success:!1,copied:r}}}(0,g.h)([b,w,R,I,j,O,$,Z,N,T,x,X,W,Y,G,P,H,J,M,z,Q,V,ee,er]),(0,s.j)("0c13c96a94486feac9241382350585b6f57f5325",b),(0,s.j)("ecc4ffd9ddf6ee0760a61cd9e34f599272f18060",w),(0,s.j)("f4b8ca900dd97d5a31514d53558e7fbdd496eb90",R),(0,s.j)("6ab7864b9809a58af732e5f8d311cf3f011c8485",I),(0,s.j)("21623ef9872b8cc6e0d27497e7e672db39388ea7",j),(0,s.j)("d171fa9fb3af973b5aedefce478d37e4810c59e8",O),(0,s.j)("436f748b1975197b7febb489bcd0cf2489e681a9",$),(0,s.j)("0c4a760a17bd3a8b19764eee8e8ad864a6fe0383",Z),(0,s.j)("e612e7ee23b789be26f87a95485d3676b4101794",N),(0,s.j)("3695d8e2d78ac27641288be30757b2e4a90905f1",T),(0,s.j)("d7e7eb9695fb5a3d90564e39b862d243c5d01a3d",x),(0,s.j)("df0bf54b3e0aeaf6f2cff7f465458bee6028d7e9",X),(0,s.j)("ee2b522f1f62007c6407fd06af89e463ad20ba3a",W),(0,s.j)("efdd8563c65647b31797496628590637c51cdde9",Y),(0,s.j)("b65b42b095be45f822c31f260ba2a0595193d4e2",G),(0,s.j)("a06532bdb62cd01aae1c7180878c22e1d5ae684a",P),(0,s.j)("2476f242944845f9268ab1b661f6d2b204506e14",H),(0,s.j)("45d61f40710f5215369f2e15bc28f20e0f12cf77",J),(0,s.j)("dad0b6c5ef84c75c8800cff92a24c1bab4588efd",M),(0,s.j)("39da23286b1cc2b75b4c1b93f61c294a052c47a3",z),(0,s.j)("8d3ad1a41118d2211089a1fb01be527ce90340de",Q),(0,s.j)("efbf261f5f67e5c51e55f118c42cbc17b43392ed",V),(0,s.j)("01f604b6e7fb88bffd68f01370a8cfb75c3bae6b",ee),(0,s.j)("de23dd1cd94d40322ec8a46fc793a0071773f63c",er)}};