"use strict";exports.id=3442,exports.ids=[3442],exports.modules={13442:(e,r,a)=>{a.r(r),a.d(r,{$$ACTION_0:()=>p,$$ACTION_1:()=>y,$$ACTION_10:()=>K,$$ACTION_11:()=>k,$$ACTION_12:()=>U,$$ACTION_13:()=>B,$$ACTION_14:()=>L,$$ACTION_15:()=>q,$$ACTION_2:()=>m,$$ACTION_3:()=>E,$$ACTION_4:()=>S,$$ACTION_5:()=>A,$$ACTION_6:()=>v,$$ACTION_7:()=>_,$$ACTION_8:()=>D,$$ACTION_9:()=>C,copyDiagnoses:()=>er,copyScreens:()=>ee,copyScripts:()=>V,countDiagnoses:()=>$,countScreens:()=>b,countScripts:()=>X,deleteDiagnoses:()=>T,deleteScreens:()=>j,deleteScripts:()=>G,deleteScriptsItems:()=>z,getDiagnoses:()=>Z,getDiagnosis:()=>N,getScreen:()=>I,getScreens:()=>w,getScript:()=>Y,getScripts:()=>W,getScriptsWithItems:()=>H,listScreens:()=>R,saveDiagnoses:()=>x,saveScreens:()=>O,saveScriptDiagnoses:()=>M,saveScriptScreens:()=>J,saveScripts:()=>P,saveScriptsWithItems:()=>Q});var t=a(24330);a(60166);var s=a(9576),c=a(49530),i=a(91966),o=a(13269),n=a(57435),d=a(88317),f=a(29712),l=a(20123);async function u(e,r){let a=r?.link,t=r?.baseURL;if(!e)throw Error("AXIOS init error: missing siteId");if(!r){let r=await (0,l._U)(e);if(r.errors?.length)throw Error("AXIOS init error: "+r.errors.join(", "));if(!r.data)throw Error("AXIOS init error: site not found");a=r.data.link,t=r.data.apiKey}let s=f.Z.create({baseURL:a});return s.interceptors.request.use(async e=>(e.headers&&(e.headers["x-api-key"]=t),n.Z.log(`AXIOS [${e.method}]`,[`${a}/api`,e.url].join("")),e)),s.interceptors.response.use(e=>e,e=>new Promise((r,a)=>a(e))),s}var h=a(66267),g=a(40618);let b=(0,t.j)("87e857cf3ff6395b6e2b0930ad3f852a82015e2f",p);async function p(...e){try{return await (0,h.isAllowed)(),await o.co(...e)}catch(e){return n.Z.error("countScreens ERROR",e.message),{errors:[e.message],data:o.W0}}}let w=(0,t.j)("4a894795d6b5cf7cc1b14b7c98dd07f683844ee4",y);async function y(...e){try{return await (0,h.isAllowed)(),await o.uK(...e)}catch(e){return n.Z.error("getScreens ERROR",e.message),{errors:[e.message],data:[]}}}let R=(0,t.j)("3aa0d4b564ff3dbb11cb61a669f66142ba12a143",m);async function m(...e){try{return await (0,h.isAllowed)(),await o.f(...e)}catch(e){return n.Z.error("listScreens ERROR",e.message),{errors:[e.message],data:[]}}}let I=(0,t.j)("d5e73aed69146feafc514cdc1db03d07428838d3",E);async function E(...e){return await (0,h.isAllowed)(),await o.NB(...e)}let j=(0,t.j)("571731a47b0bd5f8c21bbb3918be027b7d89353a",S);async function S(...e){try{return await (0,h.isAllowed)(),await i.GH(...e)}catch(e){return n.Z.error("deleteScreens ERROR",e.message),{errors:[e.message],success:!1}}}let O=(0,t.j)("cf54aed3f76af353b32cd33448010c74826dd22f",A);async function A(...e){try{return await (0,h.isAllowed)(),await i.uD(...e)}catch(e){return n.Z.error("getSys ERROR",e.message),{errors:[e.message],data:void 0,success:!1}}}let $=(0,t.j)("d9e27ef3b98ce1fa44c4ce962444115dab201438",v);async function v(...e){try{return await (0,h.isAllowed)(),await o.tW(...e)}catch(e){return n.Z.error("countDiagnoses ERROR",e.message),{errors:[e.message],data:o.GM}}}let Z=(0,t.j)("088fa19297738e17a7ed36990d12307af0c86a1f",_);async function _(...e){try{return await (0,h.isAllowed)(),await o.XA(...e)}catch(e){return n.Z.error("getDiagnoses ERROR",e.message),{errors:[e.message],data:[]}}}let N=(0,t.j)("87ddbbf6cd0f1083bf65f89106c3f148043529fc",D);async function D(...e){return await (0,h.isAllowed)(),await o.Ew(...e)}let T=(0,t.j)("bb7aa47cfc098c92b59003ff9c78c51723cfc66a",C);async function C(...e){try{return await (0,h.isAllowed)(),await i.Bx(...e)}catch(e){return n.Z.error("deleteDiagnoses ERROR",e.message),{errors:[e.message],success:!1}}}let x=(0,t.j)("05e8ab2c1eb2ea66ff9bc82f207492cbd8f5533a",K);async function K(...e){try{return await (0,h.isAllowed)(),await i.Pk(...e)}catch(e){return n.Z.error("getSys ERROR",e.message),{errors:[e.message],data:void 0,success:!1}}}let X=(0,t.j)("42b6ca705452858f68242195eb1f03faae894d74",k);async function k(...e){try{return await (0,h.isAllowed)(),await o.ix(...e)}catch(e){return n.Z.error("countScripts ERROR",e.message),{errors:[e.message],data:o.Zu}}}let W=(0,t.j)("6288bb4804a3de82eaace6181af69c05430b78d8",U);async function U(...e){try{return await (0,h.isAllowed)(),await o.Tw(...e)}catch(e){return n.Z.error("getScripts ERROR",e.message),{errors:[e.message],data:[]}}}let Y=(0,t.j)("8d2e12b35a9b12947084a1f31cefeebcbace0cc1",B);async function B(...e){return await (0,h.isAllowed)(),await o.bK(...e)}let G=(0,t.j)("48cb3ad31d91b7da73f77bfa04744c1052bcfb9d",L);async function L(...e){try{return await (0,h.isAllowed)(),await i.Es(...e)}catch(e){return n.Z.error("deleteScripts ERROR",e.message),{errors:[e.message],success:!1}}}let P=(0,t.j)("1511c19ef4513922414003d6b9fb4bc42877a7d9",q);async function q(...e){try{return await (0,h.isAllowed)(),await i.Or(...e)}catch(e){return n.Z.error("getSys ERROR",e.message),{errors:[e.message],data:void 0,success:!1}}}async function H(e){let r=[],a=[];try{let t=e?.returnDraftsIfExist!==!1,s=await o.Tw({...e,returnDraftsIfExist:t});for(let e of(s.errors?.forEach(e=>a.push(e)),s.data)){let s=await o.uK({scriptsIds:[e.scriptId],returnDraftsIfExist:t}),c=await o.XA({scriptsIds:[e.scriptId],returnDraftsIfExist:t});s.errors?.forEach(e=>a.push(e)),c.errors?.forEach(e=>a.push(e)),r.push({...e,screens:s.data,diagnoses:c.data})}if(a.length)return{errors:a,data:[]};return{data:r}}catch(e){return n.Z.error("getScriptsWithItems ERROR",e.message),{data:[],errors:[e.message]}}}async function J({screens:e,scriptId:r}){try{let a=0,t=[],c=await o.bK({scriptId:r,returnDraftIfExists:!0});if(c.errors?.length)throw Error(c.errors.join(", "));if(!c.data)throw Error("Script not found");for(let i of e){let{id:e,publishDate:o,createdAt:n,updatedAt:d,isDraft:f,deletedAt:l,version:u,oldScriptId:h,oldScreenId:g,screenId:b,scriptId:p,position:w,...y}=i,R=(0,s.Z)(),m=await O({data:[{...y,scriptId:r,oldScriptId:c.data.oldScriptId,screenId:R,version:1}]});m.errors?.forEach(e=>t.push(`(screenId=${b}) ${e||""}`)),!m.errors?.length&&a++}if(t.length)return{errors:t,saved:a,success:!1};return{saved:a,success:!0}}catch(e){return n.Z.error("saveScriptScreens ERROR",e.message),{saved:0,success:!1,errors:[e.message]}}}async function M({diagnoses:e,scriptId:r}){try{let a=0,t=[],c=await o.bK({scriptId:r,returnDraftIfExists:!0});if(c.errors?.length)throw Error(c.errors.join(", "));if(!c.data)throw Error("Script not found");for(let i of e){let{id:e,publishDate:o,createdAt:n,updatedAt:d,isDraft:f,deletedAt:l,version:u,oldDiagnosisId:h,diagnosisId:g,scriptId:b,position:p,...w}=i,y=(0,s.Z)(),R=await x({data:[{...w,scriptId:r,oldScriptId:c.data.oldScriptId,diagnosisId:y,version:1}]});R.errors?.forEach(e=>t.push(`(diagnosisId=${g}) ${e||""}`)),!R.errors?.length&&a++}if(t.length)return{errors:t,saved:a,success:!1};return{saved:a,success:!0}}catch(e){return n.Z.error("saveScriptDiagnoses ERROR",e.message),{saved:0,success:!1,errors:[e.message]}}}async function z({scriptsIds:e}){try{let r=[],a=await j({scriptsIds:e});a.errors?.forEach(e=>r.push(e));let t=await T({scriptsIds:e});if(t.errors?.forEach(e=>r.push(e)),r.length)return{errors:r,success:!1};return{success:!0}}catch(e){return n.Z.error("deleteScriptsItems ERROR",e.message),{success:!1,errors:[e.message]}}}let F={scripts:0,screens:0,diagnoses:0};async function Q({data:e}){let r={...F};try{let a=[];for(let{overWriteScriptWithId:t,...c}of e){let e=t?await Y({scriptId:t,returnDraftIfExists:!0}):{data:null};if(e.errors?.forEach(e=>a.push(e)),a.length)continue;if(t&&!e?.data){a.push("Overwrite script was not found");continue}if(e?.data){let r=await z({scriptsIds:[e.data.scriptId]});if(r.errors?.forEach(e=>a.push(e)),a.length)continue}let{id:i,screens:o=[],diagnoses:n=[],publishDate:d,createdAt:f,updatedAt:l,isDraft:u,deletedAt:h,version:g,oldScriptId:b,scriptId:p,position:w,...y}=c,R=e?.data?.scriptId||(0,s.Z)(),m=await P({data:[{...y,scriptId:R,version:1}]});if(m.errors?.forEach(e=>a.push(e)),a.length)continue;r.scripts++;let I=await J({scriptId:R,screens:o});r.screens+=I.saved;let E=await M({scriptId:R,diagnoses:n});r.diagnoses+=E.saved}if(a.length)return{success:!1,errors:a,info:r};return{success:!0,info:r}}catch(e){return n.Z.error("saveScriptsWithItems ERROR",e.message),{success:!1,errors:[e.message],info:r}}}async function V(e){let r={...F},{scriptsIds:a=[],confirmCopyAll:t,toRemoteSiteId:s,fromRemoteSiteId:i,broadcastAction:o,overWriteScriptWithId:f}={...e};try{if(!a.length&&!t)throw Error("You&apos;re about copy all the scripts, please confirm this action!");let e=i?{data:[]}:await H({scriptsIds:a});if(e.errors)return{success:!1,errors:e.errors,info:r};if(i){let t=await u(i),s=(await t.get("/api/scripts/with-items?"+c.Z.stringify({scriptsIds:JSON.stringify(a)}))).data;if(s.errors)return{success:!1,errors:s.errors,info:r};e=s}let n={success:!0,info:r};if(e.data.length){if(s){let r=await u(s);n=(await r.post("/api/scripts/with-items?",{data:e.data.map(e=>({...e,hospitalId:void 0,hospitalName:void 0}))})).data}else n=await Q({data:e.data.map(e=>({...e,overWriteScriptWithId:f,hospitalId:void 0,hospitalName:void 0}))})}return o&&!n?.errors?.length&&d.Z.emit("data_changed","copy_scripts"),n}catch(e){return n.Z.error("copyScripts ERROR",e.response?.data?.errors?.join(", ")||e.message),{errors:e.response?.data?.errors||[e.message],success:!1,info:r}}}async function ee(e){let r=0,{screensIds:a=[],fromScriptsIds:t=[],toScriptsIds:s=[],confirmCopyAll:c,broadcastAction:i}={...e};try{let e=[];if(!t.length&&!a.length&&!c)throw Error("You&apos;re about to copy all the screens, please confirm this action!");let n=await o.uK({scriptsIds:t,screensIds:a,returnDraftsIfExist:!0});if(n.errors?.length)throw Error(n.errors.join(", "));if(s.length)for(let a of s){let t=await J({scriptId:a,screens:n.data});t.errors?.forEach(r=>e.push(r)),!e.length&&r++}else{let a=n.data.reduce((e,r)=>({...e,[r.scriptId]:[...e[r.scriptId]||[],r]}),{});for(let t of Object.keys(a)){let s=await J({scriptId:t,screens:a[t]});s.errors?.forEach(r=>e.push(r)),e.length||(r+=s.saved)}}return i&&!e.length&&d.Z.emit("data_changed","copy_scripts"),{copied:r,success:!e.length,errors:e.length?e:void 0}}catch(e){return n.Z.error("copyScreens ERROR",e.message),{errors:[e.message],success:!1,copied:r}}}async function er(e){let r=0,{diagnosesIds:a=[],fromScriptsIds:t=[],toScriptsIds:s=[],confirmCopyAll:c,broadcastAction:i}={...e};try{let e=[];if(!t.length&&!a.length&&!c)throw Error("You&apos;re about to copy all the diagnoses, please confirm this action!");let n=await o.XA({scriptsIds:t,diagnosesIds:a,returnDraftsIfExist:!0});if(n.errors?.length)throw Error(n.errors.join(", "));if(s.length)for(let a of s){let t=await M({scriptId:a,diagnoses:n.data});t.errors?.forEach(r=>e.push(r)),!e.length&&r++}else{let a=n.data.reduce((e,r)=>({...e,[r.scriptId]:[...e[r.scriptId]||[],r]}),{});for(let t of Object.keys(a)){let s=await M({scriptId:t,diagnoses:a[t]});s.errors?.forEach(r=>e.push(r)),e.length||(r+=s.saved)}}return i&&!e.length&&d.Z.emit("data_changed","copy_scripts"),{copied:r,success:!e.length,errors:e.length?e:void 0}}catch(e){return n.Z.error("copyDiagnoses ERROR",e.message),{errors:[e.message],success:!1,copied:r}}}(0,g.h)([b,w,R,I,j,O,$,Z,N,T,x,X,W,Y,G,P,H,J,M,z,Q,V,ee,er]),(0,t.j)("d3dfb05b6962621e399227ba261983f9495fb5a5",b),(0,t.j)("d3ac4d264976b14d511e92b98e57e5020674ccae",w),(0,t.j)("44cb4379b90fc45300db3daa2b58f5659b2229fd",R),(0,t.j)("a5f91b7007fbfa597dab1634587268a6df569273",I),(0,t.j)("a7ca28e7614edaf2e6b5ccee56d7164c19c41000",j),(0,t.j)("ecc69ba9880b93912552464ca23f9c9f62aa03a7",O),(0,t.j)("0e38be4b50836504c7f67b93fb7ae3cf5f2e9c22",$),(0,t.j)("3b62f127aaaccc86f5c11a9cee428c085206a5bb",Z),(0,t.j)("28f338ad272f084dccac4a17a825071030625cf4",N),(0,t.j)("41bf61e6499b298b6d973285db88ca8adb7ea40a",T),(0,t.j)("baaaf52a0b382f1efd6d584fc61203bd8b88d2b3",x),(0,t.j)("c423e270d97a3bdc414a4b6af94f0da37244d751",X),(0,t.j)("6e6440b75e5eca1d3f2e9eea168a2def1055ff65",W),(0,t.j)("81d6ee191490d4c72c2a4fbc7ff2d66823517be9",Y),(0,t.j)("6d5f825048092bdc85e12871d189e55584a9bd66",G),(0,t.j)("947e034f370ce58f143d0f5b4bdc00d9d653e029",P),(0,t.j)("797262d27036c70ce881164328adcd6c008a8872",H),(0,t.j)("02daafb4339f92c64aab36b56610977e13635f0f",J),(0,t.j)("e95ca417790d107bc4d49b348f1c83b1955f0c9a",M),(0,t.j)("df94185aaee131de90c17c7b082714e1f780f1c1",z),(0,t.j)("40e010843f3a8ebeab26c3e97be909c476c8560a",Q),(0,t.j)("d85d59b51ce7aeff48d5f7157a5de30f048c58ef",V),(0,t.j)("09a000ab8c4a9178389156b1588727a549373f45",ee),(0,t.j)("4d3829ca121a05e07de85632383e564f5826b579",er)}};