"use strict";exports.id=4635,exports.ids=[4635,7636],exports.modules={69486:(e,a,t)=>{t.d(a,{D:()=>r});var l=t(10326),s=t(77863);function r({children:e,className:a}){return l.jsx("div",{className:(0,s.cn)("pb-1 border-b border-b-primary",a),children:l.jsx("span",{className:"uppercase text-primary text-sm",children:e})})}},48488:(e,a,t)=>{t.d(a,{U:()=>r,w:()=>i});var l=t(17577),s=t(47463);function r(e){return{getDefaultValues:(0,l.useCallback)(()=>({...e,fieldId:e?.fieldId||(0,s.Z)(),type:e?.type||"",key:e?.key||"",keyId:e?.keyId||"",label:e?.label||"",refKey:e?.refKey||"",refKeyId:e?.refKeyId||"",calculation:e?.calculation||"",condition:e?.condition||"",dataType:e?.dataType||"",defaultValue:e?.defaultValue||"",format:e?.format||"",minValue:e?.minValue||"",maxValue:e?.maxValue||"",minDate:e?.minDate||"",maxDate:e?.maxDate||"",minTime:e?.minTime||"",maxTime:e?.maxTime||"",minDateKey:e?.minDateKey||"",maxDateKey:e?.maxDateKey||"",minTimeKey:e?.minTimeKey||"",maxTimeKey:e?.maxTimeKey||"",minDateKeyId:e?.minDateKeyId||"",maxDateKeyId:e?.maxDateKeyId||"",minTimeKeyId:e?.minTimeKeyId||"",maxTimeKeyId:e?.maxTimeKeyId||"",values:e?.values||"",valuesOptions:e?.valuesOptions||[],confidential:e?.confidential||!1,optional:e?.optional||!1,printable:e?.printable||!1,prePopulate:e?.prePopulate||[],editable:e?.editable||!1,items:e?.items||[]}),[e])}}function i(e){return{getDefaultValues:(0,l.useCallback)(()=>({label:e?.label||"",screen:e?.screen||"",...e}),[e])}}},29354:(e,a,t)=>{t.d(a,{h:()=>i});var l=t(10326),s=t(38178),r=t(77863);function i({children:e,className:a}){return(0,l.jsxs)(l.Fragment,{children:[l.jsx("div",{className:"h-16"}),l.jsx("div",{className:(0,r.cn)(`
                        fixed 
                        left-0 
                        bottom-0 
                        h-16 
                        w-full 
                        border-t 
                        border-t-border 
                        z-[1] 
                        bg-primary-foreground 
                        dark:bg-background 
                        shadow-md 
                        dark:shadow-foreground/10
                    `),children:l.jsx(s.V,{children:l.jsx("div",{className:(0,r.cn)("flex justify-end gap-x-4",a),children:e})})})]})}},7636:(e,a,t)=>{t.d(a,{DataTable:()=>w});var l=t(10326),s=t(17577),r=t(9439),i=t(61541),n=t(99598),d=t(15940),o=t(77863),c=t(90772),u=t(53313),m=t(65304),h=t(61198),f=t(60097),p=t(79256),x=t(25696),g=t(91216),y=t(47206);let b=[{value:"asc",label:"Asc",Icon:p.Z},{value:"desc",label:"Desc",Icon:x.Z},{value:"hide",label:"Hide",divider:!0,Icon:g.Z}],v=({column:e,value:a,onFilter:t})=>{let s=b.filter(e=>e.value===a)[0],r=s?.Icon||y.Z;return(0,l.jsxs)(f.h_,{children:[l.jsx(f.$F,{asChild:!0,children:(0,l.jsxs)(c.z,{variant:"ghost",size:"sm",className:" focus-visible:ring-0  focus-visible:ring-transparent  focus-visible:ring-offset-0 ",children:[l.jsx("span",{className:"mr-2",children:e.name}),l.jsx(r,{className:"w-4 h-4"})]})}),l.jsx(f.AW,{align:"end",children:b.filter(a=>"hide"!==a.value||!1!==e.canHide).map(e=>(0,l.jsxs)(f.Xi,{onClick:()=>t(e.value),className:(0,o.cn)(e.divider?"border-t":""),children:[l.jsx(e.Icon,{className:"w-4 h-4 mr-2"}),e.label]},e.value))})]})},j=(0,s.forwardRef)(({searchButton:e,hideSearchButton:a,...t},s)=>l.jsx(l.Fragment,{children:(0,l.jsxs)("div",{className:(0,o.cn)("flex w-full"),children:[l.jsx("div",{className:(0,o.cn)("relative w-full"),children:l.jsx("input",{ref:s,type:"search",placeholder:"Search",...t,className:(0,o.cn)("w-full pl-4 py-2 rounded-l-full border focus:outline-none focus:border-secondary bg-transparent",t.className)})}),!a&&l.jsx("button",{type:"button",className:(0,o.cn)("px-5 py-2.5 transition-colors bg-transparent border border-l-0 rounded-r-full hover:bg-secondary/10 disabled:opacity-50 disabled:cursor-not-allowed",e?.className),...e,children:l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"size-5",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"})})})]})}));function N({title:e,search:a,headerActions:t}){let r=!a&&!e&&!t,[i,n]=(0,s.useState)(a?.value||"");return r?null:l.jsx(l.Fragment,{children:l.jsx("div",{className:"px-4 py-4 flex flex-col gap-y-2",children:(0,l.jsxs)("div",{className:"flex flex-col gap-y-2 md:flex-row md:gap-y-0 md:gap-x-2",children:[(0,l.jsxs)("div",{className:(0,o.cn)("flex items-center gap-x-2",!e&&"hidden"),children:[!!e&&l.jsx("div",{className:(0,o.cn)("md:mr-auto","string"==typeof e?"text-2xl":""),children:e}),l.jsx("div",{className:"ml-auto"})]}),l.jsx("div",{className:(0,o.cn)("flex-1",!a&&"hidden"),children:!!a&&l.jsx("form",{onSubmit:e=>{e.preventDefault(),e.stopPropagation(),i&&a?.setValue?.(i)},children:l.jsx(j,{placeholder:a?.inputPlaceholder||"Search",value:i,onChange:e=>{let t=e.target.value;n(t),t||a?.setValue?.(t)},searchButton:{type:"submit"}})})}),l.jsx("div",{className:(0,o.cn)("flex flex-row flex-wrap gap-x-2 gap-y-1 md:ml-auto",!t&&"hidden"),children:t})]})})})}j.displayName="SearchInput";let w=e=>{let{selectable:a=!1,loading:t,sortable:f,tableClassname:p,tableRowClassname:x,tableBodyClassname:g,filter:y,onSort:b}=e,j=(0,s.useRef)(null),{searchValue:w,state:{columns:k,rows:C,skeletonRows:I,selected:S},setSearchValue:T,setState:D,setFilter:V,setSelected:R,toggleColumn:$}=function({props:e}){(0,s.useRef)(!1);let{selectable:a,sortable:t,selectedIndexes:l,columns:r,data:i,maxRows:n,search:d,onFilteredRowsChange:o,onSelect:c}=e,[u,m]=(0,s.useState)(""),f=(0,h.N)(d?.value||u),p=(0,s.useCallback)((e="")=>{m(e),d?.setValue?.(e)},[d]),[x,g]=(0,s.useState)({selected:{},columns:[],unfilteredRows:[],rows:[],skeletonRows:[]});(0,s.useCallback)(()=>a?{...l?.reduce((e,a)=>({...e,[a]:!0}),{})}:{},[l,a]);let y=(0,s.useCallback)(e=>{let a=[];g(t=>{let l=e.length===t.rows.length,s=Object.values(t.selected).filter(e=>e).length===t.rows.length,r={...t.selected};return e.forEach(e=>{r[e]=l?!s:!r[e]}),a=Object.keys(r).filter(e=>r[e]).map(e=>Number(e)),{...t,selected:r}}),c?.(a)},[g,c]);return{state:x,searchValue:f,setSearchValue:p,setState:g,setSelected:y,toggleColumn:e=>g(a=>{let t=[...a.columns].map(a=>({...a,filter:null,hidden:a.columnIndex===e?!a.hidden:a.hidden}));return{...a,columns:t}}),setFilter:(e,a)=>g(t=>{let l=[...t.columns].map(t=>{let l=t.columnIndex===e?a:null;return{...t,filter:l}}),s=l.filter(a=>a.columnIndex===e)[0],r=[...t.rows];return a&&(r=function({column:e,rows:a}){return a.sort((a,t)=>{let l=a.cells.filter(a=>a.columnIndex===e.columnIndex)[0].value||"",s=t.cells.filter(a=>a.columnIndex===e.columnIndex)[0].value||"",r=0;if("number"===e.filterType){let a=Number(l),t=Number(s);if(!(isNaN(a)||isNaN(t)))switch(e.filter){case"asc":r=a-t;break;case"desc":r=t-a}}else if("text"===e.filterType)switch(e.filter){case"asc":r=l.localeCompare(s);break;case"desc":r=s.localeCompare(l)}return r})}({rows:r,column:s})),{...t,columns:l,rows:r}})}}({props:e}),Z=(0,s.useMemo)(()=>t?I:C,[t,I,C]),_=(0,s.useCallback)((e,a)=>{let t=[];D(l=>{let s=(0,i.q)([...l.rows],e,a);return t=s.map((e,a)=>({oldIndex:e.rowIndex,newIndex:a})),{...l,rows:s}}),b?.(e,a,t),R([])},[D,b,R]),K=!w&&f&&!e.rowRenderer;return(0,l.jsxs)(l.Fragment,{children:[l.jsx(N,{...e,search:e.search?{...e.search,value:w,setValue:T}:void 0}),l.jsx(r.ZP,{allowDrag:!!K,onSortEnd:_,draggedItemClassName:"opacity-90 z-[9999999999999]",customHolderRef:j,children:l.jsx("div",{className:"space-y-4",children:(0,l.jsxs)(d.iA,{className:(0,o.cn)("w-full overflow-x-auto",p),children:[l.jsx(d.xD,{className:(0,o.cn)(e.theadClassName),children:(0,l.jsxs)(d.SC,{children:[a&&l.jsx(d.ss,{className:(0,o.cn)(k[0]?.cellClassName,"w-8"),children:l.jsx(u.X,{disabled:t,checked:!!Z.length&&Object.values(S).filter(e=>e).length===Z.length,onCheckedChange:()=>R(Z.map(e=>e.rowIndex))})}),K&&l.jsx(d.ss,{className:(0,o.cn)(k[0]?.cellClassName,"w-4")}),k.map(a=>l.jsx(d.ss,{colSpan:a.colSpan,align:a.align,className:(0,o.cn)(e.cellClassName,e.thClassName,a.cellClassName,a.thClassName,"px-2",a.hidden?"hidden":"",a.align?({left:"text-left",center:"text-center",right:"text-right",justify:"text-justify",char:""})[a.align]:""),children:(()=>{switch(a.filterType){case"number":case"text":return l.jsx(v,{column:a,value:a.filter,onFilter:e=>{"hide"===e?$(a.columnIndex):V(a.columnIndex,e)}});default:return l.jsx(c.z,{variant:"ghost",size:"sm",className:" focus-visible:ring-0  focus-visible:ring-transparent  focus-visible:ring-offset-0 hover:bg-transparent hover:text-primary ",children:a.name||""})}})()},a.id))]})}),(0,l.jsxs)(d.RM,{ref:j,className:g,children:[!Z.length&&l.jsx(d.SC,{className:"p-0",children:l.jsx(d.pj,{colSpan:k.length+(a?1:0)+(K?1:0),className:"p-4 text-center text-muted-foreground",children:e.noDataMessage||"No data to display"})}),Z.map(i=>{if(y&&!y(i.rowIndex))return null;let c={...e.getRowOptions?.({rowIndex:i.rowIndex})};c={...c,className:(0,o.cn)(e.trClassName,"hover:bg-primary/10",S[i.rowIndex]?"bg-primary/10":"",x,c.className)};let h=[...a?[l.jsx(d.pj,{className:(0,o.cn)(k[0]?.cellClassName,"w-8"),children:l.jsx(u.X,{disabled:t,checked:!!S[i.rowIndex],onCheckedChange:()=>R([i.rowIndex])})},"select-checkbox")]:[],...K?[l.jsx(d.pj,{className:(0,o.cn)(k[0]?.cellClassName,"w-4 cursor-move"),children:l.jsx(r.TI,{children:l.jsx(n.Z,{className:"w-4 h-4 text-muted-foreground"})})},"sort-handle")]:[],...i.cells.map(a=>{let r=k[a.columnIndex],n={...e.getCellOptions?.({rowIndex:i.rowIndex,columnIndex:a.columnIndex})};return(0,s.createElement)(d.pj,{...n,key:a.id,colSpan:r.colSpan,align:r.align,className:(0,o.cn)(e.cellClassName,e.tdClassName,r.cellClassName,r.tdClassName,"px-4",n.className,r.hidden?"hidden":"")},t?l.jsx(m.O,{className:"h-4 w-[120px] bg-black/10 dark:bg-white/10"}):r.cellRenderer?r.cellRenderer(a):a.value)})];return e.rowRenderer?e.rowRenderer({props:c,cells:h,rowIndex:i.rowIndex}):l.jsx(r.TR,{children:l.jsx(d.SC,{...c,children:h})},i.id)})]})]})})})]})}},63148:(e,a,t)=>{t.d(a,{_:()=>r});var l=t(10326),s=t(33071);function r({children:e,errors:a=[]}){return l.jsx(l.Fragment,{children:l.jsx(s.Zb,{className:"bg-destructive/20 border-destructive text-destructive",children:(0,l.jsxs)(s.aY,{className:"flex flex-col gap-y-4 px-4 py-2",children:[e,!!a.length&&l.jsx("div",{children:a.map((e,a)=>{let t=`${a}`;return l.jsx("p",{children:e},t)})})]})})})}},54328:(e,a,t)=>{t.d(a,{O:()=>m});var l=t(10326),s=t(17577),r=t(9015),i=t(30811),n=t(51605),d=t(77863),o=t(11870),c=t(44099),u=t(63148);let m=(0,s.forwardRef)(({isDraft:e,userId:a,dataType:t,card:m},h)=>{let f=(0,n.v)({isDraft:e,userId:a});(0,s.useImperativeHandle)(h,()=>({isLocked:f}),[f]);let{loading:p,error:x,user:g,getUser:y}=function({userId:e,loadOnMount:a=!1}){(0,s.useRef)(!1);let[t,l]=(0,s.useState)(!1),[r,i]=(0,s.useState)(null),[n,d]=(0,s.useState)(""),o=(0,s.useCallback)(async(a=e)=>{try{if(d(""),!t&&e){l(!0);let e=(await c.Z.get(`/api/users/${a}`)).data;i(e)}}catch(e){d(e.message)}finally{l(!1)}},[t,e]);return{loading:t,user:r,error:n,getUser:o}}({userId:a,loadOnMount:!!m}),b=(0,s.useCallback)(async e=>{e&&!p&&!g&&a&&y()},[a,g,p]);return m&&f&&!p?l.jsx(u._,{children:(0,l.jsxs)("div",{className:"flex items-center gap-x-4",children:[l.jsx(r.Z,{className:"w-4 h-4"}),g?(0,l.jsxs)("div",{children:[l.jsx("strong",{children:g.displayName})," is working on this ",t||""]}):null]})}):l.jsx(l.Fragment,{children:(0,l.jsxs)(i.J2,{onOpenChange:b,children:[l.jsx(i.xo,{asChild:!0,children:l.jsx("button",{disabled:!f,children:l.jsx(r.Z,{className:(0,d.cn)("w-4 h-4 text-destructive/80",!f&&"opacity-0")})})}),l.jsx(i.yk,{className:"p-0 text-sm max-w-[200px]",children:p?l.jsx("div",{className:"p-2 flex justify-center",children:l.jsx(o.a,{padding:0})}):x||!g?l.jsx("div",{className:"p-2 text-destructive bg-destructive/20",children:x||"Failed to load user!"}):(0,l.jsxs)("div",{className:"p-2",children:[l.jsx("strong",{children:g.displayName})," is working on this ",t||""]})})]})})});m.displayName="LockStatus"},18048:(e,a,t)=>{t.d(a,{u:()=>n});var l=t(10326);t(17577);var s=t(62288),r=t(77863);let i=(0,t(60114).Ue)((e,a)=>({modals:{},open(a){e(e=>({modals:{...e.modals,[a]:!0}}))},toggle(t){let l=a().modals;e(e=>({modals:{...e.modals,[t]:!l[t]}}))},close(a){e(e=>({modals:{...e.modals,[a]:!1}}))},isOpen:e=>!!a().modals[e],set(a){e(e=>({modals:{...e.modals,...a}}))}}));function n({id:e,children:a,title:t,description:n,actions:d,trigger:o,contentProps:c,footerProps:u,...m}){let{close:h,isOpen:f,set:p}=i();return l.jsx(l.Fragment,{children:(0,l.jsxs)(s.Vq,{...m,open:(e?f(e):void 0)||m.open,onOpenChange:a=>{e&&p({[e]:a}),m?.onOpenChange?.(a)},children:[o,(0,l.jsxs)(s.cZ,{hideCloseButton:!0,className:(0,r.cn)("flex flex-col max-h-[90%] gap-y-4 p-0 m-0 sm:max-w-xl",c?.className),...c,children:[(0,l.jsxs)(s.fK,{className:(0,r.cn)(t||n?"":"hidden","border-b border-b-border px-4 py-4"),children:[l.jsx(s.$N,{className:(0,r.cn)(t?"":"hidden"),children:t}),l.jsx(s.Be,{className:(0,r.cn)(n?"":"hidden"),children:n})]}),l.jsx("div",{className:"flex-1 flex flex-col overflow-y-auto px-4 py-2",children:a}),l.jsx(s.cN,{className:(0,r.cn)("border-t border-t-border px-4 py-2 items-center w-full",d?"":"hidden",u?.className),...u,children:d})]})]})})}},99463:(e,a,t)=>{t.d(a,{w:()=>h});var l=t(10326),s=t(17577),r=t(74723),i=t(58464),n=t(7890),d=t(34474),o=t(31048),c=t(53313),u=t(90772),m=t(77863);function h({id:e,label:a,hide:t,title:h,description:f,data:p,disabled:x,onSave:g}){let y=(0,s.useMemo)(()=>{let a=!1;return Object.values(p).forEach(t=>{t[e]&&(a=!0)}),a},[p,e]),{reset:b,watch:v,setValue:j,handleSubmit:N}=(0,r.cI)({defaultValues:{...i.$7,...p}}),w=v("fontSize"),k=v("fontWeight"),C=v("fontStyle"),I=v("textColor"),S=N(g),[T,D]=(0,s.useState)(!1);return t?null:l.jsx(l.Fragment,{children:(0,l.jsxs)(n.yo,{onOpenChange:e=>{b({...i.$7,...p}),D(e)},children:[l.jsx(n.aM,{asChild:!0,children:l.jsx(u.z,{variant:"link",className:(0,m.cn)("p-0 text-xs",!y&&"text-muted-foreground/80 hover:text-muted-foreground"),children:a||`${y?"Update":"Set"} preferences`})}),(0,l.jsxs)(n.ue,{hideCloseButton:!0,className:"px-0 py-0 flex flex-col gap-y-4 h-full",children:[(0,l.jsxs)(n.Tu,{className:"px-4 py-4 border-b border-b-border",children:[l.jsx(n.bC,{children:h}),l.jsx(n.Ei,{className:f?"":"hidden",children:f})]}),l.jsx("div",{className:"flex-1 overflow-y-auto px-4 flex flex-col gap-y-6",children:T&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"flex gap-x-2 items-center",children:[l.jsx(o._,{secondary:!0,htmlFor:`fontSize.${e}`,children:"Font size"}),l.jsx("div",{children:(0,l.jsxs)(d.Ph,{value:w[e]||"default",required:!0,name:`fontSize.${e}`,disabled:x,onValueChange:a=>{let t=a||void 0;"default"===t&&(t=void 0),j(`fontSize.${e}`,t,{shouldDirty:!0})},children:[l.jsx(d.i4,{children:l.jsx(d.ki,{placeholder:"Default"})}),l.jsx(d.Bw,{children:l.jsx(d.DI,{children:[{label:"Default",value:"default"},{label:"Extra small",value:"xs"},{label:"Small",value:"sm"},{label:"Large",value:"lg"},{label:"Extra large",value:"xl"}].map(e=>l.jsx(d.Ql,{value:e.value,children:e.label},e.value))})})]})})]}),l.jsx("div",{children:(0,l.jsxs)("div",{className:"flex flex-col gap-2",children:[!!I[e]&&(0,l.jsxs)("div",{className:"flex gap-x-2 items-center",children:[l.jsx(o._,{secondary:!0,htmlFor:`textColor.${e}`,children:"Text color"}),l.jsx("input",{type:"color",value:I[e],onChange:a=>j(`textColor.${e}`,a.target.value,{shouldDirty:!0})})]}),(0,l.jsxs)("div",{className:"flex gap-x-2",children:[l.jsx(c.X,{id:`defaultTextColor.${e}`,name:`defaultTextColor.${e}`,disabled:x,checked:!I[e],onCheckedChange:()=>{let a=I[e]?void 0:"#000000";j(`textColor.${e}`,a,{shouldDirty:!0})}}),l.jsx(o._,{secondary:!0,htmlFor:`defaultTextColor.${e}`,children:"Default text color"})]})]})}),(0,l.jsxs)("div",{className:"flex gap-4 flex-wrap",children:[(0,l.jsxs)("div",{className:"flex gap-x-2",children:[l.jsx(c.X,{name:"bold",id:"bold",disabled:x,checked:"bold"===k[e],onCheckedChange:()=>j(`fontWeight.${e}`,k[e]?void 0:"bold",{shouldDirty:!0})}),l.jsx(o._,{secondary:!0,htmlFor:"bold",children:"Bold"})]}),(0,l.jsxs)("div",{className:"flex gap-x-2",children:[l.jsx(c.X,{name:"italic",id:"italic",disabled:x,checked:(C[e]||[]).includes("italic"),onCheckedChange:()=>{let a=C[e]||[];a.includes("italic")?a=a.filter(e=>"italic"!==e):a.push("italic"),a.length||(a=void 0),j(`fontStyle.${e}`,a,{shouldDirty:!0})}}),l.jsx(o._,{secondary:!0,htmlFor:"italic",children:"Italic"})]})]})]})}),(0,l.jsxs)(n.FF,{className:"px-4 py-4 border-t border-t-border",children:[l.jsx("div",{className:"ml-auto"}),l.jsx(n.sw,{asChild:!0,children:l.jsx(u.z,{variant:"outline",children:"Cancel"})}),l.jsx(n.sw,{asChild:!0,children:l.jsx(u.z,{disabled:x,onClick:()=>S(),children:"Save"})})]})]})]})})}},53313:(e,a,t)=>{t.d(a,{X:()=>d});var l=t(10326),s=t(17577),r=t(13635),i=t(32933),n=t(77863);let d=s.forwardRef(({className:e,...a},t)=>l.jsx(r.fC,{ref:t,className:(0,n.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...a,children:l.jsx(r.z$,{className:(0,n.cn)("flex items-center justify-center text-current"),children:l.jsx(i.Z,{className:"h-4 w-4"})})}));d.displayName=r.fC.displayName},54432:(e,a,t)=>{t.d(a,{I:()=>i});var l=t(10326),s=t(17577),r=t(77863);let i=s.forwardRef(({className:e,type:a,noRing:t,error:s,...i},n)=>l.jsx("input",{type:a,className:(0,r.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t&&"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",s&&"border-danger",s&&!t&&"focus-visible:ring-danger",e),ref:n,...i}));i.displayName="Input"},34474:(e,a,t)=>{t.d(a,{Bw:()=>x,DI:()=>u,Ph:()=>c,Ql:()=>y,U$:()=>b,i4:()=>h,ki:()=>m,n5:()=>g});var l=t(10326),s=t(17577),r=t(44875),i=t(941),n=t(96633),d=t(32933),o=t(77863);let c=r.fC,u=r.ZA,m=r.B4,h=s.forwardRef(({className:e,children:a,error:t,...s},n)=>(0,l.jsxs)(r.xz,{ref:n,className:(0,o.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm placeholder:text-muted-foreground focus:outline-none disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t&&"border-danger",e),...s,children:[a,l.jsx(r.JO,{asChild:!0,children:l.jsx(i.Z,{className:"h-4 w-4 opacity-50"})})]}));h.displayName=r.xz.displayName;let f=s.forwardRef(({className:e,...a},t)=>l.jsx(r.u_,{ref:t,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",e),...a,children:l.jsx(n.Z,{className:"h-4 w-4"})}));f.displayName=r.u_.displayName;let p=s.forwardRef(({className:e,...a},t)=>l.jsx(r.$G,{ref:t,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",e),...a,children:l.jsx(i.Z,{className:"h-4 w-4"})}));p.displayName=r.$G.displayName;let x=s.forwardRef(({className:e,children:a,position:t="popper",...s},i)=>l.jsx(r.h_,{children:(0,l.jsxs)(r.VY,{ref:i,className:(0,o.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===t&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:t,...s,children:[l.jsx(f,{}),l.jsx(r.l_,{className:(0,o.cn)("p-1","popper"===t&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),l.jsx(p,{})]})}));x.displayName=r.VY.displayName;let g=s.forwardRef(({className:e,...a},t)=>l.jsx(r.__,{ref:t,className:(0,o.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...a}));g.displayName=r.__.displayName;let y=s.forwardRef(({className:e,children:a,...t},s)=>(0,l.jsxs)(r.ck,{ref:s,className:(0,o.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...t,children:[l.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:l.jsx(r.wU,{children:l.jsx(d.Z,{className:"h-4 w-4"})})}),l.jsx(r.eT,{children:a})]}));y.displayName=r.ck.displayName;let b=s.forwardRef(({className:e,...a},t)=>l.jsx(r.Z0,{ref:t,className:(0,o.cn)("-mx-1 my-1 h-px bg-muted",e),...a}));b.displayName=r.Z0.displayName},15940:(e,a,t)=>{t.d(a,{RM:()=>d,SC:()=>o,iA:()=>i,pj:()=>u,ss:()=>c,xD:()=>n});var l=t(10326),s=t(17577),r=t(77863);let i=s.forwardRef(({className:e,...a},t)=>l.jsx("div",{className:"relative w-full overflow-auto",children:l.jsx("table",{ref:t,className:(0,r.cn)("w-full caption-bottom text-sm",e),...a})}));i.displayName="Table";let n=s.forwardRef(({className:e,...a},t)=>l.jsx("thead",{ref:t,className:(0,r.cn)("[&_tr]:border-b",e),...a}));n.displayName="TableHeader";let d=s.forwardRef(({className:e,...a},t)=>l.jsx("tbody",{ref:t,className:(0,r.cn)("[&_tr:last-child]:border-0",e),...a}));d.displayName="TableBody",s.forwardRef(({className:e,...a},t)=>l.jsx("tfoot",{ref:t,className:(0,r.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...a})).displayName="TableFooter";let o=s.forwardRef(({className:e,...a},t)=>l.jsx("tr",{ref:t,className:(0,r.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...a}));o.displayName="TableRow";let c=s.forwardRef(({className:e,...a},t)=>l.jsx("th",{ref:t,className:(0,r.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...a}));c.displayName="TableHead";let u=s.forwardRef(({className:e,...a},t)=>l.jsx("td",{ref:t,className:(0,r.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...a}));u.displayName="TableCell",s.forwardRef(({className:e,...a},t)=>l.jsx("caption",{ref:t,className:(0,r.cn)("mt-4 text-sm text-muted-foreground",e),...a})).displayName="TableCaption"},87673:(e,a,t)=>{t.d(a,{g:()=>i});var l=t(10326),s=t(17577),r=t(77863);let i=s.forwardRef(({className:e,noRing:a,...t},s)=>l.jsx("textarea",{className:(0,r.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a&&"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",e),ref:s,...t}));i.displayName="Textarea"},61198:(e,a,t)=>{t.d(a,{N:()=>s});var l=t(17577);function s(e,a){let[t,s]=(0,l.useState)(e);return t}},75172:(e,a,t)=>{t.d(a,{a:()=>h});var l=t(17577),s=t(35047),r=t(15491),i=t(44099),n=t(60114),d=t(96221);t(63697);var o=t(11825);let c={value:"",filter:"all",searching:!1,results:[],unfilteredResults:[]},u={initialised:!1,loading:!1,keys:[],drugs:[],typeFilter:"",statusFilter:"",sortBy:"name-asc"},m=(0,n.Ue)(e=>u);function h(){let e=m(),{drugs:a,typeFilter:t,statusFilter:n,sortBy:h}=e,f=(0,s.useRouter)(),p=(0,s.useSearchParams)(),x=(0,l.useMemo)(()=>r.Z.parse(p.toString()),[p]),{itemId:g}=x,y=(0,l.useMemo)(()=>a.filter(e=>e.itemId===g||e.key===g)[0]?.itemId,[g,a]),{alert:b}=(0,d.s)(),[v,j]=(0,l.useState)(c),N=(0,l.useCallback)(()=>j(c),[]),w=(0,l.useCallback)(()=>{let e=[],l=v.value?new Set(v.results.map(e=>e.itemId)):void 0,s=a.map(e=>[e.drug||"",e.type||"",e.key||"",e.dosageText||"",e.itemId]),r=[...s=s.filter((s,r)=>{let i=a[r];if(!i)return!1;let d=!0;return l&&(d=l.has(i.itemId)),d&&t&&"all"!==t&&(d=(i.type||"").toLowerCase()===t.toLowerCase()),d&&n&&"all"!==n&&("draft"===n?d=!0===i.isDraft:"published"===n&&(d=!i.isDraft)),d&&e.push(a[r]),d})],i=[...e],d=r.map((e,a)=>({row:e,drug:i[a]}));switch(h){case"name-asc":d.sort((e,a)=>(e.drug.drug||"").localeCompare(a.drug.drug||""));break;case"name-desc":d.sort((e,a)=>(a.drug.drug||"").localeCompare(e.drug.drug||""));break;case"type-asc":d.sort((e,a)=>(e.drug.type||"").localeCompare(a.drug.type||""));break;case"type-desc":d.sort((e,a)=>(a.drug.type||"").localeCompare(e.drug.type||""));break;case"key-asc":d.sort((e,a)=>(e.drug.key||"").localeCompare(a.drug.key||""));break;case"key-desc":d.sort((e,a)=>(a.drug.key||"").localeCompare(e.drug.key||""))}return{tableData:d.map(e=>e.row),filteredDrugs:d.map(e=>e.drug)}},[a,v,t,n,h]),k=(0,l.useCallback)(async e=>{try{N();let a=`${e||""}`.trim();if(!a)return;j(e=>({...e,value:a,searching:!0}));let{data:t}=await i.Z.get(`/api/drugs-library/search?searchValue=${encodeURIComponent(a)}`);if(t.errors?.length)throw Error(t.errors.join(", "));j(e=>{let l=t.data||[];return{value:a,filter:e.filter,searching:!1,results:(0,o.UZ)({searchValue:a,filter:e.filter,results:l}),unfilteredResults:l}})}catch{N()}},[N]),{tableData:C,filteredDrugs:I}=(0,l.useMemo)(()=>w(),[w]),S=(0,l.useCallback)(async()=>{try{m.setState({loading:!0});let e=await i.Z.get("/api/drugs-library?data="+JSON.stringify({returnDraftsIfExist:!0}));if(e.data.errors?.length)throw Error(e.data.errors?.join(", "));m.setState({drugs:e.data.data})}catch(e){b({title:"Error",message:e.message,variant:"error"})}finally{m.setState({loading:!1})}},[b]);!function({events:e}){(0,l.useMemo)(()=>e,[e]),(0,l.useRef)({eventsTimeouts:{},eventsTimestamps:{}}),(0,l.useRef)(new Date().getTime()),(0,s.useRouter)()}({events:[{name:"data_changed",onEvent:{callback:async()=>{await S(),f.refresh()}}}]});let T=(0,l.useCallback)(async e=>{try{m.setState(a=>({loading:!0,drugs:a.drugs.filter(a=>!e.includes(a.itemId))}));let a=await i.Z.delete("/api/drugs-library?data="+JSON.stringify({itemsIds:e}));if(a.data.errors?.length)throw Error(a.data.errors?.join(", "));f.refresh(),b({title:"",message:"Drug deleted successfully!",variant:"success"})}catch(e){b({title:"Error",message:e.message,variant:"error"})}finally{m.setState({loading:!1})}},[b,f.refresh]),D=(0,l.useCallback)(async e=>{try{m.setState({loading:!0});let t=[],l=[],s=a;m.setState(a=>(s=!y&&e?[...a.drugs,e]:a.drugs.map(a=>a.itemId!==e?.itemId?a:(e&&(a.key!==e.key&&l.push({old:a.key,new:e.key}),a.type!==e.type&&t.push(a.key)),{...a,...e})),{loading:!0,drugs:s}));let r={data:e?[e]:s,broadcastAction:!0},n=await i.Z.post("/api/drugs-library/save",r);if(n.data.errors?.length)throw Error(n.data.errors?.join(", "));await S(),f.refresh(),b({title:"",message:`Drug${e?"":"s"} saved successfully!`,variant:"success"})}catch(e){b({title:"Error",message:e.message,variant:"error"})}finally{m.setState({loading:!1})}},[a,y,f.refresh]),V=(0,l.useCallback)(async e=>{try{m.setState({loading:!0});let a={data:e.map(e=>({itemId:e})),broadcastAction:!0},t=await i.Z.post("/api/drugs-library/copy",a);if(t.data.errors?.length)throw Error(t.data.errors?.join(", "));await S(),f.refresh(),b({title:"",message:`Drug${e.length<2?"":"s"} copied successfully!`,variant:"success"})}catch(e){b({title:"Error",message:e.message,variant:"error"})}finally{m.setState({loading:!1})}},[f.refresh]);(0,l.useCallback)(()=>{m.setState(u)},[]);let R=(0,l.useCallback)(e=>{m.setState({typeFilter:e})},[]),$=(0,l.useCallback)(e=>{m.setState({statusFilter:e})},[]),Z=(0,l.useCallback)(e=>{m.setState({sortBy:e})},[]);return{...e,search:v,filteredDrugs:I,tableData:C,selectedItemId:y,addLink:e=>`?${r.Z.stringify({...x,addItem:e})}`,editLink:e=>`?${r.Z.stringify({...x,itemId:e})}`,getDrugs:S,deleteDrugs:T,saveDrugs:D,copyDrugs:V,setSearch:j,clearSearch:N,onSearch:k,setTypeFilter:R,setStatusFilter:$,setSortBy:Z}}},51605:(e,a,t)=>{t.d(a,{v:()=>s});var l=t(3529);function s({isDraft:e,userId:a}){let{authenticatedUser:t}=(0,l.b)();return!!(e&&a&&a!==t?.userId)}},37530:(e,a,t)=>{t.d(a,{$:()=>i});var l=t(24875);let s=new Set(["id","createdAt","updatedAt","deletedAt","oldScriptId","oldScreenId","oldDiagnosisId","oldConfigKeyId","version","publishDate","isDraft","isDeleted","draftCreatedByUserId","createdByUserId","updatedByUserId","createdBy","updatedBy"]);class r{constructor(e){this.originalSnapshot=null,this.isInitialized=!1,this.options=e}setSnapshot(e){if(this.isInitialized){console.warn("Snapshot already initialized, ignoring subsequent calls");return}this.originalSnapshot=JSON.parse(JSON.stringify(e)),this.isInitialized=!0,console.log("Initial snapshot set for entity:",this.options.entityId)}async trackChanges(e,a){if(!this.isInitialized||!this.originalSnapshot){console.warn("Snapshot not initialized, initializing now"),this.setSnapshot(e);return}console.log("Tracking changes for entity:",this.options.entityId);let t=this.detectChanges(this.originalSnapshot,e);console.log("Detected changes:",t.length);let s=new Map((await l.pb.getEntityChanges(this.options.entityId,this.options.entityType)).map(e=>[e.fieldPath,e])),r=this.resolveEntityTitle(e);for(let i of t){let t=s.get(i.path);t?(await l.pb.updateChange(t.id,{newValue:i.newValue,timestamp:Date.now(),description:a,fullSnapshot:e,entityTitle:r}),console.log("Updated change for field:",i.path)):(await l.pb.addChange({entityId:this.options.entityId,entityType:this.options.entityType,action:"update",fieldPath:i.path,fieldName:i.name,oldValue:i.oldValue,newValue:i.newValue,userId:this.options.userId,userName:this.options.userName,description:a,fullSnapshot:e,entityTitle:r}),console.log("Added new change for field:",i.path))}for(let[e,a]of Array.from(s))t.some(a=>a.path===e)||(await l.pb.deleteChange(a.id),console.log("Removed reverted change for field:",e));0===t.length&&(await l.pb.clearEntityChanges(this.options.entityId,this.options.entityType),console.log("All changes cleared - form back to original state"))}resolveEntityTitle(e){if(this.options.resolveEntityTitle){let a=this.options.resolveEntityTitle(e);if(a&&a.toString().trim().length)return a.toString().trim()}let a=this.extractTitle(e);return a?a:"string"==typeof this.options.entityTitle&&this.options.entityTitle.trim().length?this.options.entityTitle.trim():this.extractTitle(this.originalSnapshot)||`${this.options.entityType} ${this.options.entityId}`}extractTitle(e){if(!e||"object"!=typeof e)return null;for(let a of["title","name","label","key","printTitle","displayName","sectionTitle","collectionLabel"]){let t=e[a];if("string"==typeof t&&t.trim().length)return t.trim()}return null}isMeaningfulValue(e){return null!=e&&("string"!=typeof e||""!==e.trim())}detectChanges(e,a,t=""){let l=[];return null==e?null!=a&&this.isMeaningfulValue(a)&&l.push({path:t||"root",name:t.split(".").pop()||"root",oldValue:e,newValue:a}):null==a?this.isMeaningfulValue(e)&&l.push({path:t||"root",name:t.split(".").pop()||"root",oldValue:e,newValue:a}):"object"!=typeof e||"object"!=typeof a?e!==a&&this.isMeaningfulValue(a)&&l.push({path:t||"root",name:t.split(".").pop()||"root",oldValue:e,newValue:a}):Array.isArray(e)&&Array.isArray(a)?JSON.stringify(e)!==JSON.stringify(a)&&l.push({path:t||"root",name:t.split(".").pop()||"root",oldValue:e,newValue:a}):Array.from(new Set([...Object.keys(e),...Object.keys(a)])).forEach(r=>{if(s.has(r))return;let i=t?`${t}.${r}`:r,n=e[r],d=a[r];(this.isMeaningfulValue(n)||this.isMeaningfulValue(d))&&("object"!=typeof n||"object"!=typeof d||null===n||null===d||Array.isArray(n)||Array.isArray(d)?JSON.stringify(n)!==JSON.stringify(d)&&this.isMeaningfulValue(d)&&l.push({path:i,name:r,oldValue:n,newValue:d}):l.push(...this.detectChanges(n,d,i)))}),l}async clearChanges(){await l.pb.clearEntityChanges(this.options.entityId,this.options.entityType),this.originalSnapshot=null,this.isInitialized=!1,console.log("Change tracker reset for entity:",this.options.entityId)}async getPendingChanges(){return await l.pb.getEntityChanges(this.options.entityId,this.options.entityType)}}function i(e){return new r(e)}},11825:(e,a,t)=>{t.d(a,{UZ:()=>r,kv:()=>l});let l=[{value:"all",label:"All matches"},{value:"data_key",label:"Data keys only"},{value:"key_id",label:"Key IDs only"},{value:"label",label:"Label text only"},{value:"title",label:"Title only"},{value:"condition",label:"Conditional expression only"}],s={key:"data_key",gestationKey:"data_key",weightKey:"data_key",diagnosisKey:"data_key",ageKey:"data_key",preferenceKey:"data_key",keyId:"key_id",gestationKeyId:"key_id",weightKeyId:"key_id",diagnosisKeyId:"key_id",ageKeyId:"key_id",title:"title",dosageText:"label",managementText:"label",administrationFrequency:"label",routeOfAdministration:"label",type:"label",preferenceValue:"label",condition:"condition"};function r({searchValue:e,filter:a,results:t}){return"all"===a?t:t.map(t=>{let l=t.matches.filter(t=>!a||!!(s[t.field]===a&&`${t.fieldValue}`.toLowerCase().includes(`${e}`.toLowerCase())));return{...t,matches:l}}).filter(e=>e.matches.length)}},61892:(e,a,t)=>{t.d(a,{x:()=>l});function l(e){return null==e||""===e}},31949:(e,a,t)=>{t.d(a,{s:()=>l});function l(e){let a=[],t=(e||"").split("\n").map((e="")=>e.trim()).map(e=>{let a=e.split(",");return{value:a[0],label:a[1]}}),l=t.map(e=>e.value),s=t.map(e=>e.label),r=t.filter(e=>!e.value||!e.label),i=l.filter((e,a)=>l.indexOf(e)!==a);return(s.filter((e,a)=>s.indexOf(e)!==a).length||i.length)&&a.push("Values contain duplicate data"),r.length&&a.push("Incorrect values format"),a}},41236:(e,a,t)=>{t.d(a,{_:()=>d});var l=t(19510),s=t(57371),r=t(39755),i=t(24569),n=t(46697);function d({title:e,backLink:a,children:t}){return l.jsx("div",{className:"pb-20",children:l.jsx(i.V,{className:"flex flex-col gap-y-4",children:l.jsx(n.Zb,{children:(0,l.jsxs)(n.aY,{className:"p-0",children:[!!e&&(0,l.jsxs)("div",{className:"text-xl flex items-center gap-x-4 mb-4 p-4",children:[!!a&&l.jsx(s.default,{href:a,children:l.jsx(r.Z,{className:"h-5 w-5"})}),l.jsx("span",{children:e})]}),t]})})})})}}};