exports.id=1204,exports.ids=[1204],exports.modules={7738:(e,t,a)=>{Promise.resolve().then(a.bind(a,9162))},45769:(e,t,a)=>{Promise.resolve().then(a.bind(a,10827)),Promise.resolve().then(a.bind(a,82617))},29354:(e,t,a)=>{"use strict";a.d(t,{h:()=>l});var r=a(10326),s=a(38178),i=a(77863);function l({children:e,className:t}){return(0,r.jsxs)(r.Fragment,{children:[r.jsx("div",{className:"h-16"}),r.jsx("div",{className:(0,i.cn)(`
                        fixed 
                        left-0 
                        bottom-0 
                        h-16 
                        w-full 
                        border-t 
                        border-t-border 
                        z-[1] 
                        bg-primary-foreground 
                        dark:bg-background 
                        shadow-md 
                        dark:shadow-foreground/10
                    `),children:r.jsx(s.V,{children:r.jsx("div",{className:(0,i.cn)("flex justify-end gap-x-4",t),children:e})})})]})}},2025:(e,t,a)=>{"use strict";a.d(t,{u:()=>l});var r=a(10326),s=a(62288),i=a(77863);function l({children:e,title:t,description:a,actions:l,trigger:d,contentProps:o,footerProps:n,...c}){return r.jsx(r.Fragment,{children:(0,r.jsxs)(s.Vq,{...c,children:[d,(0,r.jsxs)(s.cZ,{hideCloseButton:!0,className:(0,i.cn)("flex flex-col max-h-[90%] gap-y-4 p-0 m-0 sm:max-w-xl",o?.className),...o,children:[(0,r.jsxs)(s.fK,{className:(0,i.cn)(t||a?"":"hidden","border-b border-b-border px-4 py-4"),children:[r.jsx(s.$N,{className:(0,i.cn)(t?"":"hidden"),children:t}),r.jsx(s.Be,{className:(0,i.cn)(a?"":"hidden"),children:a})]}),r.jsx("div",{className:"flex-1 flex flex-col overflow-y-auto px-4 py-2",children:e}),r.jsx(s.cN,{className:(0,i.cn)("border-t border-t-border px-4 py-2 items-center w-full",l?"":"hidden",n?.className),...n,children:l})]})]})})}},31048:(e,t,a)=>{"use strict";a.d(t,{_:()=>n});var r=a(10326),s=a(17577),i=a(34478),l=a(28671),d=a(77863);let o=(0,l.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),n=s.forwardRef(({className:e,secondary:t,error:a,...s},l)=>r.jsx(i.f,{ref:l,className:(0,d.cn)(o(),t&&"text-xs",a?"text-danger":"",e),...s}));n.displayName=i.f.displayName},34474:(e,t,a)=>{"use strict";a.d(t,{Bw:()=>x,DI:()=>f,Ph:()=>c,Ql:()=>y,i4:()=>m,ki:()=>u,n5:()=>g});var r=a(10326),s=a(17577),i=a(18792),l=a(941),d=a(96633),o=a(32933),n=a(77863);let c=i.fC,f=i.ZA,u=i.B4,m=s.forwardRef(({className:e,children:t,error:a,...s},d)=>(0,r.jsxs)(i.xz,{ref:d,className:(0,n.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm placeholder:text-muted-foreground focus:outline-none disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a&&"border-danger",e),...s,children:[t,r.jsx(i.JO,{asChild:!0,children:r.jsx(l.Z,{className:"h-4 w-4 opacity-50"})})]}));m.displayName=i.xz.displayName;let p=s.forwardRef(({className:e,...t},a)=>r.jsx(i.u_,{ref:a,className:(0,n.cn)("flex cursor-default items-center justify-center py-1",e),...t,children:r.jsx(d.Z,{className:"h-4 w-4"})}));p.displayName=i.u_.displayName;let h=s.forwardRef(({className:e,...t},a)=>r.jsx(i.$G,{ref:a,className:(0,n.cn)("flex cursor-default items-center justify-center py-1",e),...t,children:r.jsx(l.Z,{className:"h-4 w-4"})}));h.displayName=i.$G.displayName;let x=s.forwardRef(({className:e,children:t,position:a="popper",...s},l)=>r.jsx(i.h_,{children:(0,r.jsxs)(i.VY,{ref:l,className:(0,n.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===a&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:a,...s,children:[r.jsx(p,{}),r.jsx(i.l_,{className:(0,n.cn)("p-1","popper"===a&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),r.jsx(h,{})]})}));x.displayName=i.VY.displayName;let g=s.forwardRef(({className:e,...t},a)=>r.jsx(i.__,{ref:a,className:(0,n.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));g.displayName=i.__.displayName;let y=s.forwardRef(({className:e,children:t,...a},s)=>(0,r.jsxs)(i.ck,{ref:s,className:(0,n.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...a,children:[r.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:r.jsx(i.wU,{children:r.jsx(o.Z,{className:"h-4 w-4"})})}),r.jsx(i.eT,{children:t})]}));y.displayName=i.ck.displayName,s.forwardRef(({className:e,...t},a)=>r.jsx(i.Z0,{ref:a,className:(0,n.cn)("-mx-1 my-1 h-px bg-muted",e),...t})).displayName=i.Z0.displayName},82617:(e,t,a)=>{"use strict";a.d(t,{ScriptsContextProvider:()=>c,h:()=>n});var r=a(10326),s=a(17577),i=a(35047),l=a(15491),d=a(12260);let o=(0,s.createContext)(null),n=()=>(0,s.useContext)(o);function c({children:e,...t}){let a=function({}){let e=(0,i.useRouter)(),{scriptId:t}=(0,i.useParams)(),{parsed:a}=(0,d.l)(),r=(0,s.useCallback)(()=>{e.push("/")},[e]),o=(0,s.useCallback)(()=>{e.push(`/script/${t}?${l.Z.stringify({...a,section:"screens"})}`)},[e,a,t]);return{onCancelDiagnosisForm:(0,s.useCallback)(()=>{e.push(`/script/${t}?${l.Z.stringify({...a,section:"diagnoses"})}`)},[e,a,t]),onCancelScreenForm:o,onCancelScriptForm:r}}(t);return r.jsx(o.Provider,{value:{...t,...a},children:e})}},95602:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>g});var r=a(19510),s=a(58585),i=a(87845),l=a(47080),d=a(2111),o=a(68570);let n=(0,o.createProxy)(String.raw`/home/morris/Documents/NEOTREE/REPOS/neotree-editor/contexts/scripts/index.tsx`),{__esModule:c,$$typeof:f}=n;n.default,(0,o.createProxy)(String.raw`/home/morris/Documents/NEOTREE/REPOS/neotree-editor/contexts/scripts/index.tsx#ScriptsContext`),(0,o.createProxy)(String.raw`/home/morris/Documents/NEOTREE/REPOS/neotree-editor/contexts/scripts/index.tsx#useScriptsContext`);let u=(0,o.createProxy)(String.raw`/home/morris/Documents/NEOTREE/REPOS/neotree-editor/contexts/scripts/index.tsx#ScriptsContextProvider`);var m=a(85431),p=a(66267),h=a(24569),x=a(46697);async function g({children:e}){let{user:t,yes:a}=await (0,p.canAccessPage)();if(t||(0,s.redirect)("/login"),!a)return r.jsx(h.V,{children:r.jsx(x.Zb,{children:r.jsx(x.aY,{className:"p-4 text-xl text-center text-danger bg-danger/10",children:"You don't have sufficient rights to access this page!"})})});let o=await (0,d.getHospitals)();return(0,r.jsxs)(r.Fragment,{children:[r.jsx(m.D,{children:"Scripts"}),r.jsx(u,{...i,...l,hospitals:o,getHospitals:d.getHospitals,children:e})]})}},17162:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>d});var r=a(19510),s=a(21113),i=a(24569),l=a(46697);function d(){return r.jsx(i.V,{children:r.jsx(l.Zb,{children:r.jsx(l.aY,{className:"p-0",children:r.jsx(s.w,{loading:!0,maxRows:25,columns:[{name:"Key"},{name:"Label"},{name:"Description"},{name:"Action",align:"right",cellClassName:"w-20"}],data:[]})})})})}},47080:(e,t,a)=>{"use strict";a.r(t),a.d(t,{getFiles:()=>p,uploadFile:()=>h,uploadFileFromSite:()=>x});var r=a(24330);a(60166);var s=a(9576),i=a(61460),l=a(89114),d=a(57435),o=a(44652),n=a(66267),c=a(59271),f=a(49530),u=a(20123),m=a(40618);let p=l.Re;async function h(e,t){let a={success:!1,data:null};try{for(let r of(await (0,n.isAllowed)(["upload_files"]),Array.from(e.entries()))){let[l,d]=r;if("object"==typeof d){let r=Buffer.from(await d.arrayBuffer()),l=e.get("fileId")?.toString()||(0,s.Z)(),n={...(0,o.R)(e.get("metadata")?.toString()||"{}")},c=(e.get("size")?function(e,t){if("0"==`${e}`)return 0;let a=`${e||""}`.replaceAll(" ",""),[r,s]=(a=a.includes(".")?a.replaceAll(",",""):a.split(",").length>2?a.replaceAll(",",""):a.replaceAll(",",".")).split("."),i=!r||isNaN(Number(r))?"":r;return""==(i+=!s||isNaN(Number(s))?"":`.${s}`)||void 0===i||isNaN(Number(i))?t?.notNull?0:null:Number(i)}((0,o.R)(e.get("size")?.toString())):0)||d.size,f=e.get("filename")?.toString()||d.name,u=[l,f].filter(e=>e).join("__");(n.width||n.height)&&(u=`${u}?w=${n.width}&h=${n.height}`),a=await (0,i.G)({fileId:l,data:r,filename:u,size:c,contentType:e.get("contentType")?.toString()||d.type,metadata:n},t)}}}catch(e){a.success=!1,a.errors=[e.message],d.Z.error("uploadFile ERROR",e.message)}finally{return a}}async function x({fileId:e,siteURL:t}){try{let a=await (0,u.QF)({links:[t]});if(a.errors)throw Error(a.errors.join(", "));let{data:[r]}=a;if(!r)throw Error(`Site (${t}) was not found!`);let s=await (0,c.U)({baseURL:r.link,apiKey:r.apiKey}),d=await (0,l._I)(e);if(d.errors)throw Error(d.errors.join(", "));if(d?.data){let t=f.Z.stringify({...d.data.metadata});return t=t?`?${t}`:"",{data:{fileId:e,fileURL:[process.env.NEXT_PUBLIC_APP_URL,`/files/${e}${t}`].join("")}}}let o=(await s.get(`/api/files/${e}/download`)).data;if(o.errors)throw Error(o.errors.join(", "));if(!o.data)return{errors:["File not found"],data:null};await (0,i.G)({fileId:e,data:o.data.data,filename:o.data.filename,size:o.data.size,contentType:o.data.contentType,metadata:{...o.data.metadata}});let n=f.Z.stringify({...o.data.metadata});return n=n?`?${n}`:"",{data:{fileId:e,fileURL:[r.link,`/files/${e}${n}`].join("")}}}catch(e){return d.Z.error("downloadFileFromSite ERROR",e.message),{data:null,errors:[e.message]}}}(0,m.h)([p,h,x]),(0,r.j)("2603647352d6143615fc841cdc7888ee820ade32",p),(0,r.j)("404a555bd8d515b558a1176ea51d19e2670f363a",h),(0,r.j)("88c9bf8e342e37a966245e15ed8f7c8c90e2db0c",x)},2111:(e,t,a)=>{"use strict";a.r(t),a.d(t,{$$ACTION_0:()=>h,$$ACTION_1:()=>g,$$ACTION_2:()=>w,$$ACTION_3:()=>R,$$ACTION_4:()=>j,countHospitals:()=>x,deleteHospitals:()=>p,getHospital:()=>b,getHospitals:()=>y,saveHospitals:()=>N});var r=a(24330);a(60166);var s=a(57745),i=a(57435),l=a(10413),d=a(67109),o=a(88317);async function n(e){let t={success:!1};try{let a=e.filter(e=>e.id),r=e.filter(e=>!e.id),i=[];for(let e of a)try{await l.Z.update(d.hospitals).set(e).where((0,s.eq)(d.hospitals.id,e.id))}catch(e){i.push(e.message)}r.length&&await l.Z.insert(d.hospitals).values(r),i.length?t.errors=i:t.success=!0}catch(e){t.success=!1,t.errors=[e.message],i.Z.error("_saveHospitals ERROR",e.message)}finally{return t?.errors?.length||o.Z.emit("data_changed","save_hospitals"),t}}async function c(e){let t={success:!1},{ids:a,hospitalsIds:r,confirmDeleteAll:n}={...e};try{let e=[a?.length?(0,s.d3)(d.hospitals.id,a):void 0,r?.length?(0,s.d3)(d.hospitals.hospitalId,r):void 0].filter(e=>e);if(!e.length&&!n)throw Error("Please confirm that you want to delete all the hospitals!");await l.Z.delete(d.hospitals).where((0,s.xD)(...e)),t.success=!0}catch(e){t.success=!1,t.errors=[e.message],i.Z.error("_deleteHospitals ERROR",e.message)}finally{return t?.errors?.length||o.Z.emit("data_changed","delete_hospitals"),t}}var f=a(88453),u=a(66267),m=a(40618);let p=(0,r.j)("fa5ff364dc8e373c61bf5e919181e39a885e487c",h);async function h(...e){try{return await (0,u.isAllowed)(),await c(...e)}catch(e){return i.Z.error("deleteHospitals ERROR",e.message),{errors:[e.message],success:!1}}}let x=(0,r.j)("feb32317fd290d504cec676a0a7a8518ee2e101d",g);async function g(...e){try{return await (0,u.isAllowed)(),await (0,f.Py)(...e)}catch(e){return i.Z.error("countHospitals ERROR",e.message),{errors:[e.message],data:0}}}let y=(0,r.j)("35990ba7ae3c980de9d0dd031253e064853ea97c",w);async function w(...e){try{return await (0,u.isAllowed)(),await (0,f.O8)(...e)}catch(e){return i.Z.error("getHospitals ERROR",e.message),{errors:[e.message],data:[]}}}let b=(0,r.j)("97a35acd0bc43b4a8af2145bf173f255f7cfcaa6",R);async function R(...e){return await (0,u.isAllowed)(),await (0,f.C9)(...e)}let N=(0,r.j)("b1d8498ed9ba2ed0b2e75905de015d99eac788da",j);async function j(...e){try{return await (0,u.isAllowed)(),await n(...e)}catch(e){return i.Z.error("getSys ERROR",e.message),{errors:[e.message],data:void 0,success:!1}}}(0,m.h)([p,x,y,b,N]),(0,r.j)("d13ede16692bf847809ef4f0f07e07202d176123",p),(0,r.j)("0435982985ccbc8a6ff401a05d234cbb357a5ba0",x),(0,r.j)("9999285484ed2cc27c47ee1cec1b91e8cfd7b525",y),(0,r.j)("43b29b99ca25e7001283c24afd253dc9b6e45967",b),(0,r.j)("224c4cde8babcf2dee45bef9b5abcb2062ab2765",N)},24569:(e,t,a)=>{"use strict";a.d(t,{V:()=>i});var r=a(19510),s=a(50650);function i({className:e,...t}){return r.jsx("div",{...t,className:(0,s.cn)("w-full max-w-screen-xl mx-auto p-5",e)})}},21113:(e,t,a)=>{"use strict";a.d(t,{w:()=>d});var r=a(68570);let s=(0,r.createProxy)(String.raw`/home/morris/Documents/NEOTREE/REPOS/neotree-editor/components/data-table/index.tsx`),{__esModule:i,$$typeof:l}=s;s.default;let d=(0,r.createProxy)(String.raw`/home/morris/Documents/NEOTREE/REPOS/neotree-editor/components/data-table/index.tsx#DataTable`)},46697:(e,t,a)=>{"use strict";a.d(t,{Zb:()=>l,aY:()=>d});var r=a(19510),s=a(71159),i=a(50650);let l=s.forwardRef(({className:e,...t},a)=>r.jsx("div",{ref:a,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));l.displayName="Card",s.forwardRef(({className:e,...t},a)=>r.jsx("div",{ref:a,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",e),...t})).displayName="CardHeader",s.forwardRef(({className:e,...t},a)=>r.jsx("h3",{ref:a,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",e),...t})).displayName="CardTitle",s.forwardRef(({className:e,...t},a)=>r.jsx("p",{ref:a,className:(0,i.cn)("text-sm text-muted-foreground",e),...t})).displayName="CardDescription";let d=s.forwardRef(({className:e,...t},a)=>r.jsx("div",{ref:a,className:(0,i.cn)("p-6 pt-0",e),...t}));d.displayName="CardContent",s.forwardRef(({className:e,...t},a)=>r.jsx("div",{ref:a,className:(0,i.cn)("flex items-center p-6 pt-0",e),...t})).displayName="CardFooter"},61460:(e,t,a)=>{"use strict";a.d(t,{G:()=>o});var r=a(88317),s=a(57435),i=a(10413),l=a(67109),d=a(89114);async function o(e,t){let a={success:!1,data:null};try{if(!e.fileId)throw Error("Missing fileId");if(!e.data)throw Error("No file uploaded");await i.Z.insert(l.files).values(e);let s=await (0,d._I)(e.fileId);if(!s)throw Error("Failed to upload file");a.success=!0,a.data=s.data,s.data&&t?.broadcastAction!==!1&&r.Z.emit("file_uploaded")}catch(e){a.success=!1,a.errors=[e.message],s.Z.error("_uploadFile ERROR",e.message)}finally{return a}}},89114:(e,t,a)=>{"use strict";a.d(t,{_I:()=>n,Re:()=>p,KU:()=>o});var r=a(57745),s=a(10413),i=a(67109),l=a(57435),d=a(44380);async function o(e){try{let t=await s.Z.query.files.findFirst({where:(0,r.eq)(i.files.fileId,e)});return{data:t?{...t,url:(0,d.TI)(`/files/${t.fileId}`)}:null}}catch(e){return l.Z.error("_getFiles ERROR",e.message),{errors:[e.message],data:null}}}async function n(e){try{let t=await s.Z.query.files.findFirst({where:(0,r.eq)(i.files.fileId,e),columns:{contentType:!0,fileId:!0,filename:!0,size:!0,metadata:!0,createdAt:!0}});return{data:t?{...t,url:(0,d.TI)(`/files/${t.fileId}`)}:null}}catch(e){return l.Z.error("_getFiles ERROR",e.message),{errors:[e.message],data:null}}}var c=a(34149),f=a(60938),u=a(81445),m=a(41502);async function p(e){try{let{filesIds:t,archived:a,searchValue:l,limit:o,page:n=1,uploadDateGTE:p,uploadDateLTE:h}={...e},x=Math.max(0,n),g=l?["%",l,"%"].join(""):"",y=[a?(0,r.K0)(i.files.deletedAt):(0,r.Ft)(i.files.deletedAt),...t?.length?[(0,r.d3)(i.files.fileId,t)]:[],...g?[(0,c.i6)`LOWER(screens.name) like LOWER(${g})`]:[],p?(0,r.eg)(i.files.createdAt,"string"==typeof p?new Date(p):p):void 0,h?(0,r.G)(i.files.createdAt,"string"==typeof h?new Date(h):h):void 0],w=s.Z.select({count:(0,f.QX)()}).from(i.files);y.length&&w.where((0,r.xD)(...y));let[{count:b}]=await w.execute(),R=1;b&&(R=(0,m.x)(o)?1:Math.ceil(b/o),x=Math.min(x,R));let N=(0,m.x)(o)?void 0:Math.max(0,(x-1)*o);return{data:(await s.Z.query.files.findMany({where:y.length?(0,r.xD)(...y):void 0,limit:o,offset:N,orderBy:(0,u.C)(i.files.createdAt),columns:{fileId:!0,contentType:!0,filename:!0,size:!0,metadata:!0,createdAt:!0}})).map(e=>({...e,url:(0,d.TI)(`/files/${e.fileId}`)})),searchValue:l,totalPages:R,totalRows:b,page:x,limit:o}}catch(e){return l.Z.error("_getFiles ERROR",e.message),{errors:[e.message],data:[],totalPages:0,totalRows:0,page:1}}}},88453:(e,t,a)=>{"use strict";a.d(t,{Py:()=>f,C9:()=>n,O8:()=>o});var r=a(57745),s=a(30900),i=a(10413),l=a(67109),d=a(57435);async function o(e){try{let{hospitalsIds:t}={...e},a=t||[],d=a?.length?(0,r.d3)(l.hospitals.hospitalId,a.filter(e=>s.Z(e))):void 0,o=a?.length?(0,r.d3)(l.hospitals.oldHospitalId,a.filter(e=>!s.Z(e))):void 0,n=[(0,r.Ft)(l.hospitals.deletedAt),...d&&o?[(0,r.or)(d,o)]:[]];return{data:(await i.Z.select({hospital:l.hospitals}).from(l.hospitals).where(n.length?(0,r.xD)(...n):void 0)).map(e=>e.hospital)}}catch(e){return d.Z.error("_getHospitals ERROR",e.message),{data:[],errors:[e.message]}}}async function n(e){let{hospitalId:t}={...e};try{if(!t)throw Error("Missing hospitalId");let e=s.Z(t)?(0,r.eq)(l.hospitals.hospitalId,t):void 0,a=s.Z(t)?void 0:(0,r.eq)(l.hospitals.oldHospitalId,t);return{data:await i.Z.query.hospitals.findFirst({where:(0,r.xD)((0,r.Ft)(l.hospitals.deletedAt),e||a)})}}catch(e){return d.Z.error("_getHospital ERROR",e.message),{errors:[e.message]}}}var c=a(60938);async function f(){try{let[{count:e}]=await i.Z.select({count:(0,c.QX)()}).from(l.hospitals);return{data:e}}catch(e){return d.Z.error("_getHospitals ERROR",e.message),{data:0,errors:[e.message]}}}},44652:(e,t,a)=>{"use strict";function r(e){try{return JSON.parse(e)}catch(e){return null}}a.d(t,{R:()=>r})}};