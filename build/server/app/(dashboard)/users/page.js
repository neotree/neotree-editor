(()=>{var e={};e.id=7297,e.ids=[7297,7636],e.modules={67096:e=>{"use strict";e.exports=require("bcrypt")},47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},39491:e=>{"use strict";e.exports=require("assert")},14300:e=>{"use strict";e.exports=require("buffer")},32081:e=>{"use strict";e.exports=require("child_process")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},41808:e=>{"use strict";e.exports=require("net")},6005:e=>{"use strict";e.exports=require("node:crypto")},87561:e=>{"use strict";e.exports=require("node:fs")},49411:e=>{"use strict";e.exports=require("node:path")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},4074:e=>{"use strict";e.exports=require("perf_hooks")},63477:e=>{"use strict";e.exports=require("querystring")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},76224:e=>{"use strict";e.exports=require("tty")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},99697:(e,a,r)=>{"use strict";r.r(a),r.d(a,{GlobalError:()=>l.a,__next_app__:()=>u,originalPathname:()=>f,pages:()=>o,routeModule:()=>b,tree:()=>i}),r(13005),r(84232),r(56367),r(12699),r(99985),r(96560);var t=r(23191),s=r(88716),n=r(37922),l=r.n(n),d=r(95231),c={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>d[e]);r.d(a,c);let i=["",{children:["(dashboard)",{children:["users",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,13005)),"/home/watkay/ReactProjects/neotree-editor/app/(dashboard)/users/page.tsx"]}]},{loading:[()=>Promise.resolve().then(r.bind(r,84232)),"/home/watkay/ReactProjects/neotree-editor/app/(dashboard)/users/loading.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,56367)),"/home/watkay/ReactProjects/neotree-editor/app/(dashboard)/layout.tsx"],loading:[()=>Promise.resolve().then(r.bind(r,12699)),"/home/watkay/ReactProjects/neotree-editor/app/(dashboard)/loading.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,99985)),"/home/watkay/ReactProjects/neotree-editor/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.bind(r,96560)),"/home/watkay/ReactProjects/neotree-editor/app/not-found.tsx"]}],o=["/home/watkay/ReactProjects/neotree-editor/app/(dashboard)/users/page.tsx"],f="/(dashboard)/users/page",u={require:r,loadChunk:()=>Promise.resolve()},b=new t.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/(dashboard)/users/page",pathname:"/users",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:i}})},14799:(e,a,r)=>{let t={"05e67aa00650fc8732ea884d2fa5edfffcd4f5dc":()=>Promise.resolve().then(r.bind(r,73508)).then(e=>e.getUsers),"1a344b698c820488aa3eeebdf84313d6c6c2fa06":()=>Promise.resolve().then(r.bind(r,73508)).then(e=>e.$$ACTION_4),"1afe159261df7780f0ac2e2aba67daaf2ff555dc":()=>Promise.resolve().then(r.bind(r,73508)).then(e=>e.updateUsers),"2a51d2b91ddb4ac57bffd72136b2a8e4811255a6":()=>Promise.resolve().then(r.bind(r,73508)).then(e=>e.deleteUsers),"2dcc703dc0710c185b243f54d71a10a5e92689b9":()=>Promise.resolve().then(r.bind(r,73508)).then(e=>e.setPassword),"349fa565a9e7645859203619f67e35d103d96fc3":()=>Promise.resolve().then(r.bind(r,73508)).then(e=>e.searchUsers),"439bcc76f1d754796c6752dc79e8c109ae8f950c":()=>Promise.resolve().then(r.bind(r,73508)).then(e=>e.createUsers),"4588c65b6fb85ba2650217826247ed78e49be95a":()=>Promise.resolve().then(r.bind(r,73508)).then(e=>e.isEmailRegistered),"56d1e39e5ef168c8a44e5b6533cac49737d0836f":()=>Promise.resolve().then(r.bind(r,73508)).then(e=>e.getUserMini),"756f854d60219b5b63cf63ea9fddced48eb33662":()=>Promise.resolve().then(r.bind(r,73508)).then(e=>e.resetUsersPasswords),"770a8e41849bda456313154fb660d8045d3089c1":()=>Promise.resolve().then(r.bind(r,73508)).then(e=>e.getUser),"7c059ad36ec696816e015d837e81d99f35302949":()=>Promise.resolve().then(r.bind(r,73508)).then(e=>e.$$ACTION_3),"9696bfffca19346bf89c5ba78b70e7c7f30ddc5a":()=>Promise.resolve().then(r.bind(r,73508)).then(e=>e.$$ACTION_1),c5514b7679b6c600fb116e72f23fdd076bc97ac3:()=>Promise.resolve().then(r.bind(r,73508)).then(e=>e.$$ACTION_0),dcbdf5b4e56da69434c179de89b3624b2723b670:()=>Promise.resolve().then(r.bind(r,73508)).then(e=>e.$$ACTION_2),ef593127d00e8e5d39c70094fa84754b13d96377:()=>Promise.resolve().then(r.bind(r,73508)).then(e=>e.getFullUser),b0fcf79e40cf0e7239aad2b69d0f6e6ceac06a59:()=>Promise.resolve().then(r.bind(r,66267)).then(e=>e.canAccessPage),c7db9b1ba0cab2a335eda35b61797bc9a5b816ba:()=>Promise.resolve().then(r.bind(r,66267)).then(e=>e.isAllowed),"3753e7204934c26ff5afc7fac412906b9ec7c2cd":()=>Promise.resolve().then(r.bind(r,40801)).then(e=>e.getSession),"986fd4782cffd1a8b11ca93d5c1f784b6d7a2025":()=>Promise.resolve().then(r.bind(r,40801)).then(e=>e.getAuthenticatedUser),cf37b218c9ffd359e595d215859090895afe32a3:()=>Promise.resolve().then(r.bind(r,40801)).then(e=>e.getAuthenticatedUserWithRoles),"8ab7a6da9de9c86875f970a384e05b5853c94709":()=>Promise.resolve().then(r.bind(r,43767)).then(e=>e.getRoles),"6397523a8f8672c5182495764c492b3a235cbcab":()=>Promise.resolve().then(r.bind(r,60563)).then(e=>e.$$ACTION_1),"76f0b17712f4501d72b44a5049e045af2774269b":()=>Promise.resolve().then(r.bind(r,60563)).then(e=>e.getSys),d97e2a08525547477613111effde4792d4260225:()=>Promise.resolve().then(r.bind(r,60563)).then(e=>e.updateSys),e1c6930531e9485f362babf55d97916a1ad501cf:()=>Promise.resolve().then(r.bind(r,60563)).then(e=>e.$$ACTION_0),"5b32a18b5d68c0559bdc20224d166443def15579":()=>Promise.resolve().then(r.bind(r,82065)).then(e=>e.getSites),"62f755d2b4c846d8090cd4b57ab2767f1a077d36":()=>Promise.resolve().then(r.bind(r,82065)).then(e=>e.getSitesWithoutConfidentialData),"71c992fbf5ecbf9d61a1842244bc34a6b478ed4c":()=>Promise.resolve().then(r.bind(r,82065)).then(e=>e.saveSites),cec02b7793208620ac58f5f16076922997e6559c:()=>Promise.resolve().then(r.bind(r,82065)).then(e=>e.$$ACTION_0),ea9a3fcf74a0c423c844e980536ccc9ede1b166d:()=>Promise.resolve().then(r.bind(r,82065)).then(e=>e.getSite),a3f2c9f22a2d74bc5c52f0a99bf5982daa41ae01:()=>Promise.resolve().then(r.bind(r,71271)).then(e=>e.discardDrafts),a51a2d6c6369fbe75939846346b95c575004df1d:()=>Promise.resolve().then(r.bind(r,71271)).then(e=>e.$$ACTION_0),c7b55d6a1f3e2e1bcaf7d0c11dca2a32d5a604ca:()=>Promise.resolve().then(r.bind(r,71271)).then(e=>e.countAllDrafts),cb9a2ec0d6364666ae991ca69a1ccc30f74a5220:()=>Promise.resolve().then(r.bind(r,71271)).then(e=>e.getEditorDetails),d7b5dfae0e5e175752e21d0929fede082af11157:()=>Promise.resolve().then(r.bind(r,71271)).then(e=>e.revalidatePath),e5fa07e4fdc4dcce863b886208c69a80b05c95d4:()=>Promise.resolve().then(r.bind(r,71271)).then(e=>e.$$ACTION_1),ed96721a8cdb9e337ce13bba84ed504642533051:()=>Promise.resolve().then(r.bind(r,71271)).then(e=>e.publishData),"0d39aaa823e839a6bfddf6a5ed21623edef0aec2":()=>Promise.resolve().then(r.bind(r,94136)).then(e=>e.saveDataKeysUpdateIfExist),"18105b87f644f168cafbc747f8197c9d6b0856c9":()=>Promise.resolve().then(r.bind(r,94136)).then(e=>e.saveDataKeysIfNotExist),"25a1ece3dd2f23f7c7a4052df92f18e3c4b24f86":()=>Promise.resolve().then(r.bind(r,94136)).then(e=>e.saveDataKeys),"7a27adb185b0bf9ba8250af2ec4fd78ac20b1b5a":()=>Promise.resolve().then(r.bind(r,94136)).then(e=>e.$$ACTION_2),"7d2b1575988c8ba2208de85022e895402fc6d2b9":()=>Promise.resolve().then(r.bind(r,94136)).then(e=>e.$$ACTION_0),"948e22b55d8b846c9687619f6f7f74f3fc26b22d":()=>Promise.resolve().then(r.bind(r,94136)).then(e=>e.getDataKeys),c2ca9c5aa59be01c8a3407f1b00f7f96ee1f8744:()=>Promise.resolve().then(r.bind(r,94136)).then(e=>e.exportDataKeys),e50183efb5391ac0e2bc1cb207a43a2f6847d6ed:()=>Promise.resolve().then(r.bind(r,94136)).then(e=>e.$$ACTION_1)};async function s(e,...a){return(await t[e]()).apply(null,a)}e.exports={"05e67aa00650fc8732ea884d2fa5edfffcd4f5dc":s.bind(null,"05e67aa00650fc8732ea884d2fa5edfffcd4f5dc"),"1a344b698c820488aa3eeebdf84313d6c6c2fa06":s.bind(null,"1a344b698c820488aa3eeebdf84313d6c6c2fa06"),"1afe159261df7780f0ac2e2aba67daaf2ff555dc":s.bind(null,"1afe159261df7780f0ac2e2aba67daaf2ff555dc"),"2a51d2b91ddb4ac57bffd72136b2a8e4811255a6":s.bind(null,"2a51d2b91ddb4ac57bffd72136b2a8e4811255a6"),"2dcc703dc0710c185b243f54d71a10a5e92689b9":s.bind(null,"2dcc703dc0710c185b243f54d71a10a5e92689b9"),"349fa565a9e7645859203619f67e35d103d96fc3":s.bind(null,"349fa565a9e7645859203619f67e35d103d96fc3"),"439bcc76f1d754796c6752dc79e8c109ae8f950c":s.bind(null,"439bcc76f1d754796c6752dc79e8c109ae8f950c"),"4588c65b6fb85ba2650217826247ed78e49be95a":s.bind(null,"4588c65b6fb85ba2650217826247ed78e49be95a"),"56d1e39e5ef168c8a44e5b6533cac49737d0836f":s.bind(null,"56d1e39e5ef168c8a44e5b6533cac49737d0836f"),"756f854d60219b5b63cf63ea9fddced48eb33662":s.bind(null,"756f854d60219b5b63cf63ea9fddced48eb33662"),"770a8e41849bda456313154fb660d8045d3089c1":s.bind(null,"770a8e41849bda456313154fb660d8045d3089c1"),"7c059ad36ec696816e015d837e81d99f35302949":s.bind(null,"7c059ad36ec696816e015d837e81d99f35302949"),"9696bfffca19346bf89c5ba78b70e7c7f30ddc5a":s.bind(null,"9696bfffca19346bf89c5ba78b70e7c7f30ddc5a"),c5514b7679b6c600fb116e72f23fdd076bc97ac3:s.bind(null,"c5514b7679b6c600fb116e72f23fdd076bc97ac3"),dcbdf5b4e56da69434c179de89b3624b2723b670:s.bind(null,"dcbdf5b4e56da69434c179de89b3624b2723b670"),ef593127d00e8e5d39c70094fa84754b13d96377:s.bind(null,"ef593127d00e8e5d39c70094fa84754b13d96377"),b0fcf79e40cf0e7239aad2b69d0f6e6ceac06a59:s.bind(null,"b0fcf79e40cf0e7239aad2b69d0f6e6ceac06a59"),c7db9b1ba0cab2a335eda35b61797bc9a5b816ba:s.bind(null,"c7db9b1ba0cab2a335eda35b61797bc9a5b816ba"),"3753e7204934c26ff5afc7fac412906b9ec7c2cd":s.bind(null,"3753e7204934c26ff5afc7fac412906b9ec7c2cd"),"986fd4782cffd1a8b11ca93d5c1f784b6d7a2025":s.bind(null,"986fd4782cffd1a8b11ca93d5c1f784b6d7a2025"),cf37b218c9ffd359e595d215859090895afe32a3:s.bind(null,"cf37b218c9ffd359e595d215859090895afe32a3"),"8ab7a6da9de9c86875f970a384e05b5853c94709":s.bind(null,"8ab7a6da9de9c86875f970a384e05b5853c94709"),"6397523a8f8672c5182495764c492b3a235cbcab":s.bind(null,"6397523a8f8672c5182495764c492b3a235cbcab"),"76f0b17712f4501d72b44a5049e045af2774269b":s.bind(null,"76f0b17712f4501d72b44a5049e045af2774269b"),d97e2a08525547477613111effde4792d4260225:s.bind(null,"d97e2a08525547477613111effde4792d4260225"),e1c6930531e9485f362babf55d97916a1ad501cf:s.bind(null,"e1c6930531e9485f362babf55d97916a1ad501cf"),"5b32a18b5d68c0559bdc20224d166443def15579":s.bind(null,"5b32a18b5d68c0559bdc20224d166443def15579"),"62f755d2b4c846d8090cd4b57ab2767f1a077d36":s.bind(null,"62f755d2b4c846d8090cd4b57ab2767f1a077d36"),"71c992fbf5ecbf9d61a1842244bc34a6b478ed4c":s.bind(null,"71c992fbf5ecbf9d61a1842244bc34a6b478ed4c"),cec02b7793208620ac58f5f16076922997e6559c:s.bind(null,"cec02b7793208620ac58f5f16076922997e6559c"),ea9a3fcf74a0c423c844e980536ccc9ede1b166d:s.bind(null,"ea9a3fcf74a0c423c844e980536ccc9ede1b166d"),a3f2c9f22a2d74bc5c52f0a99bf5982daa41ae01:s.bind(null,"a3f2c9f22a2d74bc5c52f0a99bf5982daa41ae01"),a51a2d6c6369fbe75939846346b95c575004df1d:s.bind(null,"a51a2d6c6369fbe75939846346b95c575004df1d"),c7b55d6a1f3e2e1bcaf7d0c11dca2a32d5a604ca:s.bind(null,"c7b55d6a1f3e2e1bcaf7d0c11dca2a32d5a604ca"),cb9a2ec0d6364666ae991ca69a1ccc30f74a5220:s.bind(null,"cb9a2ec0d6364666ae991ca69a1ccc30f74a5220"),d7b5dfae0e5e175752e21d0929fede082af11157:s.bind(null,"d7b5dfae0e5e175752e21d0929fede082af11157"),e5fa07e4fdc4dcce863b886208c69a80b05c95d4:s.bind(null,"e5fa07e4fdc4dcce863b886208c69a80b05c95d4"),ed96721a8cdb9e337ce13bba84ed504642533051:s.bind(null,"ed96721a8cdb9e337ce13bba84ed504642533051"),"0d39aaa823e839a6bfddf6a5ed21623edef0aec2":s.bind(null,"0d39aaa823e839a6bfddf6a5ed21623edef0aec2"),"18105b87f644f168cafbc747f8197c9d6b0856c9":s.bind(null,"18105b87f644f168cafbc747f8197c9d6b0856c9"),"25a1ece3dd2f23f7c7a4052df92f18e3c4b24f86":s.bind(null,"25a1ece3dd2f23f7c7a4052df92f18e3c4b24f86"),"7a27adb185b0bf9ba8250af2ec4fd78ac20b1b5a":s.bind(null,"7a27adb185b0bf9ba8250af2ec4fd78ac20b1b5a"),"7d2b1575988c8ba2208de85022e895402fc6d2b9":s.bind(null,"7d2b1575988c8ba2208de85022e895402fc6d2b9"),"948e22b55d8b846c9687619f6f7f74f3fc26b22d":s.bind(null,"948e22b55d8b846c9687619f6f7f74f3fc26b22d"),c2ca9c5aa59be01c8a3407f1b00f7f96ee1f8744:s.bind(null,"c2ca9c5aa59be01c8a3407f1b00f7f96ee1f8744"),e50183efb5391ac0e2bc1cb207a43a2f6847d6ed:s.bind(null,"e50183efb5391ac0e2bc1cb207a43a2f6847d6ed")}},86621:(e,a,r)=>{Promise.resolve().then(r.bind(r,83243)),Promise.resolve().then(r.bind(r,10827))},42782:(e,a,r)=>{Promise.resolve().then(r.bind(r,7636))},83243:(e,a,r)=>{"use strict";r.d(a,{UsersTable:()=>F});var t=r(10326),s=r(17577),n=r(85999);/**
 * @license lucide-react v0.399.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,r(62881).Z)("CircleCheckBig",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);var d=r(57967),c=r.n(d),i=r(44099),o=r(68232),f=r(77863),u=r(7636),b=r(3756),m=r(8281),p=r(11870),h=r(12260),x=r(46670),g=r(3529),y=r(77109),j=r(39447),v=r(47035),w=r(90434),N=r(60097),C=r(90772);function P({email:e,userId:a,userName:r,isActivated:s,onDelete:n,onResetPasswords:l}){let d=(0,y.useSession)();return(0,h.l)(),t.jsx(t.Fragment,{children:(0,t.jsxs)(N.h_,{children:[t.jsx(N.$F,{asChild:!0,children:t.jsx(C.z,{variant:"ghost",size:"icon",className:"p-0 h-auto w-auto transition-colors rounded-full hover:text-primary hover:bg-transparent",children:t.jsx(j.Z,{className:"h-4 w-4"})})}),(0,t.jsxs)(N.AW,{children:[t.jsx(N.Ju,{children:r}),t.jsx(N.VD,{}),t.jsx(N.Xi,{asChild:!0,children:t.jsx(w.default,{href:`/users/edit/${a}`,children:"Edit"})}),t.jsx(N.Xi,{disabled:s,children:"Send activation code"}),t.jsx(N.Xi,{onClick:()=>setTimeout(()=>l(),0),className:"text-danger focus:bg-danger focus:text-danger-foreground",children:"Reset password"}),t.jsx(N.VD,{}),(0,t.jsxs)(N.Xi,{onClick:()=>setTimeout(()=>n(),0),className:"text-danger focus:bg-danger focus:text-danger-foreground",disabled:e===d.data?.user?.email,children:[t.jsx(v.Z,{className:"mr-2 h-4 w-4"}),t.jsx("span",{children:"Delete"})]})]})]})})}var R=r(83855),I=r(34474);let k=[{value:"active",label:"Active"},{value:"inactive",label:"Inactive"}];function A({selected:e,roles:a,getUsers:r,onDelete:n,searchUsers:l}){let d=(0,h.l)(),[c,i]=(0,s.useState)(d.parsed.role||"all"),[o,f]=(0,s.useState)(d.parsed.status||"all");return(0,t.jsxs)(t.Fragment,{children:[t.jsx("div",{children:(0,t.jsxs)(I.Ph,{value:o,onValueChange:e=>{let a="all"===e?void 0:e;f(e),r({status:a},e=>!e&&d.push({status:a}))},children:[t.jsx(I.i4,{children:t.jsx(I.ki,{placeholder:"Filter by status"})}),t.jsx(I.Bw,{children:(0,t.jsxs)(I.DI,{children:[t.jsx(I.n5,{children:"User status"}),t.jsx(I.Ql,{value:"all",children:"All statuses"}),k.map(e=>t.jsx(I.Ql,{value:e.value,children:e.label},e.value))]})})]})}),t.jsx("div",{children:(0,t.jsxs)(I.Ph,{value:c,onValueChange:e=>{let a="all"===e?[]:[e];i(e),r({roles:a},e=>!e&&d.push({role:a[0]}))},children:[t.jsx(I.i4,{children:t.jsx(I.ki,{placeholder:"Filter by role"})}),t.jsx(I.Bw,{children:(0,t.jsxs)(I.DI,{children:[t.jsx(I.n5,{children:"User roles"}),t.jsx(I.Ql,{value:"all",children:"All roles"}),a.map(e=>t.jsx(I.Ql,{value:e.name,children:e.description},e.name))]})})]})}),t.jsx("div",{children:t.jsx(C.z,{variant:"outline",className:"w-auto h-auto border-primary text-primary",asChild:!0,children:(0,t.jsxs)(w.default,{href:"/users/add",children:[t.jsx(R.Z,{className:"w-4 h-4 mr-1"}),"New User"]})})})]})}var U=r(74723),S=r(7890),$=r(31048),O=r(96221);function _({open:e,userIds:a,roles:r,onOpenChange:n,updateUsers:l,onSaveSuccess:d}){let{alert:c}=(0,O.s)(),{parsed:o,replace:f}=(0,h.l)(),[u,b]=(0,s.useState)(!1),{watch:m,setValue:p,handleSubmit:x}=(0,U.cI)({defaultValues:{role:""}}),g=(0,s.useCallback)(()=>{f({bulkEdit:void 0}),p("role","")},[n,f,p]),y=x(e=>{(async()=>{try{b(!0),a.length&&(await i.Z.post("/api/users/update",{data:a.map(a=>({userId:a,data:e}))}),d&&await d()),c({variant:"success",message:"Users updated",onClose:g})}catch(e){c({title:"",message:"Failed to update users: "+e.message,variant:"error"})}finally{b(!1)}})()}),j=m("role");return t.jsx(t.Fragment,{children:t.jsx(S.yo,{open:e,onOpenChange:e=>{e||g(),n?.(e)},children:(0,t.jsxs)(S.ue,{side:"right",className:"p-0 m-0 flex flex-col",children:[t.jsx(S.Tu,{className:"py-2 px-4 border-b border-b-border",children:t.jsx(S.bC,{children:"Bulk edit users"})}),t.jsx("div",{className:"flex-1 flex flex-col py-2 px-4 gap-y-4 overflow-y-auto",children:(0,t.jsxs)("div",{children:[t.jsx($._,{htmlFor:"role",children:"Role"}),(0,t.jsxs)(I.Ph,{value:j,required:!0,name:"role",disabled:u,onValueChange:e=>{p("role",e)},children:[t.jsx(I.i4,{children:t.jsx(I.ki,{placeholder:"-- select role --"})}),t.jsx(I.Bw,{children:(0,t.jsxs)(I.DI,{children:[t.jsx(I.n5,{children:"User role"}),r.map(e=>t.jsx(I.Ql,{value:e.name,children:e.description},e.name))]})})]})]})}),(0,t.jsxs)("div",{className:"border-t border-t-border px-4 py-2 flex justify-end gap-x-2",children:[t.jsx(S.sw,{asChild:!0,children:t.jsx(C.z,{variant:"outline",children:"Cancel"})}),t.jsx(C.z,{onClick:y,disabled:!j,children:"Save"})]})]})})})}function F({users:e,roles:a,user:r,getUsers:d,deleteUsers:y,getUser:j,updateUsers:v,createUsers:w,searchUsers:N,resetUsersPasswords:C}){let R=(0,h.l)(),{mode:I}=(0,g.b)(),[k,U]=(0,s.useState)(e),[S,$]=(0,s.useState)(!1),[O,F]=(0,s.useState)([]),{confirm:T}=(0,x.t)(),q=(0,s.useCallback)(async(a,r)=>{$(!0);let t=(await i.Z.get("/api/users?data="+JSON.stringify({...R.parsed,roles:R.parsed.role?[R.parsed.role]:void 0,page:1,limit:e.limit,...a}))).data;t.error?n.Am.error(t.error):(U(t),F([])),r?.(t.error,t),$(!1)},[d,R,e]),D=(0,s.useCallback)((e,a)=>{let r=k.data.filter(a=>e.includes(a.userId)).map(e=>e.displayName);T(()=>{(async()=>{try{$(!0),await i.Z.delete("/api/users?data="+JSON.stringify(e)),await q(),a?.()}catch(e){n.Am.error(e.message)}finally{$(!1)}})()},{title:"Delete "+(r.length>1?"users":"user"),message:`<p>Are you sure you want to delete:</p> ${r.map(e=>`<div class="font-bold text-danger">${e}</div>`).join("")}`,negativeLabel:"Cancel",positiveLabel:"Delete",danger:!0})},[T,y,q,k]),Z=(0,s.useCallback)((e,a)=>{let r=k.data.filter(a=>e.includes(a.userId)).map(e=>e.displayName);T(()=>{(async()=>{try{$(!0),await i.Z.post("/api/users/reset-passwords",{usersIds:e}),n.Am.success("Passwords reset successful!"),a?.()}catch(e){n.Am.error(e.message)}finally{$(!1)}})()},{title:"Reset "+(r.length>1?"users passwords":"user password"),message:`<p>Are you sure you want to reset users passwords:</p> ${r.map(e=>`<div class="font-bold text-danger">${e}</div>`).join("")}`,negativeLabel:"Cancel",positiveLabel:"Reset",danger:!0})},[T,C,k]),E=(0,s.useMemo)(()=>"view"===I,[I]),L=t.jsx(_,{roles:a,open:!!O.length,userIds:O.map(e=>k.data[e].userId),updateUsers:v,onSaveSuccess:()=>q({page:k.page}),onOpenChange:e=>!e&&F([])});return(0,t.jsxs)(t.Fragment,{children:[S&&t.jsx(p.a,{overlay:!0}),L,(0,t.jsxs)("div",{className:"flex flex-col",children:[t.jsx(u.DataTable,{title:"Users",selectable:!E,selectedIndexes:O,onSelect:F,search:{inputPlaceholder:"Search users"},headerActions:t.jsx(A,{users:k,roles:a,selected:O.map(e=>k.data[e].userId),onDelete:D,getUsers:q,searchUsers:N}),columns:[{name:"Display name"},{name:"Email"},{name:"Role"},{name:"Last login date"},{name:"Active",align:"right",cellRenderer(e){let a=k.data[e.rowIndex];return t.jsx(o.pn,{delayDuration:0,children:(0,t.jsxs)(o.u,{children:[t.jsx(o.aJ,{asChild:!0,children:t.jsx(l,{className:(0,f.cn)(a.activationDate?"text-green-400":"text-gray-400","w-4 h-4")})}),!!a.activationDate&&t.jsx(o._v,{children:(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Activation date: ",c()(a.activationDate).format("LLL")]})})]})})}},{name:"Action",align:"right",cellRenderer(e){let a=k.data[e.rowIndex];return t.jsx(P,{email:a.email,userId:a.userId,userName:a.displayName,isActivated:!!a.activationDate,onDelete:()=>D([a.userId]),onResetPasswords:()=>Z([a.userId])})}}],data:k.data.map(e=>[e.displayName,e.email,a.filter(a=>a.name===e.role)[0]?.description||e.role,e.lastLoginDate?c()(e.lastLoginDate).format("LLL"):"",""])}),t.jsx(m.Separator,{}),t.jsx("div",{className:"p-2",children:t.jsx(b.t,{currentPage:k.page,totalPages:k.totalPages,disabled:S,limit:k.limit||k.totalRows,totalRows:k.totalRows,collectionName:"users",onPaginate:e=>q({page:e},(e,a)=>!e&&R.push({page:a?.page||k.page})),hideControls:!1,hideSummary:!1})})]})]})}},7636:(e,a,r)=>{"use strict";r.d(a,{DataTable:()=>N});var t=r(10326),s=r(17577),n=r(9439),l=r(61541),d=r(99598),c=r(15940),i=r(77863),o=r(90772),f=r(53313),u=r(65304),b=r(61198),m=r(60097),p=r(79256),h=r(25696),x=r(91216),g=r(47206);let y=[{value:"asc",label:"Asc",Icon:p.Z},{value:"desc",label:"Desc",Icon:h.Z},{value:"hide",label:"Hide",divider:!0,Icon:x.Z}],j=({column:e,value:a,onFilter:r})=>{let s=y.filter(e=>e.value===a)[0],n=s?.Icon||g.Z;return(0,t.jsxs)(m.h_,{children:[t.jsx(m.$F,{asChild:!0,children:(0,t.jsxs)(o.z,{variant:"ghost",size:"sm",className:" focus-visible:ring-0  focus-visible:ring-transparent  focus-visible:ring-offset-0 ",children:[t.jsx("span",{className:"mr-2",children:e.name}),t.jsx(n,{className:"w-4 h-4"})]})}),t.jsx(m.AW,{align:"end",children:y.filter(a=>"hide"!==a.value||!1!==e.canHide).map(e=>(0,t.jsxs)(m.Xi,{onClick:()=>r(e.value),className:(0,i.cn)(e.divider?"border-t":""),children:[t.jsx(e.Icon,{className:"w-4 h-4 mr-2"}),e.label]},e.value))})]})},v=(0,s.forwardRef)(({searchButton:e,hideSearchButton:a,...r},s)=>t.jsx(t.Fragment,{children:(0,t.jsxs)("div",{className:(0,i.cn)("flex w-full"),children:[t.jsx("div",{className:(0,i.cn)("relative w-full"),children:t.jsx("input",{ref:s,type:"search",placeholder:"Search",...r,className:(0,i.cn)("w-full pl-4 py-2 rounded-l-full border focus:outline-none focus:border-secondary bg-transparent",r.className)})}),!a&&t.jsx("button",{type:"button",className:(0,i.cn)("px-5 py-2.5 transition-colors bg-transparent border border-l-0 rounded-r-full hover:bg-secondary/10 disabled:opacity-50 disabled:cursor-not-allowed",e?.className),...e,children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"size-5",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"})})})]})}));function w({title:e,search:a,headerActions:r}){let n=!a&&!e&&!r,[l,d]=(0,s.useState)(a?.value||"");return n?null:t.jsx(t.Fragment,{children:t.jsx("div",{className:"px-4 py-4 flex flex-col gap-y-2",children:(0,t.jsxs)("div",{className:"flex flex-col gap-y-2 md:flex-row md:gap-y-0 md:gap-x-2",children:[(0,t.jsxs)("div",{className:(0,i.cn)("flex items-center gap-x-2",!e&&"hidden"),children:[!!e&&t.jsx("div",{className:(0,i.cn)("md:mr-auto","string"==typeof e?"text-2xl":""),children:e}),t.jsx("div",{className:"ml-auto"})]}),t.jsx("div",{className:(0,i.cn)("flex-1",!a&&"hidden"),children:!!a&&t.jsx("form",{onSubmit:e=>{e.preventDefault(),e.stopPropagation(),l&&a?.setValue?.(l)},children:t.jsx(v,{placeholder:a?.inputPlaceholder||"Search",value:l,onChange:e=>{let r=e.target.value;d(r),r||a?.setValue?.(r)},searchButton:{type:"submit"}})})}),t.jsx("div",{className:(0,i.cn)("flex flex-row flex-wrap gap-x-2 gap-y-1 md:ml-auto",!r&&"hidden"),children:r})]})})})}v.displayName="SearchInput";let N=e=>{let{selectable:a=!1,loading:r,sortable:m,tableClassname:p,tableRowClassname:h,tableBodyClassname:x,filter:g,onSort:y}=e,v=(0,s.useRef)(null),{searchValue:N,state:{columns:C,rows:P,skeletonRows:R,selected:I},setSearchValue:k,setState:A,setFilter:U,setSelected:S,toggleColumn:$}=function({props:e}){(0,s.useRef)(!1);let{selectable:a,sortable:r,selectedIndexes:t,columns:n,data:l,maxRows:d,search:c,onFilteredRowsChange:i,onSelect:o}=e,[f,u]=(0,s.useState)(""),m=(0,b.N)(c?.value||f),p=(0,s.useCallback)((e="")=>{u(e),c?.setValue?.(e)},[c]),[h,x]=(0,s.useState)({selected:{},columns:[],unfilteredRows:[],rows:[],skeletonRows:[]});(0,s.useCallback)(()=>a?{...t?.reduce((e,a)=>({...e,[a]:!0}),{})}:{},[t,a]);let g=(0,s.useCallback)(e=>{let a=[];x(r=>{let t=e.length===r.rows.length,s=Object.values(r.selected).filter(e=>e).length===r.rows.length,n={...r.selected};return e.forEach(e=>{n[e]=t?!s:!n[e]}),a=Object.keys(n).filter(e=>n[e]).map(e=>Number(e)),{...r,selected:n}}),o?.(a)},[x,o]);return{state:h,searchValue:m,setSearchValue:p,setState:x,setSelected:g,toggleColumn:e=>x(a=>{let r=[...a.columns].map(a=>({...a,filter:null,hidden:a.columnIndex===e?!a.hidden:a.hidden}));return{...a,columns:r}}),setFilter:(e,a)=>x(r=>{let t=[...r.columns].map(r=>{let t=r.columnIndex===e?a:null;return{...r,filter:t}}),s=t.filter(a=>a.columnIndex===e)[0],n=[...r.rows];return a&&(n=function({column:e,rows:a}){return a.sort((a,r)=>{let t=a.cells.filter(a=>a.columnIndex===e.columnIndex)[0].value||"",s=r.cells.filter(a=>a.columnIndex===e.columnIndex)[0].value||"",n=0;if("number"===e.filterType){let a=Number(t),r=Number(s);if(!(isNaN(a)||isNaN(r)))switch(e.filter){case"asc":n=a-r;break;case"desc":n=r-a}}else if("text"===e.filterType)switch(e.filter){case"asc":n=t.localeCompare(s);break;case"desc":n=s.localeCompare(t)}return n})}({rows:n,column:s})),{...r,columns:t,rows:n}})}}({props:e}),O=(0,s.useMemo)(()=>r?R:P,[r,R,P]),_=(0,s.useCallback)((e,a)=>{let r=[];A(t=>{let s=(0,l.q)([...t.rows],e,a);return r=s.map((e,a)=>({oldIndex:e.rowIndex,newIndex:a})),{...t,rows:s}}),y?.(e,a,r),S([])},[A,y,S]),F=!N&&m&&!e.rowRenderer;return(0,t.jsxs)(t.Fragment,{children:[t.jsx(w,{...e,search:e.search?{...e.search,value:N,setValue:k}:void 0}),t.jsx(n.ZP,{allowDrag:!!F,onSortEnd:_,draggedItemClassName:"opacity-90 z-[9999999999999]",customHolderRef:v,children:t.jsx("div",{className:"space-y-4",children:(0,t.jsxs)(c.iA,{className:(0,i.cn)("w-full overflow-x-auto",p),children:[t.jsx(c.xD,{className:(0,i.cn)(e.theadClassName),children:(0,t.jsxs)(c.SC,{children:[a&&t.jsx(c.ss,{className:(0,i.cn)(C[0]?.cellClassName,"w-8"),children:t.jsx(f.X,{disabled:r,checked:!!O.length&&Object.values(I).filter(e=>e).length===O.length,onCheckedChange:()=>S(O.map(e=>e.rowIndex))})}),F&&t.jsx(c.ss,{className:(0,i.cn)(C[0]?.cellClassName,"w-4")}),C.map(a=>t.jsx(c.ss,{colSpan:a.colSpan,align:a.align,className:(0,i.cn)(e.cellClassName,e.thClassName,a.cellClassName,a.thClassName,"px-2",a.hidden?"hidden":"",a.align?({left:"text-left",center:"text-center",right:"text-right",justify:"text-justify",char:""})[a.align]:""),children:(()=>{switch(a.filterType){case"number":case"text":return t.jsx(j,{column:a,value:a.filter,onFilter:e=>{"hide"===e?$(a.columnIndex):U(a.columnIndex,e)}});default:return t.jsx(o.z,{variant:"ghost",size:"sm",className:" focus-visible:ring-0  focus-visible:ring-transparent  focus-visible:ring-offset-0 hover:bg-transparent hover:text-primary ",children:a.name||""})}})()},a.id))]})}),(0,t.jsxs)(c.RM,{ref:v,className:x,children:[!O.length&&t.jsx(c.SC,{className:"p-0",children:t.jsx(c.pj,{colSpan:C.length+(a?1:0)+(F?1:0),className:"p-4 text-center text-muted-foreground",children:e.noDataMessage||"No data to display"})}),O.map(l=>{if(g&&!g(l.rowIndex))return null;let o={...e.getRowOptions?.({rowIndex:l.rowIndex})};o={...o,className:(0,i.cn)(e.trClassName,"hover:bg-primary/10",I[l.rowIndex]?"bg-primary/10":"",h,o.className)};let b=[...a?[t.jsx(c.pj,{className:(0,i.cn)(C[0]?.cellClassName,"w-8"),children:t.jsx(f.X,{disabled:r,checked:!!I[l.rowIndex],onCheckedChange:()=>S([l.rowIndex])})},"select-checkbox")]:[],...F?[t.jsx(c.pj,{className:(0,i.cn)(C[0]?.cellClassName,"w-4 cursor-move"),children:t.jsx(n.TI,{children:t.jsx(d.Z,{className:"w-4 h-4 text-muted-foreground"})})},"sort-handle")]:[],...l.cells.map(a=>{let n=C[a.columnIndex],d={...e.getCellOptions?.({rowIndex:l.rowIndex,columnIndex:a.columnIndex})};return(0,s.createElement)(c.pj,{...d,key:a.id,colSpan:n.colSpan,align:n.align,className:(0,i.cn)(e.cellClassName,e.tdClassName,n.cellClassName,n.tdClassName,"px-4",d.className,n.hidden?"hidden":"")},r?t.jsx(u.O,{className:"h-4 w-[120px] bg-black/10 dark:bg-white/10"}):n.cellRenderer?n.cellRenderer(a):a.value)})];return e.rowRenderer?e.rowRenderer({props:o,cells:b,rowIndex:l.rowIndex}):t.jsx(n.TR,{children:t.jsx(c.SC,{...o,children:b})},l.id)})]})]})})})]})}},53313:(e,a,r)=>{"use strict";r.d(a,{X:()=>c});var t=r(10326),s=r(17577),n=r(13635),l=r(32933),d=r(77863);let c=s.forwardRef(({className:e,...a},r)=>t.jsx(n.fC,{ref:r,className:(0,d.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...a,children:t.jsx(n.z$,{className:(0,d.cn)("flex items-center justify-center text-current"),children:t.jsx(l.Z,{className:"h-4 w-4"})})}));c.displayName=n.fC.displayName},34474:(e,a,r)=>{"use strict";r.d(a,{Bw:()=>h,DI:()=>f,Ph:()=>o,Ql:()=>g,U$:()=>y,i4:()=>b,ki:()=>u,n5:()=>x});var t=r(10326),s=r(17577),n=r(44875),l=r(941),d=r(96633),c=r(32933),i=r(77863);let o=n.fC,f=n.ZA,u=n.B4,b=s.forwardRef(({className:e,children:a,error:r,...s},d)=>(0,t.jsxs)(n.xz,{ref:d,className:(0,i.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm placeholder:text-muted-foreground focus:outline-none disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",r&&"border-danger",e),...s,children:[a,t.jsx(n.JO,{asChild:!0,children:t.jsx(l.Z,{className:"h-4 w-4 opacity-50"})})]}));b.displayName=n.xz.displayName;let m=s.forwardRef(({className:e,...a},r)=>t.jsx(n.u_,{ref:r,className:(0,i.cn)("flex cursor-default items-center justify-center py-1",e),...a,children:t.jsx(d.Z,{className:"h-4 w-4"})}));m.displayName=n.u_.displayName;let p=s.forwardRef(({className:e,...a},r)=>t.jsx(n.$G,{ref:r,className:(0,i.cn)("flex cursor-default items-center justify-center py-1",e),...a,children:t.jsx(l.Z,{className:"h-4 w-4"})}));p.displayName=n.$G.displayName;let h=s.forwardRef(({className:e,children:a,position:r="popper",...s},l)=>t.jsx(n.h_,{children:(0,t.jsxs)(n.VY,{ref:l,className:(0,i.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===r&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r,...s,children:[t.jsx(m,{}),t.jsx(n.l_,{className:(0,i.cn)("p-1","popper"===r&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),t.jsx(p,{})]})}));h.displayName=n.VY.displayName;let x=s.forwardRef(({className:e,...a},r)=>t.jsx(n.__,{ref:r,className:(0,i.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...a}));x.displayName=n.__.displayName;let g=s.forwardRef(({className:e,children:a,...r},s)=>(0,t.jsxs)(n.ck,{ref:s,className:(0,i.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[t.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:t.jsx(n.wU,{children:t.jsx(c.Z,{className:"h-4 w-4"})})}),t.jsx(n.eT,{children:a})]}));g.displayName=n.ck.displayName;let y=s.forwardRef(({className:e,...a},r)=>t.jsx(n.Z0,{ref:r,className:(0,i.cn)("-mx-1 my-1 h-px bg-muted",e),...a}));y.displayName=n.Z0.displayName},15940:(e,a,r)=>{"use strict";r.d(a,{RM:()=>c,SC:()=>i,iA:()=>l,pj:()=>f,ss:()=>o,xD:()=>d});var t=r(10326),s=r(17577),n=r(77863);let l=s.forwardRef(({className:e,...a},r)=>t.jsx("div",{className:"relative w-full overflow-auto",children:t.jsx("table",{ref:r,className:(0,n.cn)("w-full caption-bottom text-sm",e),...a})}));l.displayName="Table";let d=s.forwardRef(({className:e,...a},r)=>t.jsx("thead",{ref:r,className:(0,n.cn)("[&_tr]:border-b",e),...a}));d.displayName="TableHeader";let c=s.forwardRef(({className:e,...a},r)=>t.jsx("tbody",{ref:r,className:(0,n.cn)("[&_tr:last-child]:border-0",e),...a}));c.displayName="TableBody",s.forwardRef(({className:e,...a},r)=>t.jsx("tfoot",{ref:r,className:(0,n.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...a})).displayName="TableFooter";let i=s.forwardRef(({className:e,...a},r)=>t.jsx("tr",{ref:r,className:(0,n.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...a}));i.displayName="TableRow";let o=s.forwardRef(({className:e,...a},r)=>t.jsx("th",{ref:r,className:(0,n.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...a}));o.displayName="TableHead";let f=s.forwardRef(({className:e,...a},r)=>t.jsx("td",{ref:r,className:(0,n.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...a}));f.displayName="TableCell",s.forwardRef(({className:e,...a},r)=>t.jsx("caption",{ref:r,className:(0,n.cn)("mt-4 text-sm text-muted-foreground",e),...a})).displayName="TableCaption"},68232:(e,a,r)=>{"use strict";r.d(a,{_v:()=>o,aJ:()=>i,pn:()=>d,u:()=>c});var t=r(10326),s=r(17577),n=r(39313),l=r(77863);let d=n.zt,c=n.fC,i=n.xz,o=s.forwardRef(({className:e,sideOffset:a=4,...r},s)=>t.jsx(n.VY,{ref:s,sideOffset:a,className:(0,l.cn)("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r}));o.displayName=n.VY.displayName},61198:(e,a,r)=>{"use strict";r.d(a,{N:()=>s});var t=r(17577);function s(e,a){let[r,s]=(0,t.useState)(e);return r}},12260:(e,a,r)=>{"use strict";r.d(a,{l:()=>l});var t=r(35047),s=r(15491),n=r(17577);function l(){let e=(0,t.useRouter)(),a=(0,t.useSearchParams)(),r=(0,n.useMemo)(()=>a.toString(),[a]),l=(0,n.useMemo)(()=>s.Z.parse(a.toString()),[a]),d=(0,n.useCallback)(e=>s.Z.stringify({...l,...e}),[l]),c=(0,n.useCallback)(a=>{e.push(`?${d(a)}`)},[d,e]);return{parsed:l,stringified:r,replace:(0,n.useCallback)(a=>{e.replace(`?${d(a)}`)},[d,e]),push:c,toSearchParams:d}}},84232:(e,a,r)=>{"use strict";r.r(a),r.d(a,{default:()=>d});var t=r(19510),s=r(21113),n=r(24569),l=r(46697);function d(){return t.jsx(n.V,{children:t.jsx(l.Zb,{children:t.jsx(l.aY,{className:"p-0",children:t.jsx(s.w,{loading:!0,maxRows:25,columns:[{name:"Display Name"},{name:"Email"},{name:"Role"},{name:"Last login date"},{name:"Active",align:"right",cellClassName:"w-20"},{name:"Action",align:"right",cellClassName:"w-20"}],data:[]})})})})}},13005:(e,a,r)=>{"use strict";r.r(a),r.d(a,{default:()=>p,dynamic:()=>m});var t=r(19510),s=r(73508),n=r(43767),l=r(24569),d=r(85431),c=r(46697),i=r(68570);let o=(0,i.createProxy)(String.raw`/home/watkay/ReactProjects/neotree-editor/app/(dashboard)/users/components/table.tsx`),{__esModule:f,$$typeof:u}=o;o.default;let b=(0,i.createProxy)(String.raw`/home/watkay/ReactProjects/neotree-editor/app/(dashboard)/users/components/table.tsx#UsersTable`),m="force-dynamic";async function p({searchParams:e}){let{page:a,role:r,status:i,userId:o}=await e,[f,u,m]=await Promise.all([(0,s.getUsers)({limit:25,page:a?Number(a):void 0,roles:r?[r]:void 0,status:i}),(0,n.getRoles)(),o?await (0,s.getUser)(o):null]);return(0,t.jsxs)(t.Fragment,{children:[t.jsx(d.D,{children:"Users"}),t.jsx(l.V,{children:f.error?t.jsx(c.Zb,{className:"border-danger bg-danger/20 text-center",children:t.jsx(c.aY,{children:t.jsx("div",{className:"text-danger",children:f.error})})}):t.jsx(c.Zb,{children:t.jsx(c.aY,{className:"p-0",children:t.jsx(b,{user:m,users:f,roles:u,getUsers:s.getUsers,deleteUsers:s.deleteUsers,getUser:s.getUser,updateUsers:s.updateUsers,createUsers:s.createUsers,searchUsers:s.searchUsers,resetUsersPasswords:s.resetUsersPasswords})})})})]})}},43767:(e,a,r)=>{"use strict";r.r(a),r.d(a,{getRoles:()=>d});var t=r(24330);r(60166);var s=r(10413);async function n(){return await s.Z.query.userRoles.findMany()}var l=r(57435);async function d(){try{return await n()}catch(e){return l.Z.error("getRoles ERROR:",e),[]}}(0,r(40618).h)([d]),(0,t.j)("8ab7a6da9de9c86875f970a384e05b5853c94709",d)},73508:(e,a,r)=>{"use strict";r.r(a),r.d(a,{$$ACTION_0:()=>R,$$ACTION_1:()=>k,$$ACTION_2:()=>S,$$ACTION_3:()=>O,$$ACTION_4:()=>F,createUsers:()=>U,deleteUsers:()=>A,getFullUser:()=>C,getUser:()=>w,getUserMini:()=>N,getUsers:()=>P,isEmailRegistered:()=>v,resetUsersPasswords:()=>j,searchUsers:()=>I,setPassword:()=>_,updateUsers:()=>$});var t=r(24330);r(60166);var s=r(67096),n=r.n(s),l=r(57745),d=r(9576),c=r(8629),i=r(10413),o=r(93567),f=r(47625);async function u(e){for(let a of e)await i.Z.update(o.users).set({password:""}).where((0,l.eq)(o.users.userId,a));return!0}async function b(e){for(let a of e){let e=new Date;await i.Z.update(o.users).set({deletedAt:e,email:a,displayName:"Former user",firstName:null,lastName:null,avatar:null,avatar_md:null,avatar_sm:null}).where((0,l.eq)(o.users.userId,a))}return!0}async function m(e,a){let r=[];for(let a of e){let e=await n().genSalt(10),t=await n().hash(a.password||(0,d.Z)(),e);r.push({...a,password:t,userId:a.userId||(0,d.Z)()})}let t={inserted:[],success:!1};try{if(await i.Z.insert(o.users).values(r),a?.returnInserted){let e=await (0,f.yT)({userIds:r.map(e=>e.userId)});t.inserted=e.data}t.success=!0}catch(e){t.error=e.message}finally{return t}}async function p(e,a){let r=[];for(let{userId:t,data:{userId:s,deletedAt:n,id:d,createdAt:u,updatedAt:b,email:m,...p}}of e)try{let e=c.C.test(t)?(0,l.eq)(o.users.email,t):(0,l.eq)(o.users.userId,t);await i.Z.update(o.users).set(p).where(e);let s=a?.returnUpdated?await (0,f.IQ)(t):void 0;r.push({userId:t,user:s})}catch(e){r.push({userId:t,error:e.message})}return r}var h=r(57435),x=r(70733),g=r(66267),y=r(40618);let j=u;async function v(e){try{let a=await (0,f.IQ)(e);return{yes:!!a,isActive:!!a?.isActive}}catch(e){return h.Z.error("getUser ERROR:",e),{errors:[e.message],yes:!1}}}async function w(e){try{return await (0,g.isAllowed)("get_user"),await (0,f.IQ)(e)||null}catch(e){return h.Z.error("getUser ERROR:",e),null}}async function N(e){try{return await (0,g.isAllowed)("get_user"),await (0,f.$M)(e)||null}catch(e){return h.Z.error("getUserMini ERROR:",e),null}}async function C(e){try{return await (0,g.isAllowed)("get_user"),await (0,f.C)(e)||null}catch(e){return h.Z.error("getFullUser ERROR:",e),null}}let P=(0,t.j)("c5514b7679b6c600fb116e72f23fdd076bc97ac3",R);async function R(...e){try{return await (0,g.isAllowed)("get_users"),await (0,f.yT)(...e)}catch(e){return{...f.Ko,error:e.message}}}let I=(0,t.j)("9696bfffca19346bf89c5ba78b70e7c7f30ddc5a",k);async function k(...e){try{return await (0,g.isAllowed)("search_users"),await (0,f.yT)(...e)}catch(e){return{...f.Ko,error:e.message}}}async function A(e){if(await (0,g.isAllowed)("delete_users"),e.length){let{data:a}=await (0,f.yT)({userIds:e});await b(e)}return!0}let U=(0,t.j)("dcbdf5b4e56da69434c179de89b3624b2723b670",S);async function S(...e){try{await (0,g.isAllowed)("create_users");let a=await m(...e);for(let a of e[0])try{await (0,x.n)({userId:a.userId,hoursValid:1})}catch(e){}return a}catch(e){throw h.Z.error("createUsers ERROR",e),e}}let $=(0,t.j)("7c059ad36ec696816e015d837e81d99f35302949",O);async function O(...e){try{return await (0,g.isAllowed)("update_users"),await p(...e)}catch(e){throw h.Z.error("updateUsers ERROR",e),e}}let _=(0,t.j)("1a344b698c820488aa3eeebdf84313d6c6c2fa06",F);async function F(e){try{if(!e.password)throw Error("Missing: password");if(!e.email)throw Error("Missing: email");if(e.password.length<6)throw Error("Password is too short: min 6 characters");if(e.password!==e.passwordConfirm)throw Error("Password confirmation does not match!");let a=await n().genSalt(10),r=await n().hash(e.password,a),t=await p([{userId:e.email,data:{password:r}}]);if(t.filter(e=>e.error).length)throw Error(t.filter(e=>e.error).map(e=>e.error).join(", "));return{success:!0}}catch(e){return h.Z.error("setPassword ERROR",e),{success:!1,errors:[e.message]}}}(0,y.h)([j,v,w,N,C,P,I,A,U,$,_]),(0,t.j)("756f854d60219b5b63cf63ea9fddced48eb33662",j),(0,t.j)("4588c65b6fb85ba2650217826247ed78e49be95a",v),(0,t.j)("770a8e41849bda456313154fb660d8045d3089c1",w),(0,t.j)("56d1e39e5ef168c8a44e5b6533cac49737d0836f",N),(0,t.j)("ef593127d00e8e5d39c70094fa84754b13d96377",C),(0,t.j)("05e67aa00650fc8732ea884d2fa5edfffcd4f5dc",P),(0,t.j)("349fa565a9e7645859203619f67e35d103d96fc3",I),(0,t.j)("2a51d2b91ddb4ac57bffd72136b2a8e4811255a6",A),(0,t.j)("439bcc76f1d754796c6752dc79e8c109ae8f950c",U),(0,t.j)("1afe159261df7780f0ac2e2aba67daaf2ff555dc",$),(0,t.j)("2dcc703dc0710c185b243f54d71a10a5e92689b9",_)},24569:(e,a,r)=>{"use strict";r.d(a,{V:()=>n});var t=r(19510),s=r(50650);function n({className:e,...a}){return t.jsx("div",{...a,className:(0,s.cn)("w-full max-w-screen-xl mx-auto p-5",e)})}},21113:(e,a,r)=>{"use strict";r.d(a,{w:()=>d});var t=r(68570);let s=(0,t.createProxy)(String.raw`/home/watkay/ReactProjects/neotree-editor/components/data-table/index.tsx`),{__esModule:n,$$typeof:l}=s;s.default;let d=(0,t.createProxy)(String.raw`/home/watkay/ReactProjects/neotree-editor/components/data-table/index.tsx#DataTable`)},46697:(e,a,r)=>{"use strict";r.d(a,{Ol:()=>d,Zb:()=>l,aY:()=>i,ll:()=>c});var t=r(19510),s=r(71159),n=r(50650);let l=s.forwardRef(({className:e,...a},r)=>t.jsx("div",{ref:r,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...a}));l.displayName="Card";let d=s.forwardRef(({className:e,...a},r)=>t.jsx("div",{ref:r,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",e),...a}));d.displayName="CardHeader";let c=s.forwardRef(({className:e,...a},r)=>t.jsx("h3",{ref:r,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",e),...a}));c.displayName="CardTitle",s.forwardRef(({className:e,...a},r)=>t.jsx("p",{ref:r,className:(0,n.cn)("text-sm text-muted-foreground",e),...a})).displayName="CardDescription";let i=s.forwardRef(({className:e,...a},r)=>t.jsx("div",{ref:r,className:(0,n.cn)("p-6 pt-0",e),...a}));i.displayName="CardContent",s.forwardRef(({className:e,...a},r)=>t.jsx("div",{ref:r,className:(0,n.cn)("flex items-center p-6 pt-0",e),...a})).displayName="CardFooter"},70733:(e,a,r)=>{"use strict";r.d(a,{n:()=>d});var t=r(51744),s=r.n(t),n=r(10413),l=r(93567);async function d({userId:e,hoursValid:a}){return(await n.Z.insert(l.tokens).values({userId:e,validUntil:s()(new Date).add(a,"hour").toDate(),token:Math.floor(1e5+9e5*Math.random())}).returning())[0]}},15491:(e,a,r)=>{"use strict";r.d(a,{Z:()=>N});var t={};r.r(t),r.d(t,{exclude:()=>w,extract:()=>h,parse:()=>x,parseUrl:()=>y,pick:()=>v,stringify:()=>g,stringifyUrl:()=>j});let s="%[a-f0-9]{2}",n=RegExp("("+s+")|([^%]+?)","gi"),l=RegExp("("+s+")+","gi");function d(e,a){if(!("string"==typeof e&&"string"==typeof a))throw TypeError("Expected the arguments to be of type `string`");if(""===e||""===a)return[];let r=e.indexOf(a);return -1===r?[]:[e.slice(0,r),e.slice(r+a.length)]}let c=e=>null==e,i=e=>encodeURIComponent(e).replaceAll(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),o=Symbol("encodeFragmentIdentifier");function f(e){if("string"!=typeof e||1!==e.length)throw TypeError("arrayFormatSeparator must be single character string")}function u(e,a){return a.encode?a.strict?i(e):encodeURIComponent(e):e}function b(e,a){return a.decode?function(e){if("string"!=typeof e)throw TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return decodeURIComponent(e)}catch{return function(e){let a={"%FE%FF":"��","%FF%FE":"��"},r=l.exec(e);for(;r;){try{a[r[0]]=decodeURIComponent(r[0])}catch{let e=function(e){try{return decodeURIComponent(e)}catch{let a=e.match(n)||[];for(let r=1;r<a.length;r++)a=(e=(function e(a,r){try{return[decodeURIComponent(a.join(""))]}catch{}if(1===a.length)return a;r=r||1;let t=a.slice(0,r),s=a.slice(r);return Array.prototype.concat.call([],e(t),e(s))})(a,r).join("")).match(n)||[];return e}}(r[0]);e!==r[0]&&(a[r[0]]=e)}r=l.exec(e)}for(let r of(a["%C2"]="�",Object.keys(a)))e=e.replace(RegExp(r,"g"),a[r]);return e}(e)}}(e):e}function m(e){let a=e.indexOf("#");return -1!==a&&(e=e.slice(0,a)),e}function p(e,a,r){return"string"===r&&"string"==typeof e?e:"function"==typeof r&&"string"==typeof e?r(e):"boolean"===r&&null!==e&&("true"===e.toLowerCase()||"false"===e.toLowerCase())?"true"===e.toLowerCase():"boolean"===r&&null!==e&&("1"===e.toLowerCase()||"0"===e.toLowerCase())?"1"===e.toLowerCase():"string[]"===r&&"none"!==a.arrayFormat&&"string"==typeof e?[e]:"number[]"!==r||"none"===a.arrayFormat||Number.isNaN(Number(e))||"string"!=typeof e||""===e.trim()?"number"!==r||Number.isNaN(Number(e))||"string"!=typeof e||""===e.trim()?a.parseBooleans&&null!==e&&("true"===e.toLowerCase()||"false"===e.toLowerCase())?"true"===e.toLowerCase():a.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?Number(e):e:Number(e):[Number(e)]}function h(e){let a=(e=m(e)).indexOf("?");return -1===a?"":e.slice(a+1)}function x(e,a){f((a={decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1,types:Object.create(null),...a}).arrayFormatSeparator);let r=function(e){let a;switch(e.arrayFormat){case"index":return(e,r,t)=>{if(a=/\[(\d*)]$/.exec(e),e=e.replace(/\[\d*]$/,""),!a){t[e]=r;return}void 0===t[e]&&(t[e]={}),t[e][a[1]]=r};case"bracket":return(e,r,t)=>{if(a=/(\[])$/.exec(e),e=e.replace(/\[]$/,""),!a){t[e]=r;return}if(void 0===t[e]){t[e]=[r];return}t[e]=[...t[e],r]};case"colon-list-separator":return(e,r,t)=>{if(a=/(:list)$/.exec(e),e=e.replace(/:list$/,""),!a){t[e]=r;return}if(void 0===t[e]){t[e]=[r];return}t[e]=[...t[e],r]};case"comma":case"separator":return(a,r,t)=>{let s="string"==typeof r&&r.includes(e.arrayFormatSeparator),n="string"==typeof r&&!s&&b(r,e).includes(e.arrayFormatSeparator);r=n?b(r,e):r;let l=s||n?r.split(e.arrayFormatSeparator).map(a=>b(a,e)):null===r?r:b(r,e);t[a]=l};case"bracket-separator":return(a,r,t)=>{let s=/(\[])$/.test(a);if(a=a.replace(/\[]$/,""),!s){t[a]=r?b(r,e):r;return}let n=null===r?[]:b(r,e).split(e.arrayFormatSeparator);if(void 0===t[a]){t[a]=n;return}t[a]=[...t[a],...n]};default:return(e,a,r)=>{if(void 0===r[e]){r[e]=a;return}r[e]=[...[r[e]].flat(),a]}}}(a),t=Object.create(null);if("string"!=typeof e||!(e=e.trim().replace(/^[?#&]/,"")))return t;for(let s of e.split("&")){if(""===s)continue;let e=a.decode?s.replaceAll("+"," "):s,[n,l]=d(e,"=");void 0===n&&(n=e),l=void 0===l?null:["comma","separator","bracket-separator"].includes(a.arrayFormat)?l:b(l,a),r(b(n,a),l,t)}for(let[e,r]of Object.entries(t))if("object"==typeof r&&null!==r&&"string"!==a.types[e])for(let[t,s]of Object.entries(r)){let n=a.types[e]?a.types[e].replace("[]",""):void 0;r[t]=p(s,a,n)}else"object"==typeof r&&null!==r&&"string"===a.types[e]?t[e]=Object.values(r).join(a.arrayFormatSeparator):t[e]=p(r,a,a.types[e]);return!1===a.sort?t:(!0===a.sort?Object.keys(t).sort():Object.keys(t).sort(a.sort)).reduce((e,a)=>{let r=t[a];return e[a]=r&&"object"==typeof r&&!Array.isArray(r)?function e(a){return Array.isArray(a)?a.sort():"object"==typeof a?e(Object.keys(a)).sort((e,a)=>Number(e)-Number(a)).map(e=>a[e]):a}(r):r,e},Object.create(null))}function g(e,a){if(!e)return"";f((a={encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:",",...a}).arrayFormatSeparator);let r=r=>a.skipNull&&c(e[r])||a.skipEmptyString&&""===e[r],t=function(e){switch(e.arrayFormat){case"index":return a=>(r,t)=>{let s=r.length;return void 0===t||e.skipNull&&null===t||e.skipEmptyString&&""===t?r:null===t?[...r,[u(a,e),"[",s,"]"].join("")]:[...r,[u(a,e),"[",u(s,e),"]=",u(t,e)].join("")]};case"bracket":return a=>(r,t)=>void 0===t||e.skipNull&&null===t||e.skipEmptyString&&""===t?r:null===t?[...r,[u(a,e),"[]"].join("")]:[...r,[u(a,e),"[]=",u(t,e)].join("")];case"colon-list-separator":return a=>(r,t)=>void 0===t||e.skipNull&&null===t||e.skipEmptyString&&""===t?r:null===t?[...r,[u(a,e),":list="].join("")]:[...r,[u(a,e),":list=",u(t,e)].join("")];case"comma":case"separator":case"bracket-separator":{let a="bracket-separator"===e.arrayFormat?"[]=":"=";return r=>(t,s)=>void 0===s||e.skipNull&&null===s||e.skipEmptyString&&""===s?t:(s=null===s?"":s,0===t.length)?[[u(r,e),a,u(s,e)].join("")]:[[t,u(s,e)].join(e.arrayFormatSeparator)]}default:return a=>(r,t)=>void 0===t||e.skipNull&&null===t||e.skipEmptyString&&""===t?r:null===t?[...r,u(a,e)]:[...r,[u(a,e),"=",u(t,e)].join("")]}}(a),s={};for(let[a,t]of Object.entries(e))r(a)||(s[a]=t);let n=Object.keys(s);return!1!==a.sort&&n.sort(a.sort),n.map(r=>{let s=e[r];return void 0===s?"":null===s?u(r,a):Array.isArray(s)?0===s.length&&"bracket-separator"===a.arrayFormat?u(r,a)+"[]":s.reduce(t(r),[]).join("&"):u(r,a)+"="+u(s,a)}).filter(e=>e.length>0).join("&")}function y(e,a){a={decode:!0,...a};let[r,t]=d(e,"#");return void 0===r&&(r=e),{url:r?.split("?")?.[0]??"",query:x(h(e),a),...a&&a.parseFragmentIdentifier&&t?{fragmentIdentifier:b(t,a)}:{}}}function j(e,a){a={encode:!0,strict:!0,[o]:!0,...a};let r=m(e.url).split("?")[0]||"",t=g({...x(h(e.url),{sort:!1}),...e.query},a);t&&=`?${t}`;let s=function(e){let a="",r=e.indexOf("#");return -1!==r&&(a=e.slice(r)),a}(e.url);if("string"==typeof e.fragmentIdentifier){let t=new URL(r);t.hash=e.fragmentIdentifier,s=a[o]?t.hash:`#${e.fragmentIdentifier}`}return`${r}${t}${s}`}function v(e,a,r){let{url:t,query:s,fragmentIdentifier:n}=y(e,r={parseFragmentIdentifier:!0,[o]:!1,...r});return j({url:t,query:function(e,a){let r={};if(Array.isArray(a))for(let t of a){let a=Object.getOwnPropertyDescriptor(e,t);a?.enumerable&&Object.defineProperty(r,t,a)}else for(let t of Reflect.ownKeys(e)){let s=Object.getOwnPropertyDescriptor(e,t);if(s.enumerable){let n=e[t];a(t,n,e)&&Object.defineProperty(r,t,s)}}return r}(s,a),fragmentIdentifier:n},r)}function w(e,a,r){return v(e,Array.isArray(a)?e=>!a.includes(e):(e,r)=>!a(e,r),r)}let N=t}};var a=require("../../../webpack-runtime.js");a.C(e);var r=e=>a(a.s=e),t=a.X(0,[1633,1744,1337,3788,2758,4901,9712,1121,7938,9414,8936,5358,4723,4924,7967,246,413,6267,6741,8781,1162,9132,2418,8778,3883,1271,3173,7645],()=>r(99697));module.exports=t})();