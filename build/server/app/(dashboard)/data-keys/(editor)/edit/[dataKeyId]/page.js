(()=>{var e={};e.id=2116,e.ids=[2116],e.modules={67096:e=>{"use strict";e.exports=require("bcrypt")},47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},39491:e=>{"use strict";e.exports=require("assert")},14300:e=>{"use strict";e.exports=require("buffer")},32081:e=>{"use strict";e.exports=require("child_process")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},41808:e=>{"use strict";e.exports=require("net")},6005:e=>{"use strict";e.exports=require("node:crypto")},87561:e=>{"use strict";e.exports=require("node:fs")},49411:e=>{"use strict";e.exports=require("node:path")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},4074:e=>{"use strict";e.exports=require("perf_hooks")},63477:e=>{"use strict";e.exports=require("querystring")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},76224:e=>{"use strict";e.exports=require("tty")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},14736:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>l.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>c,routeModule:()=>x,tree:()=>o}),r(42386),r(3333),r(4326),r(56367),r(12699),r(99985),r(96560);var a=r(23191),s=r(88716),i=r(37922),l=r.n(i),n=r(95231),d={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>n[e]);r.d(t,d);let o=["",{children:["(dashboard)",{children:["data-keys",{children:["(editor)",{children:["edit",{children:["[dataKeyId]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,42386)),"/home/watkay/ReactProjects/neotree-editor/app/(dashboard)/data-keys/(editor)/edit/[dataKeyId]/page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,3333)),"/home/watkay/ReactProjects/neotree-editor/app/(dashboard)/data-keys/layout.tsx"],loading:[()=>Promise.resolve().then(r.bind(r,4326)),"/home/watkay/ReactProjects/neotree-editor/app/(dashboard)/data-keys/loading.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,56367)),"/home/watkay/ReactProjects/neotree-editor/app/(dashboard)/layout.tsx"],loading:[()=>Promise.resolve().then(r.bind(r,12699)),"/home/watkay/ReactProjects/neotree-editor/app/(dashboard)/loading.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,99985)),"/home/watkay/ReactProjects/neotree-editor/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.bind(r,96560)),"/home/watkay/ReactProjects/neotree-editor/app/not-found.tsx"]}],c=["/home/watkay/ReactProjects/neotree-editor/app/(dashboard)/data-keys/(editor)/edit/[dataKeyId]/page.tsx"],u="/(dashboard)/data-keys/(editor)/edit/[dataKeyId]/page",p={require:r,loadChunk:()=>Promise.resolve()},x=new a.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/(dashboard)/data-keys/(editor)/edit/[dataKeyId]/page",pathname:"/data-keys/edit/[dataKeyId]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},85766:(e,t,r)=>{Promise.resolve().then(r.bind(r,47234)),Promise.resolve().then(r.bind(r,10827))},47234:(e,t,r)=>{"use strict";r.d(t,{DataKeyForm:()=>K});var a=r(10326),s=r(17577),i=r(74723),l=r(83855),n=r(39447),d=r(47035),o=r(61541),c=r(35047),u=r(90434),p=r(47463),x=r(49596),m=r(34474),h=r(60097),y=r(90772),f=r(31048),b=r(54432),j=r(46670),v=r(7636),g=r(58464),q=r(11870),N=r(35392),w=r(33071),k=r(51605),P=r(3529);r(37530);var I=r(24875);let C=e=>{if(!e)return null;let t="string"==typeof e.version?Number(e.version):e.version??null;return{uuid:e.uuid??"",uniqueKey:e.uniqueKey??"",name:e.name??"",refId:e.refId??"",dataType:e.dataType??"",label:e.label??"",options:Array.isArray(e.options)?e.options:[],metadata:e.metadata??{},version:t}};function K(e){let{loadingDataKeys:t}=(0,x.M)();return t?a.jsx(q.a,{overlay:!0}):a.jsx(_,{...e})}function _({disabled:e}){let{dataKeyId:t}=(0,c.useParams)(),{allDataKeys:r,loadingDataKeys:K,saving:_,saveDataKeys:D}=(0,x.M)(),{confirm:S}=(0,j.t)(),{authenticatedUser:R}=(0,P.b)(),A=(0,s.useMemo)(()=>r.find(e=>e.uuid===t||e.uniqueKey===t),[r,t]),F=(0,k.v)({isDraft:!!A?.isDraft,userId:A?.draftCreatedByUserId});e=e||F;let{control:T,register:M,handleSubmit:G,watch:Z,setValue:z}=(0,i.cI)({defaultValues:{...A,name:A?.name||"",refId:A?.refId||"",dataType:A?.dataType||"",label:A?.label||"",options:A?.options||[],metadata:A?.metadata||{},version:A?.version||1}}),V=(0,s.useRef)(null),E=(0,s.useRef)(null);(0,s.useRef)(null);let L=Z("dataType"),$=Z("options"),O=g.y0.find(e=>e.value===L),B=G(async e=>{let t=e?.uuid||A?.uuid||(0,p.Z)(),r=e?.uniqueKey??A?.uniqueKey??null,a={...e,uuid:t,uniqueKey:r,version:"string"==typeof e.version?Number(e.version):e.version};z("uuid",t),r&&z("uniqueKey",r);let s=C(a),i=a.name||a.uniqueKey||"Data Key";if(!A&&s){let e=(await I.pb.getEntityChanges(t,"dataKey")).find(e=>"create"===e.action);e?.id?await I.pb.updateChange(e.id,{fieldName:a.name||"New Data Key",newValue:s,timestamp:Date.now(),userId:R?.userId,userName:R?.displayName,entityTitle:i,fullSnapshot:s}):await I.pb.addChange({entityType:"dataKey",entityId:t,entityTitle:i,action:"create",fieldPath:"dataKey",fieldName:a.name||"New Data Key",oldValue:null,newValue:s,userId:R?.userId,userName:R?.displayName,fullSnapshot:s})}else V.current&&E.current&&s&&await V.current.trackChanges(s,"Data key saved");await D([{...a}],e=>{e||(window.location.href="/data-keys")})}),Q=e||_,W=(0,s.useMemo)(()=>$.map(e=>r.find(t=>t.uniqueKey===e)).filter(e=>e),[r,$]),H=K||_;return(0,a.jsxs)(a.Fragment,{children:[H&&a.jsx(q.a,{overlay:!0}),a.jsx(w.Zb,{children:(0,a.jsxs)(w.aY,{children:[(0,a.jsxs)(w.Ol,{children:[(0,a.jsxs)(w.ll,{children:[A?"Edit":"New"," data key"]}),a.jsx(w.SZ,{className:"hidden",children:""})]}),(0,a.jsxs)("div",{className:"flex-1 flex flex-col py-2 px-0 gap-y-4 overflow-y-auto",children:[a.jsx(i.Qr,{control:T,name:"dataType",disabled:Q,rules:{required:!0},render:({field:{value:e,onChange:t}})=>a.jsx(a.Fragment,{children:(0,a.jsxs)("div",{className:"px-4",children:[a.jsx(f._,{htmlFor:"name",children:"Data type *"}),(0,a.jsxs)(m.Ph,{value:e,name:"name",disabled:Q,onValueChange:e=>{t(e);let r=g.y0.find(t=>t.value===e);z("options",r?.hasChildren&&A?.options||[])},children:[a.jsx(m.i4,{children:a.jsx(m.ki,{placeholder:"Select type"})}),a.jsx(m.Bw,{children:a.jsx(m.DI,{children:g.y0.map(e=>a.jsx(m.Ql,{value:e.value,children:e.label},e.value))})})]})]})})}),(0,a.jsxs)("div",{className:"px-4",children:[a.jsx(f._,{htmlFor:"name",children:"Key *"}),a.jsx(b.I,{disabled:Q,...M("name",{disabled:Q,required:!0})})]}),(0,a.jsxs)("div",{className:"px-4",children:[a.jsx(f._,{htmlFor:"label",children:"Label *"}),a.jsx(b.I,{disabled:Q,...M("label",{disabled:Q,required:!0})})]}),(0,a.jsxs)("div",{className:"px-4 hidden",children:[a.jsx(f._,{htmlFor:"refId",children:"Ref ID"}),a.jsx(b.I,{disabled:Q,...M("refId",{disabled:Q,required:!1})})]}),a.jsx(i.Qr,{control:T,name:"options",disabled:Q,render:({field:{value:t,onChange:s}})=>O?.hasChildren?a.jsx("div",{className:"mt-4 pt-4 border-t border-t-border",children:a.jsx(v.DataTable,{sortable:!e,onSort:(e,r)=>{s((0,o.q)([...t],e,r))},search:{},title:"Options",headerActions:a.jsx(a.Fragment,{children:a.jsx(N.V,{multiple:!0,search:{placeholder:"Search data keys"},options:r.filter(e=>!$.includes(e.uniqueKey)).map(e=>({label:e.name,value:e.uniqueKey,caption:e.dataType||"",description:e.label})),trigger:(0,a.jsxs)(y.z,{variant:"ghost",className:"w-auto h-auto",children:[a.jsx(l.Z,{className:"w-4 h-4 mr-2"}),"Add"]}),onSelect:e=>{s([...t,...e.map(e=>e.value)])}})}),noDataMessage:a.jsx("div",{className:"mt-4 flex flex-col items-center justify-center gap-y-2",children:a.jsx("div",{children:"Data keys has no options"})}),columns:[{name:"Key"},{name:"Label"},{name:"Data type"},{name:"",align:"right",cellClassName:"w-20",cellRenderer:({rowIndex:r})=>!t[r]||e?null:a.jsx(a.Fragment,{children:(0,a.jsxs)(h.h_,{children:[a.jsx(h.$F,{children:a.jsx(n.Z,{className:"h-4 w-4"})}),a.jsx(h.AW,{children:(0,a.jsxs)(h.Xi,{className:"text-destructive",onClick:()=>setTimeout(()=>S(()=>z("options",$.filter((e,t)=>t!==r)),{title:"Delete",message:"Are you sure you want to delete data key option?",danger:!0}),0),children:[a.jsx(d.Z,{className:"h-4 w-4 mr-2"})," Delete"]})})]})})}],data:W.map(e=>[e.name||"",e.label||"",e.dataType||"",""])})}):a.jsx(a.Fragment,{})})]}),a.jsx("br",{}),(0,a.jsxs)(w.eW,{className:"gap-x-2",children:[a.jsx("div",{className:"ml-auto"}),a.jsx(y.z,{asChild:!0,variant:"ghost",children:a.jsx(u.default,{href:"/data-keys",children:"Cancel"})}),!e&&a.jsx(y.z,{onClick:()=>B(),disabled:Q,children:"Save"})]})]})})]})}},35392:(e,t,r)=>{"use strict";r.d(t,{V:()=>p});var a=r(10326),s=r(17577),i=r(47206),l=r(32933),n=r(90772),d=r(54432),o=r(62288),c=r(77863),u=r(61198);function p({options:e,selected:t,...r}){t=Array.isArray(t)?t:t?[t]:[];let s=e.map(e=>({...e,value:`${e.value}`})),i=t.map(e=>`${e}`);if(!r.multiple){let[e]=Array.isArray(i)?i:[i];e&&s.find(t=>t.value===e)}return a.jsx(x,{...r,options:s,selected:i})}function x({modal:e,header:t,placeholder:r,search:p,multiple:x=!1,error:m=!1,disabled:h=!1,selected:y,options:f=[],trigger:b,onTrigger:j,onSelect:v}){let[g,q]=(0,s.useState)(""),N=(0,u.N)(g),[w,k]=(0,s.useState)([]),P=(0,s.useMemo)(()=>y?Array.isArray(y)?y.map(e=>f.find(t=>t?.value===e)).map(e=>e):f.filter(e=>e?.value===y)||[]:[],[y,f]),I=(0,s.useMemo)(()=>f.map(e=>{let t=P.map(e=>e?.value).map(e=>`${e||""}`).filter(e=>e).includes(`${e?.value}`);return t=t||w.includes(e.value),{...e,isSelected:t}}).sort((e,t)=>(e.disabled?1:0)-(t.disabled?1:0)).sort((e,t)=>{let r=e.isSelected?1:0;return(t.isSelected?1:0)-r}).filter(e=>{let t=N.toLowerCase();return!t||JSON.stringify([e.value||"",e.label||"",e.description||""]).toLowerCase().includes(t)}),[f,N,P,w]);return a.jsx(a.Fragment,{children:(0,a.jsxs)(o.Vq,{modal:e,onOpenChange:()=>{q(""),k([])},children:[a.jsx(o.hg,{asChild:!0,children:b||(0,a.jsxs)(n.z,{disabled:h,variant:"outline",className:(0,c.cn)("justify-between w-full",m&&"border border-destructive hover:bg-destructive/10"),onClick:j,children:[a.jsx("span",{className:P.length?"":"opacity-50",children:P[0]?.label||r||""}),a.jsx(i.Z,{className:"size-4 opacity-50"})]})}),(0,a.jsxs)(o.cZ,{hideCloseButton:!0,className:"flex flex-col max-h-[90%] gap-y-4 p-0 m-0 sm:max-w-xl",children:[(0,a.jsxs)(o.fK,{className:"border-b border-b-border px-4 py-4",children:[a.jsx(o.$N,{className:"hidden",children:""}),a.jsx(o.Be,{className:"hidden",children:""}),(0,a.jsxs)("div",{className:"flex items-center gap-x-4",children:[p?a.jsx("div",{className:"flex-1",children:a.jsx(d.I,{type:"search",placeholder:p.placeholder||"",value:g,onChange:e=>q(e.target.value)})}):null,t]})]}),a.jsx("div",{className:"flex-1 flex flex-col gap-y-1 overflow-y-auto px-4 py-2 overflow-x-hidden",children:I.map(e=>{let t=x?"button":o.GG;return a.jsx(s.Fragment,{children:a.jsx(t,{onClick:()=>{e.disabled||(e.isSelected?x?k(t=>t.filter(t=>t!==e.value)):v?.(P.filter(t=>t.value!==e.value)):x?k(t=>[...t,e.value]):v?.([e]))},className:(0,c.cn)("flex flex-col gap-y-1 border border-border p-2 rounded-md items-start text-left",e.disabled?"opacity-50 cursor-not-allowed":"transition-colors hover:bg-primary/20",e.isSelected&&"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground"),children:(0,a.jsxs)("div",{className:"flex items-center",children:[e.isSelected?a.jsx(l.Z,{className:"size-4 mr-2"}):null,(0,a.jsxs)("div",{children:[e.caption?a.jsx("div",{className:"text-xs opacity-60",dangerouslySetInnerHTML:{__html:e.caption||""}}):null,a.jsx("p",{children:e.label}),e.description?a.jsx("div",{className:"text-xs opacity-60",dangerouslySetInnerHTML:{__html:e.description||""}}):null]})]})})},e.value)})}),(0,a.jsxs)(o.cN,{className:"border-t border-t-border px-4 py-2 items-center w-full gap-x-2",children:[a.jsx(o.GG,{asChild:!0,children:a.jsx(n.z,{variant:"ghost",children:"Close"})}),!!w.length&&a.jsx(o.GG,{asChild:!0,children:a.jsx(n.z,{onClick:()=>{v?.(w.map(e=>I.find(t=>t.value===e)).filter(e=>e))},children:"Save"})})]})]})]})})}},54432:(e,t,r)=>{"use strict";r.d(t,{I:()=>l});var a=r(10326),s=r(17577),i=r(77863);let l=s.forwardRef(({className:e,type:t,noRing:r,error:s,...l},n)=>a.jsx("input",{type:t,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r&&"focus-visible:ring-0 focus-visible:ring-transparent focus-visible:ring-offset-0",s&&"border-danger",s&&!r&&"focus-visible:ring-danger",e),ref:n,...l}));l.displayName="Input"},42386:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>u,dynamic:()=>c});var a=r(19510),s=r(85431),i=r(24569),l=r(46697),n=r(94136),d=r(40801),o=r(72177);let c="force-dynamic";async function u(){let[{isSuperUser:e}]=await Promise.all([(0,d.getAuthenticatedUserWithRoles)()]);return(0,a.jsxs)(a.Fragment,{children:[a.jsx(s.D,{children:"Data keys"}),a.jsx(i.V,{children:a.jsx(l.Zb,{className:"mb-20",children:a.jsx(l.aY,{className:"p-0",children:a.jsx(o.C,{...n,disabled:!e})})})})]})}},72177:(e,t,r)=>{"use strict";r.d(t,{C:()=>n});var a=r(68570);let s=(0,a.createProxy)(String.raw`/home/watkay/ReactProjects/neotree-editor/app/(dashboard)/data-keys/components/form.tsx`),{__esModule:i,$$typeof:l}=s;s.default;let n=(0,a.createProxy)(String.raw`/home/watkay/ReactProjects/neotree-editor/app/(dashboard)/data-keys/components/form.tsx#DataKeyForm`)}};var t=require("../../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[1633,1744,1337,3788,2758,4901,9712,1121,7938,9414,8936,5358,4723,4924,259,413,6267,6741,8781,1162,9132,2418,8778,3883,1271,3173,7645,7636,5323],()=>r(14736));module.exports=a})();