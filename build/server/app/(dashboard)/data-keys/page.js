(()=>{var e={};e.id=6948,e.ids=[6948],e.modules={67096:e=>{"use strict";e.exports=require("bcrypt")},47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},39491:e=>{"use strict";e.exports=require("assert")},14300:e=>{"use strict";e.exports=require("buffer")},32081:e=>{"use strict";e.exports=require("child_process")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},41808:e=>{"use strict";e.exports=require("net")},6005:e=>{"use strict";e.exports=require("node:crypto")},87561:e=>{"use strict";e.exports=require("node:fs")},49411:e=>{"use strict";e.exports=require("node:path")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},4074:e=>{"use strict";e.exports=require("perf_hooks")},63477:e=>{"use strict";e.exports=require("querystring")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},76224:e=>{"use strict";e.exports=require("tty")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},67270:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>l.a,__next_app__:()=>h,originalPathname:()=>u,pages:()=>c,routeModule:()=>x,tree:()=>d}),r(70945),r(4326),r(56367),r(12699),r(77482),r(96560);var s=r(23191),a=r(88716),i=r(37922),l=r.n(i),n=r(95231),o={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);r.d(t,o);let d=["",{children:["(dashboard)",{children:["data-keys",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,70945)),"/home/farai/Workbench/Neotree/neotree-editor-master/app/(dashboard)/data-keys/page.tsx"]}]},{loading:[()=>Promise.resolve().then(r.bind(r,4326)),"/home/farai/Workbench/Neotree/neotree-editor-master/app/(dashboard)/data-keys/loading.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,56367)),"/home/farai/Workbench/Neotree/neotree-editor-master/app/(dashboard)/layout.tsx"],loading:[()=>Promise.resolve().then(r.bind(r,12699)),"/home/farai/Workbench/Neotree/neotree-editor-master/app/(dashboard)/loading.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,77482)),"/home/farai/Workbench/Neotree/neotree-editor-master/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.bind(r,96560)),"/home/farai/Workbench/Neotree/neotree-editor-master/app/not-found.tsx"]}],c=["/home/farai/Workbench/Neotree/neotree-editor-master/app/(dashboard)/data-keys/page.tsx"],u="/(dashboard)/data-keys/page",h={require:r,loadChunk:()=>Promise.resolve()},x=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/(dashboard)/data-keys/page",pathname:"/data-keys",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},56763:(e,t,r)=>{Promise.resolve().then(r.bind(r,78346)),Promise.resolve().then(r.bind(r,10827))},78346:(e,t,r)=>{"use strict";r.d(t,{DataKeysTable:()=>W});var s=r(10326),a=r(17577),i=r(39447),l=r(83855),n=r(90434),o=r(35047),d=r(15491),c=r(47035),u=r(44099),h=r(29354),x=r(11870),p=r(60097),m=r(9162),y=r(90772),g=r(68483),b=r(62881);/**
 * @license lucide-react v0.399.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let j=(0,b.Z)("ArrowUpNarrowWide",[["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}],["path",{d:"M11 12h4",key:"q8tih4"}],["path",{d:"M11 16h7",key:"uosisv"}],["path",{d:"M11 20h10",key:"jvxblo"}]]),k=(0,b.Z)("ArrowDownWideNarrow",[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M11 4h10",key:"1w87gc"}],["path",{d:"M11 8h7",key:"djye34"}],["path",{d:"M11 12h4",key:"q8tih4"}]]);var v=r(34474);let f=[{value:"label.asc",label:"Label (asc)",Icon:j},{value:"label.desc",label:"Label (desc)",Icon:k},{value:"key.asc",label:"Key (asc)",Icon:j},{value:"key.desc",label:"Key (desc)",Icon:k},{value:"type.asc",label:"Type (asc)",Icon:j},{value:"type.desc",label:"Type (desc)",Icon:k},{value:"createdAt.asc",label:"Date (asc)",Icon:j},{value:"createdAt.desc",label:"Date (desc)",Icon:k}],w=f[0].value,N=({key1:e,key2:t,sortDirection:r})=>{e=(e||"").trim().toLowerCase(),t=(t||"").trim().toLowerCase();let s=0;return"asc"===r?(e<t&&(s=-1),e>t&&(s=1)):(e>t&&(s=-1),e<t&&(s=1)),s},q=(e,t=w)=>{let r=[...e];switch(t){case"key.desc":r=e.sort((e,t)=>N({sortDirection:"desc",key1:e.name,key2:t.name}));break;case"label.asc":r=e.sort((e,t)=>N({sortDirection:"asc",key1:(e.label||e.name||"").trim(),key2:(t.label||t.name||"").trim()}));break;case"label.desc":r=e.sort((e,t)=>N({sortDirection:"desc",key1:(e.label||e.name||"").trim(),key2:(t.label||t.name||"").trim()}));break;case"type.asc":r=e.sort((e,t)=>N({sortDirection:"asc",key1:(e.dataType||"").trim(),key2:(t.dataType||"").trim()}));break;case"type.desc":r=e.sort((e,t)=>N({sortDirection:"desc",key1:(e.dataType||"").trim(),key2:(t.dataType||"").trim()}));break;case"createdAt.asc":r=e.sort((e,t)=>N({sortDirection:"asc",key1:new Date(e.createdAt||"").getTime().toString(),key2:new Date(t.createdAt||"").getTime().toString()}));break;case"createdAt.desc":r=e.sort((e,t)=>N({sortDirection:"desc",key1:new Date(e.createdAt||"").getTime().toString(),key2:new Date(t.createdAt||"").getTime().toString()}));break;default:r=e.sort((e,t)=>N({sortDirection:"asc",key1:e.name,key2:t.name}))}return r},S=e=>f.find(t=>t.value===e)?.value||w;function D({dataKeys:e,value:t,onSort:r}){let[i,l]=(0,a.useState)(S(t)),n=(0,a.useCallback)(t=>{l(t),r(q(e,t),t)},[e,r]);return s.jsx(s.Fragment,{children:(0,s.jsxs)(v.Ph,{value:i,onValueChange:e=>n(e),children:[s.jsx(v.i4,{children:s.jsx(v.ki,{placeholder:"Sort"})}),s.jsx(v.Bw,{children:f.map(e=>s.jsx(v.Ql,{value:e.value,children:(0,s.jsxs)("div",{className:"flex items-center gap-x-2 w-[120px]",children:[s.jsx(e.Icon,{className:"size-4"}),s.jsx("span",{children:e.label})]})},e.value))})]})})}var K=r(58939),C=r(3529),P=r(77863),E=r(46670),Z=r(96221),I=r(47234),A=r(63685),_=r(74723),M=r(37340),T=r(31048),z=r(53313),F=r(62288);function V({uuids:e}){let[t,r]=(0,a.useState)(!1),[i,l]=(0,a.useState)(!1),{alert:n}=(0,Z.s)(),{sites:o,loading:d,loadSites:c}=(0,M.k)({loadOnMount:!1,onLoadSitesError:()=>r(!1)}),{formState:{errors:h},reset:p,watch:m,setValue:g,register:b,handleSubmit:j,setError:k}=(0,_.cI)({defaultValues:{siteId:"",overwriteExisting:!1}}),f=m("siteId"),w=m("overwriteExisting"),N=i||d,q=!!f&&!N,S=j(async t=>{try{if(t.siteId||k("siteId",{message:"Site is required"}),!q)return;l(!0);let s=(await u.Z.post("/api/data-keys/export",{...t,uuids:e})).data;if(s.errors?.length)throw Error(s.errors.join(", "));n({variant:"success",title:"Success",message:"Data exported successfully!",onClose:()=>r(!1)})}catch(e){n({variant:"error",title:"Error",message:"Failed to export: "+e.message})}finally{l(!1)}});return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(F.Vq,{open:t,onOpenChange:e=>{p(),e&&c(),r(e)},children:[s.jsx(F.hg,{asChild:!0,children:(0,s.jsxs)(y.z,{className:"h-auto w-auto",children:[s.jsx(A.Z,{className:"h-4 w-4 mr-1"}),s.jsx("span",{children:e.length>1?`Export ${e.length}`:"Export"})]})}),(0,s.jsxs)(F.cZ,{children:[(0,s.jsxs)(F.fK,{children:[s.jsx(F.$N,{children:"Export"}),s.jsx(F.Be,{className:"hidden",children:""})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-y-5",children:[(0,s.jsxs)("div",{children:[s.jsx(T._,{htmlFor:"siteId",children:"Site *"}),(0,s.jsxs)(v.Ph,{name:"siteId",onValueChange:e=>g("siteId",e,{shouldDirty:!0}),children:[s.jsx(v.i4,{children:s.jsx(v.ki,{placeholder:"Select site"})}),s.jsx(v.Bw,{children:(0,s.jsxs)(v.DI,{children:[s.jsx(v.n5,{children:"Sites"}),o.map(({siteId:e,name:t})=>s.jsx(v.Ql,{value:e,children:t},e))]})})]}),!!h.siteId?.message&&s.jsx("div",{className:"text-xs text-danger mt-1",children:h.siteId.message})]}),(0,s.jsxs)("div",{className:(0,P.cn)("flex gap-x-2"),children:[s.jsx(z.X,{name:"overwriteExisting",id:"overwriteExisting",checked:w,onCheckedChange:()=>g("overwriteExisting",!w,{shouldDirty:!0})}),s.jsx(T._,{secondary:!0,htmlFor:"overwriteExisting",children:"Overwrite existing"})]})]}),(0,s.jsxs)(F.cN,{children:[s.jsx(F.GG,{asChild:!0,children:s.jsx(y.z,{variant:"ghost",children:"Cancel"})}),(0,s.jsxs)(y.z,{onClick:S,disabled:!q,children:[s.jsx(A.Z,{className:"h-4 w-4 mr-1"}),"Export"]})]})]})]}),N&&s.jsx(x.a,{overlay:!0})]})}function W(e){let t=(0,o.useRouter)(),[r,b]=(0,a.useState)(!1),[j,k]=(0,a.useState)([]),v=(0,o.useSearchParams)(),f=(0,a.useMemo)(()=>d.Z.parse(v.toString()),[v]),N=f.sort||w,[S,A]=(0,a.useState)(!1),{viewOnly:_}=(0,C.b)(),[M,T]=(0,a.useState)({sortValue:N,filter:K.l1,dataKeys:e.dataKeys}),[z,F]=(0,a.useState)(!1),[W,O]=(0,a.useState)(null),{confirm:L}=(0,E.t)(),{alert:R}=(0,Z.s)(),$=(0,a.useCallback)(async e=>{try{b(!0);let r=(await u.Z.delete("/api/data-keys?data="+JSON.stringify({dataKeysIds:e.map(e=>e.uuid),broadcastAction:!0}))).data;if(r.errors?.length)throw Error(r.errors[0]);let s=e.reduce((e,t)=>[...e,...t.children.map(e=>({...e,parentKeys:e.parentKeys.filter(e=>e!=t.name)}))],[]);s.length&&await u.Z.post("/api/data-keys/save",{data:s,broadcastAction:!0}),k([]),t.refresh(),R({title:"Success",message:"Scripts deleted successfully!",variant:"success"})}catch(e){R({title:"Error",message:e.message,variant:"error"})}finally{b(!1)}},[t.refresh,R,L]),G=e.disabled||_,X={selectedIndexes:j,selectable:!G,sortable:!1,loading:!1,maxRows:void 0,onSelect:k,onSort:()=>{},noDataMessage:s.jsx("div",{className:"mt-4 flex flex-col items-center justify-center gap-y-2",children:s.jsx("div",{children:"No data keys saved."})}),getRowOptions({rowIndex:e}){let t=M.dataKeys[e];return t?{className:(0,P.cn)(!_&&t.isDraft&&"bg-danger/20 hover:bg-danger/30")}:{}},columns:[{name:"Key"},{name:"Label"},{name:"Data type"},{name:"",align:"right",cellClassName:(0,P.cn)("w-10"),cellRenderer({rowIndex:t}){let r=M.dataKeys[t];if(!r)return null;let a=e.dataKeys.filter(e=>e.parentKeys.includes(r.name));return s.jsx("div",{children:(0,s.jsxs)(p.h_,{children:[s.jsx(p.$F,{children:s.jsx(i.Z,{className:"size-4"})}),(0,s.jsxs)(p.AW,{children:[s.jsx(p.Xi,{asChild:!0,children:s.jsx(n.default,{href:`/data-keys/key/${r.uuid}`,children:G?"View":"Edit"})}),s.jsx(p.Xi,{className:"text-destructive w-full hover:bg-destructive hover:text-destructive-foreground gap-x-2",onClick:()=>setTimeout(()=>{L(()=>$([{...r,children:a}]),{title:"Delete data key",message:`Are you sure you want to delete data key: <b>${r.name}</b>?`,danger:!0,positiveLabel:"Yes"})},0),children:(0,s.jsxs)(s.Fragment,{children:[s.jsx(c.Z,{className:"text-destructive size-4"}),"Delete"]})})]})]})})}}],data:M.dataKeys.map(e=>[(e.name||"").trim(),(e.label||e.name||"").trim(),(e.dataType||"").trim(),""])},B=(0,a.useCallback)(e=>{let t=e.map(e=>e.uuid);return t.filter((e,r)=>t.indexOf(e)===r)},[M.dataKeys]);return(0,s.jsxs)(s.Fragment,{children:[r&&s.jsx(x.a,{overlay:!0}),!!j.length&&(0,s.jsxs)(h.h,{children:[s.jsx(V,{uuids:B(M.dataKeys.filter((e,t)=>j.includes(t)))}),(0,s.jsxs)(y.z,{variant:"destructive",className:"h-auto w-auto",onClick:()=>{let t=M.dataKeys.filter((e,t)=>j.includes(t)).map(e=>({...e,children:[]}));t.length&&(t=t.map(r=>{let s=e.dataKeys.filter(e=>e.parentKeys.includes(e.name)).filter(e=>!t.map(e=>e.name).includes(e.name));return{...r,children:s}}),L(()=>$(t),{title:"Delete data key",message:`Are you sure you want to delete selected key${t.length>1?"s":""} (${t.length})?`,danger:!0,positiveLabel:"Yes"}))},children:[s.jsx(c.Z,{className:"h-4 w-4 mr-1"}),s.jsx("span",{children:j.length>1?`Delete ${j.length}`:"Delete"})]})]}),s.jsx(I.DataKeyForm,{...e,modal:!0,item:W||void 0,open:z||!!W,onOpenChange:()=>{F(!1),O(null)}}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:flex-wrap py-6 px-4 gap-2",children:[s.jsx("div",{children:s.jsx("h1",{className:"text-2xl",children:"Data keys"})}),(0,s.jsxs)("div",{className:"sm:ml-auto flex flex-col sm:flex-row gap-2",children:[s.jsx(D,{value:N,dataKeys:M.dataKeys,onSort:(e,r)=>{A(!0),T(t=>({...t,dataKeys:e,sortValue:r})),setTimeout(()=>A(!1),0),t.push("/data-keys?"+d.Z.stringify({...f,sort:r}))}}),s.jsx(K.Ed,{dataKeys:e.dataKeys,onFilter:(e,t)=>{A(!0),T(r=>(e=q(e,r.sortValue),{...r,dataKeys:e,filter:t})),setTimeout(()=>A(!1),0)}}),G?null:s.jsx(s.Fragment,{children:s.jsx(y.z,{asChild:!0,variant:"ghost",children:(0,s.jsxs)(n.default,{href:"/data-keys/add",children:[s.jsx(l.Z,{className:"size-4"}),"Add"]})})})]})]}),s.jsx(g.Z,{}),s.jsx(m.DataTable,{...X})]})]})}},29354:(e,t,r)=>{"use strict";r.d(t,{h:()=>l});var s=r(10326),a=r(38178),i=r(77863);function l({children:e,className:t}){return(0,s.jsxs)(s.Fragment,{children:[s.jsx("div",{className:"h-16"}),s.jsx("div",{className:(0,i.cn)(`
                        fixed 
                        left-0 
                        bottom-0 
                        h-16 
                        w-full 
                        border-t 
                        border-t-border 
                        z-[1] 
                        bg-primary-foreground 
                        dark:bg-background 
                        shadow-md 
                        dark:shadow-foreground/10
                    `),children:s.jsx(a.V,{children:s.jsx("div",{className:(0,i.cn)("flex justify-end gap-x-4",t),children:e})})})]})}},68483:(e,t,r)=>{"use strict";r.d(t,{Z:()=>c});var s=r(10326),a=r(17577),i=r(45226),l="horizontal",n=["horizontal","vertical"],o=a.forwardRef((e,t)=>{let{decorative:r,orientation:a=l,...o}=e,d=n.includes(a)?a:l;return(0,s.jsx)(i.WV.div,{"data-orientation":d,...r?{role:"none"}:{"aria-orientation":"vertical"===d?d:void 0,role:"separator"},...o,ref:t})});o.displayName="Separator";var d=r(77863);let c=a.forwardRef(({className:e,orientation:t="horizontal",decorative:r=!0,...a},i)=>s.jsx(o,{ref:i,decorative:r,orientation:t,className:(0,d.cn)("shrink-0 bg-border","horizontal"===t?"h-[1px] w-full":"h-full w-[1px]",e),...a}));c.displayName=o.displayName},37340:(e,t,r)=>{"use strict";r.d(t,{k:()=>n});var s=r(17577),a=r(44099),i=r(3529),l=r(96221);function n(e){let{loadOnMount:t=!0,onLoadSitesError:r}={...e},[n,o]=(0,s.useState)(!1),{alert:d}=(0,l.s)(),{getSites:c}=(0,i.b)(),[u,h]=(0,s.useState)([]);return{loading:n,sites:u,loadSites:(0,s.useCallback)(async()=>{try{o(!0);let e=(await a.Z.get("/api/sites?data="+JSON.stringify({types:["webeditor"]}))).data;if(e.errors?.length)throw Error(e.errors.join(", "));h(e.data||[])}catch(e){d({title:"Error",message:"Failed to load sites: "+e.message,variant:"error",onClose:()=>r?.()})}finally{o(!1)}},[c,d,r])}}},39447:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});/**
 * @license lucide-react v0.399.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(62881).Z)("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]])},83855:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});/**
 * @license lucide-react v0.399.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(62881).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},47035:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});/**
 * @license lucide-react v0.399.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(62881).Z)("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]])},70945:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>m,dynamic:()=>p});var s=r(19510),a=r(85431),i=r(24569),l=r(46697),n=r(94136),o=r(40801),d=r(68570);let c=(0,d.createProxy)(String.raw`/home/farai/Workbench/Neotree/neotree-editor-master/app/(dashboard)/data-keys/components/table.tsx`),{__esModule:u,$$typeof:h}=c;c.default;let x=(0,d.createProxy)(String.raw`/home/farai/Workbench/Neotree/neotree-editor-master/app/(dashboard)/data-keys/components/table.tsx#DataKeysTable`),p="force-dynamic";async function m(){let[e,{isSuperUser:t}]=await Promise.all([n.getDataKeys(),(0,o.getAuthenticatedUserWithRoles)()]);return(0,s.jsxs)(s.Fragment,{children:[s.jsx(a.D,{children:"Data keys"}),s.jsx(i.V,{children:s.jsx(l.Zb,{className:"mb-20",children:s.jsx(l.aY,{className:"p-0",children:s.jsx(x,{...n,disabled:!t,dataKeys:e.data})})})})]})}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[1633,1744,9937,3788,2758,4901,9712,1121,7938,8945,4723,3898,8065,413,6267,7368,3712,4102,1271,7429,1717,9162,8159],()=>r(67270));module.exports=s})();