"use strict";(()=>{var e={};e.id=4687,e.ids=[4687],e.modules={67096:e=>{e.exports=require("bcrypt")},72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},39491:e=>{e.exports=require("assert")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},82361:e=>{e.exports=require("events")},57147:e=>{e.exports=require("fs")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},41808:e=>{e.exports=require("net")},6005:e=>{e.exports=require("node:crypto")},87561:e=>{e.exports=require("node:fs")},49411:e=>{e.exports=require("node:path")},22037:e=>{e.exports=require("os")},4074:e=>{e.exports=require("perf_hooks")},63477:e=>{e.exports=require("querystring")},12781:e=>{e.exports=require("stream")},24404:e=>{e.exports=require("tls")},57310:e=>{e.exports=require("url")},73837:e=>{e.exports=require("util")},59796:e=>{e.exports=require("zlib")},13828:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>m,patchFetch:()=>x,requestAsyncStorage:()=>y,routeModule:()=>d,serverHooks:()=>h,staticGenerationAsyncStorage:()=>f});var a={};t.r(a),t.d(a,{GET:()=>p});var s=t(49303),i=t(88716),n=t(60670),o=t(87070),l=t(57435),u=t(72761),c=t(61927);async function p(e){try{if(!(await (0,u.$)()).yes)return o.NextResponse.json({errors:["Unauthorised"]});JSON.parse(e.nextUrl.searchParams.get("data")||"{}");let r=await (0,c.hg)();return o.NextResponse.json(r)}catch(e){return l.Z.error("[GET] /api/aliases",e.message),o.NextResponse.json({errors:["Internal Error"]})}}let d=new s.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/aliases/route",pathname:"/api/aliases",filename:"route",bundlePath:"app/api/aliases/route"},resolvedPagePath:"/home/farai/Workbench/Neotree/neotree-editor-master/app/api/aliases/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:y,staticGenerationAsyncStorage:f,serverHooks:h}=d,m="/api/aliases/route";function x(){return(0,n.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:f})}},61927:(e,r,t)=>{t.d(r,{hg:()=>o,WL:()=>l,Wk:()=>u});var a=t(66267),s=t(13505),i=t(54491),n=t(57435);let o=async(...e)=>{try{return await (0,a.isAllowed)(),await s._(...e)}catch(e){return n.Z.error("getAllAliases ERROR",e.message),{errors:[e.message],data:[]}}},l=async(...e)=>{try{await (0,a.isAllowed)();let r=await s.Z(...e);if(r)return r;return{alias:""}}catch(e){}},u=async(...e)=>{try{return await (0,a.isAllowed)(),await i.hf(...e)}catch(e){n.Z.error("getAliases ERROR",e.message)}}},54491:(e,r,t)=>{t.d(r,{hf:()=>h,uW:()=>m});var a=t(57368),s=t(10413),i=t(57745),n=t(81445),o=t(67109),l=t(57435);function u(e){if(!e||""===e)return"A";let r=e.match(/^([A-Z]+)(\d*)$/);if(!r)throw Error("Invalid alias format");let[t,a,s]=r,i=s?parseInt(s,10):0,n=(e=>{let r="";do r=String.fromCharCode(e%26+65)+r,e=Math.floor(e/26)-1;while(e>=0);return r})(a.split("").reduce((e,r)=>26*e+(r.charCodeAt(0)-65),0)+1);return n.length>a.length?(n="A")+(i+1):n+(s||"")}async function c(e,r,t,a){let s=[],i=t;for(let t of r)if(!["management","mwi_edliz_summary_table","progress","zw_edliz_summary_table","diagnosis","drugs","fluids","feeds"].includes(t.type)){if("form"===t.type&&Array.isArray(t.fields))for(let r of t.fields)Array.isArray(r.prePopulate)&&r.prePopulate.length>0&&!await p({name:r.key,script:e})&&(i=u(i))&&s.push({name:r.key,alias:i,script:e,oldScript:a});else Array.isArray(t.prePopulate)&&t.prePopulate.length>0&&!await p({name:t.key,script:e})&&(i=u(i))&&s.push({name:t.key,alias:i,script:e,oldScript:a})}return s}async function p(e){return!!await s.Z.query.aliases.findFirst({where:(0,i.xD)((0,i.eq)(o.aliases.script,e.script),(0,i.eq)(o.aliases.name,e.name))})}async function d(){return!!await s.Z.query.aliases.findFirst()}async function y(e){let r={success:!1},t=[],a={};try{for(let r of e)try{if(!await s.Z.query.aliases.findFirst({where:(0,i.xD)((0,i.eq)(o.aliases.script,r.script),(0,i.eq)(o.aliases.name,r.name)),orderBy:(0,n.C)(o.aliases.createdAt)})){let e=s.Z.insert(o.aliases).values({alias:r.alias,name:r.name,script:r.script,oldScript:r.oldScript});a.query=e.toSQL(),await e.execute()}}catch(e){l.Z.error(e.message),t.push(e.message)}t.length?(r.errors=t,r.info=a):r.success=!0}catch(e){r.success=!1,r.errors=[e.message],r.info=a}}async function f(e){try{let r=e?await s.Z.query.aliases.findFirst({where:(0,i.eq)(o.aliases.script,e),orderBy:(0,n.C)(o.aliases.createdAt)}):"";return r?r.alias:""}catch(e){}}async function h(){try{let e=await (0,a.eh)();await d()||await m(e)}catch(e){}}async function m(e){try{for(let r of e)if(r){let e=await (0,a.A0)(r),t=await f(r),s=[r],{data:i,errors:n}=await (0,a.uK)({scriptsIds:s});if(!n||0===n.length){let a=await c(r,i,t||"",e?.[0]??null);a&&a.length>0&&await y(a)}}}catch(e){l.Z.error("Error in _generateScreenAliases:",e)}}},13505:(e,r,t)=>{t.d(r,{_:()=>n,Z:()=>o});var a=t(10413),s=t(67109),i=t(57745);async function n(){try{return{data:await a.Z.query.aliases.findMany()}}catch(e){return{data:[],errors:[e.message]}}}async function o(e){try{if(e&&e.name)return await a.Z.query.aliases.findFirst({where:(0,i.xD)((0,i.eq)(s.aliases.script,e.script),(0,i.eq)(s.aliases.name,e.name)),columns:{alias:!0}});return{alias:""}}catch(e){}}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[1633,1744,9937,3788,1490,5059,413,6267,7368],()=>t(13828));module.exports=a})();