"use strict";(()=>{var e={};e.id=4731,e.ids=[4731],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},57147:e=>{e.exports=require("fs")},41808:e=>{e.exports=require("net")},6005:e=>{e.exports=require("node:crypto")},87561:e=>{e.exports=require("node:fs")},49411:e=>{e.exports=require("node:path")},22037:e=>{e.exports=require("os")},4074:e=>{e.exports=require("perf_hooks")},12781:e=>{e.exports=require("stream")},24404:e=>{e.exports=require("tls")},29543:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>m,patchFetch:()=>g,requestAsyncStorage:()=>f,routeModule:()=>p,serverHooks:()=>x,staticGenerationAsyncStorage:()=>c});var o={};t.r(o),t.d(o,{GET:()=>d});var s=t(49303),n=t(88716),i=t(60670),a=t(87070),l=t(89114),u=t(57435);async function d(e,{params:{fileId:r}}){try{if(!r)return a.NextResponse.json({errors:["Missing fileId"]});let{data:e,errors:t}=await (0,l.KU)(r);if(t?.length)return a.NextResponse.json({errors:t});if(!e?.data)return a.NextResponse.json({errors:["Not found"]});return a.NextResponse.json({data:e})}catch(e){return u.Z.error("[GET] /api/files/"+r+"/download",e),new a.NextResponse("Internal Error",{status:500})}}let p=new s.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/files/[fileId]/download/route",pathname:"/api/files/[fileId]/download",filename:"route",bundlePath:"app/api/files/[fileId]/download/route"},resolvedPagePath:"/home/farai/Workbench/Neotree/neotree-editor-master/app/api/files/[fileId]/download/route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:f,staticGenerationAsyncStorage:c,serverHooks:x}=p,m="/api/files/[fileId]/download/route";function g(){return(0,i.patchFetch)({serverHooks:x,staticGenerationAsyncStorage:c})}},89114:(e,r,t)=>{t.d(r,{_I:()=>l,KU:()=>a});var o=t(57745),s=t(10413),n=t(43509),i=t(57435);async function a(e){try{return{data:await s.Z.query.files.findFirst({where:(0,o.eq)(n.files.fileId,e)})||null}}catch(e){return i.Z.error("_getFiles ERROR",e.message),{errors:[e.message],data:null}}}async function l(e){try{return{file:await s.Z.query.files.findFirst({where:(0,o.eq)(n.files.fileId,e),columns:{contentType:!0,fileId:!0,filename:!0,size:!0,metadata:!0,createdAt:!0}})||null}}catch(e){return i.Z.error("_getFiles ERROR",e.message),{errors:[e.message],file:null}}}},57435:(e,r,t)=>{t.d(r,{Z:()=>d});var o=t(87561),s=t.n(o),n=t(49411),i=t.n(n),a=t(51744),l=t.n(a);function u(e,...r){let t=l()(new Date).format("YYYYMMDD"),o=i().resolve(`logs/${t}`);s().existsSync(o)||s().mkdirSync(o);let n=`${new Date().toUTCString()} ${JSON.stringify([...r])}
`,a=`${o}/${e}`;s().appendFileSync(a,n)}let d={log:(...e)=>{u("logs.txt",...e)},error:(...e)=>{u("errors.txt",...e)},appError:(...e)=>{u("app_errors.txt",...e)}}}};var r=require("../../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[1633,1744,1381,5059,413],()=>t(29543));module.exports=o})();