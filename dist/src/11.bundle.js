(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{201:function(e,t,n){"use strict";var r=n(6),a=n.n(r),c=n(13),o=n.n(c),i=n(20),l=n.n(i),u=n(0),s=n.n(u),d=n(2),f=n.n(d),p=n(324),b=n(320),m=n(321),g=n(188),O=n(325),y=n(326),v=n(105),E=n(338),h=n(323),j=n(40),w=n.n(j),S=n(10),P=n.n(S),k=n(220),D=n.n(k),C=n(322),x=n(200),I=n(195),R=n.n(I),F=n(189),T=n(221),A=n.n(T),q=n(318),N=Object(x.c)((function(){return s.a.createElement("div",null,s.a.createElement(q.a,{title:"Drag to reposition"},s.a.createElement(F.a,{style:{cursor:"move"}},s.a.createElement(A.a,null))))})),W=Object(x.b)((function(e){var t=e.row,n=e.rowIndex,r=e.selectable,c=e.classes,o=e.selected,i=e.setSelected,l=e.displayFields,u=e.action;return s.a.createElement(b.a,{className:P()(c.dataItemRow,{selected:o.map((function(e){return e.rowIndex})).includes(n)})},r&&s.a.createElement(m.a,{padding:"none"},s.a.createElement(E.a,{checked:o.map((function(e){return e.rowIndex})).includes(n),onChange:function(){return i((function(e){return e.map((function(e){return e.rowIndex})).includes(n)?e.filter((function(e){return e.rowIndex!==n})):[].concat(R()(e),[{row:t,rowIndex:n}])}))}})),s.a.createElement(m.a,{padding:"none"},s.a.createElement(N,null)),l.map((function(e,r){var c=e.render?e.render({row:t,rowIndex:n,column:e.key,columnIndex:r}):(t.data||t)[e.key];return s.a.createElement(m.a,a()({},e.cellProps,{key:"".concat(n).concat(e.key).concat(r)}),c)})),u?s.a.createElement(m.a,{align:"right",padding:"none"},u):null)})),_=Object(x.a)((function(e){var t=e.rows,n=e.classes,r=e.selected,a=e.selectable,c=e.setSelected,o=e.displayFields,i=e.renderRowAction;return s.a.createElement(C.a,null,t.map((function(e,t){var l=t;return s.a.createElement(W,{key:"".concat(l).concat(t),row:e,index:t,rowIndex:t,classes:n,selectable:a,action:i?i(e,t)||s.a.createElement(s.a.Fragment,null):null,displayFields:o,selected:r,setSelected:c})})))}));function J(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function H(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?J(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):J(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var M=w()((function(e){return{table:{minWidth:800},headerWrap:{position:"relative",height:60},header:{position:"absolute",top:0,left:0,width:"100%",height:"100%",display:"flex",alignItems:"center",boxSizing:"border-box",padding:e.spacing()},dataItemRow:{"&:hover, &.selected":{backgroundColor:e.palette.action.hover}}}}));function L(e){var t=e.noDataMsg,n=e.title,r=e.selectable,c=e.renderRowAction,o=e.data,i=e.onSortData,u=e.displayFields,d=e.renderHeaderActions;r=!1!==r;var f=M(),j=s.a.useState([]),w=l()(j,2),S=w[0],k=w[1],C=s.a.useState(o),x=l()(C,2),I=x[0],R=x[1];return s.a.useEffect((function(){R(o)}),[o]),s.a.useEffect((function(){if(JSON.stringify(I)!==JSON.stringify(o)){var e=I.map((function(e,t){return H(H({},e),{},{position:t+1})}));R(e),i&&i(e)}}),[I]),s.a.createElement(s.a.Fragment,null,s.a.createElement(g.a,{square:!0,elevation:0},s.a.createElement("div",{className:P()(f.headerWrap)},s.a.createElement("div",{className:P()(f.header)},s.a.createElement(v.a,{variant:"h6"},n),s.a.createElement("div",{style:{marginLeft:"auto"}}),d&&d({selected:S}))),s.a.createElement(h.a,null),I.length?s.a.createElement(p.a,{component:g.a},s.a.createElement(O.a,{className:P()(f.table)},s.a.createElement(y.a,null,s.a.createElement(b.a,null,r&&s.a.createElement(m.a,{padding:"none"},s.a.createElement(E.a,{indeterminate:S.length>0&&S.length<I.length,checked:I.length>0&&S.length===I.length,onChange:function(){return k((function(e){return e.length<I.length?I.map((function(e,t){return{row:e,rowIndex:t}})):[]}))}})),s.a.createElement(m.a,null),u.map((function(e,t){return s.a.createElement(m.a,a()({},e.cellProps,{key:"".concat(e.key).concat(t)}),s.a.createElement("b",null,e.label))})),c?s.a.createElement(m.a,{align:"right"},s.a.createElement("b",null,"Action")):null)),s.a.createElement(_,{rows:I,selectable:r,renderRowAction:c,classes:f,displayFields:u,selected:S,setSelected:k,useDragHandle:!0,onSortEnd:function(e){var t=e.oldIndex,n=e.newIndex;return R((function(e){return D()(e,{$splice:[[t,1],[n,0,e[t]]]})}))}}))):s.a.createElement("div",{style:{textAlign:"center",padding:25}},s.a.createElement(v.a,{color:"textSecondary"},t||"No data"))))}L.propTypes={noDataMsg:f.a.string,selectable:f.a.bool,renderRowAction:f.a.func,title:f.a.string.isRequired,displayFields:f.a.array.isRequired,renderHeaderActions:f.a.func,onSortData:f.a.func,data:f.a.array.isRequired};t.a=L},212:function(e,t,n){"use strict";n.d(t,"e",(function(){return l})),n.d(t,"g",(function(){return u})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return f})),n.d(t,"f",(function(){return p})),n.d(t,"a",(function(){return b}));var r=n(13),a=n.n(r),c=n(28);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return Object(c.a)("/get-screens",i({body:e},t))},u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return Object(c.a)("/update-screens",i({method:"POST",body:e},t))},s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return Object(c.a)("/delete-screen",i({method:"POST",body:e},t))},d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return Object(c.a)("/duplicate-screen",i({method:"POST",body:e},t))},f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return Object(c.a)("/get-screen",i({body:e},t))},p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return Object(c.a)("/update-screen",i({method:"POST",body:e},t))},b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return Object(c.a)("/create-screen",i({method:"POST",body:e},t))}},247:function(e,t,n){"use strict";t.a={PAGE_TITLE:"Screens"}},251:function(e,t,n){"use strict";var r=n(6),a=n.n(r),c=n(20),o=n.n(c),i=n(9),l=n.n(i),u=n(0),s=n.n(u),d=n(2),f=n.n(d),p=n(166),b=n(163),m=n(162),g=n(161),O=n(106),y=n(105),v=n(164),E=n(204),h=s.a.forwardRef((function(e,t){var n=e.children,r=e.ids,c=e.type,i=e.onClick,u=e.onSuccess,d=l()(e,["children","ids","type","onClick","onSuccess"]),f=r.length>1,h=s.a.useState(!1),j=o()(h,2),w=j[0],S=j[1],P=s.a.useState(!1),k=o()(P,2),D=k[0],C=k[1],x=s.a.useState(!1),I=o()(x,2),R=I[0],F=I[1],T=s.a.useState([]),A=o()(T,2),q=A[0],N=A[1],W=s.a.useState(null),_=o()(W,2),J=_[0],H=_[1],M=s.a.useState(!1),L=o()(M,2),G=L[0],z=L[1],B=s.a.useState(""),K=o()(B,2),$=K[0],Q=K[1],U=s.a.useState(!1),V=o()(U,2),X=V[0],Y=V[1];s.a.useEffect((function(){H(null),Q(null),w&&!R&&(C(!0),E.g().then((function(e){var t=e.error,n=e.scripts;if(t)return H(t);N(n),F(!0),C(!1)})).then((function(e){H(e),C(!1)})))}),[w]);var Z=f?"diagnosis"===c?"diagnoses":"screens":c;return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",a()({},d,{ref:t,onClick:function(e){S(!0),i&&i(e)}}),n),s.a.createElement(p.a,{open:w,onClose:function(){return S(!1)},fullWidth:!0,maxWidth:"sm"},s.a.createElement(g.a,null,"Copy ",Z),D?s.a.createElement(m.a,null,s.a.createElement("div",{style:{textAlign:"center"}},s.a.createElement(v.a,null))):s.a.createElement(s.a.Fragment,null,s.a.createElement(m.a,null,s.a.createElement(y.a,null,"Copy to"),s.a.createElement("select",{value:$||"",style:{maxWidth:200,background:"transparent",border:"1px solid #ddd",padding:10,outline:"none !important"},onChange:function(e){return Q(e.target.value)}},s.a.createElement("option",{value:""},"Select script"),q.map((function(e,t){return s.a.createElement("option",{key:t,value:e.id},e.data.title)})))),s.a.createElement(b.a,null,s.a.createElement(O.a,{disabled:G,onClick:function(){return S(!1)}},"Cancel"),s.a.createElement(O.a,{color:"primary",variant:"contained",disabled:G||!$,onClick:function(){var e=null;switch(c){case"screen":e=E.b;break;case"diagnosis":e=E.a}e&&(z(!0),H(null),e({ids:r,script_id:$}).then((function(e){var t=e.error,n=e.items;H(t),z(!1),Q(""),u&&u(n,$),Y(!0)})).catch((function(e){H(e),z(!1)})))}},"Copy"),J?s.a.createElement(y.a,{variant:"caption",color:"error"},J.msg||J.message||JSON.stringify(J)):null))),s.a.createElement(p.a,{open:X,onClose:function(){return Y(!1)},fullWidth:!0,maxWidth:"sm"},s.a.createElement(m.a,null,s.a.createElement("div",{style:{textAlign:"center"}},s.a.createElement(y.a,null,"Copied ",s.a.createElement("b",null,Z)," successfully."))),s.a.createElement(b.a,null,s.a.createElement(O.a,{accent:!0,onClick:function(){S(!1),Y(!1)}},"OK"))))}));h.propTypes={onClick:f.a.func,children:f.a.node,ids:f.a.array.isRequired,onSuccess:f.a.func,type:f.a.oneOf(["screen","diagnosis"]).isRequired},t.a=h},253:function(e,t,n){"use strict";n.d(t,"b",(function(){return S})),n.d(t,"a",(function(){return P}));var r=n(13),a=n.n(r),c=n(20),o=n.n(c),i=n(0),l=n.n(i),u=n(12),s=n(212);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var O=n(195),y=n.n(O);function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var w=l.a.createContext(null),S=function(){return l.a.useContext(w)},P=function(e){return function(t){var n=Object(u.i)().scriptId,r=l.a.useState({screens:[]}),a=o()(r,2),c=a[0],i=a[1],d=function(e){return i((function(t){return j(j({},t),"function"==typeof e?e(t):e)}))},p=function(e){var t=e.setState;return function(e){t({loadingScreens:!0});var n=function(e,n){t(f(f({getScreensError:e},n),{},{screensInitialised:!0,loadingScreens:!1}))};s.e(e).then((function(e){return n(e.errors,e)})).catch(n)}}({setState:d}),m=function(e){var t=e.setState;return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(e.length){t({deletingScreens:!0});var n=function(n){t((function(t){var r=t.screens;return b({deleteScreensError:n,deletingScreens:!1},n?null:{screens:r.filter((function(t){return e.indexOf(t.id)<0}))})}))};s.b({id:e[0]}).then((function(e){return n(e.errors,e)})).catch(n)}}}({setState:d}),O=function(e){var t=e.setState;return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(e.length){t({updatingScreens:!0});var n=function(e,n){t(g(g({updateScreensError:e},n),{},{updatingScreens:!1}))};s.g({screens:e}).then((function(e){return n(e.errors,e)})).catch(n)}}}({setState:d}),v=function(e){var t=e.setState;return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(e.length){t({duplicatingScreens:!0});var n=function(n,r){t((function(t){var a=t.screens;return E({duplicateScreensError:n,duplicatingScreens:!1},n?null:{screens:a.reduce((function(t,n){return[].concat(y()(t),[n],y()(e.indexOf(n.id)<0?[]:[r.screen]))}),[])})}))};s.c({id:e[0]}).then((function(e){return n(e.errors,e)})).catch(n)}}}({setState:d});return l.a.useEffect((function(){p({script_id:n})}),[]),l.a.createElement(w.Provider,{value:{state:c,setState:d,_setState:i,getScreens:p,deleteScreens:m,updateScreens:O,duplicateScreens:v}},l.a.createElement(e,t))}}},270:function(e,t,n){"use strict";var r=n(6),a=n.n(r),c=n(195),o=n.n(c),i=n(0),l=n.n(i),u=n(253),s=n(202),d=n(251),f=l.a.forwardRef((function(e,t){var n=Object(s.b)().state.script,r=Object(u.b)().setState;return l.a.createElement(l.a.Fragment,null,l.a.createElement(d.a,a()({},e,{ref:t,type:"screen",onSuccess:function(e,t){t===n.id&&r((function(t){return{screens:[].concat(o()(t.screens),o()(e))}}))}})))}));t.a=f},294:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(2),o=n.n(c),i=n(189),l=n(205),u=n.n(l),s=n(106),d=n(202),f=n(37),p=n(318),b=n(270);function m(e){var t=e.selected,n=Object(d.b)().state.script;return a.a.createElement(a.a.Fragment,null,t.length>0&&a.a.createElement(a.a.Fragment,null,a.a.createElement(b.a,{ids:t.map((function(e){return e.row.id}))},a.a.createElement(s.a,null,"Copy"))),a.a.createElement(f.b,{to:"/scripts/".concat(n.id,"/screens/new")},a.a.createElement(p.a,{title:"New screen"},a.a.createElement(i.a,null,a.a.createElement(u.a,null)))))}m.propTypes={selected:o.a.array.isRequired},t.default=function(e){return a.a.createElement(m,e)}},302:function(e,t,n){"use strict";n.r(t);var r=n(20),a=n.n(r),c=n(0),o=n.n(c),i=n(2),l=n.n(i),u=n(189),s=n(211),d=n.n(s),f=n(300),p=n(327),b=n(105),m=n(37),g=n(6),O=n.n(g),y=n(9),v=n.n(y),E=n(81),h=n(253),j=o.a.forwardRef((function(e,t){var n=e.children,r=e.ids,c=e.onClick,i=v()(e,["children","ids","onClick"]),l=r.length>1,u=Object(E.a)(),s=a()(u,2),d=s[0],f=s[1],p=Object(h.b)().deleteScreens;return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",O()({},i,{ref:t,onClick:function(e){f(),c&&c(e)}}),n),d({title:"Delete screen".concat(l?"s":""),message:"Are you sure you want to delete screen".concat(l?"s":"","?"),onConfirm:function(){return p(r)}}))}));j.propTypes={onClick:l.a.func,children:l.a.node,ids:l.a.array.isRequired};var w=j,S=n(270);function P(e){var t=e.row,n=o.a.useState(null),r=a()(n,2),c=r[0],i=r[1],l=function(){return i(null)};return o.a.createElement(o.a.Fragment,null,o.a.createElement(u.a,{onClick:function(e){return i(e.currentTarget)}},o.a.createElement(d.a,null)),o.a.createElement(f.a,{anchorEl:c,keepMounted:!0,open:Boolean(c),onClose:l},o.a.createElement(p.a,{component:m.b,to:"/scripts/".concat(t.script_id,"/screens/").concat(t.id),onClick:l},"Edit"),o.a.createElement(p.a,{onClick:l,ids:[t.id],component:S.a},"Copy"),o.a.createElement(p.a,{onClick:l,ids:[t.id],component:w},o.a.createElement(b.a,{color:"error"},"Delete"))))}P.propTypes={row:l.a.object.isRequired,rowIndex:l.a.number.isRequired};t.default=function(e,t){return o.a.createElement(P,{row:e,rowIndex:t})}},331:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(247),o=n(253),i=n(201),l=n(79),u=n(164);t.default=Object(o.a)((function(){var e=Object(o.b)(),t=e.updateScreens,r=e.setState,s=e.state,d=s.screens,f=s.screensInitialised,p=s.loadingScreens,b=s.duplicatingScreens,m=s.deletingScreens;return a.a.createElement(a.a.Fragment,null,f?a.a.createElement(a.a.Fragment,null,a.a.createElement(i.a,{selectable:!0,noDataMsg:"No screens",title:c.a.PAGE_TITLE,data:d,renderHeaderActions:n(294).default,renderRowAction:n(302).default,displayFields:[{key:"type",label:"Type"},{key:"epicId",label:"Epic"},{key:"storyId",label:"Story"},{key:"refId",label:"Ref"},{key:"title",label:"Title"}],onSortData:function(e){r({screens:e}),t(e.map((function(e){return{id:e.id,position:e.position}})))}})):null,p&&a.a.createElement("div",{style:{margin:25,textAlign:"center"}},a.a.createElement(u.a,null)),m||b?a.a.createElement(l.a,null):null)}))}}]);